"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.validateOptions = void 0;
const devkit_1 = require("@nx/devkit");
const semver_1 = require("semver");
const angular_version_utils_1 = require("../../executors/utilities/angular-version-utils");
function validateOptions(options) {
    const angularVersionInfo = (0, angular_version_utils_1.getInstalledAngularVersionInfo)();
    validateAssets(options, angularVersionInfo);
    validateBuildOptimizer(options, angularVersionInfo);
    validateBundleDependencies(options, angularVersionInfo);
    validateVendorChunk(options, angularVersionInfo);
}
exports.validateOptions = validateOptions;
function validateAssets(options, { version }) {
    if ((0, semver_1.lt)(version, '15.1.0') &&
        Array.isArray(options.assets) &&
        options.assets.length > 0) {
        throw new Error((0, devkit_1.stripIndents) `The "assets" option is supported from Angular >= 15.1.0. You are currently using "${version}".
    You can resolve this error by removing the "assets" option or by migrating to Angular 15.1.0.`);
    }
}
function validateBuildOptimizer(options, { major, version }) {
    if (major < 16 && options.buildOptimizer) {
        throw new Error((0, devkit_1.stripIndents) `The "buildOptimizer" option is supported from Angular >= 16.0.0. You are currently using "${version}".
    You can resolve this error by removing the "buildOptimizer" option.`);
    }
}
function validateBundleDependencies(options, { major, version }) {
    if (major >= 15 && options.bundleDependencies) {
        throw new Error((0, devkit_1.stripIndents) `The "bundleDependencies" option was removed in Angular version 15. You are currently using "${version}".
    You can resolve this error by removing the "bundleDependencies" option.`);
    }
}
function validateVendorChunk(options, { version }) {
    if ((0, semver_1.lt)(version, '15.1.0') && options.vendorChunk) {
        throw new Error((0, devkit_1.stripIndents) `The "vendorChunk" option is supported from Angular >= 15.1.0. You are currently using "${version}".
    You can resolve this error by removing the "vendorChunk" option or by migrating to Angular 15.1.0.`);
    }
}
