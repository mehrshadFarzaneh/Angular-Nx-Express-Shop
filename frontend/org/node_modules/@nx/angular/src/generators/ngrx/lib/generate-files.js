"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateNgrxFilesFromTemplates = void 0;
const devkit_1 = require("@nx/devkit");
const semver_1 = require("semver");
const version_utils_1 = require("../../utils/version-utils");
/**
 * Generate 'feature' scaffolding: actions, reducer, effects, interfaces, selectors, facade
 */
function generateNgrxFilesFromTemplates(tree, options) {
    const name = options.name;
    const projectNames = (0, devkit_1.names)(name);
    (0, devkit_1.generateFiles)(tree, (0, devkit_1.joinPathFragments)(__dirname, '..', 'files', 'base'), options.parentDirectory, Object.assign(Object.assign(Object.assign({}, options), projectNames), { importFromOperators: (0, semver_1.lt)(options.rxjsVersion, '7.2.0'), tmpl: '' }));
    const angularVersion = (0, version_utils_1.getInstalledAngularVersion)(tree);
    if ((0, semver_1.lt)(angularVersion, '14.1.0')) {
        (0, devkit_1.generateFiles)(tree, (0, devkit_1.joinPathFragments)(__dirname, '..', 'files', 'no-inject'), options.parentDirectory, Object.assign(Object.assign(Object.assign({}, options), projectNames), { tmpl: '' }));
    }
    if (!options.facade) {
        tree.delete((0, devkit_1.joinPathFragments)(options.parentDirectory, options.directory, `${projectNames.fileName}.facade.ts`));
        tree.delete((0, devkit_1.joinPathFragments)(options.parentDirectory, options.directory, `${projectNames.fileName}.facade.spec.ts`));
    }
}
exports.generateNgrxFilesFromTemplates = generateNgrxFilesFromTemplates;
