const a11_0x464a=['Main\x20job\x20terminated\x20with\x20an\x20error:\x20\x22','FileStorage','next','./distributed-execution.api','printRunGroupError','DteArtifactStorage','getRunGroup','taskGraph','processTasks','values','log','./task-graph-creator','Main\x20job\x20was\x20terminated\x20via\x20SIGINT','nxCloudDistributedTasksRunner','../../../utilities/metric-logger','skipNxCache','done','Successfully\x20completed\x20running\x20the\x20command.','SIGINT','endTasks','throw','axiosException','value','../../error/print-run-group-error','../../api/error-reporter.api','../../../utilities/nx-imports','runUrl','getBranch','ErrorReporterApi','See\x20run\x20details\x20at\x20','lifeCycle','../../file-storage/e2e-encryption','../../../utilities/dte-artifact-storage','message','dte-main','createStartRequest','canDetectRunGroup','then','projectGraph','error','completeRunGroupWithError','Unable\x20to\x20complete\x20a\x20run.','SIGTERM','getCIExecutionEnv','defineProperty','Starting\x20distributed\x20command\x20execution','--skip-nx-cache\x20is\x20ignored\x20when\x20using\x20distributed\x20tasks\x20execution\x20(DTE).','splitTasksIntoStages','exit','note','commandStatus','tasks','E2EEncryption','DTE\x20needs\x20the\x20cache\x20to\x20share\x20files\x20between\x20agents.','submitRunMetrics','scheduleTask','encryptionKey','createTaskGraphCompat','DistributedExecutionApi','__esModule','__awaiter','getCIExecutionId','VERBOSE_LOGGING','../../../utilities/environment','warn','./process-tasks','../../file-storage/file-storage'];(function(_0x564e8c,_0x464aef){const _0x281e12=function(_0x2cd22d){while(--_0x2cd22d){_0x564e8c['push'](_0x564e8c['shift']());}};_0x281e12(++_0x464aef);}(a11_0x464a,0x7a));const a11_0x281e=function(_0x564e8c,_0x464aef){_0x564e8c=_0x564e8c-0x0;let _0x281e12=a11_0x464a[_0x564e8c];return _0x281e12;};'use strict';var __awaiter=this&&this[a11_0x281e('0x5')]||function(_0xd8e3f4,_0x286360,_0x25c008,_0x919f28){function _0xb231fc(_0x1cca9b){return _0x1cca9b instanceof _0x25c008?_0x1cca9b:new _0x25c008(function(_0x2a76b9){_0x2a76b9(_0x1cca9b);});}return new(_0x25c008||(_0x25c008=Promise))(function(_0xe40cb2,_0x3dc640){function _0x182e92(_0x3be6d6){try{_0x40514e(_0x919f28[a11_0x281e('0xe')](_0x3be6d6));}catch(_0x5b6943){_0x3dc640(_0x5b6943);}}function _0x1af40d(_0x29a98d){try{_0x40514e(_0x919f28[a11_0x281e('0x20')](_0x29a98d));}catch(_0x891ac8){_0x3dc640(_0x891ac8);}}function _0x40514e(_0x24c775){_0x24c775[a11_0x281e('0x1c')]?_0xe40cb2(_0x24c775[a11_0x281e('0x22')]):_0xb231fc(_0x24c775[a11_0x281e('0x22')])[a11_0x281e('0x31')](_0x182e92,_0x1af40d);}_0x40514e((_0x919f28=_0x919f28['apply'](_0xd8e3f4,_0x286360||[]))['next']());});};Object[a11_0x281e('0x38')](exports,a11_0x281e('0x4'),{'value':!![]});exports['nxCloudDistributedTasksRunner']=void 0x0;const environment_1=require(a11_0x281e('0x8'));const metric_logger_1=require(a11_0x281e('0x1a'));const error_reporter_api_1=require(a11_0x281e('0x24'));const print_run_group_error_1=require(a11_0x281e('0x23'));const e2e_encryption_1=require(a11_0x281e('0x2b'));const file_storage_1=require(a11_0x281e('0xb'));const distributed_execution_api_1=require(a11_0x281e('0xf'));const split_task_graph_into_stages_1=require('./split-task-graph-into-stages');const task_graph_creator_1=require(a11_0x281e('0x17'));const process_tasks_1=require(a11_0x281e('0xa'));const dte_artifact_storage_1=require(a11_0x281e('0x2c'));const {output,cacheDirectory}=require(a11_0x281e('0x25'));class NoopLifeCycle{[a11_0x281e('0x0')](_0x331dd0){}['startTask'](_0x36203e){}[a11_0x281e('0x1f')](_0x38857f){}}const nxCloudDistributedTasksRunner=(_0x1a56ef,_0x476dcf,_0x3e4e15)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){if(_0x476dcf[a11_0x281e('0x1b')]){output[a11_0x281e('0x9')]({'title':a11_0x281e('0x3a'),'bodyLine':[a11_0x281e('0x41')]});}if(environment_1[a11_0x281e('0x7')]){output[a11_0x281e('0x3d')]({'title':a11_0x281e('0x39')});}_0x476dcf[a11_0x281e('0x2a')]=new NoopLifeCycle();const _0x276494=(0x0,environment_1[a11_0x281e('0x27')])();const _0x49d3c9=(0x0,environment_1[a11_0x281e('0x12')])();const _0x549f5f=(0x0,environment_1[a11_0x281e('0x6')])();const _0x31a36a=(0x0,environment_1[a11_0x281e('0x37')])();if(!(0x0,print_run_group_error_1[a11_0x281e('0x30')])(_0x49d3c9,_0x549f5f)){(0x0,print_run_group_error_1[a11_0x281e('0x10')])();process[a11_0x281e('0x3c')](0x1);}const _0x2feb69=new e2e_encryption_1[(a11_0x281e('0x40'))](environment_1['ENCRYPTION_KEY']||_0x476dcf[a11_0x281e('0x1')]);const _0x1ffd4a=new error_reporter_api_1[(a11_0x281e('0x28'))](_0x476dcf);const _0x33625b=new dte_artifact_storage_1[(a11_0x281e('0x11'))](new file_storage_1[(a11_0x281e('0xd'))](_0x2feb69,_0x1ffd4a,_0x476dcf,a11_0x281e('0x2e')),cacheDirectory);const _0x4e4400=new distributed_execution_api_1[(a11_0x281e('0x3'))](_0x476dcf);attachSignalListenersToCompleteRunGroupOnError(_0x4e4400,_0x276494,_0x49d3c9,_0x549f5f,_0x31a36a);try{const _0x5eb8fe=getTaskGraph(_0x3e4e15,_0x1a56ef,_0x476dcf);const _0x3b4911=yield runDistributedExecution(_0x4e4400,_0x476dcf,_0x33625b,_0x276494,_0x49d3c9,_0x549f5f,_0x31a36a,_0x5eb8fe);if(_0x3b4911['commandStatus']===0x0){output['success']({'title':a11_0x281e('0x1d'),'bodyLines':[a11_0x281e('0x29')+_0x3b4911[a11_0x281e('0x26')]]});}else{output[a11_0x281e('0x33')]({'title':'Command\x20execution\x20failed.','bodyLines':[a11_0x281e('0x29')+_0x3b4911['runUrl']]});}yield(0x0,metric_logger_1[a11_0x281e('0x42')])(_0x476dcf);process[a11_0x281e('0x3c')](_0x3b4911[a11_0x281e('0x3e')]);}catch(_0x1e3129){output[a11_0x281e('0x33')]({'title':a11_0x281e('0x35'),'bodyLines':[_0x1e3129[a11_0x281e('0x2d')]]});if(_0x1e3129[a11_0x281e('0x21')]){console[a11_0x281e('0x16')](_0x1e3129[a11_0x281e('0x21')]);}else{console['log'](_0x1e3129);}try{yield _0x4e4400[a11_0x281e('0x34')](_0x276494,_0x49d3c9,_0x549f5f,_0x31a36a,a11_0x281e('0xc')+_0x1e3129[a11_0x281e('0x2d')]+'\x22');}finally{process[a11_0x281e('0x3c')](0x1);}}});exports[a11_0x281e('0x19')]=nxCloudDistributedTasksRunner;function getTaskGraph(_0x1bcf42,_0x47500e,_0x39aa4b){if(_0x1bcf42[a11_0x281e('0x13')]){return _0x1bcf42[a11_0x281e('0x13')];}else{return(0x0,task_graph_creator_1[a11_0x281e('0x2')])(_0x39aa4b,_0x1bcf42[a11_0x281e('0x32')],_0x47500e);}}function attachSignalListenersToCompleteRunGroupOnError(_0xada5b7,_0xbf0154,_0x1d3631,_0x1ca127,_0x42193e){process['on'](a11_0x281e('0x1e'),()=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0xada5b7[a11_0x281e('0x34')](_0xbf0154,_0x1d3631,_0x1ca127,_0x42193e,a11_0x281e('0x18'));process[a11_0x281e('0x3c')](0x1);}));process['on'](a11_0x281e('0x36'),()=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0xada5b7[a11_0x281e('0x34')](_0xbf0154,_0x1d3631,_0x1ca127,_0x42193e,'Main\x20job\x20was\x20terminated\x20via\x20SIGTERM');process[a11_0x281e('0x3c')](0x1);}));}function runDistributedExecution(_0x42582f,_0xfb82a6,_0x5c4886,_0x24284d,_0x3252b3,_0x19dc91,_0x49c9af,_0x37c051){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x44287b=yield _0x42582f['start']((0x0,distributed_execution_api_1[a11_0x281e('0x2f')])(_0x24284d,_0x3252b3,_0x19dc91,_0x49c9af,(0x0,split_task_graph_into_stages_1[a11_0x281e('0x3b')])(_0x37c051),_0xfb82a6));return yield(0x0,process_tasks_1[a11_0x281e('0x14')])(_0x42582f,_0x5c4886,_0x44287b,Object[a11_0x281e('0x15')](_0x37c051[a11_0x281e('0x3f')]));});}