"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.setupHostIfDynamic = void 0;
const devkit_1 = require("@nx/devkit");
function setupHostIfDynamic(tree, options) {
    var _a;
    if (options.federationType === 'static') {
        return;
    }
    const project = (0, devkit_1.readProjectConfiguration)(tree, options.appName);
    const pathToMFManifest = (0, devkit_1.joinPathFragments)(project.sourceRoot, 'assets/module-federation.manifest.json');
    if (!tree.exists(pathToMFManifest)) {
        tree.write(pathToMFManifest, '{}');
    }
    const pathToProdWebpackConfig = (0, devkit_1.joinPathFragments)(project.root, 'webpack.prod.config.js');
    if (tree.exists(pathToProdWebpackConfig)) {
        tree.delete(pathToProdWebpackConfig);
    }
    (_a = project.targets.build.configurations.production) === null || _a === void 0 ? true : delete _a.customWebpackConfig;
    (0, devkit_1.updateProjectConfiguration)(tree, options.appName, project);
}
exports.setupHostIfDynamic = setupHostIfDynamic;
