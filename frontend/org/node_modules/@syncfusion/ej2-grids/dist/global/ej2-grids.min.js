/*!
*  filename: ej2-grids.min.js
*  version : 22.1.37
*  Copyright Syncfusion Inc. 2001 - 2020. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
this.ej=this.ej||{},this.ej.grids=function(e,t,r,i,n,o,s,a,l,h,p){"use strict";function d(e,t,r,i){if(i&&e)return void e.removeAttribute(t);e&&e.setAttribute(t,r)}function c(){return["aggregates","allowGrouping","allowFiltering","allowMultiSorting","allowReordering","allowSorting","allowTextWrap","childGrid","columns","currentViewData","dataSource","detailTemplate","enableAltRow","enableColumnVirtualization","filterSettings","gridLines","groupSettings","height","locale","pageSettings","printMode","query","queryString","enableRtl","rowHeight","rowTemplate","sortSettings","textWrapSettings","allowPaging","hierarchyPrintMode","searchSettings","queryCellInfo","beforeDataBound"]}function u(e,t){return e.prototype&&t in e.prototype}function g(e,i,n){return t.isNullOrUndefined(e)||""===e?"":r.DataUtil.getObject(e,i)}function f(e,i){return t.isNullOrUndefined(e)||""===e?"":r.DataUtil.getObject(e,i)}function m(e,t){requestAnimationFrame(function(){try{t(null,e())}catch(e){t(e)}})}function y(e){return!t.isNullOrUndefined(e)&&!t.isNullOrUndefined(e.columns)&&e.columns.length>0}function v(e,t){for(var r=e.columns,i=t.columns,n=0;n<r.length;n++)if(i.length-1>=n)if(i[parseInt(n.toString(),10)].columns)for(var o=0;o<i[parseInt(n.toString(),10)].columns.length;o++)r[parseInt(n.toString(),10)].columns[parseInt(o.toString(),10)].type=i[parseInt(n.toString(),10)].columns[parseInt(o.toString(),10)].type;else r[parseInt(n.toString(),10)].type=i[parseInt(n.toString(),10)].type}function C(e){for(var t=[],r=e.vRows,i=0;i<r.length;i++)r[parseInt(i.toString(),10)].isDataRow?t.push(r[parseInt(i.toString(),10)]):r[parseInt(i.toString(),10)].isDataRow||(t.push(r[parseInt(i.toString(),10)]),!r[parseInt(i.toString(),10)].isExpand&&r[parseInt(i.toString(),10)].isCaptionRow&&(i+=S(r[parseInt(i.toString(),10)],e)));e.vcRows=t}function S(e,r){_n=0;var i=r.groupSettings.columns.length,n=e.gSummary,o=0,s="aggregatesCount";if(n===e.data.count)return r.groupSettings.columns.length&&!t.isNullOrUndefined(e[""+s])&&e[""+s]?1!==r.groupSettings.columns.length?_n+=0!==e.indent&&n<2?e.gSummary*(i-e.indent+(i-e.indent)*e[""+s]):e.gSummary*(i-e.indent+(i-e.indent-1)*e[""+s])+e[""+s]:1===r.groupSettings.columns.length&&(_n+=e.gSummary*(i-e.indent)+e[""+s]):r.groupSettings.columns.length&&(1!==r.groupSettings.columns.length?_n+=e.gSummary*(r.groupSettings.columns.length-e.indent):_n+=e.gSummary),_n;for(var a=0,l=e.data.items.length;a<l;a++){var h=e.data.items[parseInt(a.toString(),10)];_n+=h.items.length+(i===r.columns.length||t.isNullOrUndefined(h.items.records)?0:h.items.records.length),o+=t.isNullOrUndefined(h.items.records)||t.isNullOrUndefined(e[""+s])?h.items.length:h.items.records.length,h.items.GroupGuid&&0!==h.items.childLevels&&b(h)}return _n+=e.data.items.length,t.isNullOrUndefined(e[""+s])||e[""+s]&&_n&&0!==o&&(_n+=(_n-o)*e[""+s]+e[""+s]),_n}function b(e){for(var t=0,r=e.items.length;t<r;t++){var i=e.items[parseInt(t.toString(),10)];_n+=i.count,0!==i.items.childLevels&&b(i)}}function w(e,r){for(var i=[],n=0,o=e.length;n<o;n++){var s=r(e[parseInt(n.toString(),10)],n);t.isNullOrUndefined(s)||i.push(s)}return i}function I(e){for(var r=[],i=0;i<e.length;i++)r.push(t.extend({},D(e[parseInt(i.toString(),10)]),{},!0));return r}function R(e){if(e)try{var r="<"!==e[0];return"function"==typeof e?t.compile(e):r&&document.querySelectorAll(e).length?t.compile(document.querySelector(e).innerHTML.trim()):t.compile(e)}catch(r){return t.compile(e)}}function x(e,r){var i={},n=["style","class"];t.extend(i,r,{}),"style"in i&&(t.setStyleAttribute(e,i[n[0]]),delete i[n[0]]),"class"in i&&(t.addClass([e],i[n[1]]),delete i[n[1]]),t.attributes(e,i)}function F(e,r,i,n){for(var o=t.extend(e,r,i),s=Object.keys(o),a=0;a<s.length;a++)n&&-1!==n.indexOf(s[parseInt(a.toString(),10)])&&delete o[s[parseInt(a.toString(),10)]];return o}function T(e,r){void 0===r&&(r=0);for(var i=0,n=e.length;i<n;i++)e[parseInt(i.toString(),10)].columns?(e[parseInt(i.toString(),10)].index=t.isNullOrUndefined(e[parseInt(i.toString(),10)].index)?r:e[parseInt(i.toString(),10)].index,r++,r=T(e[parseInt(i.toString(),10)].columns,r)):(e[parseInt(i.toString(),10)].index=t.isNullOrUndefined(e[parseInt(i.toString(),10)].index)?r:e[parseInt(i.toString(),10)].index,r++);return r}function E(e,r,i){for(var n=0,o=e.length;n<o;n++){var s=void 0;"string"==typeof e[parseInt(n.toString(),10)]?s=new kt({field:e[parseInt(n.toString(),10)]},i):e[parseInt(n.toString(),10)]instanceof kt&&!e[parseInt(n.toString(),10)].columns?s=e[parseInt(n.toString(),10)]:e[parseInt(n.toString(),10)].columns?(e[parseInt(n.toString(),10)].columns=E(e[parseInt(n.toString(),10)].columns,null,i),s=new kt(e[parseInt(n.toString(),10)],i)):s=new kt(e[parseInt(n.toString(),10)],i),s.type&&"checkbox"===s.type.toLowerCase()&&(s.allowReordering=!1),s.headerText=t.isNullOrUndefined(s.headerText)?s.foreignKeyValue||s.field||"":s.headerText,s.foreignKeyField=s.foreignKeyField||s.field,s.valueAccessor=("string"==typeof s.valueAccessor?t.getValue(s.valueAccessor,window):s.valueAccessor)||g,s.width=r&&t.isNullOrUndefined(s.width)?200:s.width,t.isNullOrUndefined(s.visible)&&(s.visible=!0),e[parseInt(n.toString(),10)]=s}return e}function z(e,r,i){var n=e.querySelector("span"),o=e.parentElement.getBoundingClientRect(),s=r.target.getBoundingClientRect();n.className=i,e.style.display="";var a=(t.isNullOrUndefined(r.clientY)?r.changedTouches[0].clientY:r.clientY)>e.offsetHeight+10;e.style.top=s.top-o.top+(a?-(e.offsetHeight+10):e.offsetHeight+10)+"px",e.style.left=M(e,r,s,o.left)+"px",a?(e.querySelector(".e-downtail").style.display="",e.querySelector(".e-uptail").style.display="none"):(e.querySelector(".e-downtail").style.display="none",e.querySelector(".e-uptail").style.display="")}function M(e,t,r,i){var n=e.offsetWidth/2,o=B(t).x;return o-r.left<n?r.left-i:r.right-o<n?r.right-i-2*n:o-i-n}function D(e){return e instanceof t.ChildProperty?t.getValue("properties",e):e}function O(e,t,r){for(var i=e;i&&(r?i.id!==t:!i.classList.contains(t));)i=i.parentElement;return i}function k(e,t){for(var r=-1,i=0,n=t.length;i<n;i++)if(t[parseInt(i.toString(),10)].isEqualNode(e)){r=i;break}return r}function A(e,t){for(var r=0,i=t.length;r<i;r++)if(t[parseInt(r.toString(),10)]===e)return r;return-1}function L(e){for(var t=[],r=0,i=e.length;r<i;r++)e[parseInt(r.toString(),10)].hasOwnProperty("properties")?t.push(e[parseInt(r.toString(),10)].properties):t.push(e[parseInt(r.toString(),10)]);return t}function P(e,r){for(var i=[].slice.call(e.querySelectorAll(r)),n=0;n<i.length;n++)t.remove(i[parseInt(n.toString(),10)])}function B(e){var r={};return r.x=t.isNullOrUndefined(e.clientX)?e.changedTouches[0].clientX:e.clientX,r.y=t.isNullOrUndefined(e.clientY)?e.changedTouches[0].clientY:e.clientY,r}function N(e){return e+Wn++}function q(e,t){for(var r=0,i=t.length;r<i;r++)i===t.length?e.appendChild(t[parseInt(r.toString(),10)]):e.appendChild(t[0]);return e}function H(e,t,r){for(var i=e,n=[];i;)(r?i.id===t:i.classList.contains(t))&&n.push(i),i=i.parentElement;return n}function U(e,i,n,o){if("Custom"===e){var s=n.customAggregate;return"string"==typeof s&&(s=t.getValue(s,window)),s?s.call(o,i,n):""}return n.field in i||i instanceof Array?r.DataUtil.aggregates[e.toLowerCase()](i,n.field):null}function j(){if(null!==Kn)return Kn;var e=document.createElement("div"),t=0;return e.style.cssText="width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;",document.body.appendChild(e),t=e.offsetWidth-e.clientWidth|0,document.body.removeChild(e),Kn=t}function V(e){if(void 0!==Lr)return Lr;var r=t.createElement("table",{className:Jr,styles:"visibility: hidden",attrs:{role:"grid"}});r.innerHTML='<tr><td class="e-rowcell">A<td></tr>',e.appendChild(r);var i=r.querySelector("td").getBoundingClientRect();return e.removeChild(r),Lr=Math.ceil(i.height)}function G(e){if(void 0!==Pr)return Lr;var r=t.createElement("table",{className:Jr,styles:"visibility: hidden",attrs:{role:"grid"}});r.innerHTML='<tr><td class="e-rowcell">A<td></tr>',e.appendChild(r);var i=r.querySelector("tr").getBoundingClientRect();return e.removeChild(r),i.height}function _(e){return e.split(".").length>1}function W(e){return void 0===e&&(e=""),e.replace(/\./g,"___")}function K(e){return void 0===e&&(e=""),e.replace(/[^a-zA-Z0-9_.]/g,"\\$&")}function Q(e){return void 0===e&&(e=""),e.replace(/___/g,".")}function X(e,t,r){var i=O(r,Zr),n=!i||i&&!i.classList.contains("e-insertedrow");return"beginEdit"===t&&n?!(e.isIdentity||e.isPrimaryKey||!e.allowEditing):("add"!==t||!e.isIdentity)&&!(n&&!e.allowEditing&&!e.isIdentity&&!e.isPrimaryKey)}function Y(e){var r=t.select("#"+e.element.id+"EditConfirm",e.element);return"Batch"===e.editSettings.mode&&t.selectAll(".e-updatedtd",e.element).length&&e.editSettings.showConfirmDialog&&(!r||r.classList.contains("e-popup-close"))}function J(e,t){e=e instanceof Array?e:[e];for(var r=0;r<e.length;r++)t?e[parseInt(r.toString(),10)].classList.add("e-wrap"):e[parseInt(r.toString(),10)].classList.remove("e-wrap")}function Z(e,t){var r,i=e.getService("valueFormatter");switch("date"!==t.type&&"datetime"!==t.type&&"dateonly"!==t.type||(r={type:"dateonly"===t.type?"date":t.type,skeleton:t.format},"string"==typeof t.format&&"yMd"!==t.format&&(r.format=t.format)),t.type){case"date":case"dateonly":case"datetime":t.setFormatter(i.getFormatFunction(r)),t.setParser(i.getParserFunction(r));break;case"number":t.setFormatter(i.getFormatFunction({format:t.format})),t.setParser(i.getParserFunction({format:t.format}))}}function $(e,r){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];for(var o=0,s=e.length;o<s;o++)r?(t.classList(e[parseInt(o.toString(),10)],i.slice(),[]),e[parseInt(o.toString(),10)].setAttribute("aria-selected","true")):(t.classList(e[parseInt(o.toString(),10)],[],i.slice()),e[parseInt(o.toString(),10)].removeAttribute("aria-selected"))}function ee(e){for(var t={},r=[],i=0;i<e.length;i++)e[parseInt(i.toString(),10)]in t||(r.push(e[parseInt(i.toString(),10)].toString()),t[e[parseInt(i.toString(),10)]]=1);return r}function te(e,t){var r=t.element.style.display;t.element.style.display="block";var n=t.width,o=i.calculateRelativeBasedPosition(e,t.element);t.element.style.display=r,t.element.style.top=o.top+e.getBoundingClientRect().height-5+"px";var s=o.left-n+e.clientWidth;t.element.style.left=s<1?n+s-16+"px":s+-4+"px"}function re(e,t){e.popup.element.style.zIndex=(t.zIndex+1).toString()}function ie(e){var r=e.querySelector(".e-frame"),i=r.previousSibling;r.classList.contains("e-check")?(i.checked=!1,t.classList(r,["e-uncheck"],["e-check"])):(i.checked=!0,t.classList(r,["e-check"],["e-uncheck"]))}function ne(e,t){e.checked=t}function oe(e,r,i){var n=t.createElement("div",{className:i});return n.appendChild(r),n.setAttribute("uid",e),n}function se(e,r){t.removeClass([e],["e-check","e-stop","e-uncheck"]),r?e.classList.add("e-check"):e.classList.add("e-uncheck")}function ae(e,r,i){for(o=0;o<r.length;o++)t.setValue(r[parseInt(o.toString(),10)].field,le(r[parseInt(o.toString(),10)],i),e.foreignKeyData);for(var n=e.cells,o=0;o<n.length;o++)n[parseInt(o.toString(),10)].isForeignKey&&t.setValue("foreignKeyData",t.getValue(n[parseInt(o.toString(),10)].column.field,e.foreignKeyData),n[parseInt(o.toString(),10)])}function le(e,i,n,o){var s=e.foreignKeyField,a=t.isNullOrUndefined(n)?g(e.field,i,e):n;a=t.isNullOrUndefined(a)?"":a;var l=new r.Query,h=o||(e.dataSource instanceof r.DataManager&&e.dataSource.dataSource.json.length?e.dataSource.dataSource.json:e.columnData);return a.getDay?l.where(de({field:s,operator:"equal",value:a,matchCase:!1})):l.where(s,"==",a,!1),new r.DataManager(h).executeLocal(l)}function he(e,t){var r;return t.some(function(t){return r=t,t.foreignKeyValue===e})&&r}function pe(e){return e<10?"0"+e:String(e)}function de(e,i,n){var o,s,a,l=t.extend({},D(e)),h=t.extend({},D(e));if(t.isNullOrUndefined(e.value)||""===e.value)return o=new r.Predicate(l.field,l.operator,l.value,!1);var p=new Date(e.value);if("dateonly"!==i||n)if("equal"===e.operator||"notequal"===e.operator){"datetime"===i?(s=new Date(p.setSeconds(p.getSeconds()-1)),a=new Date(p.setSeconds(p.getSeconds()+2)),e.value=new Date(p.setSeconds(a.getSeconds()-1))):(s=new Date(p.setHours(0)-1),a=new Date(p.setHours(24))),l.value=s,h.value=a,"equal"===e.operator?(l.operator="greaterthan",h.operator="lessthan"):"notequal"===e.operator&&(l.operator="lessthanorequal",h.operator="greaterthanorequal");var d=new r.Predicate(l.field,l.operator,l.value,!1),c=new r.Predicate(h.field,h.operator,h.value,!1);o="equal"===e.operator?d.and(c):d.or(c)}else{"date"!==i||"lessthanorequal"!==e.operator&&"greaterthan"!==e.operator||(l.value=new Date(p.setHours(24)-1)),"string"==typeof l.value&&(l.value=new Date(l.value));var u=new r.Predicate(l.field,l.operator,l.value,!1);o=u}else{"string"==typeof l.value&&(l.value=new Date(l.value));var g=l.value.getFullYear()+"-"+pe(l.value.getMonth()+1)+"-"+pe(l.value.getDate());o=u=new r.Predicate(l.field,l.operator,g,!1)}return e.setProperties?e.setProperties({ejpredicate:o},!0):e.ejpredicate=o,o}function ce(e,t,r){t=t&&r&&r.isRowDragable()?t+1:t;for(var i=e.cloneNode(!0),n=0;n<t;n++)i.removeChild(i.children[0]);for(var n=t,o=e.childElementCount;n<o;n++)e.removeChild(e.children[e.childElementCount-1]);return i}function ue(e){return e.enableVirtualization&&e.groupSettings.columns.length>0&&e.isVirtualAdaptive&&!e.groupSettings.enableLazyLoading}function ge(e,r){if(void 0===e&&(e=""),e){for(var i=r,n=e.split("."),o=0;o<n.length&&!t.isNullOrUndefined(i);o++)if(i=i[n[parseInt(o.toString(),10)]],t.isUndefined(i)){var s=n[parseInt(o.toString(),10)].charAt(0).toUpperCase()+n[parseInt(o.toString(),10)].slice(1);i=r[""+s]||r[(""+s).charAt(0).toLowerCase()+(""+s).slice(1)]}return i}}function fe(e,r){var i=new t.Internationalization;return"date"===r?"object"==typeof e?i.getDatePattern({type:e.type?e.type:"date",format:e.format},!1):i.getDatePattern({type:"dateTime",skeleton:e},!1):"object"==typeof e?i.getDatePattern({type:e.type?e.type:"dateTime",format:e.format},!1):i.getDatePattern({type:"dateTime",skeleton:e},!1)}function me(e,t){for(var r={},i=0,n=e.getRowsObject();i<n.length;i++){var o=n[i];if(o.isExpand&&!o.isDetailRow){var s=e.allowPaging&&"AllPages"===e.printMode?o.index+e.pageSettings.currentPage*e.pageSettings.pageSize-e.pageSettings.pageSize:o.index;r[parseInt(s.toString(),10)]={},r[parseInt(s.toString(),10)].isExpand=!0,r[parseInt(s.toString(),10)].gridModel=ye(o.childGrid,t),r[parseInt(s.toString(),10)].gridModel.query=e.childGrid.query}}return r}function ye(e,t){void 0===t&&(t="Expanded");var r={};if(!e)return r;for(var i=e.isFrozenGrid()&&!e.getFrozenColumns(),n=0,o=Gn.printGridProp;n<o.length;n++){var s=o[n];r[""+s]="columns"===s?L(i?e.getColumns():e[""+s]):"allowPaging"===s?"CurrentPage"===e.printMode:D(e[""+s])}return r.enableHover=!1,e.childGrid&&"None"!==t&&(r.expandedRows=me(e,t)),r}function ve(e,r,i,n){var o=e||{},s=arguments.length;n&&(s-=1);for(var a=1;a<s;a++)if(arguments[parseInt(a.toString(),10)])for(var l=arguments[parseInt(a.toString(),10)],h=Object.keys(Object.getPrototypeOf(l)).length?Object.keys(l).concat(Ce(l)):Object.keys(l),p=0;p<h.length;p++){var d=o[h[parseInt(p.toString(),10)]],c=l[h[parseInt(p.toString(),10)]],u=void 0;n&&(t.isObject(c)||Array.isArray(c))?t.isObject(c)?(u=d||{},o[h[parseInt(p.toString(),10)]]=t.extend({},u,c,n)):(u=d||[],o[h[parseInt(p.toString(),10)]]=t.extend([],u,c,n)):o[h[parseInt(p.toString(),10)]]=c}return o}function Ce(e){for(var t=[];Object.getPrototypeOf(e)&&Object.keys(Object.getPrototypeOf(e)).length;)t=t.concat(Object.keys(Object.getPrototypeOf(e))),e=Object.getPrototypeOf(e);return t}function Se(e){for(var t=0,r=0;r<e.length;r++){var i=be(e[parseInt(r.toString(),10)],0);t<i&&(t=i)}return t+1}function be(e,t){var r=t,i=[];if(e.columns){t++;for(var n=0;n<e.columns.length;n++)i[parseInt(n.toString(),10)]=be(e.columns[parseInt(n.toString(),10)],t);for(var o=0;o<i.length;o++)r<i[parseInt(o.toString(),10)]&&(r=i[parseInt(o.toString(),10)]);t=r}return t}function we(e,t){for(var r=0;r<t.length;r++)t[parseInt(r.toString(),10)].uid=t[parseInt(r.toString(),10)].isForeignKey?he(t[parseInt(r.toString(),10)].field,e.getForeignKeyColumns()).uid:e.enableColumnVirtualization?tt(e,t[parseInt(r.toString(),10)].field).uid:e.getColumnByField(t[parseInt(r.toString(),10)].field).uid}function Ie(e){var t=document.defaultView.getComputedStyle(e,null).getPropertyValue("transform").replace(/,/g,"");return{width:parseFloat(t.split(" ")[4]),height:parseFloat(t.split(" ")[5])}}function Re(e,t){e.classList.contains("e-bigger")&&t.classList.add("e-bigger")}function xe(e,r){if(e&&r){var i=t.closest(e,"."+Zr).getBoundingClientRect().height,n=t.closest(r,"."+Zr).getBoundingClientRect().height;i>n?r.style.height=i+"px":e.style.height=n+"px"}}function Fe(e,t){var r=t.getContent().firstElementChild.offsetHeight;return e&&e.getBoundingClientRect().top>r}function Te(e,t){return e&&e.getBoundingClientRect().top<t}function Ee(e,t){var r=t.getRowHeight(),i=t.getContent().firstElementChild.scrollTop/r;return e<i+t.getContent().firstElementChild.offsetHeight/r&&e>i}function ze(e,t){var r,i=e.getPrimaryKeyFieldNames()[0];return e.getCurrentViewRecords().filter(function(e,n){i.includes(".")?ge(i,e)===ge(i,t)&&(r=n):e[""+i]===t[""+i]&&(r=n)}),r}function Me(e,t){var i=De(t),n=new r.Deferred;return i.dataSource=n.resolve,i.action=e,{state:i,deffered:n}}function De(e){var t=new r.UrlAdaptor,i=new r.DataManager({url:"",adaptor:new r.UrlAdaptor}),n=t.processQuery(i,e);return JSON.parse(n.data)}function Oe(e){for(var r=e.getVisibleColumns(),i=0,n=0,o=0;o<r.length;o++)t.isUndefined(r[parseInt(o.toString(),10)].width)?n++:-1!==r[parseInt(o.toString(),10)].width.toString().indexOf("%")&&i++;return("auto"===e.width||"string"==typeof e.width&&-1!==e.width.indexOf("%"))&&!e.groupSettings.showGroupedColumn&&e.groupSettings.columns.length&&i&&!n}function ke(e,t,r,i,n){for(var o=i||0,s=n||0;s<t.length;s++)if(t[parseInt(s.toString(),10)]&&t[parseInt(s.toString(),10)].isDataRow){t[parseInt(s.toString(),10)].index=o,t[parseInt(s.toString(),10)].isAltRow=!!e.enableAltRow&&o%2!=0,r[parseInt(s.toString(),10)].setAttribute(si,o.toString()),r[parseInt(s.toString(),10)].setAttribute(ai,(o+1).toString()),t[parseInt(s.toString(),10)].isAltRow?r[parseInt(s.toString(),10)].classList.add("e-altrow"):r[parseInt(s.toString(),10)].classList.remove("e-altrow");for(var a=0;a<r[parseInt(s.toString(),10)].cells.length;a++)r[parseInt(s.toString(),10)].cells[parseInt(a.toString(),10)].setAttribute("index",o.toString());o++}t.length||e.renderModule.emptyRow(!0)}function Ae(e,t,r,i){var n=e.dataToBeUpdated[""+r].concat(t[""+r]).reduce(function(e,t){return e[t[""+i]]=void 0===e[t[""+i]]?t:Object.assign(e[t[""+i]],t),e},{});e.dataToBeUpdated[""+r]=Object.keys(n).map(function(e){return n[""+e]})}function Le(e){if(e.isFrozenGrid()){e.contentModule.rowElements=[].slice.call(e.element.querySelectorAll(".e-movableheader .e-row, .e-movablecontent .e-row"));var t=e.getFrozenMode()===ri?".e-frozen-left-header .e-row, .e-frozen-left-content .e-row":".e-frozenheader .e-row, .e-frozencontent .e-row";e.contentModule.freezeRowElements=[].slice.call(e.element.querySelectorAll(t)),e.getFrozenMode()===ri&&(e.contentModule.frozenRightRowElements=[].slice.call(e.element.querySelectorAll(".e-frozen-right-header .e-row, .e-frozen-right-content .e-row")))}else e.contentModule.rowElements=[].slice.call(e.element.querySelectorAll(".e-row:not(.e-addedrow)"))}function Pe(e,t,r){var i=e.getFrozenLeftCount(),n=e.getMovableColumnsCount(),o=e.getFrozenRightColumnsCount(),s=e.getFrozenMode(),a=e.isRowDragable()?1:0,l="Right"===s?i+n:i+n+a,h="Right"===s?i:i+a,p="Right"===s?t.length-o-a:o?t.length-o:t.length;return r===ni?t=t.slice(0,i?i+a:t.length):r===ii?t=t.slice(l,t.length):"movable"===r&&(t=t.slice(h,p)),t}function Be(e,r){for(var i=e.getColumns(),n=[],o=[],s=[],a=0;a<i.length;a++)!t.isNullOrUndefined(r)&&r&&r!==i[parseInt(a.toString(),10)].visible||("Left"===i[parseInt(a.toString(),10)].freeze||"frozen-left"===i[parseInt(a.toString(),10)].freezeTable?o.push(i[parseInt(a.toString(),10)]):"Right"===i[parseInt(a.toString(),10)].freeze||"frozen-right"===i[parseInt(a.toString(),10)].freezeTable?s.push(i[parseInt(a.toString(),10)]):n.push(i[parseInt(a.toString(),10)]));return{frozenLeft:o,movable:n,frozenRight:s}}function Ne(e,t,r,i,n){(r[0].length||i)&&(n?t(ni,r[0],n[0]):t(ni,r[0])),e.isFrozenGrid()&&(r[1].length||i)&&(n?t("movable",r[1],n[1]):t("movable",r[1])),e.getFrozenMode()!==ri&&"Right"!==e.getFrozenMode()||!r[2].length&&!i||(n?t(ii,r[2],n[2]):t(ii,r[2]))}function qe(e){return["Right"!==e.getFrozenMode()?e.getRowsObject():[],e.getMovableRowsObject(),e.getFrozenRightRowsObject()]}function He(e){return["Right"!==e.getFrozenMode()?e.getAllDataRows(!0):[],e.getAllMovableDataRows(!0),e.getAllFrozenRightDataRows(!0)]}function Ue(e,t,r){for(var i=e.children.length,n=0,o=0;o<i;o++,n++)o>=t&&o<r||(e.removeChild(e.children[parseInt(n.toString(),10)]),n--)}function je(e,t,r){return"movable"===t.getFreezeTableName()?[].slice.call(e.getMovableDataRows()[parseInt(r.toString(),10)].getElementsByClassName(Ur)):t.getFreezeTableName()===ii?[].slice.call(e.getFrozenRightDataRows()[parseInt(r.toString(),10)].getElementsByClassName(Ur)):[].slice.call(e.getDataRows()[parseInt(r.toString(),10)].getElementsByClassName(Ur))}function Ve(e,t,r,i){var n=e.getFrozenLeftCount(),o=e.getMovableColumnsCount();return i="movable"===t.getFreezeTableName()?i-n:t.getFreezeTableName()===ii?i-(n+o):i,je(e,t,r)[parseInt(i.toString(),10)]}function Ge(e,t,r,i,n,o,s){s?r[W(e.field)]=e.validationRules:e.getFreezeTableName()===ni||!t&&e.getFreezeTableName()===ii||1===o?r[W(e.field)]=e.validationRules:"movable"!==e.getFreezeTableName()&&e.getFreezeTableName()?e.getFreezeTableName()===ii&&(n[W(e.field)]=e.validationRules):i[W(e.field)]=e.validationRules}function _e(e){var t;return e.isFrozenGrid()&&(t=e.frozenRows&&"Top"===e.editSettings.newRowPosition?e.getMovableHeaderTbody():e.getMovableContentTbody()),t}function We(e){var t;return e.getFrozenMode()===ri&&(t=e.frozenRows&&"Top"===e.editSettings.newRowPosition?e.getFrozenRightHeaderTbody():e.getFrozenRightContentTbody()),t}function Ke(e,t,r,i,n,o,s){e&&i&&s(e,i),t&&n&&s(t,n),r&&o&&s(r,o)}function Qe(e,r,i,n){var o,s=new t.Internationalization;if("number"===r)try{o=s.getNumberPattern({format:e,currency:n,useGrouping:!0},!0)}catch(t){o=e}else if("date"===r||"time"===r||"datetime"===r)try{if(o=s.getDatePattern({skeleton:e,type:r},i),t.isNullOrUndefined(o))throw"error"}catch(t){try{o=s.getDatePattern({format:e,type:r},i)}catch(t){o=e}}else o=e;if("number"!==r){var a={G:"",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"};o=o.replace(/G|H|c|'| a|yy|y|EEEE|E/g,function(e){return a[""+e]})}return o}function Xe(e){if(e.enableAdaptiveUI)for(var t=document.getElementsByClassName("e-responsive-dialog"),r=0;r<t.length;r++)t[parseInt(r.toString(),10)].classList.add("e-bigger")}function Ye(e,t){for(var r,i=e.split(".").length,n=e.split("."),o=t,s=0;s<i;s++)o=r=o[n[parseInt(s.toString(),10)]];return r}function Je(e,r,i,n,o,s){for(var a=Object.keys(e),l=0;l<a.length;l++){var h=e[a[parseInt(l.toString(),10)]].querySelectorAll("td.e-rowcell")[parseInt(r.toString(),10)];if(e[a[parseInt(l.toString(),10)]].querySelectorAll("td.e-rowcell").length&&h)if(t.setStyleAttribute(e[a[parseInt(l.toString(),10)]].querySelectorAll("td.e-rowcell")[parseInt(r.toString(),10)],{display:i}),e[a[parseInt(l.toString(),10)]].querySelectorAll("td.e-rowcell")[parseInt(r.toString(),10)].classList.contains("e-hide")&&t.removeClass([e[a[parseInt(l.toString(),10)]].querySelectorAll("td.e-rowcell")[parseInt(r.toString(),10)]],["e-hide"]),s&&o.isRowDragable()){var p=o.getFrozenColumns()?r:r+1;n[a[parseInt(l.toString(),10)]].cells[parseInt(p.toString(),10)].visible=""===i}else n[a[parseInt(l.toString(),10)]].cells[parseInt(r.toString(),10)].visible=""===i,!1===n[a[parseInt(l.toString(),10)]].cells[parseInt(r.toString(),10)].visible&&e[a[parseInt(l.toString(),10)]].querySelectorAll("td.e-rowcell")[parseInt(r.toString(),10)].classList.add("e-hide")}}function Ze(e,t,r,i){for(var n=0,o=t;n<o.length;n++){var s=o[n];r?e.on(s.event,s.handler,i):e.off(s.event,s.handler)}}function $e(e,t,r,i){var n=W(t.field);return i=Object.assign(i,{id:e.element.id+n,name:n,"e-mappinguid":t.uid}),e.createElement("input",{className:r,attrs:i})}function et(e,t){for(var r,i=0,n=e.columnModel;i<n.length;i++){var o=n[i];if(o.uid===t){r=o;break}}return r}function tt(e,t){var r;e.columnModel||e.getColumns();for(var i=0,n=e.columnModel;i<n.length;i++){var o=n[i];if(o.field===t){r=o;break}}return r}function rt(e,t,r,i){i.eventHandlers[""+e]={};for(var n=0;n<t.length;n++)i.eventHandlers[""+e][t[parseInt(n.toString(),10)]]=r[t[parseInt(n.toString(),10)]]}function it(e,t,r){for(var i=0;i<t.length&&!e.isDestroyed;i++)e.removeEventListener(t[parseInt(i.toString(),10)],r.eventHandlers[e.element.id][t[parseInt(i.toString(),10)]])}function nt(e,t){e.destroyTemplate(t),e.isReact&&e.renderTemplates()}function ot(e){return parseInt(e.getAttribute(si),10)}function st(e,r,i){for(var n=[],o=0;o<e.length;o++){var s=i.parent.getColumnByField(e[parseInt(o.toString(),10)]),a="null"===r[parseInt(o.toString(),10)]?null:r[parseInt(o.toString(),10)],l={field:e[parseInt(o.toString(),10)],predicate:"or",uid:s.uid,operator:"equal",type:s.type,matchCase:i.allowCaseSensitive,ignoreAccent:i.parent.filterSettings.ignoreAccent};""===a||t.isNullOrUndefined(a)?n=n.concat(Qn.generateNullValuePredicates(l)):n.push(F({},{value:a},l))}return Qn.getPredicate(n)}function at(e){for(var t=[],r=0,i=Object.keys(e);r<i.length;r++){var n=i[r];t.push(e[""+n])}return t}function lt(e,t){for(var r=[],i=[],n=e;n>=0&&(!t[parseInt(n.toString(),10)].isCaptionRow||-1!==r.indexOf(t[parseInt(n.toString(),10)].data.field)||!(t[parseInt(n.toString(),10)].indent<t[parseInt(e.toString(),10)].indent||n===e)||(r.push(t[parseInt(n.toString(),10)].data.field),i.push(t[parseInt(n.toString(),10)].data.key),0!==t[parseInt(n.toString(),10)].indent));n--);return{fields:r,keys:i}}function ht(e,t,r){var i=e,n=t,o=!1;if(r)for(l=n[0];l<i.length;l++)for(var s=i[parseInt(l.toString(),10)],a=0;a<s.length;a++){if(o&&1===i[parseInt(l.toString(),10)][parseInt(a.toString(),10)])return n=[l,a];o||n.toString()!==[l,a].toString()||(o=!0)}else for(var l=n[0];l>=0;l--)for(a=(s=i[parseInt(l.toString(),10)]).length-1;a>=0;a--){if(o&&1===i[parseInt(l.toString(),10)][parseInt(a.toString(),10)])return n=[l,a];o||n.toString()!==[l,a].toString()||(o=!0)}return n}function pt(e){return e.charAt(0).toUpperCase()+e.slice(1)}function dt(e,t){for(var r=0;r<e.length;r++)for(var i=0;i<e[parseInt(r.toString(),10)].columns.length;i++)t(e[parseInt(r.toString(),10)].columns[parseInt(i.toString(),10)],e[parseInt(r.toString(),10)])}function ct(e,t,r,i,n){var o="Dialog"!==t,s=fe(e.column.format,e.column.type),a=ge(e.column.field,e.rowData);return a=a?new Date(a):null,{floatLabelType:o?"Never":"Always",value:a,format:s,placeholder:o?"":e.column.headerText,enableRtl:r,enabled:X(e.column,e.requestType,e.element),cssClass:i||null,close:ut.bind(n)}}function ut(e){e.event&&"escape"===e.event.action&&(this.edit.editCellDialogClose=!0)}function gt(e,t,r,i,n,o,s,a){i.clearSelection(),e.startIndex=0;var l=new fi(o,null,i),h=n.generateRows(t,e);e.renderMovableContent?(s.vgenerator.movableCache[1]=h,h=i.getMovableRowsObject()):e.renderFrozenRightContent||e.renderMovableContent?e.renderFrozenRightContent&&(s.vgenerator.frozenRightCache[1]=h,h=i.getFrozenRightRowsObject()):(s.vgenerator.cache[1]=h,h=i.getRowsObject());var p=e.renderMovableContent||e.renderFrozenRightContent?e.renderMovableContent?i.getHeaderContent().querySelector("."+Kr).querySelector(li):i.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(li):i.getHeaderContent().querySelector("."+Xr).querySelector(li);p.innerHTML="";for(var d=0;d<i.frozenRows;d++)if(p.appendChild(l.render(h[parseInt(d.toString(),10)],i.getColumns())),r.indexOf(d)>-1){h[parseInt(d.toString(),10)].isSelected=!0;for(var c=0;c<h[parseInt(d.toString(),10)].cells.length;c++)h[parseInt(d.toString(),10)].cells[parseInt(c.toString(),10)].isSelected=!0}e.renderMovableContent?a.mvblRows=s.vgenerator.movableCache[1]:e.renderMovableContent||e.renderFrozenRightContent?e.renderFrozenRightContent&&(a.frRows=s.vgenerator.frozenRightCache[1]):a.frzRows=s.vgenerator.cache[1],e.renderMovableContent=!e.renderMovableContent&&!e.renderFrozenRightContent,e.renderFrozenRightContent=i.getFrozenMode()===ri&&!e.renderMovableContent&&!e.renderFrozenRightContent,(e.renderMovableContent||e.renderFrozenRightContent)&&(gt(e,t,r,i,n,o,s,a),e.renderMovableContent||e.renderFrozenRightContent||(e.isFrozenRowsRender=!1))}function ft(e,r,i){for(var n=[],o=0;o<e.length;o++)n.push(t.extend({},e[parseInt(o.toString(),10)])),n[parseInt(o.toString(),10)].cells=Pe(i,n[parseInt(o.toString(),10)].cells,r);return n}function mt(e,t,r){var i,n=[];e===ni?i=t.vgenerator.cache:"movable"===e?i=t.vgenerator.movableCache:e===ii&&(i="Right"===r.getFrozenMode()?t.vgenerator.cache:t.vgenerator.frozenRightCache);for(var o=Object.keys(i),s=0;s<o.length;s++)n=n.concat(ft(i[o[parseInt(s.toString(),10)]],e,r));return n}function yt(e,t){for(var r=Object.keys(t.vgenerator.cache),i=Object.keys(t.vgenerator.movableCache),n=Object.keys(t.vgenerator.frozenRightCache),o=0;o<r.length;o++)vt(e,t.vgenerator.cache[r[parseInt(o.toString(),10)]]);for(o=0;o<i.length;o++)vt(e,t.vgenerator.movableCache[i[parseInt(o.toString(),10)]]);for(o=0;o<n.length;o++)vt(e,t.vgenerator.frozenRightCache[n[parseInt(o.toString(),10)]])}function vt(e,t){for(var r=t.filter(function(t){return e.clearAll||e.uid===t.uid}),i=0;i<r.length;i++){r[parseInt(i.toString(),10)].isSelected=e.set;for(var n=r[parseInt(i.toString(),10)].cells,o=0;o<n.length;o++)n[parseInt(o.toString(),10)].isSelected=e.set}}function Ct(e,t,r,i,n){e.appendContent(r,i,n),t.refreshFrozenScrollbar()}function St(e,r,i,n,o){var s=[];s=e.vgenerator.generateRows(r,i).map(function(e){return t.extend({},e)});var a=n.generateRows(r,i,s);return o.frozenRows&&"delete"===i.requestType&&1===o.pageSettings.currentPage&&(a=a.slice(o.frozenRows)),a}function bt(e,t,r,i,n){var o=e.virtualInfo.blockIndexes,s=e.virtualInfo.columnIndexes,a=e.virtualInfo.page;e.virtualInfo.blockIndexes=[1,2],e.virtualInfo.page=1,e.renderMovableContent||(e.virtualInfo.columnIndexes=[]);var l=r.getCurrentViewRecords().length;n=r.renderModule.data.dataManager.dataSource.json.slice(0,l);var h=wt(t.vgenerator.generateRows(n,e),r,e,i);return e.virtualInfo.blockIndexes=o,e.virtualInfo.columnIndexes=s,e.virtualInfo.page=a,h.splice(0,r.frozenRows)}function wt(e,t,r,i){var n;n=r.renderMovableContent?"movable":r.renderFrozenRightContent?"frozen-right":"frozen-left";for(var o=0,s=e.length;o<s;o++)e[parseInt(o.toString(),10)].cells=Pe(t,e[parseInt(o.toString(),10)].cells,n);return e}function It(e){var t=!1;return e&&(t="virtualscroll"===e.requestType&&"X"===e.currentInfo.sentinelInfo.axis),t}function Rt(e,t){var r=It(e)?t.getMovableVirtualHeader():t.getHeaderContent();return r?[].slice.call(r.querySelectorAll(".e-headercell:not(.e-stackedheadercell)")):[]}function xt(e,t){return It(e)?t.getMovableVirtualHeader().querySelector("."+Jr+":not(.e-masked-table)"):t.getFrozenVirtualHeader().querySelector("."+Jr)}function Ft(e,t){return e=t.columns.slice(0,t.getFrozenColumns()).concat(e)}function Tt(e,r,i){return It(r)||(t.isNullOrUndefined(e)||(e.id="content-"+e.id),i.colgroup=e),i.colgroup}function Et(e,t){e.virtualRenderer.vgenerator.cache[1]?e.virtualRenderer.vgenerator.cache[1][parseInt(t.toString(),10)]=e.frzRows[parseInt(t.toString(),10)]:e.virtualRenderer.vgenerator.cache[1]=e.frzRows,e.virtualRenderer.vgenerator.movableCache[1]?e.virtualRenderer.vgenerator.movableCache[1][parseInt(t.toString(),10)]=e.mvblRows[parseInt(t.toString(),10)]:e.virtualRenderer.vgenerator.movableCache[1]=e.mvblRows}function zt(e,t,i,n){var o=e.dataSource instanceof r.DataManager&&!e.dataSource.dataSource.offline,s={container:t.content,pageHeight:2*t.getBlockHeight(),debounceEvent:o,axes:e.enableColumnVirtualization?["X","Y"]:["Y"],scrollbar:i,movableContainer:n};t.observer=new Oo(t.virtualEle.wrapper,s,t.virtualEle.movableWrapper)}var Mt=function(){function e(e){this.intl=new t.Internationalization,t.isNullOrUndefined(e)||(this.intl.culture=e)}return e.prototype.getFormatFunction=function(e){return e.type?this.intl.getDateFormat(e):this.intl.getNumberFormat(e)},e.prototype.getParserFunction=function(e){return e.type?this.intl.getDateParser(e):this.intl.getNumberParser(e)},e.prototype.fromView=function(e,r,i){return"date"!==i&&"datetime"!==i&&"number"!==i||t.isNullOrUndefined(r)?e:r(e)},e.prototype.toView=function(e,r){var i=e;return t.isNullOrUndefined(r)||t.isNullOrUndefined(e)||(i=r(e)),i},e.prototype.setCulture=function(e){t.isNullOrUndefined(e)||t.setCulture(e)},e}(),Dt=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ot=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},kt=function(){function e(e,i){var n=this;this.disableHtmlEncode=!0,this.allowSorting=!0,this.allowResizing=!0,this.allowFiltering=!0,this.allowGrouping=!0,this.allowReordering=!0,this.showColumnMenu=!0,this.enableGroupByFormat=!1,this.allowEditing=!0,this.filter={},this.showInColumnChooser=!0,this.edit={},this.allowSearching=!0,this.autoFit=!1,this.sortDirection="Descending",this.getEditTemplate=function(){return n.editTemplateFn},this.getFilterTemplate=function(){return n.filterTemplateFn},t.merge(this,e),this.parent=i,"none"===this.type?this.type=null:this.type&&(this.type="string"==typeof this.type?this.type.toLowerCase():void 0),this.editType&&(this.editType=this.editType.toLowerCase()),t.isNullOrUndefined(this.uid)&&(this.uid=N("grid-column"));var o=new Mt;if(e.format&&(e.format.skeleton||e.format.format&&"string"==typeof e.format.format)&&(this.setFormatter(o.getFormatFunction(t.extend({},e.format))),this.setParser(o.getParserFunction(e.format))),this.toJSON=function(){for(var e={},t=["filter","dataSource","headerText","template","headerTemplate","edit","editTemplate","filterTemplate","commandsTemplate","parent"],r=Object.keys(n),i=0;i<r.length;i++)if("columns"===r[parseInt(i.toString(),10)]){e[r[parseInt(i.toString(),10)]]=[];for(var o=0;o<n[r[parseInt(i.toString(),10)]].length;o++)e[r[parseInt(i.toString(),10)]].push(n[r[parseInt(i.toString(),10)]][parseInt(o.toString(),10)].toJSON())}else t.indexOf(r[parseInt(i.toString(),10)])<0&&(e[r[parseInt(i.toString(),10)]]=n[r[parseInt(i.toString(),10)]]);return e},this.field||(this.allowFiltering=!1,this.allowGrouping=!1,this.allowSorting=!1,this.columns&&(this.allowResizing=this.columns.some(function(e){return e.allowResizing}))),this.commands&&!this.textAlign&&(this.textAlign="Right"),(this.template||this.commandsTemplate)&&(this.templateFn=R(this.template||this.commandsTemplate)),this.headerTemplate&&(this.headerTemplateFn=R(this.headerTemplate)),!t.isNullOrUndefined(this.filter)&&this.filter.itemTemplate&&(this.fltrTemplateFn=R(this.filter.itemTemplate)),this.editTemplate&&(this.editTemplateFn=R(this.editTemplate)),this.filterTemplate&&(this.filterTemplateFn=R(this.filterTemplate)),this.isForeignColumn()&&(t.isNullOrUndefined(this.editType)||"dropdownedit"===this.editType||"defaultedit"===this.editType)&&(this.editType="dropdownedit",this.edit.params&&this.edit.params.dataSource&&(this.edit.params.ddEditedData=!0),this.edit.params=t.extend({dataSource:this.dataSource,query:new r.Query,fields:{value:this.foreignKeyField||this.field,text:this.foreignKeyValue}},this.edit.params)),this.sortComparer){var s=this.sortComparer;this.sortComparer=function(e,t,r,i){if("string"==typeof s&&(s=ge(s,window)),"Descending"===n.sortDirection){var o=e;e=t,t=o;var a=r;r=i,i=a}return s(e,t,r,i)}}!this.sortComparer&&this.isForeignColumn()&&(this.sortComparer=function(e,t){return e=ge(n.foreignKeyValue,le(n,{},e)[0]),t=ge(n.foreignKeyValue,le(n,{},t)[0]),"Descending"===n.sortDirection?r.DataUtil.fnDescending(e,t):r.DataUtil.fnAscending(e,t)})}return e.prototype.getSortDirection=function(){return this.sortDirection},e.prototype.setSortDirection=function(e){this.sortDirection=e},e.prototype.getFreezeTableName=function(){return this.freezeTable},e.prototype.setProperties=function(e){for(var t=Object.keys(e),r=0;r<t.length;r++)this[t[parseInt(r.toString(),10)]]=e[t[parseInt(r.toString(),10)]],this.parent&&this.parent.isReact&&("template"===t[parseInt(r.toString(),10)]?(this.templateFn=R(e[t[parseInt(r.toString(),10)]]),this.parent.refreshReactColumnTemplateByUid(this.uid,!0)):"headerTemplate"===t[parseInt(r.toString(),10)]?(this.headerTemplateFn=R(e[t[parseInt(r.toString(),10)]]),this.parent.refreshReactHeaderTemplateByUid(this.uid)):"editTemplate"===t[parseInt(r.toString(),10)]&&(this.editTemplateFn=R(e[t[parseInt(r.toString(),10)]])))},e.prototype.isForeignColumn=function(){return!(!this.dataSource||!this.foreignKeyValue)},e.prototype.getFormatter=function(){return this.formatFn},e.prototype.setFormatter=function(e){this.formatFn=e},e.prototype.getParser=function(){return this.parserFn},e.prototype.setParser=function(e){this.parserFn=e},e.prototype.getColumnTemplate=function(){return this.templateFn},e.prototype.getHeaderTemplate=function(){return this.headerTemplateFn},e.prototype.getFilterItemTemplate=function(){return this.fltrTemplateFn},e.prototype.getDomSetter=function(){return this.disableHtmlEncode?"textContent":"innerHTML"},e}(),At=function(){function e(){}return Ot([t.Property()],e.prototype,"title",void 0),Ot([t.Property()],e.prototype,"type",void 0),Ot([t.Property()],e.prototype,"buttonOption",void 0),e}(),Lt=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Dt(r,e),Ot([t.Property(null)],r.prototype,"columns",void 0),r}(kt),Pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Dt(t,e),t}(Lt),Bt="actionBegin",Nt="actionComplete",qt="dataBound",Ht="columnDragStart",Ut="columnDrag",jt="columnDrop",Vt="rowDragStartHelper",Gt="rowDragStart",_t="rowDrag",Wt="rowDrop",Kt="initial-load",Qt="initial-end",Xt="data-ready",Yt="content-ready",Jt="ui-update",Zt="on-empty",$t="inbound-model-changed",er="model-changed",tr="colgroup-refresh",rr="header-refreshed",ir="reorder-complete",nr="rowdraganddrop-complete",or="beforecellfocused",sr="key-pressed",ar="click",lr="destroy",hr="column-visible-changed",pr="column-position-changed",dr="rows-added",cr="rows-removed",ur="column-drag-stop",gr="header-drop",fr="datasource-modified",mr="refresh-virtual-block",yr="auto-col",vr="update-data",Cr="prevent-batch",Sr="dialog-destroy",br="add-delete-Action",wr="freezerender",Ir="filter-menu-close",Rr="hierarchyprint",xr="expandchildgrid",Fr="row-position-changed",Tr="columns-prepared",Er="cbox-filter-complete",zr="filter-Prevent",Mr="get-virtual-data",Dr="refresh-infinite-mode-blocks",Or="refreshResizeHandlers",kr="destroy-child-grid",Ar="commandColumnDestroy";!function(e){e[e.Data=0]="Data",e[e.Header=1]="Header",e[e.Summary=2]="Summary",e[e.GroupSummary=3]="GroupSummary",e[e.CaptionSummary=4]="CaptionSummary",e[e.Filter=5]="Filter",e[e.Indent=6]="Indent",e[e.GroupCaption=7]="GroupCaption",e[e.GroupCaptionEmpty=8]="GroupCaptionEmpty",e[e.Expand=9]="Expand",e[e.HeaderIndent=10]="HeaderIndent",e[e.StackedHeader=11]="StackedHeader",e[e.DetailHeader=12]="DetailHeader",e[e.DetailExpand=13]="DetailExpand",e[e.CommandColumn=14]="CommandColumn",e[e.DetailFooterIntent=15]="DetailFooterIntent",e[e.RowDragIcon=16]="RowDragIcon",e[e.RowDragHIcon=17]="RowDragHIcon"}(e.CellType||(e.CellType={})),function(e){e[e.Header=0]="Header",e[e.Content=1]="Content",e[e.Summary=2]="Summary"}(e.RenderType||(e.RenderType={})),function(e){e[e.Add=0]="Add",e[e.Edit=1]="Edit",e[e.Update=2]="Update",e[e.Delete=3]="Delete",e[e.Cancel=4]="Cancel",e[e.Print=5]="Print",e[e.Search=6]="Search",e[e.ColumnChooser=7]="ColumnChooser",e[e.PdfExport=8]="PdfExport",e[e.ExcelExport=9]="ExcelExport",e[e.CsvExport=10]="CsvExport",e[e.WordExport=11]="WordExport"}(e.ToolbarItem||(e.ToolbarItem={})),function(e){e[e.isEdit=0]="isEdit",e[e.isAdd=1]="isAdd",e[e.isSort=2]="isSort",e[e.isFilter=3]="isFilter"}(e.ResponsiveDialogAction||(e.ResponsiveDialogAction={})),function(e){e[e.isInitial=0]="isInitial",e[e.isSearch=1]="isSearch"}(e.ResponsiveToolbarAction||(e.ResponsiveToolbarAction={}));var Lr,Pr,Br=function(){function e(e,t){this.dataState={isPending:!1,resolver:null,group:[]},this.foreignKeyDataState={isPending:!1,resolver:null},this.parent=e,this.serviceLocator=t,this.initDataManager(),this.parent.isDestroyed||"foreignKey"===this.getModuleName()||(this.parent.on(dr,this.addRows,this),this.parent.on(Fr,this.reorderRows,this),this.parent.on(cr,this.removeRows,this),this.parent.on(fr,this.initDataManager,this),this.parent.on(lr,this.destroy,this),this.parent.on(vr,this.crudActions,this),this.parent.on(br,this.getData,this),this.parent.on(yr,this.refreshFilteredCols,this),this.parent.on(Tr,this.refreshFilteredCols,this))}return e.prototype.reorderRows=function(e){this.dataManager.dataSource.json.splice(e.toIndex,0,this.dataManager.dataSource.json.splice(e.fromIndex,1)[0])},e.prototype.getModuleName=function(){return"data"},e.prototype.initDataManager=function(){var e=this.parent;this.dataManager=e.dataSource instanceof r.DataManager?e.dataSource:t.isNullOrUndefined(e.dataSource)?new r.DataManager:new r.DataManager(e.dataSource),!e.isAngular||e.query instanceof r.Query?(this.isQueryInvokedFromData=!0,e.query=e.query instanceof r.Query?e.query:new r.Query):e.setProperties({query:new r.Query},!0)},e.prototype.generateQuery=function(e,r){var i=this.parent.getQuery().clone();if("ExcludeHidden"===this.parent.columnQueryMode)i.select(this.parent.getColumns().filter(function(e){return!(!0!==e.isPrimaryKey&&!1===e.visible||void 0===e.field)}).map(function(e){return e.field}));else if("Schema"===this.parent.columnQueryMode){for(var n=[],o=this.parent.columns,s=0;s<o.length;s++)n.push(o[parseInt(s.toString(),10)].field);i.select(n)}return this.filterQuery(i),this.searchQuery(i),this.aggregateQuery(i),this.sortQuery(i),ue(this.parent)?this.virtualGroupPageQuery(i):this.pageQuery(i,e),!t.isNullOrUndefined(r)&&r||this.groupQuery(i),i},e.prototype.aggregateQuery=function(e){for(var t=this.parent.aggregates,r=0;r<t.length;r++)for(var i=t[parseInt(r.toString(),10)],n=0;n<i.columns.length;n++)for(var o=i.columns[parseInt(n.toString(),10)],s=o.type instanceof Array?o.type:[o.type],a=0;a<s.length;a++)e.aggregate(s[parseInt(a.toString(),10)].toLowerCase(),o.field);return e},e.prototype.virtualGroupPageQuery=function(e){if(e.queries.length)for(var t=0;t<e.queries.length;t++)"onPage"===e.queries[parseInt(t.toString(),10)].fn&&e.queries.splice(t,1);return e},e.prototype.pageQuery=function(e,i){var n=this.parent,o={query:e,skipPage:!1};if(n.notify("set-virtual-page-query",o),o.skipPage)return e;if((n.allowPaging||n.enableVirtualization||n.enableInfiniteScrolling)&&!0!==i){if(n.pageSettings.currentPage=Math.max(1,n.pageSettings.currentPage),n.pageSettings.pageCount<=0&&(n.pageSettings.pageCount=8),n.pageSettings.pageSize<=0&&(n.pageSettings.pageSize=12),e.queries.length)for(var s=0;s<e.queries.length;s++)"onPage"===e.queries[parseInt(s.toString(),10)].fn&&e.queries.splice(s,1);!t.isNullOrUndefined(n.infiniteScrollModule)&&n.enableInfiniteScrolling?this.parent.notify("infinite-page-query",e):e.page(n.pageSettings.currentPage,!(n.allowPaging&&n.pagerModule&&n.pagerModule.pagerObj.isAllPage)||this.dataManager.dataSource.offline||this.dataManager.adaptor instanceof r.RemoteSaveAdaptor?n.pageSettings.pageSize:null)}return e},e.prototype.groupQuery=function(e){var t=this.parent;if(t.allowGrouping&&t.groupSettings.columns.length){this.parent.groupSettings.enableLazyLoading&&e.lazyLoad.push({key:"isLazyLoad",value:this.parent.groupSettings.enableLazyLoading});for(var r=t.groupSettings.columns,i=0,n=r.length;i<n;i++){var o=this.getColumnByField(r[parseInt(i.toString(),10)]);o||this.parent.log("initial_action",{moduleName:"group",columnName:r[parseInt(i.toString(),10)]});var s=o.enableGroupByFormat,a=o.format;s?e.group(r[parseInt(i.toString(),10)],this.formatGroupColumn.bind(this),a):e.group(r[parseInt(i.toString(),10)],null)}}return e},e.prototype.sortQuery=function(e){var t=this.parent;if((t.allowSorting||t.allowGrouping)&&t.sortSettings.columns.length){for(var r=t.sortSettings.columns,i=[],n=r.length-1;n>-1;n--){if(!(a=this.getColumnByField(r[parseInt(n.toString(),10)].field)))return this.parent.log("initial_action",{moduleName:"sort",columnName:r[parseInt(n.toString(),10)].field}),e;a.setSortDirection(r[parseInt(n.toString(),10)].direction);var o=r[parseInt(n.toString(),10)].direction;a.sortComparer&&(this.parent.log("grid_sort_comparer"),o=this.isRemote()?r[parseInt(n.toString(),10)].direction:a.sortComparer.bind(a)),-1===t.groupSettings.columns.indexOf(r[parseInt(n.toString(),10)].field)?a.isForeignColumn()||a.sortComparer?e.sortByForeignKey(a.field,o,void 0,r[parseInt(n.toString(),10)].direction.toLowerCase()):e.sortBy(a.field,o):i.push({direction:o,field:a.field})}for(var n=0,s=i.length;n<s;n++)if("string"==typeof i[parseInt(n.toString(),10)].direction)e.sortBy(i[parseInt(n.toString(),10)].field,i[parseInt(n.toString(),10)].direction);else{var a=this.getColumnByField(i[parseInt(n.toString(),10)].field);e.sortByForeignKey(i[parseInt(n.toString(),10)].field,i[parseInt(n.toString(),10)].direction,void 0,a.getSortDirection().toLowerCase())}}return e},e.prototype.searchQuery=function(e,t,i){var n=this.parent.searchSettings,o=n.fields.length?n.fields:this.getSearchColumnFieldNames(),s=[],a=!1;if(this.parent.searchSettings.key.length){a=this.parent.getForeignKeyColumns().some(function(e){return o.indexOf(e.field)>-1});var l=i?t.dataSource.adaptor:this.dataManager.adaptor;if(a||l.getModuleName&&"ODataV4Adaptor"===l.getModuleName()){o=i?[t.foreignKeyValue]:o;for(var h=0;h<o.length;h++){var p=i?t:this.getColumnByField(o[parseInt(h.toString(),10)]);p.isForeignColumn()&&!i?s=this.fGeneratePredicate(p,s):s.push(new r.Predicate(o[parseInt(h.toString(),10)],n.operator,n.key,n.ignoreCase,n.ignoreAccent))}var d=r.Predicate.or(s);d.key=n.key,e.where(d)}else e.search(n.key,o,n.operator,n.ignoreCase,n.ignoreAccent)}return e},e.prototype.filterQuery=function(e,i,n){var o,s=this.parent,a=[],l=[],h=this.parent.getForeignKeyColumns();if(s.allowFiltering&&s.filterSettings.columns.length){for(var p=i||s.filterSettings.columns,d={},c=0,u=s.getColumns();c<u.length;c++)d[(F=u[c]).field]=F.filter.type?F.filter.type:s.filterSettings.type;for(var g=[],f=[],m=0,y=p;m<y.length;m++){var v=(F=y[m]).isForeignKey?s.getColumnByUid(F.uid):s.getColumnByField(F.field);t.isNullOrUndefined(F.type)&&v&&("date"===v.type||"datetime"===v.type||"dateonly"===v.type)&&(F.type=F.isForeignKey?s.getColumnByUid(F.uid).type:s.getColumnByField(F.field).type),F.isForeignKey?g.push(F):f.push(F)}if(f.length){for(var C=0,S=f.length;C<S;C++)f[parseInt(C.toString(),10)].uid=f[parseInt(C.toString(),10)].uid||this.parent.grabColumnByFieldFromAllCols(f[parseInt(C.toString(),10)].field).uid;for(var b=Qn.getPredicate(f),w=0,I=Object.keys(b);w<I.length;w++){M=I[w];a.push(b[""+M])}}if(g.length)for(var R=0,x=g;R<x.length;R++){var F=x[R];F.uid=F.uid||this.parent.grabColumnByFieldFromAllCols(F.field).uid;var T=this.parent.grabColumnByUidFromAllCols(F.uid);if(T||this.parent.log("initial_action",{moduleName:"filter",columnName:F.field}),T.isForeignColumn()&&he(F.field,h)&&!n)l.push(F),T.columnData.length||(o=!0),a=this.fGeneratePredicate(T,a);else for(var b=Qn.getPredicate(p),E=0,z=Object.keys(b);E<z.length;E++){var M=z[E];a.push(b[""+M])}}a.length&&!o?e.where(r.Predicate.and(a)):this.parent.notify("showEmptyGrid",{})}return e},e.prototype.fGeneratePredicate=function(e,t){var r={};return e&&(this.parent.notify("generateQuery",{predicate:r,column:e}),r.predicate.predicates.length&&t.push(r.predicate)),t},e.prototype.getData=function(e,r){var i=this;void 0===e&&(e={requestType:""});var n=this.getKey(e.foreignKeyData&&Object.keys(e.foreignKeyData).length?e.foreignKeyData:this.parent.getPrimaryKeyFieldNames());if(this.parent.log("datasource_syntax_mismatch",{dataState:this.parent}),this.parent.dataSource&&"result"in this.parent.dataSource)return this.eventPromise(e,r,n).promise;var o=void 0;switch(e.requestType){case"delete":if(r=r||this.generateQuery(),1===Object.keys(e.data).length)o=this.dataManager.remove(n,e.data[0],r.fromTable,r);else{var s={addedRecords:[],deletedRecords:[],changedRecords:[]};s.deletedRecords=e.data,o=this.dataManager.saveChanges(s,n,r.fromTable,r.requiresCount())}break;case"save":r=r||this.generateQuery(),e.index=t.isNullOrUndefined(e.index)?0:e.index,o=this.dataManager.insert(e.data,r.fromTable,r,e.index)}return e.promise=o,!o||Array.isArray(o)||o.hasOwnProperty("deletedRecords")?this.insert(r,e):o.then(function(){return i.insert(r,e)})},e.prototype.insert=function(e,t){return"save"===t.requestType&&this.parent.notify("recordAdded",t),this.executeQuery(e)},e.prototype.executeQuery=function(e){var t=this;if(this.dataManager.ready){var i=new r.Deferred;return this.dataManager.ready.then(function(){t.dataManager.executeQuery(e).then(function(e){i.resolve(e)})}).catch(function(e){i.reject(e)}),i.promise}return this.dataManager.executeQuery(e)},e.prototype.formatGroupColumn=function(e,r){var i=this.serviceLocator,n=this.getColumnByField(r),o=e;return n.type||(n.type=o.getDay?o.getHours()>0||o.getMinutes()>0||o.getSeconds()>0||o.getMilliseconds()>0?"datetime":"date":typeof e),t.isNullOrUndefined(n.getFormatter())&&Z(i,n),Mt.prototype.toView(e,n.getFormatter())},e.prototype.crudActions=function(e){var t=this.generateQuery(),r=null,i="promise",n=this.getKey(e.foreignKeyData&&Object.keys(e.foreignKeyData).length?e.foreignKeyData:this.parent.getPrimaryKeyFieldNames());switch(this.parent.dataSource&&"result"in this.parent.dataSource&&this.eventPromise(e,t,n),e.requestType){case"save":r=this.dataManager.update(n,e.data,t.fromTable,t,e.previousData)}e[""+i]=r||e[""+i],this.parent.notify("crud-Action",e)},e.prototype.saveChanges=function(e,t,i,n){if(void 0===n&&(n=this.generateQuery()),n.requiresCount(),"result"in this.parent.dataSource){var o=new r.Deferred,s={requestType:"batchsave",changes:e,key:t,query:n,endEdit:o.resolve};return this.setState({isPending:!0,resolver:o.resolve}),this.parent.trigger("dataSourceChanged",s),o.promise}return this.dataManager.saveChanges(e,t,n.fromTable,n,i)},e.prototype.getKey=function(e){if(e&&e.length)return e[0]},e.prototype.isRemote=function(){return!0!==this.dataManager.dataSource.offline&&void 0!==this.dataManager.dataSource.url&&""!==this.dataManager.dataSource.url},e.prototype.addRows=function(e){for(var t=e.records.length;t>0;t--)this.dataManager.dataSource.json.splice(e.toIndex,0,e.records[t-1])},e.prototype.removeRows=function(e){var t=this.dataManager.dataSource.json;this.dataManager.dataSource.json=t.filter(function(t){return-1===e.records.indexOf(t)})},e.prototype.getColumnByField=function(e){var t;return this.parent.columnModel.some(function(r){return t=r,r.field===e})&&t},e.prototype.destroy=function(){this.parent.isDestroyed||(this.parent.off(dr,this.addRows),this.parent.off(cr,this.removeRows),this.parent.off(fr,this.initDataManager),this.parent.off(lr,this.destroy),this.parent.off(vr,this.crudActions),this.parent.off(br,this.getData),this.parent.off(yr,this.refreshFilteredCols),this.parent.off(Tr,this.refreshFilteredCols))},e.prototype.getState=function(){return this.dataState},e.prototype.setState=function(e){return this.dataState=e},e.prototype.getForeignKeyDataState=function(){return this.foreignKeyDataState},e.prototype.setForeignKeyDataState=function(e){this.foreignKeyDataState=e},e.prototype.getStateEventArgument=function(e){var i=new r.UrlAdaptor,n=new r.DataManager({url:"",adaptor:new r.UrlAdaptor}),o=i.processQuery(n,e),s=JSON.parse(o.data);return t.extend(s,o.pvtData)},e.prototype.eventPromise=function(e,t,i){var n=this,o=e,s=this.getStateEventArgument(t),a=new r.Deferred,l=new r.Deferred;if(void 0!==e.requestType&&!1!==this.dataState.isDataChanged)if(s.action=e,"save"===e.requestType||"delete"===e.requestType){var h=e;h.key=i;h.promise=l.promise,h.state=s,this.setState({isPending:!0,resolver:l.resolve}),o.endEdit=l.resolve,o.cancelEdit=l.reject,this.parent.trigger("dataSourceChanged",h),l.promise.then(function(){n.setState({isPending:!0,resolver:a.resolve,group:s.group,aggregates:s.aggregates}),"save"===h.requestType&&n.parent.notify("recordAdded",h),n.parent.trigger("dataStateChange",s)}).catch(function(){})}else this.setState({isPending:!0,resolver:a.resolve,group:s.group,aggregates:s.aggregates}),this.parent.trigger("dataStateChange",s);else this.setState({}),a.resolve(this.parent.dataSource);return a},e.prototype.getSearchColumnFieldNames=function(){for(var e=[],r=0,i=this.parent.getColumns();r<i.length;r++){var n=i[r];n.allowSearching&&!t.isNullOrUndefined(n.field)&&e.push(n.field)}return e},e.prototype.refreshFilteredCols=function(){this.parent.allowFiltering&&this.parent.filterSettings.columns.length&&we(this.parent,this.parent.filterSettings.columns)},e}(),Nr=function(){function e(e,r){t.merge(this,e),this.parent=r}return e.prototype.clone=function(){var r=new e({});return t.merge(r,this),r.cells=this.cells.map(function(e){return e.clone()}),r},e.prototype.setRowValue=function(e){if(this.parent){var t=this.data[this.parent.getPrimaryKeyFieldNames()[0]];this.parent.setRowData(t,e)}},e.prototype.setCellValue=function(e,t){if(this.parent&&!(this.data[""+e].toString()===t.toString())){var r=this.parent.getPrimaryKeyFieldNames()[0],i=this.data[""+r];this.parent.setCellValue(i,e,t),this.makechanges(r,this.data)}},e.prototype.makechanges=function(e,t){this.parent&&this.parent.getDataModule().dataManager.update(e,t)},e}(),qr=function(){function e(e){this.isSpanned=!1,this.isRowSpanned=!1,t.merge(this,e)}return e.prototype.clone=function(){var r=new e({});return t.merge(r,this),r},e}(),Hr=function(){function r(e,t){this.serviceLocator=e,this.parent=t}return r.prototype.render=function(r,i,n,o){var s,a=this.serviceLocator.getService("cellRendererFactory").getCellRenderer(i.cells[parseInt(n.toString(),10)].cellType||e.CellType.Data),l=i.cells[parseInt(n.toString(),10)].cellSpan?i.cells[parseInt(n.toString(),10)].cellSpan:r.colSpan+n<=i.cells.length?r.colSpan:i.cells.length-n,h=r.rowSpan,p=0;if(i.index>0){var d=this.parent.isFrozenGrid()?this.parent.contentModule.tempFreezeRows:this.parent.getRowsObject(),c=this.parent.groupSettings.columns.length>0&&!d[i.index-1].isDataRow?d[i.index].cells:d[i.index-1].cells,u=i.cells[parseInt(n.toString(),10)];s=c.filter(function(e){return e.column.uid===u.column.uid})[0]}for(var g=s&&s.colSpanRange>1&&s.rowSpanRange>1?s.colSpanRange:l,f=n+1;f<n+g&&f<i.cells.length;f++)!1===i.cells[parseInt(f.toString(),10)].visible?p++:i.cells[parseInt(f.toString(),10)].isSpanned=!0;if(p>0){for(f=n+l;f<n+l+p&&f<i.cells.length;f++)i.cells[parseInt(f.toString(),10)].isSpanned=!0;n+l+p>=i.cells.length&&(l-=n+l+p-i.cells.length)}return i.cells[parseInt(n.toString(),10)].cellSpan&&(i.data[r.column.field]=i.cells[parseInt(n.toString(),10)].spanText,o=a.render(i.cells[parseInt(n.toString(),10)],i.data,{index:t.isNullOrUndefined(i.index)?"":i.index.toString()})),l>1&&t.attributes(o,{colSpan:l.toString(),"aria-colSpan":l.toString()}),h>1&&(t.attributes(o,{rowspan:h.toString(),"aria-rowspan":h.toString()}),i.cells[parseInt(n.toString(),10)].isRowSpanned=!0,i.cells[parseInt(n.toString(),10)].rowSpanRange=Number(h),l>1&&(i.cells[parseInt(n.toString(),10)].colSpanRange=Number(l))),i.index>0&&s.rowSpanRange>1&&(i.cells[parseInt(n.toString(),10)].isSpanned=!0,i.cells[parseInt(n.toString(),10)].rowSpanRange=Number(s.rowSpanRange-1),i.cells[parseInt(n.toString(),10)].colSpanRange=s.rowSpanRange>0?s.colSpanRange:1),!this.parent.enableColumnVirtualization||i.cells[parseInt(n.toString(),10)].cellSpan||this.containsKey(r.column.field,r.data[r.column.field])||this.backupMergeCells(r.column.field,r.data[r.column.field],r.colSpan),o},r.prototype.backupMergeCells=function(e,t,r){this.setMergeCells(this.generteKey(e,t),r)},r.prototype.generteKey=function(e,t){return e+"__"+t.toString()},r.prototype.splitKey=function(e){return e.split("__")},r.prototype.containsKey=function(e,t){return this.getMergeCells().hasOwnProperty(this.generteKey(e,t))},r.prototype.getMergeCells=function(){return this.parent.mergeCells},r.prototype.setMergeCells=function(e,t){this.parent.mergeCells[""+e]=t},r.prototype.updateVirtualCells=function(e){for(var t=this.getMergeCells(),r=0,i=Object.keys(t);r<i.length;r++){var n=i[r],o=t[""+n],s=this.splitKey(n),a=this.getIndexFromAllColumns(s[0]),l=this.parent.getColumnIndexesInView(),h=o-(l[0]-a);if(a<l[0]&&h>1)for(var p=0,d=e;p<d.length;p++){var c=d[p];if(c.data[s[0]].toString()===s[1].toString()){c.cells[0].cellSpan=h,c.cells[0].spanText=s[1];break}}}return e},r.prototype.getIndexFromAllColumns=function(e){return w(this.parent.getVisibleColumns(),function(t,r){if(t.field===e)return r})[0]},r}(),Ur="e-rowcell",jr="e-gridheader",Vr="e-gridcontent",Gr="e-gridfooter",_r="e-headercontent",Wr="e-movablecontent",Kr="e-movableheader",Qr="e-frozencontent",Xr="e-frozenheader",Yr="e-content",Jr="e-table",Zr="e-row",$r="e-gridchkbox",ei="e-editedrow",ti="e-addedrow",ri="Left-Right",ii="frozen-right",ni="frozen-left",oi="data-colindex",si="data-rowindex",ai="aria-rowindex",li="tbody",hi="colgroup",pi="open",di="downArrow",ci="upArrow",ui="enter",gi="shiftEnter",fi=function(){function r(e,t,r){this.isSpan=!1,this.cellType=t,this.serviceLocator=e,this.parent=r,this.element=this.parent.createElement("tr")}return r.prototype.render=function(e,t,r,i,n){return this.refreshRow(e,t,r,i,n)},r.prototype.refresh=function(e,t,r,i,n){var o=this;r&&(e.data=ve({},e.changes),this.refreshMergeCells(e));var s=this.parent.element.querySelector("[data-uid="+e.uid+"]"),a=this.refreshRow(e,t,i,n,null,r),l=[].slice.call(a.cells),h=[].slice.call(s.querySelectorAll(".e-templatecell"));if(this.parent.isReact&&h.length)for(var p=0,d=t;p<d.length&&"break"!==function(e){if(e.template)return setTimeout(function(){o.parent.refreshReactColumnTemplateByUid(e.uid,!0)},0),"break"}(d[p]);p++);[].slice.call(a.attributes).map(function(e){s.setAttribute(e.name,e.value)}),s.innerHTML="";for(var c=0,u=l;c<u.length;c++){var g=u[c];s.appendChild(g)}},r.prototype.refreshRow=function(r,i,n,o,s,a){var l=t.isNullOrUndefined(s)?this.element.cloneNode():s,h={data:r.data},p={data:r.data},d=this.parent.getColumns().filter(function(e){return"checkbox"===e.type&&e.field})[0],c=!1;d&&(c=ge(d.field,h.data));var u=this.parent.getSelectedRowIndexes();r.isDataRow&&(r.isSelected=u.indexOf(r.index)>-1||c),r.isDataRow&&this.parent.isCheckBoxSelection&&"Check"===this.parent.checkAllRows&&this.parent.enableVirtualization&&(r.isSelected=!0,-1===u.indexOf(r.index)&&u.push(r.index)),this.buildAttributeFromRow(l,r),t.attributes(l,t.extend({},n,{})),x(l,r.attributes);for(var g=this.serviceLocator.getService("cellRendererFactory"),f=this,m=0,y=r.cells.length;m<y;m++)!function(i,n){var o=r.cells[parseInt(i.toString(),10)];o.isSelected=r.isSelected,o.isColumnSelected=o.column.isSelected;var s=g.getCellRenderer(r.cells[parseInt(i.toString(),10)].cellType||e.CellType.Data),h={index:t.isNullOrUndefined(r.index)?"":r.index.toString()};r.isExpand&&r.cells[parseInt(i.toString(),10)].cellType===e.CellType.DetailExpand&&(h.class=f.parent.isPrinting?"e-detailrowcollapse":"e-detailrowexpand");var d=s.render(r.cells[parseInt(i.toString(),10)],r.data,h,r.isExpand,a);if(r.cells[parseInt(i.toString(),10)].cellType!==e.CellType.Filter){if(r.cells[parseInt(i.toString(),10)].cellType===e.CellType.Data||r.cells[parseInt(i.toString(),10)].cellType===e.CellType.CommandColumn){var c=f.parent.parentDetails&&f.parent.parentDetails.parentInstObj&&f.parent.parentDetails.parentInstObj.isReact;if((f.parent.isReact&&f.parent.requireTemplateRef||c&&f.parent.parentDetails.parentInstObj.requireTemplateRef)&&o.isTemplate){var u=f;u.parent.renderTemplates(function(){var e=d.getAttribute("aria-label");d.setAttribute("aria-label",d.innerText+e),u.parent.trigger("queryCellInfo",t.extend(p,{cell:d,column:o.column,colSpan:1,rowSpan:1,foreignKeyData:r.cells[parseInt(i.toString(),10)].foreignKeyData,requestType:u.parent.requestTypeAction}))})}else f.parent.trigger("queryCellInfo",t.extend(p,{cell:d,column:o.column,colSpan:1,rowSpan:1,foreignKeyData:r.cells[parseInt(i.toString(),10)].foreignKeyData,requestType:f.parent.requestTypeAction}));var m=!1;if(r.index>0&&f.isSpan){var y=f.parent.isFrozenGrid()?f.parent.contentModule.tempFreezeRows:f.parent.getRowsObject(),v=(f.parent.groupSettings.columns.length>0&&!y[r.index-1].isDataRow?y[r.index].cells:y[r.index-1].cells).filter(function(e){return e.column.uid===r.cells[parseInt(i.toString(),10)].column.uid})[0];m=v.isRowSpanned?v.isRowSpanned:v.rowSpanRange>1}if(p.colSpan>1||r.cells[parseInt(i.toString(),10)].cellSpan>1||p.rowSpan>1||m){f.isSpan=!0;var C=new Hr(f.serviceLocator,f.parent);d=C.render(p,r,i,d)}}r.cells[parseInt(i.toString(),10)].isSpanned||l.appendChild(d)}}(m);var v={row:l,rowHeight:this.parent.rowHeight};if(r.isDataRow){var C=t.extend(h,v);C.isSelectable=!0;var S=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,b=C.row.querySelectorAll(".e-templatecell");if((this.parent.isReact&&this.parent.requireTemplateRef||S&&this.parent.parentDetails.parentInstObj.requireTemplateRef)&&b.length){var w=this;w.parent.renderTemplates(function(){w.parent.trigger("rowDataBound",C)})}else this.parent.trigger("rowDataBound",C);r.isSelectable=C.isSelectable;var I=this.parent.isRowDragable();if(this.parent.allowPaging&&this.parent.selectionSettings.persistSelection){var R=this.parent.getPrimaryKeyFieldNames()[0],F=r.data?r.data[""+R]:null,T=C.isSelectable?this.parent.partialSelectedRecords:this.parent.disableSelectedRecords;T.some(function(e){return e[""+R]===F})||T.push(r.data)}if(!C.isSelectable){this.parent.selectionModule.isPartialSelection=!0,r.isSelected=!1;for(var E=v.row.querySelectorAll(".e-rowcell.e-gridchkbox"),z=C.row.querySelector(".e-rowdragdrop"),M=this.parent.groupSettings.columns.length+(z||this.parent.isDetail()?1:0),m=0;m<E.length;m++)E[parseInt(m.toString(),10)].firstElementChild.classList.add("e-checkbox-disabled"),E[parseInt(m.toString(),10)].querySelector(".e-frame").classList.remove("e-check");if(r.cells.length)for(m=M;m<r.cells.length;m++){var D=C.row.querySelector('.e-rowcell[data-colindex="'+r.cells[parseInt(m.toString(),10)].index+'"]');D&&t.removeClass([D],["e-selectionbackground","e-active"])}z&&t.removeClass([z],["e-selectionbackground","e-active"])}if(this.parent.childGrid||I||this.parent.detailTemplate){var O=l.querySelectorAll(".e-rowcell:not(.e-hide)")[0];O&&O.classList.add("e-detailrowvisible")}}if(this.parent.enableVirtualization&&(h.rowHeight=this.parent.rowHeight),h.rowHeight?l.style.height=h.rowHeight+"px":this.parent.rowHeight&&(l.querySelector(".e-headercell")||l.querySelector(".e-groupcaption"))&&(l.style.height=this.parent.rowHeight+"px"),r.cssClass&&l.classList.add(r.cssClass),r.lazyLoadCssClass&&l.classList.add(r.lazyLoadCssClass),"Vertical"!==this.parent.rowRenderingMode||!this.parent.allowTextWrap||"Header"!==this.parent.textWrapSettings.wrapMode&&"Both"!==this.parent.textWrapSettings.wrapMode||l.classList.add("e-verticalwrap"),!(this.parent.enableColumnVirtualization&&0!==this.parent.frozenColumns)&&this.parent.aggregates.length&&this.parent.element.scrollHeight>this.parent.height)for(m=0;m<this.parent.aggregates.length;m++){if(this.parent.aggregates[parseInt(m.toString(),10)].properties.columns[0].footerTemplate){var k=[].slice.call(l.getElementsByClassName("e-summarycell"));if(k.length){var A=k[k.length-1];t.addClass([A],["e-lastsummarycell"]);var L=k[0];t.addClass([L],["e-firstsummarycell"])}}}return l},r.prototype.refreshMergeCells=function(e){for(var t=0,r=e.cells;t<r.length;t++)r[t].isSpanned=!1;return e},r.prototype.buildAttributeFromRow=function(e,r){var i={},n={rowindex:si,dataUID:"data-uid",ariaSelected:"aria-selected"},o=[];r.isDataRow&&o.push(Zr),r.isAltRow&&o.push("e-altrow"),r.isCaptionRow&&o.push("e-groupcaptionrow"),r.isAggregateRow&&r.parentUid&&o.push("e-groupfooterrow"),t.isNullOrUndefined(r.index)||(i[ai]=r.index+1,i[n.rowindex]=r.index),r.rowSpan&&(i.rowSpan=r.rowSpan),r.uid&&(i[n.dataUID]=r.uid),r.isSelected&&(i[n.ariaSelected]=!0),!1===r.visible&&o.push("e-hide"),i.class=o,x(e,i)},r}(),mi=function(){function r(e){this.parent=e}return r.prototype.generateRows=function(e,t){var r=[],i=this.parent.enableVirtualization&&t?t.startIndex:0;i=this.parent.enableInfiniteScrolling&&t?this.getInfiniteIndex(t):i,this.parent.enableImmutableMode&&t&&t.startIndex&&(i=t.startIndex);for(var n=0,o=Object.keys(e).length;n<o;n++,i++)r[parseInt(n.toString(),10)]=this.generateRow(e[parseInt(n.toString(),10)],i);return r},r.prototype.ensureColumns=function(){var t=[];if(this.parent.detailTemplate||this.parent.childGrid){var r={};this.parent.notify("detail-indentcell-info",r),t.push(this.generateCell(r,null,e.CellType.DetailExpand))}return this.parent.isRowDragable()&&t.push(this.generateCell({},null,e.CellType.RowDragIcon)),t},r.prototype.generateRow=function(e,t,r,i,n,o,s){var a={};a.foreignKeyData={},a.uid=N("grid-row"),a.data=e,a.index=t,a.indent=i,a.tIndex=o,a.isDataRow=!0,a.parentGid=n,a.parentUid=s,this.parent.isPrinting&&("All"===this.parent.hierarchyPrintMode?a.isExpand=!0:"Expanded"===this.parent.hierarchyPrintMode&&this.parent.expandedRows&&this.parent.expandedRows[parseInt(t.toString(),10)]&&(a.isExpand=this.parent.expandedRows[parseInt(t.toString(),10)].isExpand)),a.cssClass=r,a.isAltRow=!!this.parent.enableAltRow&&t%2!=0,a.isAltRow=!!this.parent.enableAltRow&&t%2!=0,a.isSelected=this.parent.getSelectedRowIndexes().indexOf(t)>-1,this.refreshForeignKeyRow(a);var l=this.ensureColumns(),h=new Nr(a,this.parent);return h.cells="Right"===this.parent.getFrozenMode()?this.generateCells(a).concat(l):l.concat(this.generateCells(a)),h},r.prototype.refreshForeignKeyRow=function(e){for(var r=this.parent.getForeignKeyColumns(),i=0;i<r.length;i++)t.setValue(r[parseInt(i.toString(),10)].field,le(r[parseInt(i.toString(),10)],e.data),e.foreignKeyData)},r.prototype.generateCells=function(r){for(var i=this.parent.getColumns(),n=[],o=0;o<i.length;o++)n.push(this.generateCell(i[parseInt(o.toString(),10)],r.uid,t.isNullOrUndefined(i[parseInt(o.toString(),10)].commands)?void 0:e.CellType.CommandColumn,null,o,r.foreignKeyData));return n},r.prototype.generateCell=function(r,i,n,o,s,a){var l={visible:r.visible,isDataCell:!t.isNullOrUndefined(r.field||r.template),isTemplate:!t.isNullOrUndefined(r.template),rowID:i,column:r,cellType:t.isNullOrUndefined(n)?e.CellType.Data:n,colSpan:o,commands:r.commands,isForeignKey:r.isForeignColumn&&r.isForeignColumn(),foreignKeyData:r.isForeignColumn&&r.isForeignColumn()&&t.getValue(r.field,a)};return(l.isDataCell||"checkbox"===l.column.type||l.commands)&&(l.index=s),new qr(l)},r.prototype.refreshRows=function(e){for(var t=0;t<e.length;t++)this.refreshForeignKeyRow(e[parseInt(t.toString(),10)]),e[parseInt(t.toString(),10)].cells=this.generateCells(e[parseInt(t.toString(),10)]);return e},r.prototype.getInfiniteIndex=function(e){return"infiniteScroll"===e.requestType||"delete"===e.requestType||"add"===e.action?t.isNullOrUndefined(e.startIndex)?e.index:e.startIndex:0},r}(),yi=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),vi=function(){function r(e){this.parent=e}return r.prototype.getData=function(){for(var e=this,t=[],r=this.parent.aggregates.slice(),i=0;i<r.length;i++){var n=r[parseInt(i.toString(),10)].columns.filter(function(t){return!(t.footerTemplate||t.groupFooterTemplate||t.groupCaptionTemplate)||e.columnSelector(t)});n.length&&t.push({columns:n})}return t},r.prototype.columnSelector=function(e){return void 0!==e.footerTemplate},r.prototype.getColumns=function(e,r){var i=[];if(!this.parent.detailTemplate&&t.isNullOrUndefined(this.parent.childGrid)||i.push(new kt({})),this.parent.allowGrouping)for(var n=0;n<this.parent.groupSettings.columns.length;n++)i.push(new kt({}));return this.parent.isRowDragable()&&!e&&i.push(new kt({})),i.push.apply(i,this.parent.getColumns()),r=r&&!e?r+this.parent.getIndentCount():r,t.isNullOrUndefined(e)?i:i.slice(e,r)},r.prototype.generateRows=function(e,t,r,i,n){if(0===e.length&&(void 0===t||!t.count))return[];for(var o=this.buildSummaryData(e,t),s=[],a=this.getData(),l=0;l<a.length;l++)s.push(this.getGeneratedRow(a[parseInt(l.toString(),10)],o[parseInt(l.toString(),10)],t?t.level:void 0,r,i,t?t.parentUid:void 0,n));return s},r.prototype.getGeneratedRow=function(r,i,n,o,s,a,l){var h=[],p=this.getIndentByLevel(),d=!t.isNullOrUndefined(this.parent.childGrid),c=o?0:this.parent.getIndentCount();this.parent.groupSettings.columns.length&&this.parent.allowRowDragAndDrop?p.push("e-indentcelltop"):this.parent.isRowDragable()&&!o&&(p=["e-indentcelltop"]);for(var u=l||this.getColumns(o,s),g=0;g<u.length;g++)h.push(this.getGeneratedCell(u[parseInt(g.toString(),10)],r,g>=c?this.getCellType():0===g&&this.parent.childGrid?e.CellType.DetailFooterIntent:e.CellType.Indent,p[parseInt(g.toString(),10)],d));var f=new Nr({data:i,attributes:{class:"e-summaryrow"}});return f.cells=h,f.uid=N("grid-row"),f.parentUid=a,f.isAggregateRow=!0,f.visible=h.some(function(e){return e.isDataCell&&e.visible}),f},r.prototype.getGeneratedCell=function(e,r,i,n,o){var s=r.columns.filter(function(t){return t.columnName===e.field})[0],a={style:{textAlign:e.textAlign},"e-mappinguid":e.uid,index:e.index};n&&(a.class=n),t.isNullOrUndefined(n)&&o&&(a.class="e-detailindentcelltop");var l={visible:e.visible,isDataCell:!t.isNullOrUndefined(s),isTemplate:s&&!t.isNullOrUndefined(s.footerTemplate||s.groupFooterTemplate||s.groupCaptionTemplate),column:s||{},attributes:a,cellType:i};return l.column.headerText=e.headerText,new qr(l)},r.prototype.buildSummaryData=function(e,t){for(var r=[],i=this.getData(),n={},o=0;o<i.length;o++){n={};for(var s=i[parseInt(o.toString(),10)].columns,a=0;a<s.length;a++)n=this.setTemplate(s[parseInt(a.toString(),10)],t&&t.aggregates?t:e,n);r.push(n)}return r},r.prototype.getIndentByLevel=function(){return this.parent.groupSettings.columns.map(function(){return"e-indentcelltop"})},r.prototype.setTemplate=function(e,r,i){var n=e.type,o={},s=e.getFormatter()||function(){return function(e){return e}}(),a=r;n instanceof Array||(n=[e.type]);for(var l=0;l<n.length;l++){var h=e.field+" - "+n[parseInt(l.toString(),10)].toLowerCase(),p=e.columnName,d="Custom"!==n[parseInt(l.toString(),10)]&&a.aggregates&&h in a.aggregates?a.aggregates[""+h]:U(n[parseInt(l.toString(),10)],a.aggregates?a:r,e,this.parent);i[""+p]=i[""+p]||{},i[""+p][""+h]=d,i[""+p][n[parseInt(l.toString(),10)]]=t.isNullOrUndefined(d)?" ":s(d),a.field&&(i[""+p].field=a.field,i[""+p].key=a.key)}return o.format=e.getFormatter(),e.setTemplate(o),i},r.prototype.getCellType=function(){return e.CellType.Summary},r}(),Ci=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return yi(r,t),r.prototype.columnSelector=function(e){return void 0!==e.groupFooterTemplate},r.prototype.getIndentByLevel=function(e){return void 0===e&&(e=this.parent.groupSettings.columns.length),this.parent.allowRowDragAndDrop&&this.parent.groupSettings.columns.length&&(e-=1),this.parent.groupSettings.columns.map(function(t,r){return r<=e-1?"":"e-indentcelltop"})},r.prototype.getCellType=function(){return e.CellType.GroupSummary},r}(vi),Si=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return yi(r,t),r.prototype.columnSelector=function(e){return void 0!==e.groupCaptionTemplate},r.prototype.getData=function(){var e={columns:[]};return[t.prototype.getData.call(this).reduce(function(e,t){return e.columns=e.columns.concat(t.columns),e},e)]},r.prototype.isEmpty=function(){return 0===(this.getData()[0].columns||[]).length},r.prototype.getCellType=function(){return e.CellType.CaptionSummary},r}(vi),bi=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),wi=function(r){function i(e){var t=r.call(this,e)||this;return t.rows=[],t.index=0,t.infiniteChildCount=0,t.renderInfiniteAgg=!0,t.parent=e,t.summaryModelGen=new Ci(e),t.captionModelGen=new Si(e),t}return bi(i,r),i.prototype.generateRows=function(e,t){if(0===this.parent.groupSettings.columns.length)return r.prototype.generateRows.call(this,e,t);this.isInfiniteScroll="infiniteScroll"===t.requestType,this.rows=[],this.index=this.parent.enableVirtualization||this.isInfiniteScroll?t.startIndex:0;for(var i=0,n=e.length;i<n;i++)this.infiniteChildCount=0,this.renderInfiniteAgg=!0,this.getGroupedRecords(0,e[parseInt(i.toString(),10)],e.level,i,void 0,this.rows.length);return this.index=0,this.parent.isCollapseStateEnabled()&&this.ensureRowVisibility(),this.rows},i.prototype.getGroupedRecords=function(e,r,i,n,o,s,a){var l,h=i;if(t.isNullOrUndefined(r.items))if(t.isNullOrUndefined(r.GroupGuid))this.rows=this.rows.concat(this.generateDataRows(r,e,n,this.rows.length,a));else for(var p=0,d=r.length;p<d;p++)this.getGroupedRecords(e,r[parseInt(p.toString(),10)],r.level,n,e,this.rows.length,a);else{var c=void 0,u=this.generateCaptionRow(r,e,n,o,s,a);if(this.isInfiniteScroll&&(c=this.getPreCaption(e,u.data.key)),c?u.uid=c.uid:this.rows=this.rows.concat(u),r.items&&r.items.length&&this.getGroupedRecords(e+1,r.items,r.items.level,n,e+1,this.rows.length,u.uid),this.parent.aggregates.length&&this.isRenderAggregate(u)){var g=this.rows.length;(l=this.rows).push.apply(l,this.summaryModelGen.generateRows(r,{level:h,parentUid:u.uid}));for(var f=g-1;f>=0;f--)if(this.rows[parseInt(f.toString(),10)].isCaptionRow)this.rows[parseInt(f.toString(),10)].aggregatesCount=this.rows.length-g;else if(!this.rows[parseInt(f.toString(),10)].isCaptionRow&&!this.rows[parseInt(f.toString(),10)].isDataRow)break}c&&this.setInfiniteRowVisibility(c)}},i.prototype.isRenderAggregate=function(e){return this.parent.enableInfiniteScrolling?!!this.renderInfiniteAgg&&(this.getPreCaption(e.indent,e.data.key),this.renderInfiniteAgg=e.data.count===this.infiniteChildCount,this.renderInfiniteAgg):!this.parent.enableInfiniteScrolling},i.prototype.getPreCaption=function(e,t){var r,i=this.parent.getRowsObject().concat(this.rows);this.infiniteChildCount=0;for(var n=i.length;n--&&(i[parseInt(n.toString(),10)].isCaptionRow&&i[parseInt(n.toString(),10)].indent===e&&i[parseInt(n.toString(),10)].data.key===t&&(r=i[parseInt(n.toString(),10)]),!(i[parseInt(n.toString(),10)].indent===e||i[parseInt(n.toString(),10)].indent<e));)i[parseInt(n.toString(),10)].indent===e+1&&this.infiniteChildCount++;return r},i.prototype.getCaptionRowCells=function(r,i,n){var o=[],s=[],a=this.parent.getColumnByField(r),l=this.parent.getColumnIndexesInView();this.parent.enableColumnVirtualization&&(a=this.parent.columns.filter(function(e){return e.field===r})[0]);var h=this.parent.groupSettings.columns.length,p=this.parent;if(!this.parent.enableColumnVirtualization||-1!==l.indexOf(i)){for(var d=0;d<i;d++)o.push(this.generateIndentCell());o.push(this.generateCell({},null,e.CellType.Expand))}if(i=this.parent.enableColumnVirtualization?1:this.parent.getVisibleColumns().length+h+(p.detailTemplate||p.childGrid?1:0)-i+(this.parent.getVisibleColumns().length?-1:0),this.parent.aggregates.length&&!this.captionModelGen.isEmpty()){var c=this.captionModelGen.generateRows(n)[0];t.extend(n,c.data);var u=0;c.cells.some(function(e,t){return u=t,e.visible&&e.isDataCell}),s=c.cells.slice(u).filter(function(e){return e.visible}),c.visible&&s[0].column.field===this.parent.getVisibleColumns()[0].field&&(s=s.slice(1)),1===this.parent.getVisibleColumns().length&&(s=[]),i-=s.length}for(var g=this.parent.enableColumnVirtualization?this.parent.getColumns():[a],f=!0,m=0;m<g.length;m++){var y=f&&-1!==l.indexOf(i);y&&(f=!1);var v=!this.parent.enableColumnVirtualization||y?e.CellType.GroupCaption:e.CellType.GroupCaptionEmpty;i=this.parent.enableColumnVirtualization&&v===e.CellType.GroupCaption?i+h:i,p.isRowDragable()&&i++,o.push(this.generateCell(a,null,v,i))}return o.push.apply(o,s),o},i.prototype.generateCaptionRow=function(e,r,i,n,o,s){var a={},l=this.parent.getColumnByField(e.field);a.data=t.extend({},e),l&&(a.data.field=e.field),a.isDataRow=!1,a.isExpand=!this.parent.groupSettings.enableLazyLoading&&!this.parent.isCollapseStateEnabled(),a.parentGid=i,a.childGid=n,a.tIndex=o,a.isCaptionRow=!0,a.parentUid=s,a.gSummary=t.isNullOrUndefined(e.items.records)?e.items.length:e.items.records.length,a.uid=N("grid-row");var h=new Nr(a);return h.indent=r,this.getForeignKeyData(h),h.cells=this.getCaptionRowCells(e.field,r,h.data),h},i.prototype.getForeignKeyData=function(e){var r=e.data,i=this.parent.getColumnByField(r.field);if(i&&i.isForeignColumn&&i.isForeignColumn()){var n=t.isNullOrUndefined(r.key)?"":i.valueAccessor(i.foreignKeyValue,le(i,{},r.key)[0],i);t.setValue("foreignKey",n,e.data)}},i.prototype.generateDataRows=function(e,t,r,i,n){for(var o=[],s=this.parent.getColumnIndexesInView(),a=0,l=e.length;a<l;a++,i++){o[parseInt(a.toString(),10)]=this.generateRow(e[parseInt(a.toString(),10)],this.index,a?void 0:"e-firstchildrow",t,r,i,n);for(var h=0;h<t;h++)this.parent.enableColumnVirtualization&&-1===s.indexOf(t)||o[parseInt(a.toString(),10)].cells.unshift(this.generateIndentCell());this.index++}return o},i.prototype.generateIndentCell=function(){return this.generateCell({},null,e.CellType.Indent)},i.prototype.refreshRows=function(e){for(var t=this.parent.getColumnIndexesInView(),r=0;r<e.length;r++)if(e[parseInt(r.toString(),10)].isDataRow){e[parseInt(r.toString(),10)].cells=this.generateCells(e[parseInt(r.toString(),10)]);for(var i=0;i<e[parseInt(r.toString(),10)].indent;i++)this.parent.enableColumnVirtualization&&-1===t.indexOf(e[parseInt(r.toString(),10)].indent)||e[parseInt(r.toString(),10)].cells.unshift(this.generateIndentCell())}else{var n=this.generateCaptionRow(e[parseInt(r.toString(),10)].data,e[parseInt(r.toString(),10)].indent);e[parseInt(r.toString(),10)].cells=n.cells}return e},i.prototype.setInfiniteRowVisibility=function(e){if(!e.isExpand||!1===e.visible)for(var t=0,r=this.rows;t<r.length;t++){var i=r[t];i.parentUid===e.uid&&(i.visible=!1,i.isCaptionRow&&this.setInfiniteRowVisibility(i))}},i.prototype.ensureRowVisibility=function(){for(var e=0;e<this.rows.length;e++){var t=this.rows[parseInt(e.toString(),10)];if(t.isCaptionRow)for(var r=e+1;r<this.rows.length;r++){var i=this.rows[parseInt(r.toString(),10)];t.uid===i.parentUid&&(this.rows[parseInt(r.toString(),10)].visible=t.isExpand)}}},i}(mi),Ii=function(){function e(e,r){var i=this;this.rows=[],this.freezeRows=[],this.movableRows=[],this.freezeRowElements=[],this.currentInfo={},this.prevCurrentView=[],this.isLoaded=!0,this.viewColIndexes=[],this.drop=function(e){i.parent.notify(jt,{target:e.target,droppedElement:e.droppedElement}),t.remove(e.droppedElement)},this.infiniteCache={},this.isRemove=!1,this.visibleRows=[],this.visibleFrozenRows=[],this.rightFreezeRows=[],this.isAddRows=!1,this.isInfiniteFreeze=!1,this.useGroupCache=!1,this.tempFreezeRows=[],this.rafCallback=function(e){var t=e;return function(){if(i.parent.isFrozenGrid()&&(i.parent.enableVirtualization||i.parent.enableInfiniteScrolling)){var r=e.tableName;if(i.isLoaded=i.parent.getFrozenMode()===ri?"frozen-right"===r:"movable"===r,i.parent.enableColumnVirtualization&&"virtualscroll"===e.requestType&&i.isLoaded){var n=[].slice.call(i.parent.getMovableVirtualHeader().getElementsByClassName(Zr)),o=[].slice.call(i.parent.getFrozenVirtualHeader().getElementsByClassName(Zr));i.isLoaded=n.length===o.length}}if(i.ariaService.setBusy(i.getPanel().querySelector("."+Yr),!1),!i.parent.isDestroyed){var s=i.rows.slice(0);if(i.parent.enableInfiniteScrolling){if(i.parent.groupSettings.enableLazyLoading)for(p=0;p<i.visibleRows.length;p++)i.setRowsInLazyGroup(i.visibleRows[parseInt(p.toString(),10)],p);s=i.parent.getRowsObject();var a=t.prevPage;if(i.parent.infiniteScrollSettings.enableCache&&a){var l=i.parent.infiniteScrollSettings.maxBlocks;s=[];for(var h=parseInt(i.rowElements[0].getAttribute("data-rowindex"),10)+1,p=0,d=Math.ceil(h/i.parent.pageSettings.pageSize);p<l;p++,d++)i.infiniteCache[parseInt(d.toString(),10)]&&(s=s.concat(i.infiniteCache[parseInt(d.toString(),10)]))}}if(i.parent.isFrozenGrid()&&(s=e.isFrozen?i.freezeRows:e.renderFrozenRightContent?i.parent.getFrozenRightRowsObject():i.movableRows),i.parent.notify(Yt,{rows:s,args:t}),i.parent.autoFit&&i.parent.preventAdjustColumns(),i.parent.isInitialLoad||i.parent.focusModule.setFirstFocusableTabIndex(),i.isLoaded){i.parent.isManualRefresh=!1,i.parent.enableInfiniteScrolling&&i.parent.groupSettings.enableLazyLoading&&"sorting"===e.requestType&&(i.parent.infiniteScrollModule.groupCaptionAction=void 0);var c=i.parent.parentDetails&&i.parent.parentDetails.parentInstObj&&i.parent.parentDetails.parentInstObj.isReact;if((i.parent.isReact||c)&&i.parent.element.querySelectorAll(".e-templatecell").length){var u=i;u.parent.renderTemplates(function(){u.parent.trigger(qt,{},function(){u.parent.allowTextWrap&&u.parent.notify(wr,{case:"textwrap"})})})}else i.parent.trigger(qt,{},function(){i.parent.allowTextWrap&&i.parent.notify(wr,{case:"textwrap"})});i.parent.allowTextWrap&&"auto"===i.parent.height&&(i.parent.getContentTable().scrollHeight>i.parent.getContent().clientHeight?i.parent.scrollModule.setPadding():i.parent.scrollModule.removePadding())}if(t){var g=(t.requestType||"").toLowerCase()+"-complete";i.parent.notify(g,t),"batchsave"===e.requestType&&(e.cancel=!1,i.parent.trigger(Nt,e))}i.isLoaded&&i.parent.hideSpinner()}}},this.parent=e,this.serviceLocator=r,this.ariaService=this.serviceLocator.getService("ariaService"),this.parent.enableDeepCompare=this.parent.getDataModule().isRemote(),this.generator=this.getModelGenerator(),this.parent.isDestroyed||(this.parent.enableColumnVirtualization||this.parent.enableVirtualization||this.parent.groupSettings.enableLazyLoading||this.parent.on(hr,this.setVisible,this),this.parent.on(tr,this.colGroupRefresh,this),this.parent.on(Jt,this.enableAfterRender,this),this.parent.on(Dr,this.refreshContentRows,this),this.parent.on(or,this.beforeCellFocused,this),this.parent.on(lr,this.droppableDestroy,this))}return e.prototype.beforeCellFocused=function(e){!e.byKey||"upArrow"!==e.keyArgs.action&&"downArrow"!==e.keyArgs.action?this.pressedKey=void 0:this.pressedKey=e.keyArgs.action},e.prototype.renderPanel=function(){var e=this.parent,t=this.parent.element.querySelector("."+Vr);if(t)return this.ariaService.setOptions(this.parent.element.querySelector("."+Yr),{busy:!1}),void this.setPanel(t);t=this.parent.createElement("div",{className:Vr});var r=this.parent.createElement("div",{className:Yr});this.ariaService.setOptions(r,{busy:!1}),t.appendChild(r),this.setPanel(t),e.element.appendChild(t)},e.prototype.renderTable=function(){var e=this.getPanel(),r=e.querySelector(".e-virtualtable"),i=e.querySelector(".e-virtualtrack");!this.parent.enableVirtualization||t.isNullOrUndefined(r)||t.isNullOrUndefined(i)||(t.remove(r),t.remove(i)),e.appendChild(this.createContentTable("_content_table")),this.setTable(e.querySelector("."+Jr)),this.ariaService.setOptions(this.getTable(),{multiselectable:"Multiple"===this.parent.selectionSettings.type}),this.initializeContentDrop(),this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont")},e.prototype.createContentTable=function(e){var r=this.getPanel().firstElementChild;this.getTable()&&t.remove(this.getTable());var i=r.querySelector("."+Jr)?r.querySelector("."+Jr):this.parent.createElement("table",{className:Jr,attrs:{cellspacing:"0.25px",role:"grid",id:this.parent.element.id+e}});return this.setColGroup(this.parent.getHeaderTable().querySelector(hi).cloneNode(!0)),i.appendChild(this.getColGroup()),i.appendChild(this.parent.createElement(li,{attrs:{role:"rowgroup"}})),r.appendChild(i),r},e.prototype.refreshContentRows=function(e){var r=this;void 0===e&&(e={});var i=this.parent;if(0!==i.currentViewData.length){var n=this.currentMovableRows||i.currentViewData,o=this.parent.contentModule,s=i.isReact&&!t.isNullOrUndefined(i.rowTemplate),a=s?i.createElement(li,{attrs:{role:"rowgroup"}}):document.createDocumentFragment();this.initialPageRecords||(this.initialPageRecords=t.extend([],n));var l,h,p=s?i.createElement(li,{attrs:{role:"rowgroup"}}):document.createDocumentFragment();i.isReact&&i.rowTemplate&&(l=a,h=p);var d,c,u,g=i.getColumns(),f=i.getFrozenColumns(),y=this.parent.isFrozenGrid(),v=new fi(this.serviceLocator,null,this.parent),C=this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.requestType;i.notify(kr,{}),this.rowElements=[],this.rows=[],this.tempFreezeRows=[];var S,b,w=this.getPanel().querySelector("."+Qr),I=this.getPanel().querySelector("."+Wr),R=this.getPanel().querySelector("."+Yr);ue(i)&&["sorting","filtering","searching","grouping","ungrouping","reorder","save","delete"].some(function(t){return e.requestType===t})&&this.emptyVcRows();var x;this.parent.enableVirtualization&&this.parent.isFrozenGrid()?(this.parent.enableColumnVirtualization&&"virtualscroll"===e.requestType&&"X"===e.virtualInfo.sentinelInfo.axis&&(x=this.parent.contentModule.generateRows(n,e),e.renderMovableContent=!0),x=this.parent.contentModule.generateRows(n,e)):(x=this.checkCache(x,e),this.isAddRows||this.useGroupCache||(x=this.generator.generateRows(n,e))),this.setGroupCache(x,e),this.parent.notify("set-infinite-cache",{isInfiniteScroll:C,modelData:x,args:e});var F=x[0].cells[0].index;y&&(b=o.setTbody(x,e),S=o.getTbody(b));var T=this.parent.getFrozenMode()===ri&&b===ii;if(("infiniteScroll"!==e.requestType||this.parent.infiniteScrollSettings.enableCache)&&this.parent.registeredTemplate&&this.parent.registeredTemplate.template&&!e.isFrozen&&!T){for(var E=[],z=0;z<this.parent.registeredTemplate.template.length;z++)for(var M=0;M<this.parent.registeredTemplate.template[z].rootNodes.length;M++)t.isNullOrUndefined(this.parent.registeredTemplate.template[z].rootNodes[M].parentNode)&&E.push(this.parent.registeredTemplate.template[z]);this.parent.destroyTemplate(["template"],E)}if((this.parent.isReact||this.parent.isVue)&&("infiniteScroll"!==e.requestType||this.parent.infiniteScrollSettings.enableCache)&&!e.isFrozen){var D=[this.parent.isVue?"template":"columnTemplate","rowTemplate","detailTemplate","captionTemplate","commandsTemplate","groupFooterTemplate","groupCaptionTemplate"];"infiniteScroll"===e.requestType&&this.parent.infiniteScrollSettings.enableCache&&(D=[this.parent.isVue?"template":"columnTemplate","commandsTemplate"]),nt(this.parent,D)}this.parent.enableColumnVirtualization&&new Hr(this.serviceLocator,this.parent).updateVirtualCells(x),y||(this.tbody=this.getTable().querySelector(li));var O=0,k=!0;if(ue(i)&&i.vcRows.length){var A=t.isNullOrUndefined(e.virtualInfo.offsets)?t.isNullOrUndefined(e.scrollTop)?0:e.scrollTop.top:e.virtualInfo.offsets.top;if(0!==A){for(var L=i.vGroupOffsets,P=i.pageSettings.pageSize/2,B=Object.keys(L).map(function(e){return L[""+e]}),N=0;N<B.length;N++)if(A<B[parseInt(N.toString(),10)]){if(t.isNullOrUndefined(e.virtualInfo)||"up"!==e.virtualInfo.direction){O=N*P,(this.parent.contentModule.isEndBlock(N)||this.parent.contentModule.isEndBlock(N+1))&&(e.virtualInfo.blockIndexes=[N,N+1]);break}O=N>0?(N-1)*P:N*P;break}Math.round(A+this.contentPanel.firstElementChild.offsetHeight)>=this.contentPanel.firstElementChild.scrollHeight&&!e.rowObject&&(k=!1)}}var H=i.frozenRows&&!i.isFrozenGrid()&&this.parent.enableVirtualization&&"reorder"===e.requestType;if(i.frozenRows&&"virtualscroll"===e.requestType&&"X"===e.virtualInfo.sentinelInfo.axis||H){var U=e.virtualInfo.blockIndexes,j=e.virtualInfo.page;e.virtualInfo.blockIndexes=[1,2],H&&(e.virtualInfo.page=1);var V=H?this.initialPageRecords:n,G=this.vgenerator.generateRows(V,e);G.splice(this.parent.frozenRows);for(z=0;z<this.parent.frozenRows;z++)G[parseInt(z.toString(),10)].cells.splice(0,this.parent.getFrozenColumns()),d=v.render(G[parseInt(z.toString(),10)],g),p.appendChild(d);e.virtualInfo.blockIndexes=U,e.virtualInfo.page=j,H&&1===e.virtualInfo.page&&x.splice(0,this.parent.frozenRows)}this.virtualFrozenHdrRefresh(p,x,v,e,n,g),this.parent.groupSettings.enableLazyLoading&&!this.useGroupCache&&this.parent.groupSettings.columns.length&&((this.parent.enableVirtualization?this.parent.lazyLoadRender:this.parent.contentModule).refRowsObj[this.parent.pageSettings.currentPage]=[]),this.parent.enableInfiniteScrolling&&this.parent.groupSettings.enableLazyLoading&&"delete"===e.requestType&&(this.visibleRows=[]);for(var _=this,z=O,W=x.length;z<W&&"break"!==function(r,o){if(_.rows.push(x[parseInt(r.toString(),10)]),y&&_.tempFreezeRows.push(x[parseInt(r.toString(),10)]),_.parent.groupSettings.enableLazyLoading&&!_.useGroupCache&&_.parent.groupSettings.columns.length&&((_.parent.enableVirtualization?_.parent.lazyLoadRender:_.parent.contentModule).refRowsObj[_.parent.pageSettings.currentPage].push(x[parseInt(r.toString(),10)]),_.setRowsInLazyGroup(x[parseInt(r.toString(),10)],r),t.isNullOrUndefined(x[parseInt(r.toString(),10)].indent)))return"continue";if(_.setInfiniteVisibleRows(e,x[parseInt(r.toString(),10)],b),ue(i)&&e.virtualInfo&&e.virtualInfo.blockIndexes&&_.rowElements.length>=e.virtualInfo.blockIndexes.length*_.parent.contentModule.getBlockSize()&&k)return _.parent.currentViewData.records=_.rows.map(function(e){return e.data}),"break";if(i.rowTemplate){var s=i.element.id+"rowTemplate",c=void 0;if(i.isReact){var f=i.frozenRows&&r<i.frozenRows,m=t.extend({index:r},n[parseInt(r.toString(),10)]);if(i.getRowTemplate()(m,i,"rowTemplate",s,null,null,f?p:a),i.requireTemplateRef){var S=_;return S.parent.renderTemplates(function(){i.frozenRows&&r<i.frozenRows?d=h.childNodes[parseInt(r.toString(),10)]:u=l.childNodes[parseInt(r.toString(),10)];var e={data:x[parseInt(r.toString(),10)].data,row:u||d};S.parent.trigger("rowDataBound",e),(x[parseInt(r.toString(),10)].isDataRow||S.parent.enableVirtualization&&S.parent.groupSettings.enableLazyLoading)&&S.rowElements.push(d),S.ariaService.setOptions(S.getTable(),{colcount:i.getColumns().length.toString()}),r===x.length-1&&(l=null,h=null)}),"continue"}}else c=i.getRowTemplate()(t.extend({index:r},n[parseInt(r.toString(),10)]),i,"rowTemplate",s,void 0,void 0,void 0,_.parent.root);if(i.isReact||"TBODY"!==c[0].tagName)i.frozenRows&&r<i.frozenRows?d=i.isReact?p.lastElementChild:q(p,c):(i.isReact||(d=q(a,c)),u=i.isReact?a.lastElementChild:d.lastElementChild);else{for(var w=0;w<c.length;w++){var I="tr"===c[parseInt(w.toString(),10)].nodeName.toLowerCase();(I||c[parseInt(w.toString(),10)].querySelectorAll&&c[parseInt(w.toString(),10)].querySelectorAll("tr").length)&&(d=I?c[parseInt(w.toString(),10)]:c[parseInt(w.toString(),10)].querySelector("tr"))}i.frozenRows&&r<i.frozenRows?p.appendChild(d):a.appendChild(d)}var R={data:x[parseInt(r.toString(),10)].data,row:u||d};_.parent.trigger("rowDataBound",R)}else{d=v.render(x[parseInt(r.toString(),10)],g);var F=_.ensureFrozenHeaderRender(e);i.frozenRows&&r<i.frozenRows&&!C&&"virtualscroll"!==e.requestType&&F&&_.ensureVirtualFrozenHeaderRender(e)?p.appendChild(d):a.appendChild(d),x[parseInt(r.toString(),10)].isExpand&&i.notify(xr,d.cells[i.groupSettings.columns.length])}(x[parseInt(r.toString(),10)].isDataRow||_.parent.enableVirtualization&&_.parent.groupSettings.enableLazyLoading)&&_.rowElements.push(d),_.ariaService.setOptions(_.getTable(),{colcount:i.getColumns().length.toString()})}(z);z++);var K=i.parentDetails&&i.parentDetails.parentInstObj&&i.parentDetails.parentInstObj.isReact;if(!i.isReact&&!K||i.requireTemplateRef||i.renderTemplates(),this.parent.enableInfiniteScrolling&&this.parent.groupSettings.enableLazyLoading&&(this.parent.contentModule.refRowsObj[this.parent.pageSettings.currentPage]=this.parent.contentModule.groupCache[this.parent.pageSettings.currentPage]),this.parent.groupSettings.enableLazyLoading&&!this.useGroupCache&&this.parent.groupSettings.columns.length&&this.parent.notify("refresh-Expand-and-Collapse",{rows:(this.parent.enableVirtualization?this.parent.lazyLoadRender:this.parent.contentModule).refRowsObj[this.parent.pageSettings.currentPage]}),y&&o.splitRows(b),i.removeMaskRow(),this.parent.notify("removeGanttShimmer",{requestType:"hideShimmer"}),i.frozenRows&&"virtualscroll"!==e.requestType&&!C&&this.ensureVirtualFrozenHeaderRender(e)||"virtualscroll"===e.requestType&&e.virtualInfo.sentinelInfo&&"X"===e.virtualInfo.sentinelInfo.axis)if(c=y?o.getFrozenHeader(b):i.getHeaderTable().querySelector(li),s){var Q=c.parentElement;t.remove(c),Q.appendChild(p)}else c.innerHTML="",c.appendChild(p);!i.enableVirtualization&&i.frozenRows&&0===F&&R.offsetHeight===Number(i.height)&&(R.style.height=R.offsetHeight-c.offsetHeight+"px"),e.rows=this.rows.slice(0),y&&o.setIsFrozen(e,b),this.index=F,m(function(){r.parent.notify("beforeFragAppend",e);var n=r.parent.enableVirtualization&&r.parent.isFrozenGrid();if(r.parent.enableVirtualization||C||(r.parent.isFrozenGrid()?(t.remove(o.getTbody(b)),S=r.parent.createElement(li,{attrs:{role:"rowgroup"}})):(i.isReact||(r.tbody.innerHTML=""),t.isNullOrUndefined(r.tbody.parentElement)?t.remove(i.getContentTable().querySelector(li)):t.remove(r.tbody),r.tbody=r.parent.createElement(li,{attrs:{role:"rowgroup"}}))),!y||n||r.parent.enableInfiniteScrolling)if(i.rowTemplate&&t.updateBlazorTemplate(i.element.id+"rowTemplate","RowTemplate",i),n){if(e.renderFrozenRightContent){var s=i.getContent().querySelector(".e-frozen-right-content").querySelector(li);r.appendContent(s,a,e)}else e.renderMovableContent?(r.appendContent(I.querySelector(li),a,e),e.renderMovableContent=!1):r.appendContent(w.querySelector(li),a,e);r.parent.getFrozenColumns()||o.renderNextFrozentPart(e,b)}else!t.isNullOrUndefined(r.parent.infiniteScrollModule)&&r.parent.enableInfiniteScrolling?(r.isAddRows=!1,r.parent.notify("remove-infinite-rows",{args:e}),r.parent.notify("append-infinite-content",{tbody:S||r.tbody,frag:a,args:e,rows:r.rows,rowElements:r.rowElements,visibleRows:r.visibleRows,tableName:b}),!f&&y&&((i.getFrozenMode()===ri||b!==ni&&b!==ii)&&(i.getFrozenMode()!==ri||b!==ni&&"movable"!==b)||r.refreshContentRows(t.extend({},e)))):(r.useGroupCache=!1,r.appendContent(r.tbody,a,e));else r.appendContent(S,a,e,b);f&&o.renderNextFrozentPart(e,b),a=null},this.rafCallback(t.extend({},e)))}},e.prototype.emptyVcRows=function(){this.parent.vcRows=[],this.parent.vRows=[]},e.prototype.appendContent=function(e,r,i,n){if(this.parent.isReact&&!t.isNullOrUndefined(this.parent.rowTemplate)?this.getTable().appendChild(r):(e.appendChild(r),this.getTable().appendChild(e)),"Vertical"===this.parent.rowRenderingMode&&this.parent.allowTextWrap&&("Header"===this.parent.textWrapSettings.wrapMode||"Both"===this.parent.textWrapSettings.wrapMode))for(var o=e.querySelectorAll("td"),s=0;s<o.length;s++){var a=parseFloat(document.defaultView.getComputedStyle(o[parseInt(s.toString(),10)],"::before").getPropertyValue("height"));a>o[parseInt(s.toString(),10)].offsetHeight&&(o[parseInt(s.toString(),10)].style.height=a+"px",o[parseInt(s.toString(),10)].style.boxSizing="content-box")}},e.prototype.setRowsInLazyGroup=function(e,t){this.parent.groupSettings.enableLazyLoading&&!this.useGroupCache&&this.parent.groupSettings.columns.length&&(this.parent.enableVirtualization?this.parent.lazyLoadRender:this.parent.contentModule).maintainRows(e,t)},e.prototype.setGroupCache=function(e,t){!this.useGroupCache&&this.parent.groupSettings.enableLazyLoading&&this.parent.notify("group-cache",{args:t,data:e})},e.prototype.ensureFrozenHeaderRender=function(e){return!(this.parent.enableVirtualization&&("reorder"===e.requestType||"refresh"===e.requestType)||this.parent.infiniteScrollSettings.enableCache&&this.parent.frozenRows&&"delete"===this.parent.infiniteScrollModule.requestType&&1!==this.parent.pageSettings.currentPage)},e.prototype.ensureVirtualFrozenHeaderRender=function(e){return!(this.parent.enableVirtualization&&"delete"===e.requestType)},e.prototype.checkCache=function(e,r){if(this.parent.infiniteScrollSettings.enableCache&&"infiniteScroll"===r.requestType){var i=r.isFrozen?1:0,n=this.parent.isFrozenGrid();if(this.isAddRows=!t.isNullOrUndefined(this.infiniteCache[this.parent.pageSettings.currentPage]),n&&!t.isNullOrUndefined(this.infiniteCache[this.parent.pageSettings.currentPage])&&(this.isAddRows=0!==this.infiniteCache[this.parent.pageSettings.currentPage][parseInt(i.toString(),10)].length),this.isAddRows){var o=n?this.infiniteCache[this.parent.pageSettings.currentPage][parseInt(i.toString(),10)]:this.infiniteCache[this.parent.pageSettings.currentPage];e=1===this.parent.pageSettings.currentPage?o.slice(this.parent.frozenRows):o}return e}return this.parent.groupSettings.enableLazyLoading&&this.parent.groupSettings.columns.length&&("paging"===r.requestType||"columnstate"===r.requestType||"reorder"===r.requestType||"virtualscroll"===r.requestType)&&(this.parent.enableVirtualization?this.parent.lazyLoadRender:this.parent.contentModule).getGroupCache()[this.parent.pageSettings.currentPage]?(this.parent.enableVirtualization||(this.useGroupCache=!0),this.parent.enableVirtualization?this.parent.getRowsObject():this.parent.contentModule.initialGroupRows("reorder"===r.requestType)):null},e.prototype.setInfiniteVisibleRows=function(e,t,r){var i=this.parent.isFrozenGrid();this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&(i?r===ni||"Right"===this.parent.getFrozenMode()&&r===ii?this.visibleFrozenRows.push(t):"movable"===r?this.visibleRows.push(t):this.rightFreezeRows.push(t):this.parent.infiniteScrollSettings.enableCache||this.visibleRows.push(t))},e.prototype.getCurrentBlockInfiniteRecords=function(e){var t=[];if(this.parent.infiniteScrollSettings.enableCache){if(!Object.keys(this.infiniteCache).length)return[];var r=this.parent.isFrozenGrid(),i=this.parent.getRows(),n=parseInt(i[this.parent.frozenRows].getAttribute(si),10),o=Math.ceil((n+1)/this.parent.pageSettings.pageSize);n=parseInt(i[i.length-1].getAttribute(si),10);var s=Math.ceil((n+(i.length?1:0))/this.parent.pageSettings.pageSize);if(r){for(var a=e?0:1,l=o;l<=s;l++)t=t.length?t.concat(this.infiniteCache[parseInt(l.toString(),10)][parseInt(a.toString(),10)]):this.infiniteCache[parseInt(l.toString(),10)][parseInt(a.toString(),10)];this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(t=this.infiniteCache[1][parseInt(a.toString(),10)].slice(0,this.parent.frozenRows).concat(t))}else{for(l=o;l<=s;l++)t=t.length?t.concat(this.infiniteCache[parseInt(l.toString(),10)]):this.infiniteCache[parseInt(l.toString(),10)];this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(t=this.infiniteCache[1].slice(0,this.parent.frozenRows).concat(t))}}return t},e.prototype.getReorderedVFRows=function(e){return this.parent.contentModule.getReorderedFrozenRows(e)},e.prototype.getReorderedRows=function(e){return this.parent.contentModule.getReorderedFrozenRows(e)},e.prototype.virtualFrozenHdrRefresh=function(e,t,r,i,n,o){if(this.parent.frozenRows&&this.parent.enableVirtualization&&("reorder"===i.requestType||"refresh"===i.requestType)){var s=void 0,a=[];this.parent.isFrozenGrid()?(this.currentMovableRows=n,a=this.getReorderedVFRows(i)):a=this.getReorderedRows(i);for(var l=0;l<a.length;l++)s=r.render(a[parseInt(l.toString(),10)],o),e.appendChild(s);1===i.virtualInfo.page&&t.splice(0,this.parent.frozenRows),i.renderMovableContent&&(this.parent.currentViewData=this.currentMovableRows,this.currentMovableRows=null)}},e.prototype.getInfiniteRows=function(){var e=[],t=this.parent.isFrozenGrid();if(this.parent.enableInfiniteScrolling)if(this.parent.infiniteScrollSettings.enableCache)for(var r=Object.keys(this.infiniteCache),i=0;i<r.length;i++)e=t?e.concat(this.infiniteCache[r[parseInt(i.toString(),10)]][0]):e.concat(this.infiniteCache[r[parseInt(i.toString(),10)]]);else e=t?this.visibleFrozenRows:this.visibleRows;return e},e.prototype.getInfiniteMovableRows=function(){var e=this.getCurrentBlockInfiniteRecords();return this.parent.enableInfiniteScrolling?e.length?e:this.visibleRows:[]},e.prototype.getPanel=function(){return this.contentPanel},e.prototype.setPanel=function(e){this.contentPanel=e},e.prototype.getTable=function(){return this.contentTable},e.prototype.setTable=function(e){this.contentTable=e},e.prototype.getRows=function(){var e=this.getInfiniteRows();return e.length?e:this.parent.getFrozenColumns()?this.freezeRows:this.rows},e.prototype.getMovableRows=function(){var e=this.getInfiniteMovableRows();return e.length?e:this.movableRows},e.prototype.getRowElements=function(){return this.parent.getFrozenColumns()?this.freezeRowElements:this.rowElements},e.prototype.getMovableRowElements=function(){return this.rowElements},e.prototype.setRowElements=function(e){this.rowElements=e},e.prototype.getColGroup=function(){return this.colgroup},e.prototype.setColGroup=function(e){return t.isNullOrUndefined(e)||(e.id="content-"+e.id),this.colgroup=e},e.prototype.setVisible=function(e){var r=this.parent,i=this.parent.isFrozenGrid(),n=r.getFrozenColumns(),o=[];if(i){var s=this.freezeRows,a=this.movableRows,l=s.length,h=void 0,p=[];r.getFrozenMode()===ri&&(p=r.getFrozenRightRowsObject());for(var d=0,c=void 0;d<l;d++){h=a[parseInt(d.toString(),10)].cells.length;var u=p.length?p[parseInt(d.toString(),10)].cells.length:0;c=s[parseInt(d.toString(),10)].clone();for(var g=0;g<h;g++)c.cells.push(a[parseInt(d.toString(),10)].cells[parseInt(g.toString(),10)]);for(var f=0;f<u;f++)c.cells.push(p[parseInt(d.toString(),10)].cells[parseInt(f.toString(),10)]);o.push(c)}}else o=this.getRows();var m;o.some(function(e){return e.isDataRow&&(m=e),e.isDataRow});var y=!0;!r.groupSettings.columns.length&&m&&(y=!1);for(var v=r.getDataRows(),C={},S=this.infiniteRowVisibility(),b=S||this.rows.filter(function(e){return!e.isDetailRow}),w=0,I=e.length;w<I;w++){var R=e[parseInt(w.toString(),10)],x=this.parent.getNormalizedColumnIndex(R.uid),F=this.parent.getColumnIndexByUid(R.uid),T=!0===R.visible?"":"none";if(-1!==x&&m&&x<m.cells.length)if(i)if("movable"!==R.getFreezeTableName())if(R.getFreezeTableName()===ii){F=x-=this.parent.getFrozenLeftColumnsCount()+this.parent.getMovableColumnsCount();var E=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(hi);t.setStyleAttribute(E.childNodes[parseInt(x.toString(),10)],{display:T}),b=r.getFrozenRightRowsObject(),v=r.getFrozenRightDataRows()}else{t.setStyleAttribute(this.getColGroup().childNodes[parseInt(x.toString(),10)],{display:T});var z=this.infiniteRowVisibility(!0);b=z||this.freezeRows,v=r.getDataRows()}else{var M=r.getContent().querySelector("."+Wr).querySelector(hi);F=x=x-n-this.parent.getFrozenLeftColumnsCount(),t.setStyleAttribute(M.childNodes[parseInt(x.toString(),10)],{display:T}),v=r.getMovableDataRows();var D=this.infiniteRowVisibility();b=D||this.movableRows}else t.setStyleAttribute(this.getColGroup().childNodes[parseInt(x.toString(),10)],{display:T});y||(this.setDisplayNone(v,F,T,b),i&&this.parent.notify(wr,{case:"refreshHeight",isModeChg:!0})),!this.parent.invokedFromMedia&&R.hideAtMedia&&this.parent.updateMediaColumns(R),this.parent.invokedFromMedia=!1}y?this.refreshContentRows({requestType:"refresh"}):this.parent.getFrozenColumns()?(this.parent.notify("partial-refresh",{rows:this.freezeRows,args:{isFrozen:!0,rows:this.freezeRows}}),this.parent.notify("partial-refresh",{rows:this.movableRows,args:{isFrozen:!1,rows:this.movableRows}})):this.parent.notify("partial-refresh",{rows:b,args:C})},e.prototype.setDisplayNone=function(e,t,r,i){Je(e,t,r,i,this.parent,this.parent.isRowDragable()),this.parent.notify("infinite-show-hide",{visible:r,index:t,isFreeze:this.isInfiniteFreeze})},e.prototype.infiniteRowVisibility=function(e){var t;return this.parent.enableInfiniteScrolling&&(this.isInfiniteFreeze=e,t=this.parent.infiniteScrollSettings.enableCache?e?this.getCurrentBlockInfiniteRecords(!0):this.getCurrentBlockInfiniteRecords():e?this.visibleFrozenRows:this.visibleRows),t},e.prototype.colGroupRefresh=function(){if(this.getColGroup()){var e=void 0;e=this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&this.parent.contentModule.isXaxis()?this.parent.getMovableVirtualHeader().querySelector("colgroup:not(.e-masked-colgroup)").cloneNode(!0):this.getHeaderColGroup(),this.getTable().replaceChild(e,this.getColGroup()),this.setColGroup(e)}},e.prototype.getHeaderColGroup=function(){return this.parent.element.querySelector("."+jr).querySelector("colgroup:not(.e-masked-colgroup)").cloneNode(!0)},e.prototype.initializeContentDrop=function(){var e=this.parent;this.droppable=new t.Droppable(e.element,{accept:".e-dragclone",drop:this.drop})},e.prototype.droppableDestroy=function(){this.droppable&&!this.droppable.isDestroyed&&this.droppable.destroy()},e.prototype.canSkip=function(e,r,i){return t.isNullOrUndefined(r)||t.isNullOrUndefined(e.visible)||r.cells[parseInt(i.toString(),10)].visible===e.visible},e.prototype.getModelGenerator=function(){return this.generator=this.parent.allowGrouping?new wi(this.parent):new mi(this.parent)},e.prototype.renderEmpty=function(e){this.getTable().appendChild(e),this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector(li).innerHTML="")},e.prototype.setSelection=function(e,t,r){this.parent.notify("set-freeze-selection",{uid:e,set:t,clearAll:r});var i=this.parent.isFrozenGrid();if(!i||!this.parent.enableVirtualization){if(i)for(var n=this.getMovableRows().filter(function(t){return r||e===t.uid}),o=0;o<n.length;o++)n[parseInt(o.toString(),10)].isSelected=t;for(var s=this.getRows().filter(function(t){return r||e===t.uid}),a=0;a<s.length;a++){s[parseInt(a.toString(),10)].isSelected=t;for(var l=s[parseInt(a.toString(),10)].cells,h=0;h<l.length;h++)l[parseInt(h.toString(),10)].isSelected=t}}},e.prototype.getRowByIndex=function(e){return e=this.getInfiniteRowIndex(e),t.isNullOrUndefined(e)?void 0:this.parent.getDataRows()[parseInt(e.toString(),10)]},e.prototype.getInfiniteRowIndex=function(e){if(this.parent.infiniteScrollSettings.enableCache){var t=this.parent.frozenRows,r=t>e?0:t,i=parseInt(this.parent.getRows()[parseInt(r.toString(),10)].getAttribute(si),10);e=t>e?e:e-i+t}return e},e.prototype.getVirtualRowIndex=function(e){return e},e.prototype.getMovableRowByIndex=function(e){return e=this.getInfiniteRowIndex(e),t.isNullOrUndefined(e)?void 0:this.parent.getMovableDataRows()[parseInt(e.toString(),10)]},e.prototype.enableAfterRender=function(e){"group"===e.module&&e.enable&&(this.generator=this.getModelGenerator())},e.prototype.setRowObjects=function(e){this.rows=e},e.prototype.immutableModeRendering=function(e){var r=this;void 0===e&&(e={});var i=this.parent;i.hideSpinner();var n=i.getPrimaryKeyFieldNames()[0],o={},s={},a=[],l={},h=i.getRowsObject().slice(),p=this.getBatchEditedRecords(n,h),d={},c=0!==Object.keys(p).length;if(i.getContent().querySelector(".e-emptyrow")||"reorder"===e.requestType||this.parent.groupSettings.columns.length)this.refreshContentRows(e);else{if(0===i.currentViewData.length)return;var u={},g=i.createElement(li,{attrs:{role:"rowgroup"}}),f=i.currentViewData,m=[].slice.call(this.getTable().querySelector(li).children);if(this.prevCurrentView.length){var y=this.prevCurrentView.length,v=f.length;if(y===v)for(C=0;C<v;C++)"Batch"===this.parent.editSettings.mode&&m[parseInt(C.toString(),10)].classList.contains("e-insertedrow")?(m.splice(C,1),--C):(s[f[parseInt(C.toString(),10)][""+n]]=o[this.prevCurrentView[parseInt(C.toString(),10)][""+n]]=C,d[parseInt(C.toString(),10)]=f[parseInt(C.toString(),10)][""+n],u[h[parseInt(C.toString(),10)].uid]=m[parseInt(C.toString(),10)],l[parseInt(C.toString(),10)]=this.prevCurrentView[parseInt(C.toString(),10)][""+n]);else{for(C=0;C<v;C++)s[f[parseInt(C.toString(),10)][""+n]]=C,d[parseInt(C.toString(),10)]=f[parseInt(C.toString(),10)][""+n];for(C=0;C<y;C++)"Batch"===this.parent.editSettings.mode&&m[parseInt(C.toString(),10)].classList.contains("e-insertedrow")?(m.splice(C,1),--C):(u[h[parseInt(C.toString(),10)].uid]=m[parseInt(C.toString(),10)],o[this.prevCurrentView[parseInt(C.toString(),10)][""+n]]=C,l[parseInt(C.toString(),10)]=this.prevCurrentView[parseInt(C.toString(),10)][""+n])}}for(var C=0;C<f.length;C++){var S=o[f[parseInt(C.toString(),10)][""+n]];if(t.isNullOrUndefined(S)){var b=new fi(this.serviceLocator,null,i),w={startIndex:C},I=this.generator.generateRows([f[parseInt(C.toString(),10)]],w);a.push(I[0]);x=b.render(I[0],i.getColumns());g.appendChild(x),this.refreshImmutableContent(C,x,a[parseInt(C.toString(),10)])}else{var R=!1;this.parent.enableDeepCompare&&(R=this.objectEqualityChecker(this.prevCurrentView[parseInt(S.toString(),10)],f[parseInt(C.toString(),10)]));var x=u[h[parseInt(S.toString(),10)].uid];if(a.push(h[parseInt(S.toString(),10)]),this.rowElements[parseInt(S.toString(),10)]&&this.rowElements[parseInt(S.toString(),10)].getAttribute("data-uid")===a[parseInt(C.toString(),10)].uid&&(c&&t.isNullOrUndefined(p[d[parseInt(C.toString(),10)]])||!c&&(R||this.prevCurrentView[parseInt(S.toString(),10)]===f[parseInt(C.toString(),10)]))){S!==C&&this.refreshImmutableContent(C,x,a[parseInt(C.toString(),10)]),g.appendChild(x);continue}(c&&!t.isNullOrUndefined(p[d[parseInt(C.toString(),10)]])||!this.parent.enableDeepCompare&&f[parseInt(C.toString(),10)]!==this.prevCurrentView[parseInt(S.toString(),10)]||this.parent.enableDeepCompare&&!R)&&h[parseInt(S.toString(),10)].setRowValue(f[parseInt(C.toString(),10)]),g.appendChild(x),this.refreshImmutableContent(C,x,a[parseInt(C.toString(),10)])}}if(this.rows=a,this.rowElements=[].slice.call(g.children),t.remove(this.getTable().querySelector(li)),this.getTable().appendChild(g),this.parent.trigger(qt,{},function(){r.parent.allowTextWrap&&r.parent.notify(wr,{case:"textwrap"})}),e){var F=(e.requestType||"").toLowerCase()+"-complete";this.parent.notify(F,e)}}},e.prototype.objectEqualityChecker=function(e,t){for(var r=Object.keys(e),i=!0,n=0;n<r.length;n++)if(!(e[r[parseInt(n.toString(),10)]]===t[r[parseInt(n.toString(),10)]]||e[r[parseInt(n.toString(),10)]]instanceof Date&&t[r[parseInt(n.toString(),10)]]instanceof Date&&e[r[parseInt(n.toString(),10)]].getTime()===t[r[parseInt(n.toString(),10)]].getTime())){i=!1;break}return i},e.prototype.getBatchEditedRecords=function(e,t){var r={},i=this.parent.getBatchChanges(),n=[],o=[];Object.keys(i).length&&(n=i.changedRecords,o=i.addedRecords);var s={cancel:!1};this.parent.notify("immutable-batch-cancel",{rows:t,args:s}),o.length&&("Bottom"===this.parent.editSettings.newRowPosition?t.splice(t.length-1,o.length):s.cancel||t.splice(0,o.length));for(var a=0;a<n.length;a++)r[n[parseInt(a.toString(),10)][""+e]]=a;return r},e.prototype.refreshImmutableContent=function(e,t,r){r.isAltRow=!!this.parent.enableAltRow&&e%2!=0,r.isAltRow?t.classList.add("e-altrow"):t.classList.remove("e-altrow"),r.index=e,r.edit=void 0,r.isDirty=!1,t.setAttribute(si,e.toString()),t.setAttribute(ai,(e+1).toString()),this.updateCellIndex(t,e)},e.prototype.updateCellIndex=function(e,t){for(var r=0;r<e.cells.length;r++)e.cells[parseInt(r.toString(),10)].setAttribute("index",t.toString())},e}(),Ri=function(){function r(e,r){var i=this;this.frzIdx=0,this.notfrzIdx=0,this.isFirstCol=!1,this.isReplaceDragEle=!0,this.helper=function(e){var r=i.parent,n=i.draggable.currentStateTarget,o=O(n,"e-headercell");if(!r.allowReordering&&!r.allowGrouping||!t.isNullOrUndefined(o)&&o.getElementsByClassName("e-checkselectall").length>0)return!1;var s=i.parent.createElement("div",{className:"e-cloneproperties e-dragclone e-headerclone"}),a=n.classList.contains("e-headercell")?n:o;if(!a||!r.allowReordering&&a.classList.contains("e-stackedheadercell"))return!1;var l,h=a.offsetHeight,p=a.querySelector(".e-headercelldiv")||a.querySelector(".e-stackedheadercelldiv");if(p){if(l=a.querySelector(".e-stackedheadercelldiv")?r.getStackedHeaderColumnByHeaderText(p.innerText.trim(),r.columns):r.getColumnByUid(p.getAttribute("e-mappinguid")),i.column=l,i.column.lockColumn)return!1;s.setAttribute("e-mappinguid",i.column.uid)}if(l&&!t.isNullOrUndefined(l.headerTemplate))if(t.isNullOrUndefined(l.headerTemplate))s.innerHTML=l.headerTemplate;else{var d=r.getColumnIndexByField(l.field);q(s,l.getHeaderTemplate()(t.extend({index:d},l),r,"headerTemplate"))}else s.innerHTML=p?l.headerText:a.firstElementChild.innerHTML;return s.style.width=a.offsetWidth+"px",s.style.height=a.offsetHeight+"px",s.style.lineHeight=(h-6).toString()+"px",r.element.appendChild(s),s},this.dragStart=function(e){var t=i.parent;t.element.querySelector(".e-gridpopup").style.display="none",t.notify(Ht,{target:i.draggable.currentStateTarget,column:i.column,event:e.event})},this.drag=function(e){var r=i.parent,n=e.target;if(n){var o=t.closest(n,".e-grid"),s=i.parent.element.querySelector(".e-cloneproperties");if(!(o&&o.getAttribute("id")===r.element.getAttribute("id")||(t.classList(s,["e-notallowedcur"],["e-defaultcur"]),r.allowReordering&&(r.element.querySelector(".e-reorderuparrow").style.display="none",r.element.querySelector(".e-reorderdownarrow").style.display="none"),r.groupSettings.allowReordering)))return;r.notify(Ut,{target:e.target,column:i.column,event:e.event})}},this.dragStop=function(e){var r,n=i.parent;n.element.querySelector(".e-gridpopup").style.display="none",(!O(e.target,"e-headercell")&&!O(e.target,"e-groupdroparea")||!n.allowReordering&&O(e.target,"e-headercell")||!e.helper.getAttribute("e-mappinguid")&&O(e.target,"e-groupdroparea"))&&(t.remove(e.helper),r=!0),n.notify(ur,{target:e.target,event:e.event,column:i.column,cancel:r})},this.drop=function(e){var r=i.parent,n=e.droppedElement.getAttribute("e-mappinguid"),o=t.closest(e.target,".e-grid");t.remove(e.droppedElement),o&&o.getAttribute("id")!==r.element.getAttribute("id")||!r.allowReordering&&!r.allowGrouping||r.notify(gr,{target:e.target,uid:n,droppedElement:e.droppedElement})},this.parent=e,this.serviceLocator=r,this.ariaService=this.serviceLocator.getService("ariaService"),this.widthService=this.serviceLocator.getService("widthService"),this.parent.isDestroyed||(this.parent.enableColumnVirtualization||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount()||this.parent.on(hr,this.setVisible,this),this.parent.on(pr,this.colPosRefresh,this),this.parent.on(Qt,this.renderCustomToolbar,this),"Vertical"===this.parent.rowRenderingMode&&this.parent.on(Jt,this.updateCustomResponsiveToolbar,this))}return r.prototype.renderPanel=function(){var e=this.parent.element.querySelector("."+jr),t=null!=e;e=t?e:this.parent.createElement("div",{className:"e-gridheader"});var r=t?e.querySelector("."+_r):this.parent.createElement("div",{className:_r});this.toggleStackClass(e),e.appendChild(r),this.setPanel(e),t||this.parent.element.appendChild(e)},r.prototype.renderTable=function(){var e=this.getPanel();e.appendChild(this.createHeaderTable()),this.setTable(e.querySelector("."+Jr)),this.parent.getFrozenColumns()||this.parent.getFrozenRightColumnsCount()||this.parent.getFrozenLeftColumnsCount()||(this.initializeHeaderDrag(),this.initializeHeaderDrop()),this.parent.notify(rr,{rows:this.rows,args:{isFrozen:this.parent.isFrozenGrid()}})},r.prototype.getPanel=function(){return this.headerPanel},r.prototype.setPanel=function(e){this.headerPanel=e},r.prototype.getTable=function(){return this.headerTable},r.prototype.setTable=function(e){this.headerTable=e},r.prototype.getColGroup=function(){return this.colgroup},r.prototype.setColGroup=function(e){return this.colgroup=e},r.prototype.getRows=function(){return this.getTable().tHead.rows},r.prototype.createHeaderTable=function(){var e=this.createTable(),t=this.getPanel().querySelector("."+_r);return t.appendChild(e),t},r.prototype.createHeader=function(e,r){void 0===e&&(e=null);var i=this.parent,n=i.isFrozenGrid();this.getTable()&&!n&&t.remove(this.getTable());var o=this.parent.createElement("table",{className:Jr,attrs:{cellspacing:"0.25px",role:"grid"}}),s=r||(i.getFrozenLeftCount()?"frozen-left":"frozen-right"),a=this.createHeaderContent(s),l=a.thead,h=this.parent.createElement(li,{className:this.parent.frozenRows?"":"e-hide",attrs:{role:"rowgroup"}});this.caption=this.parent.createElement("caption",{innerHTML:this.parent.element.id+"_header_table",className:"e-hide"});for(var p,d=this.parent.createElement(hi),c=this.parent.createElement("tr"),u=this.rows=a.rows,g=0,f=u.length;g<f;g++)for(var m=0,y=u[parseInt(g.toString(),10)].cells.length;m<y;m++)p=this.parent.createElement("td"),c.appendChild(p);if((i.allowFiltering||i.allowSorting||i.allowGrouping)&&o.classList.add("e-sortfilter"),n&&i.allowResizing){var v=this.parent.getContent().querySelector("."+Wr).querySelector("."+Jr);"movable"!==r||t.isNullOrUndefined(v)||(o.style.width=v.style.width)}return this.updateColGroup(d),h.appendChild(c),o.appendChild(this.setColGroup(d)),o.appendChild(l),o.appendChild(h),o.appendChild(this.caption),this.ariaService.setOptions(o,{colcount:i.getColumns().length.toString()}),o},r.prototype.createTable=function(e){return void 0===e&&(e=null),this.createHeader(e)},r.prototype.createHeaderContent=function(t){var r=this.parent,i=1,n=r.getFrozenMode(),o=r.getColumns(),s=this.parent.createElement("thead",{attrs:{role:"rowgroup"}}),a=this.parent.createElement("tr",{className:"e-columnheader"}),l=new fi(this.serviceLocator,e.CellType.Header,r);l.element=a;var h,p=[];this.colDepth=Se(r.columns);for(var d=0,c=this.colDepth;d<c;d++)p[parseInt(d.toString(),10)]=this.generateRow(d),p[parseInt(d.toString(),10)].cells=[];"Right"!==n&&(p=this.ensureColumns(p)),p=this.getHeaderCells(p,t),"Right"===n&&(i=0,p=this.ensureColumns(p));var u=this.parent.getFrozenColumns();if(this.parent.isRowDragable()&&this.parent.isFrozenGrid()&&p[0].cells[parseInt(i.toString(),10)]){var g=p[0].cells[parseInt(i.toString(),10)].column.getFreezeTableName();if("movable"===t&&this.getStackedLockColsCount.length)for(var f=0,c=p.length;f<c;f++)"Right"===n?p[parseInt(f.toString(),10)].cells.pop():p[parseInt(f.toString(),10)].cells.shift();else"movable"===g||n===ri&&g===ii?"Right"===n?p[0].cells.pop():p[0].cells.shift():u||g!==ni?"Right"===n&&g===ii&&(p[0].cells[p[0].cells.length-1].column.freeze="Right"):p[0].cells[0].column.freeze=g===ni?"Left":"Right"}for(var d=0,c=this.colDepth;d<c;d++)h=l.render(p[parseInt(d.toString(),10)],o),this.parent.rowHeight&&h.querySelector(".e-headercell")&&(h.style.height=this.parent.rowHeight+"px"),s.appendChild(h);return{thead:s,rows:p}},r.prototype.updateColGroup=function(e){var r,i=this.parent.getColumns(),n=this.parent.getColumnIndexesInView();if(this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&this.parent.contentModule.isXaxis()&&(i=t.extend([],this.parent.getColumns())).splice(0,this.parent.getFrozenColumns()),e.id=this.parent.element.id+hi,this.parent.allowGrouping)for(var o=0,s=this.parent.groupSettings.columns.length;o<s;o++)this.parent.enableColumnVirtualization&&-1===n.indexOf(o)||(r=this.parent.createElement("col",{className:"e-group-intent"}),e.appendChild(r));(this.parent.detailTemplate||this.parent.childGrid)&&(r=this.parent.createElement("col",{className:"e-detail-intent"}),e.appendChild(r)),this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()&&(r=this.parent.createElement("col",{className:"e-drag-intent"}),e.appendChild(r));for(var o=0,s=i.length;o<s;o++)r=this.parent.createElement("col"),!1===i[parseInt(o.toString(),10)].visible&&t.setStyleAttribute(r,{display:"none"}),e.appendChild(r);return this.parent.isRowDragable()&&"Right"===this.parent.getFrozenMode()&&(r=this.parent.createElement("col",{className:"e-drag-intent"}),e.appendChild(r)),e},r.prototype.ensureColumns=function(t){for(var r=this.parent,i=this.parent.getColumnIndexesInView(),n=0,o=t.length;n<o;n++){if(r.allowGrouping)for(var s=0,a=r.groupSettings.columns.length;s<a;s++)this.parent.enableColumnVirtualization&&-1===i.indexOf(s)||t[parseInt(n.toString(),10)].cells.push(this.generateCell({},e.CellType.HeaderIndent));if(r.detailTemplate||r.childGrid){var l={};this.parent.notify("detail-indentcell-info",l),t[parseInt(n.toString(),10)].cells.push(this.generateCell(l,e.CellType.DetailHeader))}r.isRowDragable()&&t[parseInt(n.toString(),10)].cells.push(this.generateCell({},e.CellType.RowDragHIcon))}return t},r.prototype.getHeaderCells=function(e,t){var r=this.parent.getHeaderTable()&&this.parent.getHeaderTable().querySelector("thead"),i=this.parent.enableColumnVirtualization?this.parent.getColumns(this.parent.enablePersistence):this.parent.columns;if(this.frzIdx=0,this.notfrzIdx=0,this.parent.lockcolPositionCount)for(n=0;n<i.length;n++)this.lockColsRendered=!1,e=this.appendCells(i[parseInt(n.toString(),10)],e,0,0===n,!1,n===i.length-1,r,t,!1);for(var n=0,o=i.length;n<o;n++)this.notfrzIdx=0,this.lockColsRendered=!0,e=this.appendCells(i[parseInt(n.toString(),10)],e,0,0===n,!1,n===o-1,r,t,!1);return e},r.prototype.appendCells=function(t,r,i,n,o,s,a,l,h){var p,d=s?h?"e-laststackcell":"e-lastcell":"",c=this.parent.isFrozenGrid(),u=!this.parent.lockcolPositionCount||t.lockColumn&&!this.lockColsRendered||!t.lockColumn&&this.lockColsRendered,g=!this.parent.lockcolPositionCount||t.lockColumn&&!this.lockColsRendered||!t.lockColumn&&this.lockColsRendered,f=this.parent.getContent().querySelector(".e-movablescrollbar");if(c&&f&&this.parent.enableColumnVirtualization&&(p=f.scrollLeft),t.columns){this.isFirstCol=!1;var m=this.getCellCnt(t,0);if(m){var y=this.getStackedLockColsCount(t,0),v=0===this.parent.lockcolPositionCount||!this.lockColsRendered&&0!==y||this.lockColsRendered&&m-y!=0,C=c&&this.ensureStackedFrozen(t.columns,l,!1);(!c&&v||C)&&r[parseInt(i.toString(),10)].cells.push(new qr({cellType:e.CellType.StackedHeader,column:t,colSpan:this.getColSpan(m,y,t.columns,l,c),className:n?"":o?"e-firstcell":""}))}if(this.parent.lockcolPositionCount&&!this.lockColsRendered)for(S=0;S<t.columns.length;S++)r=this.appendCells(t.columns[parseInt(S.toString(),10)],r,i+1,n,0===S,S===t.columns.length-1&&s,a,l,!1);if(this.lockColsRendered)for(var S=0,b=t.columns.length;S<b;S++){n=n&&0===S;var w=this.isFirstCol=t.columns[parseInt(S.toString(),10)].visible&&!n,I=S===b-1&&s;r=this.appendCells(t.columns[parseInt(S.toString(),10)],r,i+1,n,w&&!I,I,a,l,!0)}}else p&&p>0&&this.parent.contentModule.isXaxis()&&0!==this.parent.inViewIndexes[0]&&"movable"===t.getFreezeTableName()?r[parseInt(i.toString(),10)].cells.push(this.generateCell(t,e.CellType.Header,this.colDepth-i,(n?"":o?"e-firstcell":"")+d,i,this.parent.getColumnIndexByUid(t.uid))):(!c&&u||c&&t.getFreezeTableName()===l&&g)&&r[parseInt(i.toString(),10)].cells.push(this.generateCell(t,e.CellType.Header,this.colDepth-i,(n?"":o?"e-firstcell":"")+d,i,this.parent.getColumnIndexByUid(t.uid))),this.parent.lockcolPositionCount?this.frzIdx+this.notfrzIdx<this.parent.frozenColumns&&(t.lockColumn&&!this.lockColsRendered||!t.lockColumn&&this.lockColsRendered)?this.frzIdx++:this.notfrzIdx++:this.frzIdx++;return r},r.prototype.ensureStackedFrozen=function(e,t,r){for(var i=e.length,n=0;n<i;n++)if(e[parseInt(n.toString(),10)].columns)r=this.ensureStackedFrozen(e[parseInt(n.toString(),10)].columns,t,r);else if(e[parseInt(n.toString(),10)].getFreezeTableName()===t){r=!0;break}return r},r.prototype.getStackedLockColsCount=function(e,t){if(e.columns)for(var r=0;r<e.columns.length;r++)t=this.getStackedLockColsCount(e.columns[parseInt(r.toString(),10)],t);else e.lockColumn&&t++;return t},r.prototype.getColSpan=function(e,t,r,i,n){return n?e=this.getFrozenColSpan(r,i,0):this.parent.lockcolPositionCount&&(e=this.lockColsRendered?e-t:t),e},r.prototype.getFrozenColSpan=function(e,t,r){for(var i=e.length,n=0;n<i;n++)e[parseInt(n.toString(),10)].columns?r=this.getFrozenColSpan(e[parseInt(n.toString(),10)].columns,t,r):e[parseInt(n.toString(),10)].getFreezeTableName()===t&&e[parseInt(n.toString(),10)].visible&&r++;return r},r.prototype.generateRow=function(e){return new Nr({})},r.prototype.generateCell=function(e,r,i,n,o,s){var a={visible:e.visible,isDataCell:!1,isTemplate:!t.isNullOrUndefined(e.headerTemplate),rowID:"",column:e,cellType:r,rowSpan:i,className:n,index:o,colIndex:s};return(!a.rowSpan||a.rowSpan<2)&&delete a.rowSpan,new qr(a)},r.prototype.setVisible=function(e){for(var r,i,n=this.parent,o=n.getFrozenColumns(),s=0,a=e.length;s<a;s++){var l=e[parseInt(s.toString(),10)];if(i=n.getNormalizedColumnIndex(l.uid),r=l.visible?"":"none",o){var h=this.parent.isRowDragable()?o+1:o;if(i<h)t.setStyleAttribute(this.getColGroup().children[parseInt(i.toString(),10)],{display:r});else{var p=n.getHeaderContent().querySelector("."+Kr).querySelector(hi);t.setStyleAttribute(p.children[i-h],{display:r})}}else t.setStyleAttribute(this.getColGroup().children[parseInt(i.toString(),10)],{display:r})}this.refreshUI()},r.prototype.colPosRefresh=function(){this.refreshUI()},r.prototype.refreshUI=function(){var e=this.parent.isFrozenGrid(),r=this.parent.enableColumnVirtualization&&e,i=this.getPanel();this.toggleStackClass(i);var n=this.freezeReorder?this.headerPanel.querySelector("."+Kr).querySelector("."+Jr):this.getTable(),o=this.parent.isFrozenGrid()?this.parent.getFrozenLeftCount()?"frozen-left":"frozen-right":void 0;if(r&&(n=this.parent.contentModule.getVirtualFreezeHeader(),o=this.parent.contentModule.isXaxis()?"movable":o),n){t.remove(n),n.removeChild(n.firstChild),n.removeChild(n.childNodes[0]);var s=this.parent.createElement(hi),a=this.createHeaderContent(o);this.rows=a.rows,n.insertBefore(a.thead,n.firstChild),this.updateColGroup(s),n.insertBefore(this.setColGroup(s),n.firstChild),r||this.setTable(n),this.appendContent(n),this.parent.notify(tr,{}),this.widthService.setWidthToColumns(),this.parent.updateDefaultCursor(),(!e||this.parent.enableColumnVirtualization&&e)&&this.initializeHeaderDrag();for(var l=[].slice.call(i.querySelectorAll("tr.e-columnheader")),h=0,p=l;h<p.length;h++){var d=p[h],c=[].slice.call(d.getElementsByClassName("e-grouptopleftcell"));c.length&&c[c.length-1].classList.add("e-lastgrouptopleftcell")}this.parent.notify(rr,{rows:this.rows,args:{isFrozen:e}}),this.parent.enableColumnVirtualization&&O(n,Kr)&&this.parent.notify(rr,{rows:this.rows,args:{isFrozen:!1,isXaxis:!0}}),this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&J(l,!0)}},r.prototype.toggleStackClass=function(e){this.parent.columns.some(function(e){return!t.isNullOrUndefined(e.columns)})?e.classList.add("e-stackedheader"):e.classList.remove("e-stackedheader")},r.prototype.appendContent=function(e){this.getPanel().querySelector("."+_r).appendChild(e)},r.prototype.getCellCnt=function(e,t){if(e.columns)for(var r=0,i=e.columns.length;r<i;r++)t=this.getCellCnt(e.columns[parseInt(r.toString(),10)],t);else e.visible&&t++;return t},r.prototype.initializeHeaderDrag=function(){var e=this.parent;(this.parent.allowReordering||this.parent.allowGrouping&&this.parent.groupSettings.showDropArea)&&(this.draggable=new t.Draggable(e.getHeaderContent(),{dragTarget:".e-headercell",distance:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop,abort:".e-rhandler",isReplaceDragEle:this.isReplaceDragEle}),this.parent.on(lr,this.droppableDestroy,this))},r.prototype.initializeHeaderDrop=function(){var e=this.parent;this.droppable=new t.Droppable(e.getHeaderContent(),{accept:".e-dragclone",drop:this.drop}),this.parent.on(lr,this.droppableDestroy,this)},r.prototype.droppableDestroy=function(){this.droppable&&!this.droppable.isDestroyed&&this.droppable.destroy(),this.draggable&&!this.draggable.isDestroyed&&this.draggable.destroy()},r.prototype.renderCustomToolbar=function(){var e=this,t=this.parent;if("Vertical"===t.rowRenderingMode&&!t.toolbar&&(t.allowSorting||t.allowFiltering&&"FilterBar"!==t.filterSettings.type)){for(var r=t.createElement("div",{className:"e-res-toolbar e-toolbar"}),i=t.createElement("div",{className:"e-toolbar-items"}),o=t.createElement("div",{className:"e-toolbar-left"}),s=this.parent.allowFiltering&&this.parent.allowSorting?2:1,a=0;a<s;a++){var l=t.createElement("div",{className:"e-toolbar-item e-gridresponsiveicons e-icons e-tbtn-align"}),h=1===s?this.parent.allowSorting?"sort":"filter":1===a?"sort":"filter",p=t.createElement("button",{className:"e-tbar-btn e-control e-btn e-lib e-icon-btn"}),d=t.createElement("span",{className:"e-btn-icon e-res"+h+"-icon e-icons"});p.appendChild(d),new n.Button({cssClass:this.parent.cssClass?this.parent.cssClass:""}).appendTo(p),p.onclick=function(t){t.target.classList.contains("e-ressort-btn")||t.target.classList.contains("e-ressort-icon")?e.parent.showResponsiveCustomSort():e.parent.showResponsiveCustomFilter()},l.appendChild(p),o.appendChild(l)}i.appendChild(o),r.appendChild(i),t.element.insertBefore(r,this.parent.element.querySelector("."+jr))}else t.enableAdaptiveUI&&!t.toolbar&&t.getContent().classList.add("e-responsive-header")},r.prototype.updateCustomResponsiveToolbar=function(e){var r=this.parent.element.querySelector(".e-responsive-toolbar");"toolbar"===e.module&&(r?t.remove(r):this.renderCustomToolbar())},r}(),xi=function(){function r(e,t){this.localizer=t.getService("localization"),this.formatter=t.getService("valueFormatter"),this.parent=e,this.element=this.parent.createElement("TD",{className:Ur,attrs:{tabindex:"-1"}}),this.rowChkBox=this.parent.createElement("input",{className:"e-checkselect",attrs:{type:"checkbox","aria-label":this.localizer.getConstant("CheckBoxLabel")}})}return r.prototype.getGui=function(){return""},r.prototype.format=function(e,r,i){return t.isNullOrUndefined(e.format)||("number"===e.type&&isNaN(parseInt(r,10))&&(r=null),r=this.formatter.toView(r,e.getFormatter())),t.isNullOrUndefined(r)?"":r.toString()},r.prototype.evaluate=function(e,r,i,n,o,s){var a,l;if(r.column.template){var h=this.parent.isReact&&"string"!=typeof r.column.template&&r.column.template.prototype&&!r.column.template.prototype.CSPTemplate,p=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,d=["index"],c=ve({},i,(a={},a.foreignKeyData=o,a.column=r.column,a)),u=this.parent.element.id+r.column.uid,g="isStringTemplate";if(h||p){var f={index:n[d[0]]};r.column.getColumnTemplate()(t.extend(f,c),this.parent,"columnTemplate",u,this.parent[""+g],null,e)}else l=r.column.getColumnTemplate()(t.extend({index:n[d[0]]},c),this.parent,"template",u,this.parent[""+g],void 0,void 0,this.parent.root);return h||p||q(e,l),this.parent.notify("template-result",{template:l}),l=null,e.setAttribute("aria-label",e.innerText+this.localizer.getConstant("TemplateCell")+this.localizer.getConstant("ColumnHeader")+r.column.headerText),!1}return!0},r.prototype.invokeFormatter=function(e,r,i){return t.isNullOrUndefined(e.formatter)||(r=u(e.formatter,"getValue")?(new(0,e.formatter)).getValue(e,i):"function"==typeof e.formatter?e.formatter(e,i):e.formatter.getValue(e,i)),r},r.prototype.render=function(e,t,r,i,n){return this.refreshCell(e,t,r,n)},r.prototype.refreshTD=function(e,r,i,n){var o="Batch"===this.parent.editSettings.mode&&e.classList.contains("e-editedbatchcell");if(this.parent.isReact){e.innerHTML="";var s=e.cellIndex,a=e.parentElement;t.remove(e);var l=this.refreshCell(r,i,n,o);this.cloneAttributes(l,e),a.cells.length!==s-1?a.insertBefore(l,a.cells[parseInt(s.toString(),10)]):a.appendChild(l)}else{var h=this.refreshCell(r,i,n,o);e.innerHTML="",e.setAttribute("aria-label",h.getAttribute("aria-label"));for(var p=0,d=[].slice.call(h.childNodes);p<d.length;p++){var c=d[p];e.appendChild(c)}}},r.prototype.cloneAttributes=function(e,t){for(var r,i=t.attributes,n=i.length;n--;)r=i[parseInt(n.toString(),10)],e.setAttribute(r.name,r.value)},r.prototype.refreshCell=function(e,r,i,o){var s,a,l=this.element.cloneNode(),h=e.column;e.isForeignKey&&(a=e.foreignKeyData[0]||(s={},s[h.foreignKeyValue]=h.format?null:"",s));var p=this.getGui(),d=e.isForeignKey?this.getValue(h.foreignKeyValue,a,h):this.getValue(h.field,r,h);if("date"!==h.type&&"datetime"!==h.type&&"dateonly"!==h.type||t.isNullOrUndefined(d)||(d=new Date(d)),d=this.format(h,d,r),p=d.toString(),"boolean"===h.type&&!h.displayAsCheckBox){var c="true"!==d&&"false"!==d?null:"true"===d?"True":"False";p=c?this.localizer.getConstant(c):p}var u=this.invokeFormatter(h,d,r);if(p=t.isNullOrUndefined(h.formatter)?p:t.isNullOrUndefined(u)?"":u.toString(),l.setAttribute("aria-label",p+this.localizer.getConstant("ColumnHeader")+e.column.headerText),this.evaluate(l,e,r,i,a,o)&&"checkbox"!==h.type)this.appendHtml(l,this.parent.sanitize(p),h.getDomSetter?h.getDomSetter():"innerHTML");else if("checkbox"===h.type){l.classList.add($r),l.setAttribute("aria-label",this.localizer.getConstant("CheckBoxLabel")),d=!!this.parent.selectionSettings.persistSelection&&"true"===d;f=n.createCheckBox(this.parent.createElement,!1,{checked:d,label:" "});this.parent.cssClass&&t.addClass([f],[this.parent.cssClass]),this.rowChkBox.id="checkbox-"+e.rowID,f.insertBefore(this.rowChkBox.cloneNode(),f.firstChild),l.appendChild(f)}if("Check"===this.parent.checkAllRows&&this.parent.enableVirtualization&&(e.isSelected=!0),this.setAttributes(l,e,i),"boolean"===h.type&&h.displayAsCheckBox){var g=isNaN(parseInt(d.toString(),10))?"true"===d:parseInt(d.toString(),10)>0,f=n.createCheckBox(this.parent.createElement,!1,{checked:g,label:" "});l.innerHTML="",l.classList.add("e-gridchkbox-cell"),f.classList.add("e-checkbox-disabled"),this.parent.cssClass&&t.addClass([f],[this.parent.cssClass]),l.appendChild(f),l.setAttribute("aria-label",g+this.localizer.getConstant("ColumnHeader")+e.column.headerText)}return l},r.prototype.appendHtml=function(e,t,r){return void 0===r&&(r="innerHTML"),e[""+r]=t,e},r.prototype.setAttributes=function(e,t,r){var i=t.column;this.buildAttributeFromCell(e,t,"checkbox"===i.type),x(e,r),x(e,t.attributes),i.customAttributes&&x(e,i.customAttributes),"Vertical"===this.parent.rowRenderingMode&&x(e,{"data-cell":i.headerText}),i.textAlign&&(e.style.textAlign=i.textAlign),"Clip"===i.clipMode||!i.clipMode&&"Clip"===this.parent.clipMode?e.classList.add("e-gridclip"):"EllipsisWithTooltip"!==i.clipMode&&(i.clipMode||"EllipsisWithTooltip"!==this.parent.clipMode||this.parent.allowTextWrap&&("Content"===this.parent.textWrapSettings.wrapMode||"Both"===this.parent.textWrapSettings.wrapMode))||"checkbox"!==i.type&&e.classList.add("e-ellipsistooltip")},r.prototype.buildAttributeFromCell=function(r,i,n){var o={},s={colindex:oi},a=[];i.colSpan&&(o.colSpan=i.colSpan),i.rowSpan&&(o.rowSpan=i.rowSpan),i.isTemplate&&a.push("e-templatecell"),i.isSelected&&(a.push.apply(a,["e-selectionbackground","e-active"]),n&&r.querySelector(".e-frame").classList.add("e-check")),i.isColumnSelected&&a.push.apply(a,["e-columnselection"]),i.cellType===e.CellType.Header?(o[s.colindex]=i.colIndex,o["aria-colindex"]=i.colIndex+1):t.isNullOrUndefined(i.index)||(o[s.colindex]=i.index,o["aria-colindex"]=i.index+1),i.visible||a.push("e-hide"),o.class=a,x(r,o)},r.prototype.getValue=function(e,t,r){return r.valueAccessor(e,t,r)},r}(),Fi=function(){function e(){}return e.prototype.setOptions=function(e,t){for(var r=Object.keys(t),i=0;i<r.length;i++)d(e,Ti[r[parseInt(i.toString(),10)]],t[r[parseInt(i.toString(),10)]])},e.prototype.setExpand=function(e,t){d(e,Ti.expand,t)},e.prototype.setSort=function(e,t){d(e,Ti.sort,t,"boolean"==typeof t)},e.prototype.setBusy=function(e,t){d(e,Ti.busy,t),d(e,Ti.invalid,null,!0)},e.prototype.setGrabbed=function(e,t,r){d(e,Ti.grabbed,t,r)},e.prototype.setDropTarget=function(e,t){d(e,Ti.dropeffect,"copy",!t)},e}(),Ti={expand:"aria-expanded",role:"role",datarole:"data-role",selected:"aria-selected",multiselectable:"aria-multiselectable",sort:"aria-sort",busy:"aria-busy",invalid:"aria-invalid",grabbed:"aria-grabbed",dropeffect:"aria-dropeffect",haspopup:"aria-haspopup",level:"aria-level",colcount:"aria-colcount",rowcount:"aria-rowcount"},Ei=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),zi=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-headercell",attrs:{tabindex:"-1"}}),t.ariaService=new Fi,t.hTxtEle=t.parent.createElement("span",{className:"e-headertext"}),t.sortEle=t.parent.createElement("div",{className:"e-sortfilterdiv e-icons",attrs:{"aria-hidden":"true"}}),t.gui=t.parent.createElement("div"),t.chkAllBox=t.parent.createElement("input",{className:"e-checkselectall",attrs:{type:"checkbox","aria-label":t.localizer.getConstant("CheckBoxLabel")}}),t}return Ei(r,e),r.prototype.getGui=function(){return this.gui.cloneNode()},r.prototype.render=function(e,t,r){var i=this.element.cloneNode(),n=this.parent.createElement("div",{className:"e-filtermenudiv e-icons e-icon-filter",attrs:{"aria-hidden":"true"}});return this.prepareHeader(e,i,n)},r.prototype.refresh=function(e,t){this.clean(t);var r=this.parent.createElement("div",{className:"e-filtermenudiv e-icons e-icon-filter",attrs:{"aria-hidden":"true"}});return this.prepareHeader(e,t,r)},r.prototype.clean=function(e){e.innerHTML=""},r.prototype.prepareHeader=function(e,r,i){var o,s=e.column,a={},l="",h=this.getGui();if(t.attributes(h,{"e-mappinguid":s.uid,class:"e-headercelldiv"}),t.isNullOrUndefined(s.headerValueAccessor)||(o=this.getValue(s.headerText,s)),"checkbox"!==s.type){var p=s.headerText;t.isNullOrUndefined(o)||(p=o);var d=this.hTxtEle.cloneNode();d[s.getDomSetter()]=this.parent.sanitize(p),h.appendChild(d)}else{s.editType="booleanedit";var c=n.createCheckBox(this.parent.createElement,!1,{checked:!1,label:" "});this.chkAllBox.id="checkbox-"+s.uid,c.insertBefore(this.chkAllBox.cloneNode(),c.firstChild),this.parent.cssClass&&t.addClass([c],[this.parent.cssClass]),h.appendChild(c),h.classList.add("e-headerchkcelldiv")}if(this.buildAttributeFromCell(r,e),this.appendHtml(r,h),r.appendChild(this.sortEle.cloneNode()),this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&s.allowFiltering&&!t.isNullOrUndefined(s.field)&&(!this.parent.showColumnMenu||!s.showColumnMenu)){t.attributes(i,{"e-mappinguid":"e-flmenu-"+s.uid}),l=l.length?l+". "+this.localizer.getConstant("FilterDescription"):this.localizer.getConstant("FilterDescription"),r.classList.add("e-fltr-icon");var u=[];if(this.parent.filterSettings.columns.length&&this.parent.filterSettings.columns.length!==u.length)for(var g=this.parent.getForeignKeyColumns(),f=0;f<this.parent.columns.length;f++)for(var m=0;m<this.parent.filterSettings.columns.length;m++)if(this.parent.filterSettings.columns[parseInt(m.toString(),10)].field===s.field||g.length&&s.foreignKeyValue===this.parent.filterSettings.columns[parseInt(m.toString(),10)].field){i.classList.add("e-filtered"),u.push(s.field);break}r.appendChild(i.cloneNode())}e.className&&r.classList.add(e.className),s.customAttributes&&x(r,s.customAttributes),this.parent.allowSorting&&s.allowSorting&&(a.sort="none",l=l.length?l+". "+this.localizer.getConstant("SortDescription"):this.localizer.getConstant("SortDescription")),(this.parent.allowGrouping&&s.allowGrouping||this.parent.allowReordering&&s.allowReordering)&&(a.grabbed=!1,l=l.length?l+". "+this.localizer.getConstant("GroupDescription"):this.localizer.getConstant("GroupDescription")),this.parent.showColumnMenu&&(l=l.length?l+". "+this.localizer.getConstant("ColumnMenuDescription"):this.localizer.getConstant("ColumnMenuDescription")),r=this.extendPrepareHeader(s,r);var y,v=this.parent,C=v.getColumnIndexByField(s.field);if(!t.isNullOrUndefined(s.headerTemplate)){var S=v.element.id+s.uid+"headerTemplate",b="isStringTemplate",w=s,I=this.parent.isReact&&"string"!=typeof s.headerTemplate,R=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact;if(I||R){var F={index:C};r.firstElementChild.innerHTML="",s.getHeaderTemplate()(t.extend(F,w),v,"headerTemplate",S,this.parent[""+b],null,r.firstElementChild),this.parent.renderTemplates()}else y=s.getHeaderTemplate()(t.extend({index:C},w),v,"headerTemplate",S,this.parent[""+b],void 0,void 0,this.parent.root),r.firstElementChild.innerHTML="",q(r.firstElementChild,y)}if(this.ariaService.setOptions(r,a),!t.isNullOrUndefined(s.headerTextAlign)||!t.isNullOrUndefined(s.textAlign)){var T=s.headerTextAlign||s.textAlign;h.style.textAlign=T,"Right"===T||"Left"===T?r.classList.add("Right"===T?"e-rightalign":"e-leftalign"):"Center"===T&&r.classList.add("e-centeralign")}"Clip"===s.clipMode||!s.clipMode&&"Clip"===this.parent.clipMode?r.classList.add("e-gridclip"):"EllipsisWithTooltip"!==s.clipMode&&(s.clipMode||"EllipsisWithTooltip"!==this.parent.clipMode)||v.allowTextWrap&&("Header"===v.textWrapSettings.wrapMode||"Both"===v.textWrapSettings.wrapMode)||"checkbox"!==s.type&&r.classList.add("e-ellipsistooltip"),l&&r.setAttribute("aria-description",l),r.setAttribute("aria-rowspan",(t.isNullOrUndefined(e.rowSpan)?1:e.rowSpan).toString()),r.setAttribute("aria-colspan","1");var E=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact;if((this.parent.isReact&&this.parent.requireTemplateRef||E&&this.parent.parentDetails.parentInstObj.requireTemplateRef)&&!t.isNullOrUndefined(s.headerTemplate)){var z=this;z.parent.renderTemplates(function(){z.parent.trigger("headerCellInfo",{cell:e,node:r})})}else this.parent.trigger("headerCellInfo",{cell:e,node:r});return r},r.prototype.getValue=function(e,t){return t.headerValueAccessor(e,t)},r.prototype.extendPrepareHeader=function(e,r){if(this.parent.showColumnMenu&&e.showColumnMenu&&!t.isNullOrUndefined(e.field)){var i=this.parent.createElement("div",{className:"e-icons e-columnmenu",attrs:{"aria-hidden":"true"}}),n=[];if(this.parent.filterSettings.columns.length&&this.parent.filterSettings.columns.length!==n.length)for(var o=0;o<this.parent.columns.length;o++)for(var s=0;s<this.parent.filterSettings.columns.length;s++)if(this.parent.filterSettings.columns[parseInt(s.toString(),10)].field===e.field){i.classList.add("e-filtered"),n.push(e.field);break}r.classList.add("e-fltr-icon"),r.appendChild(i)}if(this.parent.allowResizing){var a=this.parent.createElement("div");a.className=e.allowResizing?"e-rhandler e-rcursor":"e-rsuppress",r.appendChild(a)}return r},r.prototype.appendHtml=function(e,t){return e.appendChild(t),e},r}(xi),Mi=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Di=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-headercell e-stackedheadercell",attrs:{tabindex:"-1"}}),t}return Mi(r,e),r.prototype.render=function(e,r,i){var n=this.element.cloneNode(),o=this.parent.createElement("div",{className:"e-stackedheadercelldiv",attrs:{"e-mappinguid":e.column.uid}}),s=e.column;if(n.appendChild(o),t.isNullOrUndefined(s.headerTemplate)?this.appendHtml(o,this.parent.sanitize(s.headerText),s.getDomSetter()):q(o,s.getHeaderTemplate()(s,this.parent,"headerTemplate")),e.column.toolTip&&n.setAttribute("title",e.column.toolTip),"Clip"===s.clipMode||!s.clipMode&&"Clip"===this.parent.clipMode?n.classList.add("e-gridclip"):("EllipsisWithTooltip"===s.clipMode||!s.clipMode&&"EllipsisWithTooltip"===this.parent.clipMode)&&n.classList.add("e-ellipsistooltip"),t.isNullOrUndefined(e.column.textAlign)||(o.style.textAlign=e.column.textAlign),e.column.customAttributes&&x(n,e.column.customAttributes),n.setAttribute("colspan",e.colSpan.toString()),n.setAttribute("aria-colspan",e.colSpan.toString()),n.setAttribute("aria-rowspan","1"),this.parent.allowResizing){var a=this.parent.createElement("div");a.className=e.column.allowResizing?"e-rhandler e-rcursor":"e-rsuppress",n.appendChild(a)}return e.className&&n.classList.add(e.className),this.parent.trigger("headerCellInfo",{cell:e,node:n}),n},r}(xi),Oi=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ki=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-indentcell"}),t}return Oi(t,e),t.prototype.render=function(e,t){var r=this.element.cloneNode();return x(r,e.attributes),r},t}(xi),Ai=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Li=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.cellUid=0,t.element=t.parent.createElement("TD",{className:"e-groupcaption",attrs:{id:t.parent.element.id+"captioncell",tabindex:"-1"}}),t}return Ai(r,e),r.prototype.render=function(e,r){this.element.id=this.parent.element.id+"captioncell"+this.cellUid++;var i,n,o,s=this.element.cloneNode(),a=this.parent,l=e.column,h=l.getDomSetter?l.getDomSetter():"innerHTML";r.headerText=e.column.headerText,e.isForeignKey&&(n=this.format(e.column,e.column.valueAccessor("foreignKey",r,e.column)));for(var p=e.isForeignKey?n:e.column.enableGroupByFormat?r.key:this.format(e.column,e.column.valueAccessor("key",r,e.column)),d=0;d<a.aggregates.length;d++)for(var c=0;c<a.aggregates[parseInt(d.toString(),10)].columns.length;c++)if(a.getVisibleColumns()[0].field===a.aggregates[parseInt(d.toString(),10)].columns[parseInt(c.toString(),10)].field&&a.aggregates[parseInt(d.toString(),10)].columns[parseInt(c.toString(),10)].groupCaptionTemplate){o=a.aggregates[parseInt(d.toString(),10)].columns[parseInt(c.toString(),10)].groupCaptionTemplate.includes("$")?a.aggregates[parseInt(d.toString(),10)].columns[parseInt(c.toString(),10)].groupCaptionTemplate.split("$")[0]+r[a.getVisibleColumns()[0].field][a.aggregates[parseInt(d.toString(),10)].columns[parseInt(c.toString(),10)].type]+a.aggregates[parseInt(d.toString(),10)].columns[parseInt(c.toString(),10)].groupCaptionTemplate.split("}")[1]:a.aggregates[parseInt(d.toString(),10)].columns[parseInt(c.toString(),10)].groupCaptionTemplate;break}if(t.isNullOrUndefined(a.groupSettings.captionTemplate))a.groupSettings.enableLazyLoading?s[""+h]=this.parent.sanitize(e.column.headerText)+": "+this.parent.sanitize(p)+(o?"   "+o:""):s[""+h]=this.parent.sanitize(e.column.headerText)+": "+this.parent.sanitize(p)+" - "+r.count+" "+(r.count<2?this.localizer.getConstant("Item"):this.localizer.getConstant("Items"))+(o?"   "+o:"");else{var u=this.parent.isReact&&"string"!=typeof a.groupSettings.captionTemplate,g=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact;if(u||g){var f=a.element.id+"captionTemplate";R(a.groupSettings.captionTemplate)(r,this.parent,"captionTemplate",f,null,null,s),this.parent.renderTemplates()}else i=this.parent.isVue?R(a.groupSettings.captionTemplate)(r,this.parent):R(a.groupSettings.captionTemplate)(r);u||g||q(s,i)}return s.setAttribute("colspan",e.colSpan.toString()),s.setAttribute("aria-label",s.innerHTML+this.localizer.getConstant("GroupCaption")),s.setAttribute("title",s.textContent),s},r}(xi),Pi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-groupcaption"}),t}return Ai(t,e),t.prototype.render=function(e,t){var r=this.element.cloneNode();return r.innerHTML="&nbsp;",r.setAttribute("colspan",e.colSpan.toString()),r},t}(xi),Bi=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ni=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return Bi(r,t),r.prototype.render=function(t,r,i,n){var o=this.element.cloneNode();return o.setAttribute("ej-mappingname",r.field),o.setAttribute("ej-mappingvalue",r.key),o.setAttribute("aria-expanded",n?"true":"false"),o.setAttribute("tabindex","-1"),this.parent.infiniteScrollSettings&&this.parent.infiniteScrollSettings.enableCache?(t.cellType=e.CellType.Indent,o.className=n?"e-recordplusexpand e-disablepointer":"e-recordpluscollapse e-disablepointer"):(o.className=n?"e-recordplusexpand":"e-recordpluscollapse",o.appendChild(this.parent.createElement("a",{className:n?"e-icons e-gdiagonaldown e-icon-gdownarrow":"e-icons e-gnextforward e-icon-grightarrow",attrs:{href:"#",title:n?"expanded":"collapsed"}}))),o},r}(ki),qi=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Hi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-grouptopleftcell"}),t}return qi(t,e),t.prototype.render=function(e,t){var r=this.element.cloneNode();return r.appendChild(this.parent.createElement("div",{className:"e-headercelldiv e-emptycell",innerHTML:""})),r},t}(xi),Ui=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ji=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-detailheadercell"}),t}return Ui(t,e),t.prototype.render=function(e,t){var r=this.element.cloneNode();return r.appendChild(this.parent.createElement("div",{className:"e-emptycell"})),r},t}(xi),Vi=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Gi=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-detailrowcollapse",attrs:{"aria-expanded":"false",tabindex:"-1"}}),t}return Vi(r,e),r.prototype.render=function(e,r,i){var n=this.element.cloneNode();return i&&!t.isNullOrUndefined(i.class)?(n.className="",n.className=i.class,n.appendChild(this.parent.createElement("a",{className:"e-icons e-dtdiagonaldown e-icon-gdownarrow",attrs:{href:"#",title:this.localizer.getConstant("Expanded")}}))):n.appendChild(this.parent.createElement("a",{className:"e-icons e-dtdiagonalright e-icon-grightarrow",attrs:{href:"#",title:this.localizer.getConstant("Collapsed")}})),n},r}(xi),_i=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Wi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-rowdragdrop e-rowdragdropcell",attrs:{tabindex:"-1"}}),t}return _i(t,e),t.prototype.render=function(e,t){var r=this.element.cloneNode();return r.appendChild(this.parent.createElement("div",{className:"e-icons e-rowcelldrag e-dtdiagonalright e-icon-rowdragicon",attrs:{"aria-hidden":"true"}})),e.isSelected&&(r.classList.add("e-selectionbackground"),r.classList.add("e-active")),r},t}(xi),Ki=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Qi=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-rowdragheader"}),t}return Ki(r,e),r.prototype.render=function(e,r){var i=this.element.cloneNode();return i.appendChild(t.createElement("div",{className:"e-emptycell"})),i},r}(xi),Xi=function(){function i(e,t){this.emptyGrid=!1,this.counter=0,this.parent=e,this.locator=t,this.data=new Br(e,t),this.l10n=t.getService("localization"),this.ariaService=this.locator.getService("ariaService"),this.renderer=this.locator.getService("rendererFactory"),this.addEventListener()}return i.prototype.render=function(){var t=this.parent;this.headerRenderer=this.renderer.getRenderer(e.RenderType.Header),this.contentRenderer=this.renderer.getRenderer(e.RenderType.Content),this.headerRenderer.renderPanel(),this.contentRenderer.renderPanel(),t.getColumns().length&&(this.isLayoutRendered=!0,this.headerRenderer.renderTable(),this.contentRenderer.renderTable(),this.emptyRow(!1)),this.parent.scrollModule.setWidth(),this.parent.scrollModule.setHeight(),"auto"!==this.parent.height&&this.parent.scrollModule.setPadding(),this.refreshDataManager()},i.prototype.refresh=function(e){var t=this;void 0===e&&(e={requestType:"refresh"});var r=this.parent;r.notify(e.requestType+"-begin",e),r.trigger(Bt,e,function(e){if(void 0===e&&(e={requestType:"refresh"}),e.cancel)return void r.notify("cancel-Begin",e);if(("clearFilter"===e.action||"searching"===e.requestType&&""===e.searchString||"add"===e.action)&&(r.selectionModule.rmtHdrChkbxClicked=!1),r.allowPaging&&r.pageSettings.pageSizes&&r.pagerModule.pagerObj.isAllPage&&"add"===e.action&&"save"===e.requestType&&r.pagerModule.pagerObj.checkAll&&r.setProperties({pageSettings:{pageSize:r.pageSettings.pageSize+1}},!0),"delete"===e.requestType&&r.allowPaging){var i=e.data.length,n=r.pageSettings.totalRecordsCount-i;r.getCurrentViewRecords().length-i||!n||(r.pageSettings.currentPage-1)*r.pageSettings.pageSize!==n||(r.prevPageMoving=!0,r.setProperties({pageSettings:{totalRecordsCount:n,currentPage:Math.ceil(n/r.pageSettings.pageSize)}},!0),r.pagerModule.pagerObj.totalRecordsCount=n)}"reorder"===e.requestType&&t.parent.dataSource&&"result"in t.parent.dataSource?t.contentRenderer.refreshContentRows(e):("paging"===e.requestType||"columnstate"===e.requestType||"reorder"===e.requestType)&&t.parent.groupSettings.enableLazyLoading&&t.parent.groupSettings.columns.length&&(t.parent.enableVirtualization?t.parent.lazyLoadRender:t.parent.contentModule).getGroupCache()[t.parent.pageSettings.currentPage]?t.contentRenderer.refreshContentRows(e):t.refreshDataManager(e)})},i.prototype.resetTemplates=function(){var e=this.parent,r=e.getColumns();if(e.detailTemplate){var i=e.element.id+"detailTemplate";t.blazorTemplates[""+i]=[],t.resetBlazorTemplate(i,"DetailTemplate")}e.groupSettings.captionTemplate&&t.resetBlazorTemplate(e.element.id+"captionTemplate","CaptionTemplate"),e.rowTemplate&&t.resetBlazorTemplate(e.element.id+"rowTemplate","RowTemplate"),e.toolbarTemplate&&t.resetBlazorTemplate(e.element.id+"toolbarTemplate","ToolbarTemplate"),e.pageSettings.template&&t.resetBlazorTemplate(e.element.id+"_template","pageSettings");for(var n=0;n<r.length;n++)r[parseInt(n.toString(),10)].template&&(t.blazorTemplates[e.element.id+r[parseInt(n.toString(),10)].uid]=[],t.resetBlazorTemplate(e.element.id+r[parseInt(n.toString(),10)].uid,"Template")),r[parseInt(n.toString(),10)].headerTemplate&&t.resetBlazorTemplate(e.element.id+r[parseInt(n.toString(),10)].uid+"headerTemplate","HeaderTemplate"),r[parseInt(n.toString(),10)].filterTemplate&&t.resetBlazorTemplate(e.element.id+r[parseInt(n.toString(),10)].uid+"filterTemplate","FilterTemplate");for(var o=0;o<e.aggregates.length;o++)for(var s=0;s<e.aggregates[parseInt(o.toString(),10)].columns.length;s++){if(e.aggregates[parseInt(o.toString(),10)].columns[parseInt(s.toString(),10)].footerTemplate){a=e.element.id+e.aggregates[parseInt(o.toString(),10)].columns[parseInt(s.toString(),10)].guid+"footerTemplate";t.resetBlazorTemplate(a,"FooterTemplate")}if(e.aggregates[parseInt(o.toString(),10)].columns[parseInt(s.toString(),10)].groupFooterTemplate){a=e.element.id+e.aggregates[parseInt(o.toString(),10)].columns[parseInt(s.toString(),10)].guid+"groupFooterTemplate";t.resetBlazorTemplate(a,"GroupFooterTemplate")}if(e.aggregates[parseInt(o.toString(),10)].columns[parseInt(s.toString(),10)].groupCaptionTemplate){var a=e.element.id+e.aggregates[parseInt(o.toString(),10)].columns[parseInt(s.toString(),10)].guid+"groupCaptionTemplate";t.resetBlazorTemplate(a,"GroupCaptionTemplate")}}},i.prototype.refreshComplete=function(e){this.parent.trigger(Nt,e)},i.prototype.refreshDataManager=function(e){var t=this;void 0===e&&(e={});var i=this.parent,n="Shimmer"===i.loadingIndicator.indicatorType&&"virtualscroll"!==e.requestType&&"infiniteScroll"!==e.requestType||("virtualscroll"===e.requestType||"infiniteScroll"===e.requestType)&&i.enableVirtualMaskRow;"virtualscroll"===e.requestType||e.isCaptionCollapse||n||this.parent.showSpinner(),n&&i.showMaskRow("virtualscroll"===e.requestType?e.virtualInfo.sentinelInfo.axis:"infiniteScroll"===e.requestType?e.direction:void 0),this.parent.notify("reset-infinite-blocks",e),this.emptyGrid=!1;var o,s=this.isNeedForeignAction();if(this.ariaService.setBusy(this.parent.getContent().querySelector("."+Yr),!0),s){var a=new r.Deferred;o=this.getFData(a,e)}if(o=o?o.then(function(i){var n=t.data.generateQuery().requiresCount();if(t.emptyGrid){var o=new r.Deferred;return o.resolve({result:[],count:0}),o.promise}return t.data.getData(e,n)}):this.data.getData(e,this.data.generateQuery().requiresCount()),this.parent.getForeignKeyColumns().length&&(!s||this.parent.searchSettings.key.length)){var l=new r.Deferred;o=o.then(function(r){return t.parent.notify("getForeignKeyData",{dataManager:o,result:r,promise:l,action:e}),l.promise})}this.parent.groupSettings.disablePageWiseAggregates&&this.parent.groupSettings.columns.length&&(o=o.then(function(e){return t.validateGroupRecords(e)})),o.then(function(r){return t.dataManagerSuccess(r,e)}).catch(function(r){return t.dataManagerFailure(r,e)})},i.prototype.getFData=function(e,t){return this.parent.notify("getForeignKeyData",{isComplex:!0,promise:e,action:t}),e.promise},i.prototype.isNeedForeignAction=function(){var e=this.parent;return!!(e.allowFiltering&&e.filterSettings.columns.length||e.searchSettings.key.length)&&this.foreignKey(this.parent.getForeignKeyColumns())},i.prototype.foreignKey=function(e){var t=this;return e.some(function(e){return!(!t.parent.filterSettings.columns.some(function(t){return e.uid===t.uid})&&!t.parent.searchSettings.key.length)})},i.prototype.sendBulkRequest=function(e){var t=this;e.requestType="batchsave";var r=this.parent;if(r.allowPaging&&r.pageSettings.pageSizes&&r.pagerModule.pagerObj.isAllPage&&r.pagerModule.pagerObj.checkAll){var i=e.changes.addedRecords.length;i&&r.setProperties({pageSettings:{pageSize:r.pageSettings.pageSize+i}},!0)}var n=this.data.saveChanges(e.changes,this.parent.getPrimaryKeyFieldNames()[0],e.original),o=this.data.generateQuery().requiresCount();if(this.data.dataManager.dataSource.offline)return void this.refreshDataManager({requestType:"batchsave"});n.then(function(r){t.data.getData(e,o).then(function(r){return t.dmSuccess(r,e)}).catch(function(r){return t.dmFailure(r,e)})}).catch(function(r){return t.dmFailure(r,e)})},i.prototype.dmSuccess=function(e,t){this.dataManagerSuccess(e,t)},i.prototype.dmFailure=function(e,t){this.dataManagerFailure(e,t)},i.prototype.renderEmptyRow=function(){this.emptyRow(!0)},i.prototype.emptyRow=function(e){var r=this.parent,i=this.contentRenderer.getTable().querySelector(li);t.isNullOrUndefined(i)||t.remove(i),i=this.parent.createElement(li,{attrs:{role:"rowgroup"}});var n=0;(r.detailTemplate||r.childGrid)&&++n;var o=this.parent.createElement("tr",{className:"e-emptyrow"});o.appendChild(this.parent.createElement("td",{innerHTML:this.l10n.getConstant("EmptyRecord"),attrs:{colspan:(r.getVisibleColumns().length+n+r.groupSettings.columns.length).toString()}})),i.appendChild(o),this.contentRenderer.renderEmpty(i),e&&(this.parent.trigger(qt,{}),this.parent.notify(Zt,{rows:[new Nr({isDataRow:!0,cells:[new qr({isDataCell:!0,visible:!0})]})]}))},i.prototype.dynamicColumnChange=function(){this.parent.getCurrentViewRecords().length&&this.updateColumnType(this.parent.getCurrentViewRecords()[0])},i.prototype.updateColumnType=function(e){for(var r,i=this.parent.getColumns(),n=e&&e.items?e.items[0]:e,o=this.locator.getService("valueFormatter"),s=0,a=i.length;s<a;s++){r=ge(i[parseInt(s.toString(),10)].field||"",n),t.isNullOrUndefined(i[parseInt(s.toString(),10)].customFormat)||(i[parseInt(s.toString(),10)].format=i[parseInt(s.toString(),10)].customFormat),t.isNullOrUndefined(i[parseInt(s.toString(),10)].validationRules)||t.isNullOrUndefined(i[parseInt(s.toString(),10)].validationRules.equalTo)||(i[parseInt(s.toString(),10)].validationRules.equalTo[0]=this.parent.element.id+i[parseInt(s.toString(),10)].validationRules.equalTo[0]),i[parseInt(s.toString(),10)].isForeignColumn()&&i[parseInt(s.toString(),10)].columnData&&(r=ge(i[parseInt(s.toString(),10)].foreignKeyValue||"",i[parseInt(s.toString(),10)].columnData[0])),t.isNullOrUndefined(r)?i[parseInt(s.toString(),10)].type=i[parseInt(s.toString(),10)].type||null:(this.isColTypeDef=!0,i[parseInt(s.toString(),10)].type||(i[parseInt(s.toString(),10)].type=r.getDay?r.getHours()>0||r.getMinutes()>0||r.getSeconds()>0||r.getMilliseconds()>0?"datetime":"date":typeof r));var l=new Mt;i[parseInt(s.toString(),10)].format&&(i[parseInt(s.toString(),10)].format.skeleton||i[parseInt(s.toString(),10)].format.format&&"string"==typeof i[parseInt(s.toString(),10)].format.format)&&(i[parseInt(s.toString(),10)].setFormatter(l.getFormatFunction(t.extend({},i[parseInt(s.toString(),10)].format))),i[parseInt(s.toString(),10)].setParser(l.getParserFunction(i[parseInt(s.toString(),10)].format))),"string"==typeof i[parseInt(s.toString(),10)].format?Z(this.locator,i[parseInt(s.toString(),10)]):i[parseInt(s.toString(),10)].format||"number"!==i[parseInt(s.toString(),10)].type||i[parseInt(s.toString(),10)].setParser(o.getParserFunction({format:"n2"})),"dateonly"!==i[parseInt(s.toString(),10)].type||i[parseInt(s.toString(),10)].format||(i[parseInt(s.toString(),10)].format="yMd",Z(this.locator,i[parseInt(s.toString(),10)]))}},i.prototype.dataManagerSuccess=function(r,i){var n=this,o=this.parent;this.contentRenderer=this.renderer.getRenderer(e.RenderType.Content),this.headerRenderer=this.renderer.getRenderer(e.RenderType.Header),r.actionArgs=i;var s=this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&!o.groupSettings.enableLazyLoading&&("delete"===i.requestType||"save"===i.requestType&&"add"===this.parent.infiniteScrollModule.requestType&&!(o.sortSettings.columns.length||o.filterSettings.columns.length||this.parent.groupSettings.columns.length||o.searchSettings.key));o.trigger("beforeDataBound",r,function(e){if(!e.cancel){e.result=t.isNullOrUndefined(e.result)?[]:e.result;var a=Object.keys(e.result).length;if(!n.parent.isDestroyed){if(!(o.getColumns().length||a||o.columns.length&&o.columns[0]instanceof kt))return void o.hideSpinner();if(n.isInfiniteEnd(i)&&!a)return void n.parent.notify("infinite-edit-handler",{e:i,result:r.result,count:r.count,agg:r.aggregates});if(n.parent.isEdit=!1,n.parent.notify("edit-reset",{}),n.parent.notify("tooltip-destroy",{}),i&&"infiniteScroll"!==i.requestType&&n.parent.notify(Ar,{type:"refreshCommandColumn"}),n.contentRenderer.prevCurrentView=n.parent.currentViewData.slice(),o.currentViewData=e.result,o.notify("refresh-infinite-current-view-data",{args:i,data:e.result}),e.count&&!o.allowPaging&&(o.enableVirtualization||o.enableInfiniteScrolling)&&(o.totalDataRecordsCount=e.count),!a&&e.count&&o.allowPaging&&i&&"delete"!==i.requestType)return!n.parent.groupSettings.enableLazyLoading||"grouping"!==i.requestType&&"ungrouping"!==i.requestType||n.parent.notify("grouping-complete",i),o.prevPageMoving=!0,o.pageSettings.totalRecordsCount=e.count,"paging"!==i.requestType&&(o.pageSettings.currentPage=Math.ceil(e.count/o.pageSettings.pageSize)),void o.dataBind();if((o.getColumns().length||!a)&&n.isLayoutRendered||ue(o)||(o.removeMaskRow(),n.updatesOnInitialRender(e)),!n.isColTypeDef&&o.getCurrentViewRecords()&&(n.data.dataManager.dataSource.offline&&o.dataSource&&o.dataSource.length?n.updateColumnType(o.dataSource[0]):n.updateColumnType(o.getCurrentViewRecords()[0])),n.parent.isInitialLoad||!n.parent.groupSettings.disablePageWiseAggregates||n.parent.groupSettings.columns.length||(e.result=n.parent.dataSource instanceof Array?n.parent.dataSource:n.parent.currentViewData),!n.parent.isReact&&!n.parent.isVue||t.isNullOrUndefined(i)||"infiniteScroll"===i.requestType||i.isFrozen||nt(n.parent,["footerTemplate"]),n.parent.isAngular&&n.parent.allowGrouping&&n.parent.groupSettings.captionTemplate&&(t.isNullOrUndefined(i)||"infiniteScroll"!==i.requestType)&&n.parent.destroyTemplate(["groupSettings_captionTemplate"]),n.parent.notify(Xt,t.extend({count:e.count,result:e.result,aggregates:e.aggregates},i)),(o.groupSettings.columns.length||i&&"ungrouping"===i.requestType)&&i&&"filtering"!==i.requestType&&n.headerRenderer.refreshUI(),a){if(ue(o)){i.scrollTop={top:n.contentRenderer.content.scrollTop}}s?n.parent.notify("infinite-edit-handler",{e:i,result:r.result,count:r.count,agg:r.aggregates}):n.parent.enableImmutableMode?n.contentRenderer.immutableModeRendering(i):n.contentRenderer.refreshContentRows(i)}else{if(i&&i.isCaptionCollapse)return;if(!o.getColumns().length)return o.element.innerHTML="",void alert(n.l10n.getConstant("EmptyDataSourceError"));if(n.contentRenderer.setRowElements([]),n.contentRenderer.setRowObjects([]),n.ariaService.setBusy(n.parent.getContent().querySelector("."+Yr),!1),o.removeMaskRow(),n.renderEmptyRow(),o.enableColumnVirtualization&&!a&&n.parent.notify(Yt,{rows:o.getRowsObject(),args:{}}),i){var l=(i.requestType||"").toLowerCase()+"-complete";n.parent.notify(l,i),"batchsave"===i.requestType&&(i.cancel=!1,i.rows=[],i.isFrozen=0!==n.parent.getFrozenColumns()&&!i.isFrozen,n.parent.trigger(Nt,i))}n.parent.autoFit&&n.parent.preventAdjustColumns(),n.parent.hideSpinner()}n.parent.notify("toolbar-refresh",{}),n.setRowCount(n.parent.getCurrentViewRecords().length),"query"in r&&(n.parent.getDataModule().isQueryInvokedFromData=!1)}}})},i.prototype.dataManagerFailure=function(e,t){this.ariaService.setOptions(this.parent.getContent().querySelector("."+Yr),{busy:!1,invalid:!0}),this.setRowCount(1),this.parent.trigger("actionFailure",{error:e}),this.parent.hideSpinner(),this.parent.removeMaskRow(),"save"!==t.requestType&&"delete"!==t.requestType&&"bulk-save"!==t.name&&(this.parent.currentViewData=[],this.renderEmptyRow(),this.parent.isInitialLoad||this.parent.focusModule.setFirstFocusableTabIndex(),this.parent.log("actionfailure",{error:e}))},i.prototype.setRowCount=function(e){this.ariaService.setOptions(this.parent.getHeaderTable(),{rowcount:e?e.toString():"1"})},i.prototype.isInfiniteEnd=function(e){return this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&"delete"===e.requestType},i.prototype.updatesOnInitialRender=function(e){this.isLayoutRendered=!0,this.parent.columns.length<1&&this.buildColumns(e.result[0]),E(this.parent.columns,null,this.parent),this.headerRenderer.renderTable(),this.contentRenderer.renderTable(),this.parent.isAutoGen=!0,this.parent.notify(yr,{})},i.prototype.iterateComplexColumns=function(e,t,r){for(var i=Object.keys(e),n=0;n<i.length;n++)("object"!=typeof e[i[parseInt(n.toString(),10)]]||!e[i[parseInt(n.toString(),10)]]||e[i[parseInt(n.toString(),10)]]instanceof Date?[]:Object.keys(e[i[parseInt(n.toString(),10)]])).length?this.iterateComplexColumns(e[i[parseInt(n.toString(),10)]],t+(i[parseInt(n.toString(),10)]+"."),r):(r[this.counter]=t+i[parseInt(n.toString(),10)],this.counter++)},i.prototype.buildColumns=function(e){var r=[],i={};this.iterateComplexColumns(e,"",i);for(var n=Object.keys(i).filter(function(e){return"BlazId"!==i[""+e]}).map(function(e){return i[""+e]}),o=0,s=n.length;o<s;o++)r[parseInt(o.toString(),10)]={field:n[parseInt(o.toString(),10)]},this.parent.enableColumnVirtualization&&(r[parseInt(o.toString(),10)].width=t.isNullOrUndefined(r[parseInt(o.toString(),10)].width)?200:r[parseInt(o.toString(),10)].width);this.parent.setProperties({columns:r},!0)},i.prototype.instantiateRenderer=function(){this.renderer.addRenderer(e.RenderType.Header,new Ri(this.parent,this.locator)),this.renderer.addRenderer(e.RenderType.Content,new Ii(this.parent,this.locator));var t=this.locator.getService("cellRendererFactory");t.addCellRenderer(e.CellType.Header,new zi(this.parent,this.locator)),t.addCellRenderer(e.CellType.Data,new xi(this.parent,this.locator)),t.addCellRenderer(e.CellType.StackedHeader,new Di(this.parent,this.locator)),t.addCellRenderer(e.CellType.Indent,new ki(this.parent,this.locator)),t.addCellRenderer(e.CellType.GroupCaption,new Li(this.parent,this.locator)),t.addCellRenderer(e.CellType.GroupCaptionEmpty,new Pi(this.parent,this.locator)),t.addCellRenderer(e.CellType.Expand,new Ni(this.parent,this.locator)),t.addCellRenderer(e.CellType.HeaderIndent,new Hi(this.parent,this.locator)),t.addCellRenderer(e.CellType.StackedHeader,new Di(this.parent,this.locator)),t.addCellRenderer(e.CellType.DetailHeader,new ji(this.parent,this.locator)),t.addCellRenderer(e.CellType.RowDragHIcon,new Qi(this.parent,this.locator)),t.addCellRenderer(e.CellType.DetailExpand,new Gi(this.parent,this.locator)),t.addCellRenderer(e.CellType.DetailFooterIntent,new ki(this.parent,this.locator)),t.addCellRenderer(e.CellType.RowDragIcon,new Wi(this.parent,this.locator))},i.prototype.addEventListener=function(){var e=this;this.parent.isDestroyed||(this.parent.on(Kt,this.instantiateRenderer,this),this.parent.on("refreshdataSource",this.dataManagerSuccess,this),this.parent.on(er,this.refresh,this),this.parent.on("refresh-complete",this.refreshComplete,this),this.parent.on("bulk-save",this.sendBulkRequest,this),this.parent.on("showEmptyGrid",function(){e.emptyGrid=!0},this),this.parent.on(yr,this.dynamicColumnChange,this))},i.prototype.validateGroupRecords=function(e){var t=this,i=e.result.length-1;if(i<0)return Promise.resolve(e);var n=e.result[0],o=e.result[parseInt(i.toString(),10)],s=[],a=function(e){for(var i=[n,o],a=0;a<i.length;a++)s.push(new r.Predicate("field","==",i[parseInt(a.toString(),10)].field).and(t.getPredicate("key","equal",i[parseInt(a.toString(),10)].key)));e.where(r.Predicate.or(s))},l=new r.Query;a(l);var h=new r.DataManager(e.result).executeLocal(l),p=this.data.generateQuery(!0),d=[];if(this.data.isRemote()){for(var c=[n,o],u=0;u<c.length;u++)d.push(this.getPredicate(c[parseInt(u.toString(),10)].field,"equal",c[parseInt(u.toString(),10)].key));p.where(r.Predicate.or(d))}else a(p);var g=new r.Deferred;return this.data.getData({},p).then(function(r){t.updateGroupInfo(h,r.result),g.resolve(e)}).catch(function(e){return g.reject(e)}),g.promise},i.prototype.getPredicate=function(e,t,i){return i instanceof Date?de({field:e,operator:t,value:i}):new r.Predicate(e,t,i)},i.prototype.updateGroupInfo=function(e,i){for(var n=new r.DataManager(i),o=e,s=0;s<o.length;s++){var a=n.executeLocal((new r.Query).where(new r.Predicate("field","==",o[parseInt(s.toString(),10)].field).and(this.getPredicate("key","equal",o[parseInt(s.toString(),10)].key))))[0];o[parseInt(s.toString(),10)].count=a.count;var l=o[parseInt(s.toString(),10)].items,h=a.items;l.GroupGuid&&(o[parseInt(s.toString(),10)].items=this.updateGroupInfo(o[parseInt(s.toString(),10)].items,a.items));for(var p=this.parent.aggregates,d=0;d<p.length;d++)for(var c=p[parseInt(d.toString(),10)],u=0;u<c.columns.length;u++)for(var g=c.columns[parseInt(u.toString(),10)].type instanceof Array?c.columns[parseInt(u.toString(),10)].type:[c.columns[parseInt(u.toString(),10)].type],f=0;f<g.length;f++){var m=c.columns[parseInt(u.toString(),10)].field+" - "+g[parseInt(f.toString(),10)].toLowerCase(),y=l.level?h.records:a.items,v=this.parent;if("Custom"===g[parseInt(f.toString(),10)]){var C=l.level?h:a,S=c.columns[parseInt(u.toString(),10)].customAggregate;"string"==typeof S&&(S=t.getValue(S,window)),o[parseInt(s.toString(),10)].aggregates[""+m]=S?S.call(v,C,c.columns[parseInt(u.toString(),10)]):""}else o[parseInt(s.toString(),10)].aggregates[""+m]=r.DataUtil.aggregates[g[parseInt(f.toString(),10)].toLowerCase()](y,c.columns[parseInt(u.toString(),10)].field)}}return e},i}(),Yi=function(){function r(){this.cellRenderMap={}}return r.prototype.addCellRenderer=function(r,i){r="string"==typeof r?r:t.getEnumValue(e.CellType,r),t.isNullOrUndefined(this.cellRenderMap[""+r])&&(this.cellRenderMap[""+r]=i)},r.prototype.getCellRenderer=function(r){if(r="string"==typeof r?r:t.getEnumValue(e.CellType,r),t.isNullOrUndefined(this.cellRenderMap[""+r]))throw"The cellRenderer "+r+" is not found";return this.cellRenderMap[""+r]},r}(),Ji=function(){function r(e,t){this.sortedCols=[],this.sortPredicate=[],this.isCustomDialog=!1,this.parent=e,this.serviceLocator=t,this.addEventListener()}return r.prototype.addEventListener=function(){this.evtHandlers=[{event:"filter-dialog-close",handler:this.closeCustomDialog},{event:"refresh-cutsom-filter-ok-button",handler:this.refreshCustomFilterOkBtn},{event:"render-responsive-cmenu",handler:this.renderResponsiveContextMenu},{event:"filter-cmenu-select",handler:this.renderCustomFilterDiv},{event:"custom-filter-close",handler:this.customExFilterClose},{event:"refresh-cutsom-filter-clear-button",handler:this.refreshCustomFilterClearBtn}],Ze(this.parent,this.evtHandlers,!0,this),this.onActionCompleteFn=this.editComplate.bind(this),this.parent.addEventListener(Nt,this.onActionCompleteFn)},r.prototype.customExFilterClose=function(){this.isCustomDlgRender=!1},r.prototype.renderCustomFilterDiv=function(){var e=this.customResponsiveDlg.element.querySelector(".e-dlg-header-content"),t=e.querySelector(".e-dlg-custom-header"),r=e.querySelector(".e-dlg-closeicon-btn");this.isCustomDlgRender=!0,this.parent.filterModule.filterModule.closeDialog(),this.saveBtn.element.style.display="",this.refreshCustomFilterOkBtn({disabled:!1}),this.backBtn.element.style.display="none",r.style.display="",t.innerHTML=this.parent.localeObj.getConstant("CustomFilter");var i=this.customResponsiveDlg.element.querySelector(".e-dlg-content");this.customExcelFilterParent=this.parent.createElement("div",{className:"e-xl-customfilterdiv e-default-filter"}),i.appendChild(this.customExcelFilterParent)},r.prototype.renderResponsiveContextMenu=function(r){if(this.action===e.ResponsiveDialogAction.isFilter){var i=this.customResponsiveDlg.element.querySelector(".e-dlg-content"),o=this.customResponsiveDlg.element.querySelector(".e-dlg-header-content"),s=o.querySelector(".e-dlg-closeicon-btn"),a=o.querySelector(".e-dlg-custom-header");if(r.isOpen){i.firstChild.style.display="none",i.appendChild(r.target),s.style.display="none",this.saveBtn.element.style.display="none",this.filterClearBtn.element.style.display="none",a.innerHTML=r.header;var l=this.parent.createElement("button"),h=this.parent.createElement("span",{className:"e-btn-icon e-resfilterback e-icons"});l.appendChild(h),this.backBtn=new n.Button({cssClass:this.parent.cssClass?"e-res-back-btn "+this.parent.cssClass:"e-res-back-btn"}),this.backBtn.appendTo(l),a.parentElement.insertBefore(l,a)}else this.backBtn&&!this.isCustomDlgRender&&(i.firstChild.style.display="",t.remove(this.backBtn.element),s.style.display="",this.saveBtn.element.style.display="",this.isFiltered&&(this.filterClearBtn.element.style.display=""),a.innerHTML=this.getHeaderTitle({action:e.ResponsiveDialogAction.isFilter},r.col))}},r.prototype.refreshCustomFilterClearBtn=function(e){this.filterClearBtn&&(this.isFiltered=e.isFiltered,this.filterClearBtn.element.style.display=e.isFiltered?"":"none")},r.prototype.refreshCustomFilterOkBtn=function(e){this.saveBtn&&(this.saveBtn.disabled=e.disabled)},r.prototype.renderResponsiveContent=function(r){var i=this,o=this.parent;if(r)return this.filterParent=this.parent.createElement("div",{className:"e-mainfilterdiv e-default-filter",id:r.uid+"-main-filter"}),this.filterParent;var s=o.getColumns();this.customColumnDiv=o.createElement("div",{className:"columndiv",styles:"width: 100%"});var a=o.createElement("div",{className:"e-ressortbutton-parent"}),l=[],h=this.action===e.ResponsiveDialogAction.isSort,p=this.action===e.ResponsiveDialogAction.isFilter;if(p)for(d=0;d<o.filterSettings.columns.length;d++)l.push(o.filterSettings.columns[parseInt(d.toString(),10)].field);for(var d=0;d<s.length;d++)if(!(!s[parseInt(d.toString(),10)].visible||!s[parseInt(d.toString(),10)].allowSorting&&h||!s[parseInt(d.toString(),10)].allowFiltering&&p)){var c=o.createElement("div",{className:"e-responsivecoldiv"});c.setAttribute("data-e-mappingname",s[parseInt(d.toString(),10)].field),c.setAttribute("data-e-mappinguid",s[parseInt(d.toString(),10)].uid);var u=o.createElement("span",{innerHTML:s[parseInt(d.toString(),10)].headerText,className:"e-res-header-text"});if(c.appendChild(u),this.customColumnDiv.appendChild(c),h){var g=this.getSortedFieldsAndDirections("field").indexOf(s[parseInt(d.toString(),10)].field),f=o.createElement("button",{id:o.element.id+s[parseInt(d.toString(),10)].field+"sortbutton"}),m=a.cloneNode();m.appendChild(f),c.appendChild(m),new n.Button({cssClass:this.parent.cssClass?"e-ressortbutton "+this.parent.cssClass:"e-ressortbutton"}).appendTo(f);var y=void 0;t.isNullOrUndefined(this.parent.sortSettings.columns[parseInt(g.toString(),10)])||(y="Ascending"===this.parent.sortSettings.columns[parseInt(g.toString(),10)].direction?this.parent.localeObj.getConstant("AscendingText"):this.parent.localeObj.getConstant("DescendingText")),f.innerHTML=g>-1?y:this.parent.localeObj.getConstant("NoneText"),f.onclick=function(e){i.sortButtonClickHandler(e.target)}}if(p&&l.indexOf(s[parseInt(d.toString(),10)].field)>-1){var v=o.createElement("div",{className:"e-icons e-res-icon e-filtersetdiv"}),C=o.createElement("span",{className:"e-icons e-res-icon e-filterset"});C.setAttribute("colType",s[parseInt(d.toString(),10)].type),v.appendChild(C),c.appendChild(v)}}return t.EventHandler.add(this.customColumnDiv,"click",this.customFilterColumnClickHandler,this),this.customColumnDiv},r.prototype.getSortedFieldsAndDirections=function(e){for(var t=[],r=0;r<this.parent.sortSettings.columns.length;r++)t.push(this.parent.sortSettings.columns[parseInt(r.toString(),10)][""+e]);return t},r.prototype.sortButtonClickHandler=function(e){if(e){var t=O(e,"e-responsivecoldiv").getAttribute("data-e-mappingname");this.parent.allowMultiSorting||(this.sortPredicate=[],this.sortedCols=[],this.isSortApplied=!1,this.resetSortButtons(e));var r=e.textContent,i=r===this.parent.localeObj.getConstant("NoneText")?this.parent.localeObj.getConstant("AscendingText"):r===this.parent.localeObj.getConstant("AscendingText")?this.parent.localeObj.getConstant("DescendingText"):this.parent.localeObj.getConstant("NoneText"),n=i===this.parent.localeObj.getConstant("AscendingText")?"Ascending":i===this.parent.localeObj.getConstant("DescendingText")?"Descending":"None";e.innerHTML=i,this.setSortedCols(t,n)}},r.prototype.resetSortButtons=function(e){for(var t=[].slice.call(this.customColumnDiv.getElementsByClassName("e-ressortbutton")),r=0;r<t.length;r++)t[parseInt(r.toString(),10)]!==e&&(t[parseInt(r.toString(),10)].innerHTML="None")},r.prototype.setSortedCols=function(e,t){var r=this.getCurrentSortedFields().indexOf(e);this.parent.allowMultiSorting&&r>-1&&(this.sortedCols.splice(r,1),this.sortPredicate.splice(r,1)),this.isSortApplied=!0,"None"!==t&&(this.sortedCols.push(e),this.sortPredicate.push({field:e,direction:t}))},r.prototype.getCurrentSortedFields=function(){for(var e=[],t=0;t<this.sortedCols.length;t++)e.push(this.sortedCols[parseInt(t.toString(),10)]);return e},r.prototype.customFilterColumnClickHandler=function(t){if(this.action===e.ResponsiveDialogAction.isFilter){var r=this.parent,i=t.target;if("FilterBar"!==r.filterSettings.type)if(i.classList.contains("e-responsivecoldiv")||i.parentElement.classList.contains("e-responsivecoldiv")){if((s=i.getAttribute("data-e-mappingname"))||(s=i.parentElement.getAttribute("data-e-mappingname")),s){var n=r.getColumnByField(s);this.isRowResponsive=!0,this.showResponsiveDialog(n)}}else if(i.classList.contains("e-filterset")||i.parentElement.classList.contains("e-filtersetdiv")){var o=O(i,"e-responsivecoldiv");if(o){var s=o.getAttribute("data-e-mappingname");("Menu"===(n=r.getColumnByField(s)).filter.type||!n.filter.type&&"Menu"===r.filterSettings.type)&&(this.isDialogClose=!0),this.parent.filterModule.filterModule.clearCustomFilter(n),this.removeCustomDlgFilterEle(i)}}}},r.prototype.showResponsiveDialog=function(t){if(this.isCustomDialog&&this.action===e.ResponsiveDialogAction.isFilter&&!this.isRowResponsive)this.renderCustomFilterDialog();else{if(this.filteredCol=t,this.renderResponsiveDialog(t),this.parent.enableAdaptiveUI&&t&&(this.parent.filterModule.setFilterModel(t),this.parent.filterModule.filterModule.openDialog(this.parent.filterModule.createOptions(t,void 0))),this.action===e.ResponsiveDialogAction.isSort){var r={cancel:!1,dialogObj:this.customResponsiveDlg,requestType:"beforeOpenAptiveSortDialog"};if(this.parent.trigger("beforeOpenAdaptiveDialog",r),r.cancel)return}this.customResponsiveDlg.show(!0),this.customResponsiveDlg.element.style.maxHeight="100%",this.setTopToChildDialog(this.customResponsiveDlg.element)}},r.prototype.setTopToChildDialog=function(e){var t=e.querySelector(".e-dialog");if(t){var r=e.querySelector(".e-dlg-header-content").getBoundingClientRect().height;t.style.top=r+"px"}},r.prototype.renderCustomFilterDialog=function(t){var r=this.parent;if(this.action!==e.ResponsiveDialogAction.isFilter||"FilterBar"!==r.filterSettings.type){var i=this.parent.createElement("div",{id:r.element.id+"customfilter",className:this.parent.cssClass?"e-customfilterdiv e-responsive-dialog "+this.parent.cssClass:"e-customfilterdiv e-responsive-dialog"});this.parent.element.appendChild(i),this.customFilterDlg=this.getDialogOptions(t,!0);var n={cancel:!1,dialogObj:this.customFilterDlg,requestType:"beforeOpenAptiveFilterDialog"};this.parent.trigger("beforeOpenAdaptiveDialog",n),n.cancel||(this.customFilterDlg.appendTo(i),this.customFilterDlg.show(!0),this.customFilterDlg.element.style.maxHeight="100%")}},r.prototype.getDialogOptions=function(t,r,n){var o=new i.Dialog({isModal:!0,showCloseIcon:!0,closeOnEscape:!1,locale:this.parent.locale,target:this.parent.adaptiveDlgTarget?this.parent.adaptiveDlgTarget:document.body,visible:!1,enableRtl:this.parent.enableRtl,content:this.renderResponsiveContent(t),open:this.dialogOpen.bind(this),created:this.dialogCreated.bind(this),close:this.beforeDialogClose.bind(this),width:"100%",height:"100%",animationSettings:{effect:"None"},cssClass:this.parent.cssClass?this.parent.cssClass:""});return o.isStringTemplate=!0,r?(o.header=this.renderResponsiveHeader(t,void 0,!0),o.cssClass="e-customfilter"):(o.header=this.renderResponsiveHeader(t),o.cssClass="Vertical"===this.parent.rowRenderingMode&&this.action===e.ResponsiveDialogAction.isFilter?"e-res"+n+" e-row-responsive-filter":"e-res"+n),o},r.prototype.renderResponsiveDialog=function(t){var r=this.parent;if(this.action!==e.ResponsiveDialogAction.isFilter||"FilterBar"!==r.filterSettings.type){var i=this.action===e.ResponsiveDialogAction.isFilter?"filter":"sort",n=this.parent.createElement("div",{id:r.element.id+"responsive"+i,className:this.parent.cssClass?"e-res"+i+"div e-responsive-dialog "+this.parent.cssClass:"e-res"+i+"div e-responsive-dialog"});this.parent.element.appendChild(n),this.customResponsiveDlg=this.getDialogOptions(t,!1,i),this.customResponsiveDlg.appendTo(n)}},r.prototype.dialogCreated=function(){Xe(this.parent)},r.prototype.dialogOpen=function(){if(this.action===e.ResponsiveDialogAction.isSort&&this.parent.allowMultiSorting)for(var t=0;t<this.parent.sortSettings.columns.length;t++){this.sortedCols.push(this.parent.sortSettings.columns[parseInt(t.toString(),10)].field);var r=this.parent.sortSettings.columns[parseInt(t.toString(),10)].field,i=this.parent.sortSettings.columns[parseInt(t.toString(),10)].direction;this.sortPredicate.push({field:r,direction:i})}},r.prototype.beforeDialogClose=function(t){this.isDialogClose=t.element&&!t.element.querySelector(".e-xl-customfilterdiv")&&t.element.classList.contains("e-resfilterdiv"),this.action===e.ResponsiveDialogAction.isFilter?t.element.classList.contains("e-resfilterdiv")?this.parent.filterModule.filterModule.closeResponsiveDialog(this.isCustomDlgRender):t.element.classList.contains("e-customfilterdiv")&&this.closeCustomFilter():this.action===e.ResponsiveDialogAction.isSort&&this.closeCustomDialog(),this.parent.off("enter-key-handler",this.keyHandler)},r.prototype.sortColumn=function(){if(!this.isSortApplied)return void this.closeCustomDialog();this.sortPredicate.length&&this.parent.setProperties({sortSettings:{columns:[]}},!0);for(var e=0;e<this.sortPredicate.length;e++)this.parent.sortColumn(this.sortPredicate[parseInt(e.toString(),10)].field,this.sortPredicate[parseInt(e.toString(),10)].direction,this.parent.allowMultiSorting);this.sortPredicate.length||this.parent.clearSorting(),this.closeCustomDialog()},r.prototype.getHeaderTitle=function(t,r){var i,n=this.parent;return this.action===e.ResponsiveDialogAction.isEdit?i=n.localeObj.getConstant("EditFormTitle")+t.primaryKeyValue[0]:this.action===e.ResponsiveDialogAction.isAdd?i=n.localeObj.getConstant("AddFormTitle"):this.action===e.ResponsiveDialogAction.isFilter?i=r?r.headerText||r.field:n.localeObj.getConstant("FilterButton"):this.action===e.ResponsiveDialogAction.isSort&&(i=n.localeObj.getConstant("Sort")),i},r.prototype.getDialogName=function(t){var r;return t===e.ResponsiveDialogAction.isAdd||t===e.ResponsiveDialogAction.isEdit?r="dialogEdit_wrapper_title":t===e.ResponsiveDialogAction.isFilter&&(r="responsive_filter_dialog_wrapper"),r},r.prototype.getButtonText=function(t){var r;return t===e.ResponsiveDialogAction.isAdd||t===e.ResponsiveDialogAction.isEdit?r="Save":t!==e.ResponsiveDialogAction.isFilter&&this.action!==e.ResponsiveDialogAction.isSort||(r="OKButton"),r},r.prototype.renderResponsiveHeader=function(t,r,i){var o=this,s=this.parent;s.on("enter-key-handler",this.keyHandler,this);var a=s.element.id+this.getDialogName(this.action),l=s.createElement("div",{className:"e-res-custom-element"}),h=s.createElement("div",{className:"e-dlg-custom-header",id:a});h.innerHTML=this.getHeaderTitle(r,t),l.appendChild(h);var p=s.createElement("button");i||(this.saveBtn=new n.Button({cssClass:this.parent.cssClass?"e-primary e-flat e-res-apply-btn "+this.parent.cssClass:"e-primary e-flat e-res-apply-btn"}),p.innerHTML=s.localeObj.getConstant(this.getButtonText(this.action)),this.saveBtn.appendTo(p),p.onclick=function(e){o.dialogHdrBtnClickHandler()});var d=this.action===e.ResponsiveDialogAction.isSort,c=this.action===e.ResponsiveDialogAction.isFilter;if(c||d){var u=d?"sort":"filter",g=s.createElement("button");if(this.filterClearBtn=new n.Button({cssClass:this.parent.cssClass?"e-primary e-flat e-res-"+u+"-clear-btn "+this.parent.cssClass:"e-primary e-flat e-res-"+u+"-clear-btn"}),c){var f=s.createElement("span",{className:"e-btn-icon e-icon-filter-clear e-icons"});g.appendChild(f)}else g.innerHTML=s.localeObj.getConstant("Clear");l.appendChild(g),this.filterClearBtn.appendTo(g),g.onclick=function(e){O(e.target,"e-customfilter")?(o.parent.filterModule.clearFiltering(),o.removeCustomDlgFilterEle()):c?o.filterClear():(o.resetSortButtons(),o.sortedCols=[],o.sortPredicate=[],o.isSortApplied=!0)},l.appendChild(g)}return i||l.appendChild(p),l},r.prototype.filterClear=function(){this.parent.filterModule.filterModule.clearCustomFilter(this.filteredCol),this.parent.filterModule.filterModule.closeResponsiveDialog()},r.prototype.dialogHdrBtnClickHandler=function(){this.action===e.ResponsiveDialogAction.isEdit||this.action===e.ResponsiveDialogAction.isAdd?this.parent.endEdit():this.action===e.ResponsiveDialogAction.isFilter?this.parent.filterModule.filterModule.applyCustomFilter({col:this.filteredCol,isCustomFilter:this.isCustomDlgRender}):this.action===e.ResponsiveDialogAction.isSort&&this.sortColumn()},r.prototype.closeCustomDialog=function(){if(this.isCustomDlgRender){var e=this.customResponsiveDlg.element.querySelector(".e-mainfilterdiv");return void t.remove(e)}this.isRowResponsive=!1,this.isCustomDlgRender=!1,this.destroyCustomFilterDialog()},r.prototype.destroyCustomFilterDialog=function(){if(this.customResponsiveDlg){var r=document.getElementById(this.customResponsiveDlg.element.id);this.customResponsiveDlg&&!this.customResponsiveDlg.isDestroyed&&r&&(this.customResponsiveDlg.destroy(),t.remove(r)),this.closeCustomFilter(),this.action===e.ResponsiveDialogAction.isSort&&(this.sortPredicate=[],this.sortedCols=[],this.isSortApplied=!1)}},r.prototype.closeCustomFilter=function(){if(!this.isDialogClose&&this.customFilterDlg){var e=document.getElementById(this.customFilterDlg.element.id);this.customFilterDlg&&!this.customFilterDlg.isDestroyed&&e&&(this.customFilterDlg.destroy(),t.remove(e))}this.isCustomDialog=!1,this.isDialogClose=!1},r.prototype.removeCustomDlgFilterEle=function(e){if(e)e.parentElement.classList.contains("e-filtersetdiv")?t.remove(e.parentElement):t.remove(e);else for(var r=this.customColumnDiv.children,i=0;i<r.length;i++)(e=r[parseInt(i.toString(),10)].querySelector(".e-filtersetdiv"))&&(t.remove(e),i--)},r.prototype.keyHandler=function(t){13===t.keyCode&&(this.action===e.ResponsiveDialogAction.isFilter&&t.target.classList.contains("e-searchinput")||this.action===e.ResponsiveDialogAction.isEdit||this.action===e.ResponsiveDialogAction.isAdd)&&this.dialogHdrBtnClickHandler()},r.prototype.editComplate=function(e){"save"!==e.requestType&&"cancel"!==e.requestType||this.parent.off("enter-key-handler",this.keyHandler)},r.prototype.removeEventListener=function(){this.customColumnDiv&&t.EventHandler.remove(this.customColumnDiv,"click",this.customFilterColumnClickHandler),Ze(this.parent,this.evtHandlers,!0,this),this.parent.removeEventListener(Nt,this.onActionCompleteFn)},r}(),Zi=function(){function e(){this.services={}}return e.prototype.register=function(e,r){t.isNullOrUndefined(this.services[""+e])&&(this.services[""+e]=r)},e.prototype.getService=function(e){if(t.isNullOrUndefined(this.services[""+e]))throw"The service "+e+" is not registered";return this.services[""+e]},e.prototype.registerAdaptiveService=function(e,t,r){t?(e.responsiveDialogRenderer=new Ji(e.parent,e.serviceLocator),e.responsiveDialogRenderer.action=r):e.responsiveDialogRenderer&&(e.responsiveDialogRenderer.removeEventListener(),e.responsiveDialogRenderer=void 0)},e}(),$i=function(){function r(){this.rendererMap={}}return r.prototype.addRenderer=function(r,i){var n=t.getEnumValue(e.RenderType,r);t.isNullOrUndefined(this.rendererMap[""+n])&&(this.rendererMap[""+n]=i)},r.prototype.getRenderer=function(r){var i=t.getEnumValue(e.RenderType,r);if(t.isNullOrUndefined(this.rendererMap[""+i]))throw"The renderer "+i+" is not found";return this.rendererMap[""+i]},r}(),en=function(){function e(e){this.parent=e}return e.prototype.setWidthToColumns=function(){var e=0,t=this.parent.getColumnIndexesInView(),r=!0,i=0;if(this.parent.allowGrouping)for(var n=this.parent.groupSettings.columns.length;e<n;e++)this.parent.enableColumnVirtualization&&-1===t.indexOf(e)?r=!1:this.setColumnWidth(new kt({width:"30px"}),e);(this.parent.detailTemplate||this.parent.childGrid)&&(this.setColumnWidth(new kt({width:"30px"}),e),e++),this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()&&(this.setColumnWidth(new kt({width:"30px"}),e),e++);for(var o=this.parent.getColumns(),s=0;s<o.length;s++)this.setColumnWidth(o[parseInt(s.toString(),10)],r&&this.parent.enableColumnVirtualization?void 0:s+e);this.parent.isRowDragable()&&"Right"===this.parent.getFrozenMode()&&this.setColumnWidth(new kt({width:"30px"}),o.length),i=this.getTableWidth(this.parent.getColumns()),"auto"!==this.parent.width&&-1===this.parent.width.toString().indexOf("%")&&this.setMinwidthBycalculation(i)},e.prototype.setMinwidthBycalculation=function(e){var r=0,i=this.parent.getColumns().filter(function(e){return t.isNullOrUndefined(e.width)||"auto"===e.width});if(i.length){r=t.isNullOrUndefined(this.parent.width)||"auto"===this.parent.width||"string"!=typeof this.parent.width||-1!==this.parent.width.indexOf("%")?this.parent.element.getBoundingClientRect().width-e:("string"==typeof this.parent.width?parseInt(this.parent.width,10):this.parent.width)-e;for(var n=0,o=0,s=i;o<s.length;o++){var a=s[o];n+=t.isNullOrUndefined(a.minWidth)?0:"string"==typeof a.minWidth?parseInt(a.minWidth,10):a.minWidth}for(var l=0;l<i.length;l++){0===e&&this.parent.allowResizing&&this.isWidthUndefined()&&l!==i.length-1&&this.setUndefinedColumnWidth(i);var h=this.parent.getColumnIndexByField(i[parseInt(l.toString(),10)].field)+this.parent.getIndentCount();0!==e&&r<n?this.setWidth(i[parseInt(l.toString(),10)].minWidth,h):0!==e&&r>n&&this.setWidth("",h,!0)}}},e.prototype.setUndefinedColumnWidth=function(e){for(var t=0;t<e.length;t++)t!==e.length-1&&(e[parseInt(t.toString(),10)].width=200,this.setWidth(200,this.parent.getColumnIndexByField(e[parseInt(t.toString(),10)].field)))},e.prototype.setColumnWidth=function(e,r,i){if(!(this.parent.getColumns().length<1)){var n=t.isNullOrUndefined(r)?this.parent.getNormalizedColumnIndex(e.uid):r,o=this.getWidth(e),s=this.getTableWidth(this.parent.getColumns());null!==o&&(this.setWidth(o,n),"auto"!==this.parent.width&&-1===this.parent.width.toString().indexOf("%")&&this.setMinwidthBycalculation(s),(this.parent.allowResizing&&"resize"===i||this.parent.getFrozenColumns()&&this.parent.allowResizing)&&this.setWidthToTable(),this.parent.notify("column-width-changed",{index:n,width:o,column:e,module:i}))}},e.prototype.setWidth=function(e,r,i){this.parent.groupSettings.columns.length>r&&Oe(this.parent)&&(e=(30/this.parent.element.offsetWidth*100).toFixed(1)+"%");var n,o=this.parent.getHeaderTable(),s=this.parent.getContentTable(),a=t.formatUnit(e),l=this.parent.getFrozenColumns(),h=this.parent.isRowDragable();l=l&&h?l+1:l;var p=this.parent.getHeaderContent().querySelector("."+Kr),d=this.parent.getContent().querySelector("."+Wr),c=this.parent.getFrozenLeftColumnsCount(),u=this.parent.getFrozenRightColumnsCount(),g=this.parent.getMovableColumnsCount(),f=0!==c||0!==u;if(l&&r>=l){if(!p||!p.querySelector(hi))return;n=p.querySelector("colgroup:not(.e-masked-colgroup)").children[r-l]}else if(this.parent.enableColumnVirtualization&&l&&this.parent.contentModule.isXaxis()&&p.scrollLeft>0)n=(v=p.querySelector(hi)).children[v.children.length-1-r];else if(f){C=void 0;if(c&&!u)C=(r=h?r-1:r)<c?o:p;else if(!c&&u)C=r>=g?o:p;else if(c&&u){r=h?r-1:r;var m=this.parent.getFrozenRightHeader();C=r<c?o:r<c+g?p:m}if(!(n=this.getColumnLevelFrozenColgroup(r,c,g,C)))return}else n=o.querySelector(hi).children[parseInt(r.toString(),10)];n&&!i?n.style.width=a:n&&i&&(n.style.width="");var y;if(l&&r>=l)y=this.parent.getContent().querySelector("."+Wr).querySelector("colgroup:not(.e-masked-colgroup)").children[r-l];else if(this.parent.enableColumnVirtualization&&l&&this.parent.contentModule.isXaxis()&&d.scrollLeft>0){var v=this.parent.getContent().querySelector("."+Wr).querySelector(hi);y=v.children[v.children.length-1-r]}else if(f){var C=void 0;if(c&&!u&&(C=r<c?s:d),!c&&u&&(C=r>=g?s:d),c&&u){var S=this.parent.getContent().querySelector(".e-frozen-right-content");C=r<c?s:r<c+g?d:S}y=this.getColumnLevelFrozenColgroup(r,c,g,C)}else y=s.querySelector(hi).children[parseInt(r.toString(),10)];if(y&&!i?(y.style.width!==n.style.width&&this.parent.isFrozenGrid()&&this.parent.reorderModule&&this.parent.reorderModule.element&&this.parent.reorderModule.destElement&&(y.style.display=this.parent.getColumnByIndex(r).visible?"":"none"),y.style.width=a):y&&i&&(y.style.width=""),!this.parent.enableColumnVirtualization){for(var b=this.parent.element.querySelectorAll(".e-table.e-inline-edit"),w=[],I=0;I<b.length;I++)if(O(b[parseInt(I.toString(),10)],"e-grid").id===this.parent.element.id)for(var R=0;R<b[parseInt(I.toString(),10)].querySelector("colgroup").children.length;R++)w.push(b[parseInt(I.toString(),10)].querySelector("colgroup").children[parseInt(R.toString(),10)]);b.length&&w.length&&(w[parseInt(r.toString(),10)].style.width=a)}this.parent.isFrozenGrid()&&this.refreshFrozenScrollbar()},e.prototype.getColumnLevelFrozenColgroup=function(e,t,r,i){if(!i||!i.querySelector(hi))return null;var n=this.parent.getColumns(),o=this.parent.isRowDragable(),s=this.parent.getFrozenMode(),a=[].slice.call(i.querySelector("colgroup:not(.e-masked-colgroup)").children);return"Right"===s&&o&&e===r+this.parent.getFrozenRightColumnsCount()?a[a.length-1]:o&&-1===e?a[0]:"Left"===n[parseInt(e.toString(),10)].freeze?a[o?e+1:e]:"Right"===n[parseInt(e.toString(),10)].freeze?a[e-(t+r)]:a[e-t]},e.prototype.refreshFrozenScrollbar=function(){var e={cancel:!1};if(this.parent.notify("prevent-frozen-scroll-refresh",e),!e.cancel){var t=j(),r=this.parent.element.querySelector(".e-frozenscrollbar"),i=this.parent.element.querySelector(".e-movablescrollbar"),n=this.parent.getContent().querySelector("."+Qr),o=this.parent.getContent().querySelector("."+Wr),s=n.firstElementChild.getBoundingClientRect().width,a=o.firstElementChild.getBoundingClientRect().width;if("Right"===this.parent.getFrozenMode()&&(s+=t),r.style.width=s+"px",this.parent.getFrozenMode()===ri){var l=this.parent.element.querySelector(".e-frozen-right-scrollbar"),h=this.parent.getContent().querySelector(".e-frozen-right-content").firstElementChild.getBoundingClientRect().width;"auto"!==this.parent.height&&(h+=t),l.style.width=h+"px"}else{if(this.parent.enableColumnVirtualization){var p=this.parent.getMovableVirtualContent().querySelector(".e-virtualtrack");p&&(a=p.scrollWidth)}"Right"!==this.parent.getFrozenMode()&&"auto"!==this.parent.height&&(a+=t)}i.firstElementChild.style.width=a+"px"}},e.prototype.getSiblingsHeight=function(e){return this.getHeightFromDirection(e,"previous")+this.getHeightFromDirection(e,"next")},e.prototype.getHeightFromDirection=function(e,t){for(var r=e[t+"ElementSibling"],i=0,n=[jr,Gr,"e-groupdroparea","e-gridpager","e-toolbar","e-temp-toolbar"];r;)n.some(function(e){return r.classList.contains(e)})&&(i+=r.offsetHeight),r=r[t+"ElementSibling"];return i},e.prototype.isWidthUndefined=function(){var e=this.parent.getColumns().filter(function(e){return t.isNullOrUndefined(e.width)&&t.isNullOrUndefined(e.minWidth)}).length;return this.parent.getColumns().length===e},e.prototype.getWidth=function(e){if(t.isNullOrUndefined(e.width)&&this.parent.allowResizing&&t.isNullOrUndefined(e.minWidth)&&!this.isWidthUndefined()&&(e.width=200),this.parent.isFrozenGrid()&&t.isNullOrUndefined(e.width)&&(e.getFreezeTableName()===ni||e.getFreezeTableName()===ii)&&(e.width=200),!e.width)return null;var r=parseInt(e.width.toString(),10);return e.minWidth&&r<parseInt(e.minWidth.toString(),10)?e.minWidth:e.maxWidth&&r>parseInt(e.maxWidth.toString(),10)?e.maxWidth:e.width},e.prototype.getTableWidth=function(e){for(var t=0,r=0,i=e;r<i.length;r++){var n=i[r],o=this.getWidth(n);"auto"===n.width&&(o=0),!1!==n.visible&&null!==o&&(t+=parseInt(o.toString(),10))}return t},e.prototype.calcMovableOrFreezeColWidth=function(e){var r=this.parent.getColumns().slice(),i=this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenColumns(),n=this.parent.getMovableColumnsCount(),o=this.parent.getFrozenRightColumnsCount();return"movable"===e?(o&&r.splice(i+n,r.length),i&&r.splice(0,i)):"freeze-left"===e?r.splice(i,r.length):"freeze-right"===e&&r.splice(0,i+n),t.formatUnit(this.getTableWidth(r))},e.prototype.setWidthToFrozenRightTable=function(){var e=this.calcMovableOrFreezeColWidth("freeze-right");e=this.isAutoResize()?"100%":e;var t=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("."+Jr+":not(.e-masked-table)"),r=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector("."+Jr+":not(.e-masked-table)");t.style.width=e,r.style.width=e},e.prototype.setWidthToFrozenLeftTable=function(){var e=this.calcMovableOrFreezeColWidth("freeze-left");e=this.isAutoResize()?"100%":e,this.parent.getHeaderTable().style.width=e,this.parent.getContentTable().style.width=e},e.prototype.setWidthToMovableTable=function(){var e="",r=this.parent.getColumns().filter(function(e){return t.isNullOrUndefined(e.width)}).length>=1,i=this.parent.getColumns().filter(function(e){return"auto"===e.width}).length>=1,n=this.parent.getHeaderContent().querySelector("."+Kr),o=this.parent.getContent().querySelector("."+Wr);"number"!=typeof this.parent.width||r||i||this.parent.resizeModule.resizeProcess?r||i||(e=this.calcMovableOrFreezeColWidth("movable")):e=t.formatUnit(this.parent.width-parseInt(this.calcMovableOrFreezeColWidth("freeze").split("px")[0],10)-5),e=this.isAutoResize()?"100%":e,n.firstElementChild&&(n.firstElementChild.classList.contains("e-masked-table")?n.childNodes[1].style.width=e:n.firstElementChild.style.width=e),o.firstElementChild.classList.contains("e-masked-table")?o.childNodes[1].style.width=e:o.firstElementChild.style.width=e},e.prototype.setWidthToFrozenEditTable=function(){var e=this.calcMovableOrFreezeColWidth("freeze");e=this.isAutoResize()?"100%":e,this.parent.element.querySelectorAll(".e-table.e-inline-edit")[0].style.width=e},e.prototype.setWidthToMovableEditTable=function(){var e=this.calcMovableOrFreezeColWidth("movable");e=this.isAutoResize()?"100%":e,this.parent.element.querySelectorAll(".e-table.e-inline-edit")[1].style.width=e},e.prototype.setWidthToTable=function(){var e=t.formatUnit(this.getTableWidth(this.parent.getColumns()));this.parent.isFrozenGrid()?((this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount())&&this.setWidthToFrozenLeftTable(),this.setWidthToMovableTable(),this.parent.getFrozenRightColumnsCount()&&this.setWidthToFrozenRightTable()):((this.parent.detailTemplate||this.parent.childGrid)&&this.setColumnWidth(new kt({width:"30px"})),e=this.isAutoResize()?"100%":e,this.parent.getHeaderTable().style.width=e,this.parent.getContentTable().style.width=e);var r=this.parent.element.querySelector(".e-table.e-inline-edit");r&&this.parent.getFrozenColumns()?(this.setWidthToFrozenEditTable(),this.setWidthToMovableEditTable()):r&&(r.style.width=e)},e.prototype.isAutoResize=function(){return this.parent.allowResizing&&"Auto"===this.parent.resizeSettings.mode},e}(),tn=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),rn=function(){function e(e){this.currentInfo={},this.oneTime=!0,this.swap={},this.isInfiniteScroll=!1,this.forget=!1,this.skipFocus=!0,this.focusByClick=!1,this.firstHeaderCellClick=!1,this.prevIndexes={},this.refMatrix=this.refreshMatrix(!0),this.actions=["downArrow","upArrow"],this.isVirtualScroll=!1,this.parent=e,this.rowModelGen=new mi(this.parent),this.addEventListener()}return e.prototype.focusCheck=function(e){var t=e.target;this.focusByClick=!0,this.firstHeaderCellClick=!0,this.skipFocus=t.classList.contains("e-grid")},e.prototype.onFocus=function(e){if(!(this.parent.isDestroyed||t.Browser.isDevice||this.parent.enableVirtualization||this.parent.element.querySelector(".e-masked-table")||!this.parent.isInitialLoad&&e&&e.target===this.parent.element&&this.parent.element.querySelector(".e-spin-show"))){this.setActive(!this.parent.enableHeaderFocus&&0===this.parent.frozenRows,this.parent.isFrozenGrid()),this.parent.enableHeaderFocus||this.parent.getCurrentViewRecords().length||"Batch"===this.parent.editSettings.mode&&("Batch"!==this.parent.editSettings.mode||!this.parent.editModule||this.parent.editModule.getBatchChanges().addedRecords.length)||this.getContent().matrix.generate(this.rowModelGen.generateRows({rows:[new Nr({isDataRow:!0})]}),this.getContent().selector,!1);var r=this.getContent().matrix.get(0,-1,[0,1],null,this.getContent().validator());this.getContent().matrix.select(r[0],r[1]),!this.skipFocus||e&&e.target===this.parent.element||(this.focus(e),this.skipFocus=!1)}},e.prototype.passiveFocus=function(e){if(!this.parent.isDestroyed){var r=this.parent.getHeaderContent().querySelector(".e-headercell");e.target!==r||!e.relatedTarget||O(e.relatedTarget,"e-grid")||this.firstHeaderCellClick||(this.currentInfo.element=e.target,this.currentInfo.elementToFocus=e.target,t.addClass([this.currentInfo.element],["e-focused","e-focus"])),this.firstHeaderCellClick=!1,e.target&&e.target.classList.contains("e-detailcell")&&(this.currentInfo.skipAction=!1,t.addClass([this.currentInfo.element],["e-focused","e-focus"]))}},e.prototype.onBlur=function(e){var r=!(!O(e.target,"e-gantt")||!e.target.classList.contains("e-rowcell")||t.isNullOrUndefined(e.target.nextElementSibling)||!e.target.nextElementSibling.classList.contains("e-rowcell"));(!this.parent.isEdit&&(!e||e.relatedTarget&&!t.closest(e.relatedTarget,".e-grid")||this.parent.element.classList.contains("e-childgrid")&&!this.parent.element.matches(":focus-within"))||!r&&t.isNullOrUndefined(e.relatedTarget)&&0===parseInt(e.target.getAttribute("data-colindex"),10)&&0===parseInt(e.target.getAttribute("index"),10)||!r&&t.isNullOrUndefined(e.relatedTarget)&&!t.closest(document.activeElement,".e-grid")&&!t.isNullOrUndefined(e.sourceCapabilities))&&(this.removeFocus(),this.skipFocus=!0,this.currentInfo.skipAction=!1,this.setLastContentCellTabIndex(),this.setFirstFocusableTabIndex(),this.firstHeaderCellClick=!1)},e.prototype.setFirstFocusableTabIndex=function(){var e=this.parent;if(e.element.tabIndex=-1,e.allowGrouping&&e.groupSettings.showDropArea){var r=e.groupModule,i=r.getFocusableGroupedItems();return void(i.length>0?(r.element.tabIndex=-1,i[0].tabIndex=0):r.element.tabIndex=0)}if(e.toolbar||e.toolbarTemplate){var n=e.toolbarModule.element,o=this.parent.toolbarModule.getFocusableToolbarItems();return void(o.length>0&&o[0].querySelector(".e-toolbar-item-focus,.e-btn,.e-input")?(n.tabIndex=-1,o[0].querySelector(".e-toolbar-item-focus,.e-btn,.e-input").tabIndex=0):n.tabIndex=0)}if(e.getColumns().length){if(e.getHeaderContent().querySelector(".e-headercell").tabIndex=0,!this.parent.isFrozenGrid()||"Left"!==this.parent.getFrozenMode()&&this.parent.getFrozenMode()!==ri?this.setActive(!1):this.setActive(!1,!0),!t.isNullOrUndefined(this.active)){var s=[0,0];0===this.active.matrix.matrix[s[0]][s[1]]&&(s=ht(this.active.matrix.matrix,s,!0)),this.active.matrix.current=s}}else;},e.prototype.setLastContentCellTabIndex=function(){var e=this.parent.getContentTable();e.rows[e.rows.length-1]&&(e.rows[e.rows.length-1].lastElementChild.tabIndex=0)},e.prototype.onClick=function(e,r){if(!O(e.target,"e-filterbarcell")||!O(e.target,"e-multiselect")&&!e.target.classList.contains("e-input-group-icon")){var i=!t.isNullOrUndefined(t.closest(e.target,"."+Vr)),n=!t.isNullOrUndefined(t.closest(e.target,"."+jr));i=i&&n?!i:i;var o=!t.isNullOrUndefined(t.closest(e.target,"."+Qr))||!t.isNullOrUndefined(t.closest(e.target,"."+Xr)),s=!1;if(this.parent.getFrozenMode()===ri&&(s=!t.isNullOrUndefined(t.closest(e.target,".e-frozen-right-content"))||!t.isNullOrUndefined(t.closest(e.target,".e-frozen-right-header")),o=o&&!s),!(!i&&t.isNullOrUndefined(t.closest(e.target,"."+jr))||e.target.classList.contains(Yr))&&t.isNullOrUndefined(t.closest(e.target,".e-unboundcell"))){if(this.setActive(i,o,s),!i&&t.isNullOrUndefined(t.closest(e.target,"."+jr)))return void this.clearOutline();var a={cancel:!1,byKey:!1,byClick:!t.isNullOrUndefined(e.target),clickArgs:e};if(this.parent.notify(or,a),!a.cancel&&!t.closest(e.target,".e-inline-edit")&&(this.setActive(i,o,s),this.getContent())){if(!1===this.getContent().onClick(e,r))return;this.parent.isFrozenGrid()&&n&&e.target===this.parent.getHeaderContent().firstChild&&-1===this.active.matrix.current[0]&&this.active.matrix.current[1]===this.active.matrix.columns&&(this.active.matrix.current=[0,0]),this.focus()}}}},e.prototype.onKeyPress=function(e){var r=this.parent.isFrozenGrid();if(this.parent.allowPaging){var i=this.parent.pagerModule.pagerObj.element,n=this.parent.pagerModule.pagerObj.getFocusablePagerElements(i,[]);if(this.parent.childGrid&&this.allowToPaging(e)&&n.length&&(n[0].tabIndex=0),this.parent.pagerModule.pagerObj.checkPagerHasFocus()){if("shiftTab"===e.action&&n.length&&n[0]===e.target){this.setActive(!0);w=[this.active.matrix.matrix.length-1,this.active.matrix.matrix[this.active.matrix.matrix.length-1].length-1];return 0===this.active.matrix.matrix[w[0]][w[1]]&&(w=ht(this.active.matrix.matrix,w,!1)),this.active.matrix.current="Batch"===this.parent.editSettings.mode?this.isValidBatchEditCell(w)?w:this.findBatchEditCell(w,!1):w,e.preventDefault(),void this.focus(e)}if("tab"!==e.action||!this.parent.element.classList.contains("e-childgrid")||(this.parent.pageSettings.pageSizes||!n.length||n[n.length-1]!==e.target)&&this.parent.pagerModule.pagerObj.getDropDownPage()!==e.target)return void this.parent.pagerModule.pagerObj.changePagerFocus(e);var o=O(this.parent.element,"e-detailcell");t.removeClass([this.parent.element],["e-focus"]),t.removeClass([o],["e-focused"]),o.tabIndex=-1}if(0===this.parent.pagerModule.pagerObj.element.tabIndex&&(38===e.keyCode||e.shiftKey&&9===e.keyCode))return e.preventDefault(),void this.focus(e);if(0===this.parent.pagerModule.pagerObj.element.tabIndex&&9===e.keyCode)return e.preventDefault(),void this.parent.pagerModule.pagerObj.setPagerFocus();if(this.parent.pagerModule.pagerObj.checkFirstPagerFocus()){var s=this.getContent().matrix.rows,a=this.getContent().matrix.columns;this.getContent().matrix.current=[s,a]}}if(!this.skipOn(e)){if(e.target&&O(e.target,"e-gridcontent")&&!r){var l=[].slice.call(this.parent.getContentTable().rows),h=l[l.length-1].lastElementChild;e.target===h&&(this.setActive(!0),this.setLastContentCellActive())}if("shiftTab"===e.action&&e.target&&(e.target===this.parent.element||O(e.target,"e-toolbar")||O(e.target,"e-groupdroparea"))){if(e.target===this.parent.element)return void(this.parent.element.classList.contains("e-childgrid")&&this.focusOutFromChildGrid(e));if(O(e.target,"e-groupdroparea"))return void(this.parent.element.classList.contains("e-childgrid")&&(e.preventDefault(),this.parent.element.focus()));if(O(e.target,"e-toolbar")){if(this.parent.allowGrouping&&this.parent.groupSettings.showDropArea){var p=(c=this.parent.groupModule).getFocusableGroupedItems();e.preventDefault(),p.length>0?p[p.length-1].focus():c.element.focus()}else this.parent.element.classList.contains("e-childgrid")&&(e.preventDefault(),this.parent.element.focus());return}}var d=!1;if("tab"===e.action&&e.target&&(e.target===this.parent.element||O(e.target,"e-toolbar")||O(e.target,"e-groupdroparea"))){if(this.parent.allowGrouping&&this.parent.groupSettings.showDropArea&&(e.target===this.parent.element||e.target.classList.contains("e-groupdroparea"))){var c=this.parent.groupModule;if((p=c.getFocusableGroupedItems()).length>0)return e.preventDefault(),void p[0].focus();if(!e.target.classList.contains("e-groupdroparea"))return e.preventDefault(),void c.element.focus()}if((this.parent.toolbar||this.parent.toolbarTemplate)&&(e.target===this.parent.element||O(e.target,"e-groupdroparea")||e.target.classList.contains("e-toolbar"))){var u=this.parent.toolbarModule.element,g=this.parent.toolbarModule.getFocusableToolbarItems();if(g.length>0)return e.preventDefault(),void g[0].querySelector(".e-toolbar-item-focus,.e-btn,.e-input").focus();if(!e.target.classList.contains("e-toolbar"))return e.preventDefault(),void u.focus()}(e.target===this.parent.element||O(e.target,"e-toolbar")||O(e.target,"e-groupdroparea"))&&(d=!0)}d&&(!r||"Left"!==this.parent.getFrozenMode()&&this.parent.getFrozenMode()!==ri?this.parent.allowGrouping&&this.parent.groupSettings.columns.length===this.parent.columns.length?this.setActive(!0):this.setActive(!1):this.setActive(!1,!0),this.active.matrix.current=[0,-1]),this.activeKey=e.action;var f={cancel:!1,byKey:!0,byClick:!1,keyArgs:e};if(this.parent.notify(or,f),!f.cancel){var m=this.getContent().matrix.current,y=this.getActiveName(),v=this.active&&this.active.matrix.current?[this.active.matrix.current[0],this.active.matrix.current[1]]:void 0;this.currentInfo.outline=!0;var C=this.getContent().jump(e.action,m);this.swap=C,C.swap&&(!r||"Batch"!==this.parent.editSettings.mode||"tab"!==e.action&&"shiftTab"!==e.action)&&(this.setActive(!C.toHeader,C.toFrozen,C.toFrozenRight),this.getContent().matrix.current=this.getContent().getNextCurrent(m,C,this.active,e.action),this.prevIndexes={}),this.setActiveByKey(e.action,this.getContent());var S=r&&"Batch"===this.parent.editSettings.mode&&e.target&&("tab"===e.action||"shiftTab"===e.action)&&(O(e.target,"e-gridheader")||O(e.target,"e-gridcontent"))?void 0:!this.content.lastIdxCell&&this.getContent().onKeyPress(e);if(e.target&&O(e.target,"e-gridheader"))if(r){if("Batch"!==this.parent.editSettings.mode||"tab"!==e.action&&"shiftTab"!==e.action||this.setFrozenBatchEditCell(y,v,"tab"===e.action),"shiftTab"===e.action&&m.toString()===this.active.matrix.current.toString()&&!C.swap&&("Batch"!==this.parent.editSettings.mode||this.getActiveName()===y))return void this.focusOutFromHeader(e)}else{if("tab"===e.action&&m.toString()===this.active.matrix.current.toString()){var b=ht(this.active.matrix.matrix,this.active.matrix.current,!0),w=[this.active.matrix.matrix.length-1,this.active.matrix.matrix[this.active.matrix.matrix.length-1].length-1];if(0===this.active.matrix.matrix[w[0]][w[1]]&&(w=ht(this.active.matrix.matrix,w,!1)),this.active.matrix.current.toString()===w.toString()){S=!0,this.setActive(!0);R=[0,0];0===this.active.matrix.matrix[R[0]][R[1]]&&(R=ht(this.active.matrix.matrix,[0,0],!0)),this.active.matrix.current="Batch"===this.parent.editSettings.mode?this.isValidBatchEditCell(R)?R:this.findBatchEditCell(R,!0):R}else this.active.matrix.current.toString()!==b.toString()&&(this.active.matrix.current=b)}if("shiftTab"===e.action&&m.toString()===this.active.matrix.current.toString()){var I=ht(this.active.matrix.matrix,this.active.matrix.current,!1);if(I.toString()===this.active.matrix.current.toString())return void this.focusOutFromHeader(e);this.active.matrix.current.toString()===I.toString()||S||(S=!0,this.active.matrix.current=I)}}if(e.target&&O(e.target,"e-gridcontent"))if(r)"Batch"!==this.parent.editSettings.mode||"tab"!==e.action&&"shiftTab"!==e.action||(this.setFrozenBatchEditCell(y,v,"tab"===e.action),"tab"===e.action&&v.toString()===this.active.matrix.current.toString()&&this.getActiveName()===y&&(this.parent.editModule.editModule.addBatchRow=!0));else if("Batch"!==this.parent.editSettings.mode||"tab"!==e.action&&"shiftTab"!==e.action||(this.active.matrix.current=this.findBatchEditCell(v,"tab"===e.action),"tab"===e.action&&v.toString()===this.active.matrix.current.toString()&&(this.parent.editModule.editModule.addBatchRow=!0)),"shiftTab"===e.action&&m.toString()===this.active.matrix.current.toString()){if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length===this.parent.columns.length)return void this.focusOutFromHeader(e);var R=[0,0];0===this.active.matrix.matrix[R[0]][R[1]]&&(R=ht(this.active.matrix.matrix,[0,0],!0)),S||R.toString()!==this.active.matrix.current.toString()&&("Batch"!==this.parent.editSettings.mode||v.toString()!==this.active.matrix.current.toString())||(S=!0,this.setActive(!1),this.setLastContentCellActive())}if(!1===S){if(this.clearIndicator(),"shiftTab"===e.action&&m.toString()===[0,0].toString()&&(this.parent.element.tabIndex=-1),this.parent.allowPaging&&!this.parent.pagerModule.pagerObj.checkPagerHasFocus()&&this.allowToPaging(e)&&m.toString()!==[0,0].toString()){if(e.preventDefault(),40===e.keyCode)return void this.parent.pagerModule.pagerObj.setPagerContainerFocus();if(9===e.keyCode)return void this.parent.pagerModule.pagerObj.setPagerFocus()}return void(this.parent.element.classList.contains("e-childgrid")&&this.focusOutFromChildGrid(e))}e.preventDefault(),this.focus(e)}}},e.prototype.isValidBatchEditCell=function(e){var r=this.active.getTable().rows[e[0]].cells[e[1]],i=t.closest(r,"tr"),n=parseInt(r.getAttribute("data-colindex"),10),o=this.parent.getColumns()[parseInt(n.toString(),10)];return!(1!==this.active.matrix.matrix[e[0]][e[1]]||!i.classList.contains("e-insertedrow")&&i.classList.contains("e-row")&&(o.isPrimaryKey||!o.allowEditing))},e.prototype.findBatchEditCell=function(e,t,r){for(var i=e,n=e,o=!1;!o;){var s=n;n=ht(this.active.matrix.matrix,n,t),s.toString()===n.toString()||r&&s[0]!==n[0]?o=!0:this.isValidBatchEditCell(n)&&(i=n,o=!0)}return i},e.prototype.setFrozenBatchEditCell=function(e,t,r,i){var n,o=this.parent,s=!1;if(n=void 0!==i?[i,r?0:this.active.matrix.matrix[parseInt(i.toString(),10)].length-1]:r?[t[0],t[1]+1]:[t[0],t[1]-1],this.active.matrix.matrix[n[0]]&&this.active.matrix.matrix[n[0]][n[1]])if(this.isValidBatchEditCell(n))this.active.matrix.current=n;else{var a=n;n=this.findBatchEditCell(n,r,!0),a.toString()===n.toString()?s=!0:this.active.matrix.current=n}else s=!0;if(s){var l=this.getActiveName(),h=o.getFrozenMode(),p=n[0],d=p-1,c=p+1,u=!r&&-1===d,g=r&&c>this.active.matrix.matrix.length-1;if(("FrozenLeftHeader"===l||"Movableheader"===l&&"Right"===h)&&u||("FrozenRightContent"===l||"MovableContent"===l&&"Left"===h)&&g)this.setActiveByName(e),this.active.matrix.current=t;else{var f="Left-Right"===h&&!r,m="Left-Right"===h&&r,y="Left"===h&&g,v="Left"===h&&r,C="Right"===h&&!r,S="Right"===h&&u,b="Movableheader"===l&&y||"FrozenRightHeader"===l&&g||"FrozenLeftContent"===l&&!u||"MovableContent"===l&&!S||"FrozenRightContent"===l,w=("Movableheader"===l||"MovableContent"===l)&&!m||("FrozenRightHeader"===l||"FrozenRightContent"===l)&&m,I=("FrozenLeftHeader"===l||"FrozenLeftContent"===l)&&f||("Movableheader"===l||"MovableContent"===l)&&m;this.setActive(b,w,I);var R="Movableheader"===l&&y||"FrozenRightHeader"===l&&g?0:("Movableheader"===l||"MovableContent"===l)&&v||("FrozenRightHeader"===l||"FrozenRightContent"===l)&&r?c:"FrozenLeftContent"===l&&u||"MovableContent"===l&&S?this.active.matrix.matrix.length-1:("FrozenLeftHeader"===l||"FrozenLeftContent"===l)&&!r||("Movableheader"===l||"MovableContent"===l)&&C?d:p;this.setFrozenBatchEditCell(e,t,r,R)}}},e.prototype.getActiveName=function(){var e;if(this.active){var t=this.active.getTable();e=O(t,"e-frozen-left-header")?"FrozenLeftHeader":O(t,"e-movableheader")?"Movableheader":O(t,"e-frozen-right-header")?"FrozenRightHeader":O(t,"e-frozen-left-content")?"FrozenLeftContent":O(t,"e-movablecontent")?"MovableContent":O(t,"e-frozen-right-content")?"FrozenRightContent":void 0}return e},e.prototype.setActiveByName=function(e){var t=this.parent.getFrozenMode();switch(e){case"FrozenLeftHeader":this.setActive(!1,!0);break;case"Movableheader":this.setActive(!1);break;case"FrozenRightHeader":this.setActive(!1,"Right"===t,"Right"!==t);break;case"FrozenLeftContent":this.setActive(!0,!0);break;case"MovableContent":this.setActive(!0);break;case"FrozenRightContent":this.setActive(!0,"Right"===t,"Right"!==t)}},e.prototype.setLastContentCellActive=function(){var e=[this.active.matrix.matrix.length-1,this.active.matrix.matrix[this.active.matrix.matrix.length-1].length-1];0===this.active.matrix.matrix[e[0]][e[1]]&&(e=ht(this.active.matrix.matrix,e,!1)),this.active.matrix.current=e},e.prototype.focusOutFromChildGrid=function(e){var r=O(O(this.parent.element,"e-table"),"e-grid").ej2_instances[0],i=O(this.parent.element,"e-detailcell"),n=O(this.parent.element,"e-detailrow").getAttribute("data-uid"),o=[].slice.call(r.getContentTable().rows),s=o.map(function(e){return e.getAttribute("data-uid")}).indexOf(n);if(!("tab"===e.action&&s>=o.length-1)){t.removeClass([this.parent.element],["e-focus"]),t.removeClass([i],["e-focused"]),i.tabIndex=-1,e.preventDefault();var a;if(r.focusModule.removeFocus(),"shiftTab"===e.action){for(var l=o[s-1].cells,h=l.length-1;h>=0;h--)if(!(a=l[parseInt(h.toString(),10)]).classList.contains("e-hide")){r.focusModule.active.matrix.current=[s-1,h];break}}else a=o[s+1].cells[0],r.focusModule.active.matrix.current=[s+1,0];r.focusModule.currentInfo.element=a,r.focusModule.currentInfo.elementToFocus=a,t.addClass([a],["e-focused","e-focus"]),a.tabIndex=0,a.focus()}},e.prototype.focusOutFromHeader=function(e){if(this.removeFocus(),this.parent.toolbar||this.parent.toolbarTemplate){var t=this.parent.toolbarModule.element,r=this.parent.toolbarModule.getFocusableToolbarItems();return e.preventDefault(),void(r.length>0?r[r.length-1].querySelector(".e-toolbar-item-focus,.e-btn,.e-input").focus():t.focus())}if(this.parent.allowGrouping&&this.parent.groupSettings.showDropArea){var i=this.parent.groupModule,n=i.getFocusableGroupedItems();return e.preventDefault(),void(n.length>0?n[n.length-1].focus():i.element.focus())}this.parent.element.classList.contains("e-childgrid")&&(e.preventDefault(),this.parent.element.focus())},e.prototype.allowToPaging=function(e){return"Batch"!==this.parent.editSettings.mode||!this.parent.editSettings.allowAdding||40===e.keyCode},e.prototype.skipOn=function(e){var r=e.target;if(!r)return!1;if(this.currentInfo.skipAction)return this.clearIndicator(),!0;if(["pageUp","pageDown","altDownArrow"].indexOf(e.action)>-1)return this.clearIndicator(),!0;if(this.parent.allowGrouping){var i=this.parent.groupModule.getFocusableGroupedItems();if(O(e.target,"e-groupheadercell")&&!(e.target===i[0]&&"shiftTab"===e.action||e.target===i[i.length-1]&&"tab"===e.action))return!0}if(this.parent.toolbar||this.parent.toolbarTemplate){var n=this.parent.toolbarModule.element.querySelectorAll(".e-toolbar-item:not(.e-overlay):not(.e-hidden)");if(O(e.target,"e-toolbar-item")&&!(n.length>0&&(O(e.target,"e-toolbar-item")===n[0]&&"shiftTab"===e.action||O(e.target,"e-toolbar-item")===n[n.length-1]&&"tab"===e.action)))return!0}var o=t.closest(r,"th")&&!t.closest(r,"th").tabIndex;!e.target.classList.contains("e-filterbaroperator")||13!==e.keyCode&&27!==e.keyCode||t.closest(e.target,".e-filterbarcell").querySelector("input").focus(),o&&null!==t.closest(document.activeElement,".e-filterbarcell")&&this.removeFocus();var s=null!==t.closest(document.activeElement,".e-filterbarcell");if(this.parent.enableHeaderFocus&&s){var a=this.active.matrix,l=a.current;s=a.matrix[l[0]].lastIndexOf(1)!==l[1]}return"delete"===e.action||"Batch"!==this.parent.editSettings.mode&&(this.parent.isEdit||["insert","f2"].indexOf(e.action)>-1)||s&&this.parent.enableHeaderFocus||s&&"tab"!==e.action&&"shiftTab"!==e.action||null!==t.closest(document.activeElement,"#"+this.parent.element.id+"_searchbar")&&["enter","leftArrow","rightArrow","shiftLeft","shiftRight","ctrlPlusA"].indexOf(e.action)>-1||null===t.closest(r,"."+Vr)&&null===t.closest(r,"."+jr)&&!(e.target===this.parent.element||O(e.target,"e-toolbar")||O(e.target,"e-groupdroparea"))||"space"===e.action&&!r.classList.contains($r)&&null===t.closest(r,"."+$r)&&null===t.closest(r,".e-headerchkcelldiv")||null!==t.closest(r,".e-filter-popup")},e.prototype.focusVirtualElement=function(e){var t=this;if(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling){var r={virtualData:{},isAdd:!1,isCancel:!1};this.parent.notify(Mr,r);var i=this.actions.some(function(e){return e===t.activeKey}),n=!!this.parent.contentModule&&this.parent.contentModule.selectedRowIndex>-1;r.isAdd||Object.keys(r.virtualData).length||i||r.isCancel||n?(this.parent.notify("reset-virtual-focus",{isCancel:!1}),r.isCancel=!1,this.parent.contentModule.selectedRowIndex=-1,i&&(this.activeKey=this.empty,this.parent.notify("virtaul-key-handler",e)),this.currentInfo.elementToFocus.focus({preventScroll:!0})):this.isVirtualScroll||this.isInfiniteScroll?this.currentInfo.elementToFocus.focus({preventScroll:!0}):this.currentInfo.elementToFocus.focus()}this.isVirtualScroll=this.isInfiniteScroll=!1},e.prototype.getFocusedElement=function(){return this.currentInfo.elementToFocus},e.prototype.getContent=function(){return this.active||this.content},e.prototype.setActive=function(e,t,r){this.active=e?t?this.fContent:r?this.frContent:this.content:t?this.fHeader:r?this.frHeader:this.header},e.prototype.setFocusedElement=function(e,r){var i=this;this.currentInfo.elementToFocus=e,setTimeout(function(){t.isNullOrUndefined(i.currentInfo.elementToFocus)||(i.parent.enableVirtualization||i.parent.enableInfiniteScrolling?i.focusVirtualElement(r):i.currentInfo.elementToFocus.focus())},0)},e.prototype.focus=function(e){this.parent.notify("virtaul-cell-focus",e),this.removeFocus(),this.addFocus(this.getContent().getFocusInfo(),e)},e.prototype.removeFocus=function(e){this.currentInfo.element&&(t.removeClass([this.currentInfo.element,this.currentInfo.elementToFocus],["e-focused","e-focus"]),this.currentInfo.element.tabIndex=-1)},e.prototype.addOutline=function(){var e=this.getContent().getFocusInfo();e.element&&(t.addClass([e.element],["e-focused"]),t.addClass([e.elementToFocus],["e-focus"]))},e.prototype.focusHeader=function(){this.setActive(!1,this.parent.isFrozenGrid()),this.resetFocus()},e.prototype.focusContent=function(){this.setActive(!0,this.parent.isFrozenGrid()),this.resetFocus()},e.prototype.resetFocus=function(){var e=this.getContent().matrix.get(0,-1,[0,1],null,this.getContent().validator());this.getContent().matrix.select(e[0],e[1]),this.focus()},e.prototype.addFocus=function(e,r){if(this.currentInfo=e,this.currentInfo.outline=e.outline&&!t.isNullOrUndefined(r),this.isInfiniteScroll&&(this.currentInfo.outline=!0),e.element){var i=e.elementToFocus.classList.contains("e-focus");if(!i){this.currentInfo.outline&&t.addClass([e.element],["e-focused"]),t.addClass([e.elementToFocus],["e-focus"]),e.element.tabIndex=0,i||this.setFocusedElement(e.elementToFocus,r),this.parent.notify("cellfocused",{element:e.elementToFocus,parent:e.element,indexes:this.getContent().matrix.current,byKey:!t.isNullOrUndefined(r),byClick:t.isNullOrUndefined(r),keyArgs:r,isJump:this.swap.swap,container:this.getContent().getInfo(r),outline:!t.isNullOrUndefined(r),swapInfo:this.swap});var n=this.getContent().matrix.current,o=n[0],s=n[1];this.prevIndexes={rowIndex:o,cellIndex:s},this.focusedColumnUid=this.parent.getColumnByIndex(s).uid,this.focusByClick=!1}}},e.prototype.refreshMatrix=function(e){var r=this;return function(i){e&&i.args&&i.args.isFrozen&&!r.fContent?r.fContent=new an(r.parent):e&&!r.frContent&&i.args&&i.args.renderFrozenRightContent?r.frContent=new pn(r.parent):e&&!r.content&&(r.content=new on(r.parent)),!e&&i.args&&i.args.isFrozen&&!r.fHeader?r.fHeader=new ln(r.parent):!e&&i.args&&i.args.renderFrozenRightContent&&!r.frHeader?r.frHeader=new dn(r.parent):e||r.header||(r.header=new sn(r.parent));var n=e?i.args&&i.args.isFrozen?r.fContent:i.args&&i.args.renderFrozenRightContent?r.frContent:r.content:i.args&&i.args.isFrozen?r.fHeader:i.args&&i.args.renderFrozenRightContent?r.frHeader:r.header,o=e?i.rows.slice(r.parent.frozenRows):i.rows,s=e?i.rows.slice(0,r.parent.frozenRows):i.rows;r.parent.isCollapseStateEnabled()&&e&&(o=o.filter(function(e){return!1!==e.visible}));var a=!t.isNullOrUndefined(r.parent.rowTemplate),l=n.matrix.generate(s,n.selector,a);if("batchAdd"===i.name&&r.parent.isFrozenGrid()){var h=r.parent.getMovableRowsObject().slice(r.parent.frozenRows).map(function(e){return e.clone()}),p=o.map(function(e){return e.clone()});if(r.fContent.matrix.generate(p,r.fContent.selector,a),r.content.matrix.generate(h,r.content.selector,a),r.parent.getFrozenMode()===ri){var d=r.parent.getFrozenRightRowsObject().slice(r.parent.frozenRows).map(function(e){return e.clone()});r.frContent.matrix.generate(d,r.frContent.selector,a)}}else n.matrix.generate(o,n.selector,a);if(r.parent.isFrozenGrid()&&(i.args&&("sorting"===i.args.requestType||"batchsave"===i.args.requestType||"paging"===i.args.requestType)||"batchAdd"===i.name||"batchCancel"===i.name)||n.generateRows(s,{matrix:l,handlerInstance:i.args&&i.args.isFrozen?r.fHeader:i.args&&i.args.renderFrozenRightContent?r.frHeader:r.header}),!t.Browser.isDevice&&i&&i.args&&(r.focusByClick||"paging"!==i.args.requestType||r.parent.pagerModule.pagerObj.checkPagerHasFocus()||(r.skipFocus=!1,r.parent.element.focus()),"grouping"===i.args.requestType&&(r.skipFocus=!0)),i&&i.args&&"virtualscroll"===i.args.requestType)if(r.currentInfo.uid){var c;if(i.rows.some(function(e,t){return c=t,e.uid===r.currentInfo.uid})&&(r.content.matrix.current[0]=c,r.content.matrix.current[1]=r.parent.getColumnIndexByUid(r.focusedColumnUid)||0,f=r.getContent().getFocusInfo().elementToFocus)){var u=f.getBoundingClientRect(),g=r.parent.element.getBoundingClientRect();u.top>=0&&u.left>=0&&u.right<=Math.min(g.right,window.innerWidth||document.documentElement.clientWidth)&&u.bottom<=Math.min(g.bottom,window.innerHeight||document.documentElement.clientHeight)&&(r.isVirtualScroll=!0,r.focus())}}else if(i.args.focusElement&&i.args.focusElement.classList.contains("e-filtertext")){var f=r.parent.element.querySelector("#"+i.args.focusElement.id);f&&f.focus()}i&&i.args&&"infiniteScroll"===i.args.requestType&&(r.isInfiniteScroll=!0)}},e.prototype.addEventListener=function(){var e=this;this.parent.isDestroyed||(t.EventHandler.add(this.parent.element,"mousedown",this.focusCheck,this),t.EventHandler.add(this.parent.element,"touchstart",this.focusCheck,this),t.EventHandler.add(this.parent.element,"focus",this.onFocus,this),this.parent.element.addEventListener("focus",this.passiveHandler=function(t){return e.passiveFocus(t)},!0),t.EventHandler.add(this.parent.element,"focusout",this.onBlur,this),this.evtHandlers=[{event:sr,handler:this.onKeyPress},{event:ar,handler:this.onClick},{event:Yt,handler:this.refMatrix},{event:"partial-refresh",handler:this.refMatrix},{event:"refresh-Expand-and-Collapse",handler:this.refMatrix},{event:rr,handler:this.refreshMatrix()},{event:"close-edit",handler:this.restoreFocus},{event:"restore-Focus",handler:this.restoreFocus},{event:"start-edit",handler:this.clearIndicator},{event:"start-add",handler:this.clearIndicator},{event:"sorting-complete",handler:this.restoreFocus},{event:"filtering-complete",handler:this.filterfocus},{event:"grouping-complete",handler:this.restoreFocusWithAction},{event:"ungrouping-complete",handler:this.restoreFocusWithAction},{event:"batchAdd",handler:this.refMatrix},{event:"batchCancel",handler:this.refMatrix},{event:"batchDelete",handler:this.refMatrix},{event:"detailDataBound",handler:this.refMatrix},{event:Zt,handler:this.refMatrix},{event:"cellfocused",handler:this.internalCellFocus}],Ze(this.parent,this.evtHandlers,!0,this))},e.prototype.filterfocus=function(){"FilterBar"!==this.parent.filterSettings.type&&this.restoreFocus()},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(t.EventHandler.remove(this.parent.element,"mousedown",this.focusCheck),t.EventHandler.remove(this.parent.element,"touchstart",this.focusCheck),t.EventHandler.remove(this.parent.element,"focus",this.onFocus),t.EventHandler.remove(this.parent.element,"focusout",this.onBlur),this.parent.element.removeEventListener("focus",this.passiveHandler,!0),Ze(this.parent,this.evtHandlers,!1))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.restoreFocus=function(){var e=this.parent.groupModule;if(this.parent.allowGrouping&&e&&(e.groupSortFocus||e.groupTextFocus))return e.groupSortFocus=!1,void(e.groupTextFocus=!1);this.firstHeaderCellClick=!0,this.addFocus(this.getContent().getFocusInfo())},e.prototype.restoreFocusWithAction=function(e){if(!this.parent.enableInfiniteScrolling){var r=this.getContent().matrix,i=r.current;switch(e.requestType){case"grouping":case"ungrouping":i[1]=!i.length||this.parent.groupSettings.showGroupedColumn||t.isNullOrUndefined(r.matrix[i[0]])?"grouping"===e.requestType?i[1]+1:i[1]-1:r.matrix[i[0]].indexOf(1)}this.getContent().matrix.current=i;var n=this.parent.groupModule;if(this.parent.allowGrouping&&n&&n.groupCancelFocus){var o=n.getFocusableGroupedItems();return o.length?o[0].parentElement.getAttribute("ej-mappingname")===e.columnName?o[3].focus():o[0].focus():n.element.focus(),void(n.groupCancelFocus=!1)}this.addFocus(this.getContent().getFocusInfo())}},e.prototype.clearOutline=function(){this.getContent().matrix.current=this.getContent().matrix.get(0,-1,[0,1],"downArrow",this.getContent().validator()),this.clearIndicator()},e.prototype.clearIndicator=function(){this.currentInfo.element&&this.currentInfo.elementToFocus&&t.removeClass([this.currentInfo.element,this.currentInfo.elementToFocus],["e-focus","e-focused"])},e.prototype.getPrevIndexes=function(){var e=this.forget;return this.forget=!1,e||!Object.keys(this.prevIndexes).length?{rowIndex:null,cellIndex:null}:this.prevIndexes},e.prototype.forgetPrevious=function(){this.forget=!0},e.prototype.setActiveByKey=function(e,t){var r=this;if(this.parent.isFrozenGrid()||0!==this.parent.frozenRows){var i,n={home:function(){return{toHeader:!i.isContent,toFrozen:!0}},end:function(){return{toHeader:!i.isContent,toFrozen:!1}},ctrlHome:function(){return{toHeader:!0,toFrozen:r.parent.isFrozenGrid()}},ctrlEnd:function(){return{toHeader:!1,toFrozen:!1}}};if(e in n){i=t.getInfo();var o=n[""+e]();this.setActive(!o.toHeader,o.toFrozen),this.getContent().matrix.current=t.matrix.current}}},e.prototype.internalCellFocus=function(e){if(e.byKey&&e.container.isContent&&"enter"===e.keyArgs.action&&(e.parent.classList.contains("e-detailcell")||e.parent.classList.contains("e-unboundcell"))){this.clearIndicator();var t=this.getContent().getFocusable(this.getFocusedElement());this.setFocusedElement(t),this.currentInfo.skipAction=!0}},e}(),nn=function(){function e(){this.matrix=[],this.current=[]}return e.prototype.set=function(e,t,r){e=Math.max(0,Math.min(e,this.rows)),t=Math.max(0,Math.min(t,this.columns)),this.matrix[parseInt(e.toString(),10)]=this.matrix[parseInt(e.toString(),10)]||[],this.matrix[parseInt(e.toString(),10)][parseInt(t.toString(),10)]=r?1:0},e.prototype.get=function(e,r,i,n,o){var s=r;if(e+i[0]<0)return[e,r];e=Math.max(0,Math.min(e+i[0],this.rows));var a=!0;if(t.isNullOrUndefined(this.matrix[parseInt(e.toString(),10)]))return null;if(r=Math.max(0,Math.min(r+i[1],this.matrix[parseInt(e.toString(),10)].length-1)),s+i[1]>this.matrix[parseInt(e.toString(),10)].length-1&&o(e,r,n))return[e,s];var l=this.first(this.matrix[parseInt(e.toString(),10)],r,i,!0,n);r=null===l?s:l;var h=t.getValue(e+"."+r,this.matrix);if(e!==this.rows||"downArrow"!==n&&"enter"!==n||(i[0]=-1),null===l){for(var p=0;p<this.rows;p++)if(this.matrix[parseInt(p.toString(),10)].some(function(e){return 1===e})){a=!1;break}if(a)return e=this.current.length?this.current[0]:0,[e,r]}return this.inValid(h)||!o(e,r,n)?this.get(e,s,i,n,o):[e,r]},e.prototype.first=function(e,t,r,i,n){return(t<0||t===e.length)&&this.inValid(e[parseInt(t.toString(),10)])&&"upArrow"!==n&&"downArrow"!==n||!e.some(function(e){return 1===e})?null:this.inValid(e[parseInt(t.toString(),10)])?this.first(e,-1!==["upArrow","downArrow","shiftUp","shiftDown"].indexOf(n)?i?0:++t:t+r[1],r,!1,n):t},e.prototype.select=function(e,t){e=Math.max(0,Math.min(e,this.rows)),t=Math.max(0,Math.min(t,this.matrix[parseInt(e.toString(),10)].length-1)),this.current=[e,t]},e.prototype.generate=function(e,t,r){this.rows=e.length-1,this.matrix=[];for(var i=0;i<e.length;i++){var n=e[parseInt(i.toString(),10)].cells.filter(function(e){return!0!==e.isSpanned});this.columns=Math.max(n.length-1,0|this.columns);for(var o=0,s=0;s<n.length;s++)n[parseInt(s.toString(),10)].column&&n[parseInt(s.toString(),10)].column.columns?o=this.columnsCount(n[parseInt(s.toString(),10)].column.columns,o):o++,this.set(i,s,!1!==e[parseInt(i.toString(),10)].visible&&t(e[parseInt(i.toString(),10)],n[parseInt(s.toString(),10)],r));this.columns=Math.max(o-1,0|this.columns)}return this.matrix},e.prototype.columnsCount=function(e,t){for(var r=e,i=t,n=0;n<r.length;n++)r[parseInt(n.toString(),10)].columns?i=this.columnsCount(r[parseInt(n.toString(),10)].columns,i):i++;return i},e.prototype.inValid=function(e){return 0===e||void 0===e},e}(),on=function(){function r(e){var t=this;this.matrix=new nn,this.lastIdxCell=!1,this.parent=e,this.keyActions={rightArrow:[0,1],tab:[0,1],leftArrow:[0,-1],shiftTab:[0,-1],upArrow:[-1,0],downArrow:[1,0],shiftUp:[-1,0],shiftDown:[1,0],shiftRight:[0,1],shiftLeft:[0,-1],enter:[1,0],shiftEnter:[-1,0]},this.indexesByKey=function(e){return{home:[t.matrix.current[0],-1,0,1],end:[t.matrix.current[0],t.matrix.columns+1,0,-1],ctrlHome:[0,-1,0,1],ctrlEnd:[t.matrix.rows,t.matrix.columns+1,0,-1]}[""+e]||null}}return r.prototype.getTable=function(){return this.parent.isFrozenGrid()?this.parent.getContent().querySelector(".e-movablecontent .e-table"):this.parent.getContentTable()},r.prototype.onKeyPress=function(e){var t=this.keyActions[e.action],r=this.getCurrentFromAction(e.action,t,e.action in this.keyActions,e);if(r){if((["tab","shiftTab"].indexOf(e.action)>-1&&this.matrix.current||[]).toString()===r.toString()||this.parent.allowPaging&&!this.parent.pagerModule.pagerObj.checkPagerHasFocus()&&this.matrix.current[0]===this.matrix.rows&&("Batch"===this.parent.editSettings.mode&&this.parent.editSettings.allowAdding&&40===e.keyCode||40===e.keyCode)){if(r.toString()===[this.matrix.rows,this.matrix.columns].toString()||r.toString()===[0,0].toString()||this.matrix.current[0]===this.matrix.rows&&this.matrix.current.toString()===r.toString()||this.parent.allowGrouping&&this.parent.infiniteScrollSettings.enableCache&&r.toString()===[0,1].toString())return!1;r=this.editNextRow(r[0],r[1],e.action)}this.matrix.select(r[0],r[1])}},r.prototype.editNextRow=function(e,t,r){var i=this.parent,n=i.editSettings.allowNextRowEdit&&(i.isEdit||i.isLastCellPrimaryKey),o=i.getColumnIndexByField(i.getVisibleColumns()[0].field),s=this.getTable().rows[parseInt(e.toString(),10)].cells[parseInt(t.toString(),10)];return"tab"===r&&n&&(e++,t=o+(this.getTable().rows[parseInt(e.toString(),10)].getElementsByClassName("e-indentcell").length+this.getTable().rows[parseInt(e.toString(),10)].getElementsByClassName("e-detailrowcollapse").length)),"shiftTab"===r&&n&&(e--,t=i.getColumnIndexByField(i.getVisibleColumns()[i.getVisibleColumns().length-1].field)),s.classList.contains(Ur)||s.classList.contains("e-headercell")||s.classList.contains("e-groupcaption")||s.classList.contains("e-filterbarcell")?[e,t]:this.editNextRow(e,t,r)},r.prototype.getCurrentFromAction=function(e,t,r,i){if(void 0===t&&(t=[0,0]),!r&&!this.indexesByKey(e)||0===this.matrix.current.length)return null;if(!this.shouldFocusChange(i))return this.matrix.current;var n=this.indexesByKey(e)||this.matrix.current.concat(t),o=n[0],s=n[1],a=n[2],l=n[3];if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&this.parent.aggregates.length&&"enter"===e)for(var h=o;h<this.matrix.matrix.length;h++){var p=this.getTable().rows[h+1];if(p&&p.cells[parseInt(s.toString(),10)]&&p.cells[parseInt(s.toString(),10)].classList.contains("e-rowcell"))return[h+1,s];if(h===this.matrix.matrix.length-1)return[o,s]}if("ctrlEnd"===e||"end"===e){var d=[this.matrix.matrix.length-1,this.matrix.matrix[this.matrix.matrix.length-1].length-1];"end"===e&&(d=[o,this.matrix.matrix[parseInt(o.toString(),10)].length-1]),0===this.matrix.matrix[d[0]][d[1]]&&(d=ht(this.matrix.matrix,d,!1)),o=d[0],s=d[1]+1}return this.matrix.get(o,s,[a,l],e,this.validator())},r.prototype.onClick=function(e,r){var i=e.target;if(this.target=i,i=i.classList.contains(Ur)?i:t.closest(i,"td"),i=i||(t.closest(e.target,"td.e-detailrowcollapse")||t.closest(e.target,"td.e-detailrowexpand")),i=t.closest(e.target,"td.e-detailcell")&&t.isNullOrUndefined(t.closest(t.closest(e.target,".e-grid"),"td.e-detailcell"))?null:i,!(i=i&&t.closest(i,"table").classList.contains(Jr)?i:null))return!1;var n=[i.parentElement.rowIndex,i.cellIndex],o=n[0],s=n[1],a=this.matrix.current,l=a[0],h=a[1],p=t.getValue(o+"."+s,this.matrix.matrix);if(this.matrix.inValid(p)||!r&&l===o&&h===s||!O(e.target,Ur)&&!O(e.target,"e-groupcaption")&&!O(e.target,"e-recordpluscollapse")&&!O(e.target,"e-recordplusexpand")&&!O(e.target,"e-detailrowcollapse")&&!O(e.target,"e-detailrowexpand")&&!O(e.target,"e-templatecell"))return!1;this.matrix.select(o,s)},r.prototype.getFocusInfo=function(){var e={},r=this.matrix.current,i=r[0],n=void 0===i?0:i,o=r[1],s=void 0===o?0:o;return this.matrix.current=[n,s],e.element=t.isNullOrUndefined(this.getTable().rows[parseInt(n.toString(),10)])?null:this.getTable().rows[parseInt(n.toString(),10)].cells[parseInt(s.toString(),10)],e.element?(e.elementToFocus=e.element.classList.contains("e-unboundcell")||e.element.classList.contains("e-detailcell")?e.element:this.getFocusable(e.element),e.elementToFocus=e.element.classList.contains("e-detailcell")&&e.element.querySelector(".e-childgrid")?e.element.querySelector(".e-childgrid"):e.elementToFocus,e.outline=!0,e.uid=e.element.parentElement.getAttribute("data-uid"),e):e},r.prototype.getFocusable=function(e){var r='button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])',i=!t.isNullOrUndefined(t.closest(e,".e-templatecell"));this.parent.isEdit&&(r='input:not([type="hidden"]), select:not([aria-hidden="true"]), textarea');var n=[].slice.call(e.querySelectorAll(r));return n.length?i&&n.length>1?this.target?this.target:e:n[0]:e},r.prototype.selector=function(r,i,n){var o=[e.CellType.Expand,e.CellType.GroupCaption,e.CellType.CaptionSummary,e.CellType.GroupSummary];return(r.isDataRow&&i.visible&&(i.isDataCell||i.isTemplate)||r.isDataRow&&i.cellType===e.CellType.DetailExpand&&t.isNullOrUndefined(i.visible)||!r.isDataRow&&o.indexOf(i.cellType)>-1&&!!(i.cellType!==e.CellType.GroupSummary&&i.cellType!==e.CellType.CaptionSummary||i.isDataCell&&i.visible)||i.column&&i.visible&&"checkbox"===i.column.type||i.cellType===e.CellType.CommandColumn||r.isDataRow&&n)&&!("delete"===r.edit&&r.isDirty)},r.prototype.nextRowFocusValidate=function(e){for(var t=e,r=e,i=this.matrix.rows;r<=i;r++){if(-1!==this.matrix.matrix[parseInt(e.toString(),10)].indexOf(1))return e;e+=1}return this.lastIdxCell=!0,t},r.prototype.previousRowFocusValidate=function(e){for(var t=e,r=e;r>=0;r--){if(-1!==this.matrix.matrix[parseInt(e.toString(),10)].indexOf(1))return e;if((e-=1)<0)return this.lastIdxCell=!0,t}return t},r.prototype.jump=function(e,t){var r=this.parent.getFrozenLeftCount()&&("leftArrow"===e||"shiftTab"===e)&&0===t[1]||t[0]<this.matrix.matrix.length-1&&"tab"===e&&"Left"===this.parent.getFrozenMode()&&t[1]===this.matrix.matrix[t[0]].lastIndexOf(1),i=("rightArrow"===e||"tab"===e)&&t[1]===this.matrix.matrix[t[0]].lastIndexOf(1)||"shiftTab"===e&&"Right"===this.parent.getFrozenMode()&&t[1]===this.matrix.matrix[t[0]].indexOf(1),n=this.parent.getFrozenMode()===ri&&i;"Right"===this.parent.getFrozenMode()&&(r=i),this.lastIdxCell=!1;var o=0!==this.parent.frozenRows&&"shiftEnter"===e,s=("upArrow"===e||o)&&0===t[0]||"shiftTab"===e&&"Right"===this.parent.getFrozenMode()&&0===t[0]&&t[1]===this.matrix.matrix[t[0]].indexOf(1);this.parent.isFrozenGrid()||"tab"!==e||t[1]!==this.matrix.matrix[t[0]].lastIndexOf(1)||this.matrix.matrix.length-1===t[0]||(this.matrix.current[0]=this.nextRowFocusValidate(this.matrix.current[0]+1),this.matrix.current[1]=-1,r=this.parent.isFrozenGrid()),this.parent.isFrozenGrid()||"shiftTab"!==e||0===t[0]||this.matrix.matrix[t[0]].indexOf(1)!==t[1]||(this.matrix.current[0]=this.previousRowFocusValidate(this.matrix.current[0]-1),this.matrix.current[1]=this.matrix.matrix[t[0]].length);var a=!1,l=document.activeElement.parentElement;return(this.parent.enableVirtualization||this.parent.infiniteScrollSettings.enableCache)&&l.classList.contains(Zr)&&(a=parseInt(l.getAttribute(si),10)>0),"shiftTab"===e&&"Right"===this.parent.getFrozenMode()&&0===t[0]&&t[1]===this.matrix.matrix[t[0]].indexOf(1)&&(this.matrix.current[0]=-1),{swap:!a&&(("upArrow"===e||o)&&0===t[0]||r||n),toHeader:s,toFrozen:r,toFrozenRight:n}},r.prototype.getNextCurrent=function(e,t,r,i){void 0===e&&(e=[]);var n=[];return"Right"===this.parent.getFrozenMode()||this.parent.getFrozenMode()===ri?("leftArrow"!==i&&"shiftTab"!==i||(n[0]=e[0],n[1]=this.matrix.matrix[n[0]].length),this.parent.getFrozenMode()!==ri||"rightArrow"!==i&&"tab"!==i||(n[0]=e[0],n[1]=-1),"Right"===this.parent.getFrozenMode()&&"tab"===i&&(n[0]=e[0]+1,n[1]=-1)):"rightArrow"!==i&&"tab"!==i||(n[0]=e[0],n[1]=-1),"downArrow"!==i&&"enter"!==i||(n[0]=-1,n[1]=e[1]),"shiftTab"===i&&"Left"===this.parent.getFrozenMode()&&(n[0]=e[0]-1,n[1]=this.matrix.matrix[n[0]].length),n},r.prototype.generateRows=function(e,t){var r,i=t.matrix,n=t.handlerInstance,o=n.matrix.matrix.length,s=this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type?o+1:o;n.matrix.matrix=n.matrix.matrix.slice(0,s),n.matrix.rows=s,(r=n.matrix.matrix).push.apply(r,i),n.matrix.rows+=i.length},r.prototype.getInfo=function(e){var t=this.getFocusInfo(),r=this.matrix.current,i=r[0],n=r[1],o=t.element.classList.contains(Ur),s=o||e&&"enter"!==e.action&&(t.element.classList.contains("e-detailrowcollapse")||t.element.classList.contains("e-detailrowexpand")),a=[Math.min(parseInt(t.element.parentElement.getAttribute(si),10),i),Math.min(parseInt(t.element.getAttribute(oi),10),n)],l=a[0],h=a[1];return this.parent.allowGrouping&&this.parent.groupSettings.enableLazyLoading&&o&&(l=this.parent.getDataRows().indexOf(t.element.parentElement)),{isContent:!0,isDataCell:o,indexes:[l,h],isSelectable:s}},r.prototype.validator=function(){var e=this.getTable();return function(r,i,n){if(!t.isNullOrUndefined(e.rows[parseInt(r.toString(),10)])){var o=void 0;i=e.querySelector(".e-emptyrow")?0:i;var s=0!==(o=e.rows[parseInt(r.toString(),10)].cells[0].classList.contains("e-editcell")?e.rows[parseInt(r.toString(),10)].cells[0].querySelectorAll("td")[parseInt(i.toString(),10)]:e.rows[parseInt(r.toString(),10)].cells[parseInt(i.toString(),10)]).getBoundingClientRect().width;if("enter"===n||"shiftEnter"===n)return s&&o.classList.contains(Ur);if(("shiftUp"===n||"shiftDown"===n)&&o.classList.contains(Ur))return s;if("shiftUp"!==n&&"shiftDown"!==n)return s}return!1}},r.prototype.shouldFocusChange=function(e){var r=this.matrix.current,i=r[0],n=void 0===i?-1:i,o=r[1],s=void 0===o?-1:o;if(n<0||s<0)return!0;var a=t.getValue(n+".cells."+s,this.getTable().rows);return!a||("enter"!==e.action&&"shiftEnter"!==e.action||(a.classList.contains(Ur)&&!a.classList.contains("e-unboundcell")||a.classList.contains("e-editedbatchcell")&&!a.classList.contains("e-detailcell")))},r.prototype.getGridSeletion=function(){return this.parent.allowSelection&&this.parent.selectionSettings.allowColumnSelection},r}(),sn=function(r){function i(e){return r.call(this,e)||this}return tn(i,r),i.prototype.getTable=function(){return this.parent.isFrozenGrid()?this.parent.getHeaderContent().querySelector(".e-movableheader .e-table"):this.parent.getHeaderTable()},i.prototype.onClick=function(e){var r=e.target;if(this.target=r,(r=r.classList.contains("e-headercell")?r:t.closest(r,"th"))||0===this.parent.frozenRows||(r=e.target.classList.contains(Ur)?e.target:t.closest(e.target,"td")),e.target.classList.contains("e-columnheader")||e.target.querySelector(".e-stackedheadercell"))return!1;if(r){var i=[r.parentElement.rowIndex,r.cellIndex],n=i[0],o=i[1],s=t.getValue(n+"."+o,this.matrix.matrix);if(this.matrix.inValid(s))return!1;this.matrix.select(r.parentElement.rowIndex,r.cellIndex)}},i.prototype.getFocusInfo=function(){var e={},r=this.matrix.current,i=r[0],n=void 0===i?0:i,o=r[1],s=void 0===o?0:o;return e.element=this.getTable().rows[parseInt(n.toString(),10)].cells[parseInt(s.toString(),10)],t.isNullOrUndefined(e.element)||(e.elementToFocus=this.getFocusable(e.element),e.outline=!e.element.classList.contains("e-filterbarcell")),e},i.prototype.selector=function(r,i){return i.visible&&(void 0!==i.column.field||i.isTemplate||!t.isNullOrUndefined(i.column.template)||!t.isNullOrUndefined(i.column.commands))||"checkbox"===i.column.type||i.cellType===e.CellType.StackedHeader},i.prototype.jump=function(e,r){var i=this.parent.getFrozenLeftCount()&&("leftArrow"===e||"shiftLeft"===e&&this.getGridSeletion()||"shiftTab"===e)&&(0===r[1]||r[1]===this.matrix.matrix[r[0]].indexOf(1))||"Left"===this.parent.getFrozenMode()&&"tab"===e&&r[1]===this.matrix.matrix[r[0]].lastIndexOf(1),n=("rightArrow"===e||"shiftRight"===e&&this.getGridSeletion()||"tab"===e)&&(r[1]===this.matrix.columns||r[1]===this.matrix.matrix[r[0]].lastIndexOf(1))||r[0]>0&&"shiftTab"===e&&"Right"===this.parent.getFrozenMode()&&r[1]===this.matrix.matrix[r[0]].indexOf(1),o=this.parent.getFrozenMode()===ri&&n;"Right"===this.parent.getFrozenMode()&&(i=n);var s,a,l=0!==this.parent.frozenRows&&"enter"===e,h=i&&!("Left"===this.parent.getFrozenMode()&&"tab"===e&&r[0]===this.matrix.matrix.length-1)||o,p=this.parent.focusModule.fHeader&&this.parent.focusModule.fHeader.matrix.matrix,d=p&&!t.isNullOrUndefined(p[r[0]]);return this.parent.enableHeaderFocus&&"tab"===e&&(a=this.matrix.matrix.length-1===r[0],(s=r[1]===this.matrix.matrix[r[0]].lastIndexOf(1))&&(this.matrix.current[0]=a?0:this.matrix.current[0]+1,this.matrix.current[1]=-1),this.parent.isFrozenGrid()&&a&&s&&(i=!0,h=!1)),"tab"===e&&"Left"===this.parent.getFrozenMode()&&r[0]===this.matrix.matrix.length-1&&r[1]===this.matrix.matrix[r[0]].lastIndexOf(1)&&(this.matrix.current[0]=-1),{swap:("downArrow"===e||l)&&r[0]===this.matrix.matrix.length-1||d&&(i||o)||"tab"===e&&a&&s,toHeader:h,toFrozen:i,toFrozenRight:o}},i.prototype.getNextCurrent=function(e,t,r,i){void 0===e&&(e=[]);var n=[];return"Right"===this.parent.getFrozenMode()||this.parent.getFrozenMode()===ri?(("leftArrow"===i||"shiftLeft"===i&&this.getGridSeletion()||"shiftTab"===i)&&(n[0]=e[0],n[1]=this.matrix.matrix[n[0]].length),this.parent.getFrozenMode()===ri&&("rightArrow"===i||"shiftRight"===i&&this.getGridSeletion()||"tab"===i)&&(n[0]=e[0],n[1]=-1)):("rightArrow"===i||"shiftRight"===i&&this.getGridSeletion()||"tab"===i)&&(n[0]=e[0],n[1]=-1),"upArrow"!==i&&"shiftEnter"!==i||(n[0]=this.matrix.matrix.length,n[1]=e[1]),"Left"===this.parent.getFrozenMode()&&"shiftTab"===i&&(n[0]=-1===e[0]?this.matrix.matrix.length-1:e[0]-1,n[1]=this.matrix.matrix[n[0]].length),"Right"===this.parent.getFrozenMode()&&"tab"===i&&(n[0]=e[0]+1,n[1]=-1),n},i.prototype.generateRows=function(e){var t=this.matrix.matrix.length;if(this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type){this.matrix.rows=++this.matrix.rows;for(var r=e[0].cells,i=0,n="FixedHeaderFocus"===this.getHeaderType()&&"Right"!==this.parent.getFrozenMode()?ni:"FixedHeaderFocus"===this.getHeaderType()||"FixedRightHeaderFocus"===this.getHeaderType()?ii:"movable",o=0;o<r.length;o++)r[parseInt(o.toString(),10)].column&&r[parseInt(o.toString(),10)].column.columns?i=this.checkFilterColumn(r[parseInt(o.toString(),10)].column.columns,t,i,n):(!this.parent.isFrozenGrid()||this.parent.isFrozenGrid()&&r[parseInt(o.toString(),10)].column.freezeTable===n)&&(this.matrix.set(t,i,r[parseInt(o.toString(),10)].visible&&!1!==r[parseInt(o.toString(),10)].column.allowFiltering),i++)}},i.prototype.checkFilterColumn=function(e,t,r,i){for(var n=e,o=r,s=0;s<n.length;s++)n[parseInt(s.toString(),10)].columns?o=this.checkFilterColumn(n[parseInt(s.toString(),10)].columns,t,o,i):(!this.parent.isFrozenGrid()||this.parent.isFrozenGrid()&&n[parseInt(s.toString(),10)].freezeTable===i)&&(this.matrix.set(t,o,n[parseInt(s.toString(),10)].visible&&!1!==n[parseInt(s.toString(),10)].allowFiltering),o++);return o},i.prototype.getInfo=function(e){return t.extend(r.prototype.getInfo.call(this,e),{isContent:!1,isHeader:!0})},i.prototype.validator=function(){return function(){return!0}},i.prototype.shouldFocusChange=function(e){var r=this.matrix.current,i=r[0],n=r[1];if(i<0||n<0)return!0;var o=t.getValue(i+".cells."+n,this.getTable().rows);return!o||("enter"!==e.action&&"altDownArrow"!==e.action||!o.classList.contains("e-headercell"))},i.prototype.getHeaderType=function(){return"HeaderFocus"},i}(on),an=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tn(t,e),t.prototype.getTable=function(){return this.parent.getContent().querySelector(".e-frozencontent .e-table")},t.prototype.jump=function(e,t){var r=0!==this.parent.frozenRows&&"shiftEnter"===e,i=("upArrow"===e||r)&&0===t[0]||"shiftTab"===e&&"Right"!==this.parent.getFrozenMode()&&0===t[0]&&t[1]===this.matrix.matrix[t[0]].indexOf(1),n=("upArrow"===e||r)&&0===t[0],o="shiftTab"===e&&this.parent.getFrozenMode()===ri&&t[1]===this.matrix.matrix[t[0]].indexOf(1);return"Right"===this.parent.getFrozenMode()?{swap:i||("shiftTab"===e||"leftArrow"===e)&&0===t[1]||"tab"===e&&t[0]<this.matrix.matrix.length-1&&t[1]===this.matrix.matrix[t[0]].lastIndexOf(1),toHeader:i,toFrozen:n}:("shiftTab"===e&&0===t[0]&&t[1]===this.matrix.matrix[t[0]].indexOf(1)&&(this.matrix.current[0]=-1),{swap:i||("tab"===e||"rightArrow"===e)&&t[1]===this.matrix.matrix[t[0]].lastIndexOf(1)||"shiftTab"===e&&t[1]===this.matrix.matrix[t[0]].indexOf(1),toHeader:i,toFrozen:n,toFrozenRight:o})},t.prototype.getNextCurrent=function(e,t,r,i){void 0===e&&(e=[]);var n=[];return"Right"===this.parent.getFrozenMode()?("rightArrow"!==i&&"tab"!==i||(n[0]=e[0],n[1]=-1),"shiftTab"===i&&(n[0]=e[0]-1,n[1]=this.matrix.matrix[n[0]].length)):("tab"===i&&this.parent.enableHeaderFocus&&(n[0]=e[0],n[1]=-1),"leftArrow"!==i&&"shiftTab"!==i||(n[0]=e[0],n[1]=this.matrix.matrix[e[0]].length)),"downArrow"!==i&&"enter"!==i||(n[0]=-1,n[1]=e[1]),"tab"===i&&"Right"!==this.parent.getFrozenMode()&&(n[0]=e[0]+1,n[1]=-1),n},t}(on),ln=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return tn(r,e),r.prototype.jump=function(e,r){var i=0!==this.parent.frozenRows&&"enter"===e,n=this.parent.focusModule.header&&this.parent.focusModule.header.matrix.matrix,o=n&&!t.isNullOrUndefined(n[r[0]]);if("Right"===this.parent.getFrozenMode()){var s=("leftArrow"===e||"shiftLeft"===e&&this.getGridSeletion()||"shiftTab"===e)&&(0===r[1]||r[1]===this.matrix.matrix[r[0]].indexOf(1))||r[0]<this.matrix.matrix.length-1&&"tab"===e&&r[1]===this.matrix.matrix[r[0]].lastIndexOf(1),a=("downArrow"===e||i||"tab"===e&&r[1]===this.matrix.matrix[r[0]].lastIndexOf(1))&&r[0]===this.matrix.matrix.length-1||o&&s,l=("downArrow"===e||i)&&r[0]===this.matrix.matrix.length-1;return"tab"===e&&r[0]===this.matrix.matrix.length-1&&r[1]===this.matrix.matrix[r[0]].lastIndexOf(1)&&(this.matrix.current[0]=-1),{swap:a,toHeader:s,toFrozen:l}}var h=r[0]>0&&"shiftTab"===e&&this.parent.getFrozenMode()===ri&&r[1]===this.matrix.matrix[r[0]].indexOf(1);return{swap:("downArrow"===e||i)&&r[0]===this.matrix.matrix.length-1||("rightArrow"===e||"shiftRight"===e&&this.getGridSeletion()||"tab"===e)&&(r[1]===this.matrix.columns||r[1]===this.matrix.matrix[r[0]].lastIndexOf(1))&&o||"tab"===e&&r[1]===this.matrix.matrix[r[0]].lastIndexOf(1)||"shiftTab"===e&&r[1]===this.matrix.matrix[r[0]].indexOf(1)&&r[0]>0,toHeader:("rightArrow"===e||"shiftRight"===e&&this.getGridSeletion()||"tab"===e)&&(r[1]===this.matrix.columns||r[1]===this.matrix.matrix[r[0]].lastIndexOf(1))||"tab"===e&&r[1]===this.matrix.matrix[r[0]].lastIndexOf(1)||"shiftTab"===e&&r[1]===this.matrix.matrix[r[0]].indexOf(1)&&r[0]>0,toFrozen:("downArrow"===e||i)&&r[0]===this.matrix.matrix.length-1,toFrozenRight:h}},r.prototype.getTable=function(){return this.parent.getHeaderContent().querySelector(".e-frozenheader .e-table")},r.prototype.getNextCurrent=function(e,t,r,i){void 0===e&&(e=[]);var n=[];return"Right"===this.parent.getFrozenMode()?(("rightArrow"===i||"shiftRight"===i&&this.getGridSeletion()||"tab"===i)&&(n[0]=e[0],n[1]=-1),"shiftTab"===i&&(n[0]=-1===e[0]?this.matrix.matrix.length-1:e[0]-1,n[1]=this.matrix.matrix[n[0]].length)):("leftArrow"===i||"shiftLeft"===i&&this.getGridSeletion()||"shiftTab"===i)&&(n[0]=e[0],n[1]=this.matrix.matrix[n[0]].length),"upArrow"!==i&&"shiftEnter"!==i||(n[0]=this.matrix.matrix.length,n[1]=e[1]),"tab"===i&&"Right"!==this.parent.getFrozenMode()&&(n[0]=e[0]+1,n[1]=-1),n},r.prototype.getHeaderType=function(){return"FixedHeaderFocus"},r}(sn),hn=function(){function e(e){this.searchBox=e}return e.prototype.searchFocus=function(e){if(e.target.parentElement.classList.add("e-input-focus"),e.target.classList.contains("e-input")&&e.target.classList.contains("e-search")&&e.target.value){var t=e.target.parentElement.querySelector(".e-sicon");t.classList.add("e-clear-icon"),t.setAttribute("title","Clear"),t.style.cursor="pointer"}},e.prototype.searchBlur=function(e){var t=e.relatedTarget?e.relatedTarget:null;if(t&&t.classList.contains("e-sicon")?t.classList.contains("e-clear-icon")&&e.target.parentElement.classList.remove("e-input-focus"):e.target.parentElement.classList.remove("e-input-focus"),e.target.classList.contains("e-search")&&t&&!t.classList.contains("e-sicon e-clear-icon")&&!t.classList.contains("e-sicon")){var r=e.target.parentElement.querySelector(".e-sicon");r.classList.remove("e-clear-icon"),r.removeAttribute("title"),r.style.cursor="default"}},e.prototype.wireEvent=function(){this.searchBox&&(t.EventHandler.add(this.searchBox,"focus",this.searchFocus,this),t.EventHandler.add(this.searchBox,"blur",this.searchBlur,this))},e.prototype.unWireEvent=function(){this.searchBox&&(t.EventHandler.remove(this.searchBox,"focus",this.searchFocus),t.EventHandler.remove(this.searchBox,"blur",this.searchBlur))},e}(),pn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tn(t,e),t.prototype.getTable=function(){return this.parent.getContent().querySelector(".e-frozen-right-content .e-table")},t.prototype.jump=function(e,t){var r=0!==this.parent.frozenRows&&"shiftEnter"===e,i=("upArrow"===e||r)&&0===t[0],n=this.parent.getFrozenMode()===ri&&"tab"===e&&t[1]===this.matrix.matrix[t[0]].lastIndexOf(1);return{swap:i||("shiftTab"===e||"leftArrow"===e)&&0===t[1]||"tab"===e&&t[0]<this.matrix.matrix.length-1&&t[1]===this.matrix.matrix[t[0]].lastIndexOf(1),toHeader:i,toFrozenRight:i,toFrozen:n}},t.prototype.getNextCurrent=function(e,t,r,i){void 0===e&&(e=[]);var n=[];return"rightArrow"!==i&&"tab"!==i||(n[0]=e[0],n[1]=-1),"downArrow"!==i&&"enter"!==i||(n[0]=-1,n[1]=e[1]),"shiftTab"===i&&(n[0]=e[0]-1,n[1]=this.matrix.matrix[n[0]].length),n},t}(on),dn=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return tn(r,e),r.prototype.jump=function(e,r){var i=this.parent.focusModule.header&&this.parent.focusModule.header.matrix.matrix,n=i&&!t.isNullOrUndefined(i[r[0]]),o=0!==this.parent.frozenRows&&"enter"===e,s=("leftArrow"===e||"shiftLeft"===e&&this.getGridSeletion()||"shiftTab"===e)&&(0===r[1]||r[1]===this.matrix.matrix[r[0]].indexOf(1))||r[0]<this.matrix.matrix.length-1&&"tab"===e&&r[1]===this.matrix.matrix[r[0]].lastIndexOf(1),a=("downArrow"===e||o||"tab"===e&&r[1]===this.matrix.matrix[r[0]].lastIndexOf(1))&&r[0]===this.matrix.matrix.length-1||n&&s,l="tab"===e&&r[1]===this.matrix.matrix[r[0]].lastIndexOf(1),h=("downArrow"===e||o)&&r[0]===this.matrix.matrix.length-1;return"tab"===e&&r[0]===this.matrix.matrix.length-1&&r[1]===this.matrix.matrix[r[0]].lastIndexOf(1)&&(this.matrix.current[0]=-1),{swap:a,toHeader:s,toFrozen:l,toFrozenRight:h}},r.prototype.getTable=function(){return this.parent.getHeaderContent().querySelector(".e-frozen-right-header .e-table")},r.prototype.getNextCurrent=function(e,t,r,i){void 0===e&&(e=[]);var n=[];return("rightArrow"===i||"shiftRight"===i&&this.getGridSeletion()||"tab"===i)&&(n[0]=e[0],n[1]=-1),"upArrow"!==i&&"shiftEnter"!==i||(n[0]=this.matrix.matrix.length,n[1]=e[1]),"shiftTab"===i&&(n[0]=-1===e[0]?this.matrix.matrix.length-1:e[0]-1,n[1]=this.matrix.matrix[n[0]].length),n},r.prototype.getHeaderType=function(){return"FixedRightHeaderFocus"},r}(sn),cn=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),un=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},gn=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return cn(r,e),un([t.Property(12)],r.prototype,"pageSize",void 0),un([t.Property(8)],r.prototype,"pageCount",void 0),un([t.Property(1)],r.prototype,"currentPage",void 0),un([t.Property()],r.prototype,"totalRecordsCount",void 0),un([t.Property(!1)],r.prototype,"enableQueryString",void 0),un([t.Property(!1)],r.prototype,"pageSizes",void 0),un([t.Property(null)],r.prototype,"template",void 0),r}(t.ChildProperty),fn=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),mn=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},yn=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return fn(r,e),mn([t.Property("startsWith")],r.prototype,"operator",void 0),mn([t.Property(!1)],r.prototype,"ignoreAccent",void 0),r}(t.ChildProperty),vn=function(){return(vn=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)},Cn=function(){function i(e,t,r){this.selectedRowIndexes=[],this.selectedRowCellIndexes=[],this.selectedRecords=[],this.preventFocus=!1,this.selectedColumnsIndexes=[],this.checkBoxState=!1,this.isMultiShiftRequest=!1,this.isMultiCtrlRequest=!1,this.enableSelectMultiTouch=!1,this.clearRowCheck=!1,this.selectRowCheck=!1,this.selectedRowState={},this.unSelectedRowState={},this.totalRecordsCount=0,this.chkAllCollec=[],this.isCheckedOnAdd=!1,this.persistSelectedData=[],this.deSelectedData=[],this.isHdrSelectAllClicked=!1,this.needColumnSelection=!1,this.isCancelDeSelect=!1,this.isPreventCellSelect=!1,this.disableUI=!1,this.isPersisted=!1,this.cmdKeyPressed=!1,this.cellselected=!1,this.isMultiSelection=!1,this.isAddRowsToSelection=!1,this.initialRowSelection=!1,this.isPrevRowSelection=!1,this.isKeyAction=!1,this.isRowDragSelected=!1,this.isPartialSelection=!1,this.rmtHdrChkbxClicked=!1,this.isCheckboxReset=!1,this.autoFillRLselection=!0,this.bottom="0 0 2px 0",this.top="2px 0 0 0",this.right_bottom="0 2px 2px 0",this.bottom_left="0 0 2px 2px",this.top_right="2px 2px 0 0",this.top_left="2px 0 0 2px",this.top_bottom="2px 0 2px 0",this.top_right_bottom="2px 2px 2px 0",this.top_bottom_left="2px 0 2px 2px",this.top_right_left="2px 2px 0 2px",this.right_bottom_left="0 2px 2px 2px",this.all_border="2px",this.parent=e,this.selectionSettings=t,this.factory=r.getService("rendererFactory"),this.focus=r.getService("focus"),this.addEventListener(),this.wireEvents()}return i.prototype.initializeSelection=function(){this.parent.log("selection_key_missing"),this.render()},i.prototype.onActionBegin=function(e,t){this.parent.trigger(t,this.fDataUpdate(e))},i.prototype.fDataUpdate=function(e){if(!(this.isMultiSelection||t.isNullOrUndefined(e.cellIndex)&&t.isNullOrUndefined(e.rowIndex))){var r=this.getRowObj(t.isNullOrUndefined(e.rowIndex)?t.isNullOrUndefined(e.cellIndex)?this.currentIndex:e.cellIndex.rowIndex:e.rowIndex);e.foreignKeyData=r.foreignKeyData}return e},i.prototype.onActionComplete=function(e,t){this.parent.trigger(t,this.fDataUpdate(e)),this.isMultiSelection=!1},i.prototype.getModuleName=function(){return"selection"},i.prototype.destroy=function(){var e=this.parent.element;e&&(e.querySelector("."+jr)||e.querySelector("."+Vr))&&(this.hidePopUp(),this.clearSelection(),this.removeEventListener(),this.unWireEvents(),t.EventHandler.remove(this.parent.getContent(),"mousedown",this.mouseDownHandler),t.EventHandler.remove(this.parent.getHeaderContent(),"mousedown",this.mouseDownHandler))},i.prototype.isEditing=function(){return("Normal"===this.parent.editSettings.mode||"Batch"===this.parent.editSettings.mode&&this.parent.editModule&&this.parent.editModule.formObj&&!this.parent.editModule.formObj.validate())&&this.parent.isEdit&&!this.parent.isPersistSelection},i.prototype.getSelectedMovableRow=function(e){var t=this.parent;return t.isFrozenGrid()&&this.parent.getContent().querySelector("."+Wr)?t.getMovableRowByIndex(e):null},i.prototype.getSelectedFrozenRightRow=function(e){var t=this.parent;return t.isFrozenGrid()&&t.getFrozenMode()===ri&&t.getFrozenRightContent()?t.getFrozenRightRowByIndex(e):null},i.prototype.getCurrentBatchRecordChanges=function(){var e=this.parent;if("Batch"===e.editSettings.mode&&e.editModule){var t=I(this.parent.getCurrentViewRecords());t="Bottom"===e.editSettings.newRowPosition?t.concat(this.parent.editModule.getBatchChanges().addedRecords):this.parent.editModule.getBatchChanges().addedRecords.concat(t);for(var r=this.parent.editModule.getBatchChanges().deletedRecords,i=this.parent.getPrimaryKeyFieldNames()[0],n=0;n<r.length;n++)for(var o=0;o<t.length;o++)if(r[parseInt(n.toString(),10)][""+i]===t[parseInt(o.toString(),10)][""+i]){t.splice(o,1);break}return t}return e.getCurrentViewRecords()},i.prototype.selectRow=function(e,t){if(this.selectedRowIndexes.length&&this.selectionSettings.enableSimpleMultiRowSelection)return void this.addRowsToSelection([e]);var r=this.parent,i=r.getRowByIndex(e),n=i&&r.getRowObjectFromUID(i.getAttribute("data-uid"));if(!(this.isPartialSelection&&n&&n.isDataRow)||n.isSelectable){var o,s=this.getSelectedMovableRow(e),a=this.getSelectedFrozenRightRow(e);if(r.enableVirtualization&&e>-1){var l={selectedIndex:e,isAvailable:!0};this.parent.notify("select-virtual-Row",l);var h=r.isFrozenGrid()?r.contentModule.getRowObjectByIndex(e):null;if(!i||!r.getRowObjectFromUID(i.getAttribute("data-uid"))&&!h)return void(l.isAvailable&&!r.selectionSettings.persistSelection&&this.parent.getSelectedRecords().length>0&&this.clearRowSelection());o=h||r.getRowObjectFromUID(i.getAttribute("data-uid")).data}else o=this.getRowObj(e).data;if(this.isRowType()&&i&&!this.isEditing()){var p=i.hasAttribute("aria-selected");this.activeTarget(),t=t?!!this.selectedRowIndexes.length&&(1===this.selectedRowIndexes.length&&((!this.isKeyAction||!this.parent.isCheckBoxSelection)&&e===this.selectedRowIndexes[0])):t,this.isKeyAction=!1;var d;t?this.rowSelectingCallBack(d,t,e,o,!1,p,"cancel")(d):(d={data:o,rowIndex:e,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,row:i,previousRow:r.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,target:this.actualTarget,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked},d=this.addMovableArgs(d,s,a),this.parent.trigger("rowSelecting",this.fDataUpdate(d),this.rowSelectingCallBack(d,t,e,o,!1,p,"cancel")))}}},i.prototype.rowSelectingCallBack=function(e,r,i,n,o,s,a){var l=this;return function(e){if(!t.isNullOrUndefined(e)&&!0===e[""+a])return void l.disableInteracted();l.index=i,l.toggle=r,l.data=n,l.removed=o,s&&l.selectionSettings.persistSelection&&"ResetOnRowClick"!==l.selectionSettings.checkboxMode?(l.clearSelectedRow(i),l.selectRowCallBack()):!s&&l.selectionSettings.persistSelection&&"ResetOnRowClick"!==l.selectionSettings.checkboxMode&&l.selectRowCallBack(),"ResetOnRowClick"===l.selectionSettings.checkboxMode&&(l.isCheckboxReset=!0,l.clearSelection()),(!l.selectionSettings.persistSelection||"ResetOnRowClick"===l.selectionSettings.checkboxMode||!l.parent.isCheckBoxSelection&&l.selectionSettings.persistSelection)&&(l.selectRowCheck=!0,l.clearRow())}},i.prototype.selectRowCallBack=function(){var e,t=this.parent,r=this.index,i=this.toggle,n=this.data,o=this.removed,s=t.getRowByIndex(r),a=this.getSelectedMovableRow(r),l=this.getSelectedFrozenRightRow(r);i||o||(this.selectedRowIndexes.indexOf(r)<=-1&&(this.updateRowSelection(s,r),this.selectMovableRow(a,l,r)),this.selectRowIndex(r)),i||(e={data:n,rowIndex:r,row:s,previousRow:t.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,target:this.actualTarget,isInteracted:this.isInteracted,isHeaderCheckBoxClicked:this.isHeaderCheckboxClicked,rowIndexes:r},e=this.addMovableArgs(e,a,l),this.onActionComplete(e,"rowSelected")),this.isInteracted=!1,this.updateRowProps(r)},i.prototype.selectMovableRow=function(e,t,r){this.parent.isFrozenGrid()&&(this.updateRowSelection(e,r),this.parent.getFrozenMode()===ri&&t&&this.updateRowSelection(t,r))},i.prototype.addMovableArgs=function(e,t,r){if(this.parent.isFrozenGrid()){var i={mRow:t,previousMovRow:this.parent.getMovableRows()[this.prevRowIndex]};this.parent.getFrozenMode()===ri&&r&&(i.frozenRightRow=r,i.previousFrozenRightRow=this.parent.getFrozenRightDataRows()[this.prevRowIndex]),e=vn({},e,i)}return e},i.prototype.selectRowsByRange=function(e,t){this.selectRows(this.getCollectionFromIndexes(e,t)),this.selectRowIndex(t)},i.prototype.selectedDataUpdate=function(e,t,r,i,n){for(var o=0,s=i.length;o<s;o++){var a=this.parent.getDataRows()[i[parseInt(o.toString(),10)]];this.parent.enableVirtualization&&(a=this.parent.getRowByIndex(i[parseInt(o.toString(),10)]));var l=this.getRowObj(a);l&&l.isDataRow&&l.isSelectable?(e.push(l.data),r.push(a),t.push(l.foreignKeyData)):this.isPartialSelection&&n&&n.splice(n.indexOf(i[parseInt(o.toString(),10)]),1)}},i.prototype.selectRows=function(e){var r=this,i=this.parent,n=e.slice(),o=this.isSingleSel()?e[e.length-1]:e[0];this.isMultiSelection=!0;var s=[],a=[],l=this.getSelectedMovableRow(o),h=this.getSelectedFrozenRightRow(o),p=[];if(this.isRowType()&&!this.isEditing()){this.selectedDataUpdate(p,a,s,e,n),this.activeTarget();var d={cancel:!1,rowIndexes:n,row:s,rowIndex:o,target:this.actualTarget,prevRow:i.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,isInteracted:this.isInteracted,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,data:p,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,foreignKeyData:a};d=this.addMovableArgs(d,l,h),this.parent.trigger("rowSelecting",this.fDataUpdate(d),function(e){if(!t.isNullOrUndefined(e)&&!0===e.cancel)return void r.disableInteracted();r.clearRow(),r.selectRowIndex(n.slice(-1)[0]);var p=function(e,t){if(r.updateRowSelection(i.getRowByIndex(e),e,t),i.isFrozenGrid()){var n=r.parent.getFrozenMode()===ri?i.getFrozenRightRowByIndex(e):void 0;r.selectMovableRow(i.getMovableRowByIndex(e),n,e)}r.updateRowProps(o)};if(r.isSingleSel())p(o);else for(var d=0,c=n;d<c.length;d++)p(c[d],!!i.enableVirtualization);e={rowIndexes:n,row:s,rowIndex:o,target:r.actualTarget,prevRow:i.getRows()[r.prevRowIndex],previousRowIndex:r.prevRowIndex,data:r.getSelectedRecords(),isInteracted:r.isInteracted,isHeaderCheckboxClicked:r.isHeaderCheckboxClicked,foreignKeyData:a},e=r.addMovableArgs(e,l,h),r.isRowSelected&&r.onActionComplete(e,"rowSelected"),r.isInteracted=!1})}},i.prototype.addRowsToSelection=function(e){var r=this.parent,i=this.target;this.isMultiSelection=!0;var n=[],o=[],s=[],a=r.getSelectedRowIndexes().concat(e),l=this.isSingleSel()?r.getRowByIndex(e[e.length-1]):r.getRowByIndex(e[0]),h=this.isSingleSel()?this.getSelectedMovableRow(e[e.length-1]):this.getSelectedMovableRow(e[0]),p=this.isSingleSel()?this.getSelectedFrozenRightRow(e[e.length-1]):this.getSelectedFrozenRightRow(e[0]);if(this.isRowType()&&!this.isEditing()||this.selectionSettings.checkboxOnly){var d,c=this.parent.getColumns().filter(function(e){return"checkbox"===e.type});this.isMultiCtrlRequest&&!c.length&&this.selectedDataUpdate(s,o,n,a);for(var u=0,g=e;u<g.length;u++){var f=g[u],m=this.getRowObj(f),y=this.selectedRowIndexes.indexOf(f)>-1;if(!(this.isPartialSelection&&m&&m.isDataRow)||m.isSelectable){if(this.selectRowIndex(f),y&&(c.length||this.selectionSettings.enableToggle||this.isMultiCtrlRequest)){if(this.isAddRowsToSelection=!0,this.rowDeselect("rowDeselecting",[f],[m.data],[l],[m.foreignKeyData],i),this.isCancelDeSelect)return;this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(f),1),this.selectedRecords.splice(this.selectedRecords.indexOf(l),1),this.selectRowIndex(this.selectedRowIndexes.length?this.selectedRowIndexes[this.selectedRowIndexes.length-1]:-1),l.removeAttribute("aria-selected"),this.addRemoveClassesForRow(l,!1,null,"e-selectionbackground","e-active"),h&&(this.selectedRecords.splice(this.selectedRecords.indexOf(h),1),h.removeAttribute("aria-selected"),this.addRemoveClassesForRow(h,!1,null,"e-selectionbackground","e-active")),p&&(this.selectedRecords.splice(this.selectedRecords.indexOf(p),1),p.removeAttribute("aria-selected"),this.addRemoveClassesForRow(p,!1,null,"e-selectionbackground","e-active")),this.rowDeselect("rowDeselected",[f],[m.data],[l],[m.foreignKeyData],i,[h],void 0,[p]),this.isInteracted=!1,this.isMultiSelection=!1,this.isAddRowsToSelection=!1,this.isHdrSelectAllClicked=!1}else{if(this.activeTarget(),d={cancel:!1,data:s.length?s:m.data,rowIndex:f,row:n.length?n:l,target:this.actualTarget,prevRow:r.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,foreignKeyData:o.length?o:m.foreignKeyData,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,rowIndexes:a},d=this.addMovableArgs(d,h,p),this.parent.trigger("rowSelecting",this.fDataUpdate(d)),!t.isNullOrUndefined(d)&&!0===d.cancel)return void this.disableInteracted();this.isSingleSel()&&this.clearRow(),this.updateRowSelection(l,f),this.selectMovableRow(h,p,f)}if(y||(d={data:s.length?s:m.data,rowIndex:f,row:n.length?n:l,target:this.actualTarget,prevRow:r.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,foreignKeyData:o.length?o:m.foreignKeyData,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,rowIndexes:a},d=this.addMovableArgs(d,h,p),this.onActionComplete(d,"rowSelected")),this.isInteracted=!1,this.updateRowProps(f),this.isSingleSel())break}}}},i.prototype.getCollectionFromIndexes=function(e,t){for(var r=[],i=e<=t?{i:e,max:t}:{i:t,max:e},n=i.i,o=i.max;n<=o;n++)r.push(n);return e>t&&r.reverse(),r},i.prototype.clearRow=function(){this.clearRowCheck=!0,this.clearRowSelection()},i.prototype.clearRowCallBack=function(){this.isCancelDeSelect&&"Check"!==this.parent.checkAllRows||(this.selectedRowIndexes=[],this.selectedRecords=[],this.selectRowIndex(-1),this.isSingleSel()&&this.parent.isPersistSelection&&(this.selectedRowState={}))},i.prototype.clearSelectedRow=function(e){if(this.toggle){var t=this.parent.getRowByIndex(e);this.disableUI||(t.removeAttribute("aria-selected"),this.addRemoveClassesForRow(t,!1,!0,"e-selectionbackground","e-active")),this.removed=!0,this.updatePersistCollection(t,!1),this.updateCheckBoxes(t),this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(e),1),this.selectedRecords.splice(this.selectedRecords.indexOf(this.parent.getRowByIndex(e)),1)}},i.prototype.updateRowProps=function(e){this.prevRowIndex=e,this.isRowSelected=this.selectedRowIndexes.length&&!0},i.prototype.getPkValue=function(e,t){return e&&_(e)?ge(e,t):t[""+e]},i.prototype.updatePersistCollection=function(e,r){var i=this;if((this.parent.isPersistSelection||this.parent.selectionSettings.persistSelection&&this.parent.getPrimaryKeyFieldNames().length>0)&&!t.isNullOrUndefined(e)){this.parent.isPersistSelection||this.ensureCheckboxFieldSelection();var n=this.getRowObj(e),o=n.data?this.getPkValue(this.primaryKey,n.data):null;if(null===o)return;n.isSelected=r,r&&!this.isPartialSelection||this.isPartialSelection&&n.isSelectable&&n.isSelected?(this.selectedRowState[""+o]=r,delete this.unSelectedRowState[""+o],this.persistSelectedData.some(function(e){return i.getPkValue(i.primaryKey,e)===o})||this.persistSelectedData.push(n.data)):this.updatePersistDelete(o)}},i.prototype.updatePersistDelete=function(e,t){var r=this;delete this.selectedRowState[""+e],this.rmtHdrChkbxClicked&&(this.unSelectedRowState[""+e]=!0);var i;this.persistSelectedData.some(function(t,n){return i=n,r.getPkValue(r.primaryKey,t)===e})&&(this.persistSelectedData.splice(i,1),t&&this.parent.partialSelectedRecords.splice(i,1))},i.prototype.updateCheckBoxes=function(e,r,i){if(!t.isNullOrUndefined(e)){var n=e.querySelector(".e-checkselect");t.isNullOrUndefined(n)||(se(n.nextElementSibling,r),ne(n,r),(t.isNullOrUndefined(this.checkedTarget)||!t.isNullOrUndefined(this.checkedTarget)&&!this.checkedTarget.classList.contains("e-checkselectall"))&&this.setCheckAllState(i))}},i.prototype.updateRowSelection=function(e,t,r){if(e){this.selectedRowIndexes.push(t);var i=this.selectedRowIndexes.length;if(this.parent.isFrozenGrid()&&i>1&&this.selectedRowIndexes[i-2]===this.selectedRowIndexes[i-1]&&this.selectedRowIndexes.pop(),this.selectedRecords.push(e),e.setAttribute("aria-selected","true"),this.updatePersistCollection(e,!0),this.updateCheckBoxes(e,!0),this.addRemoveClassesForRow(e,!0,null,"e-selectionbackground","e-active"),!this.preventFocus){var n=this.focus.getPrevIndexes().cellIndex?e.cells[this.focus.getPrevIndexes().cellIndex]:e.querySelector(".e-selectionbackground:not(.e-hide):not(.e-detailrowcollapse):not(.e-detailrowexpand)");if(this.parent.contextMenuModule&&2===this.mouseButton&&(n=this.parent.contextMenuModule.cell),!n||r)return;this.focus.onClick({target:n},!0)}}},i.prototype.clearSelection=function(){if(this.checkSelectAllClicked=!0,this.selectionSettings.persistSelection&&this.persistSelectedData.length&&(this.deSelectedData=I(this.persistSelectedData)),!this.parent.isPersistSelection||this.parent.isPersistSelection&&!this.parent.isEdit||!t.isNullOrUndefined(this.checkedTarget)&&this.checkedTarget.classList.contains("e-checkselectall")){var e=this.parent.element.querySelector(".e-gridpopup").querySelector("span");e.classList.contains("e-rowselect")&&e.classList.remove("e-spanclicked"),this.parent.isPersistSelection&&(this.persistSelectedData=[],this.selectedRowState={}),this.clearRowSelection(),this.clearCellSelection(),this.clearColumnSelection(),this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevECIdxs=void 0,this.enableSelectMultiTouch=!1,this.isInteracted=!1,this.checkSelectAllClicked=!1,this.isHdrSelectAllClicked=!1}},i.prototype.clearRowSelection=function(){var e=this;if(this.isRowSelected){for(var t=this.parent,r=this.parent.getDataRows(),i=[],n=[],o=[],s=[],a=[],l=[],h=this.target,p=0,d=this.selectedRowIndexes.length;p<d;p++){var c="Batch"===this.parent.editSettings.mode?this.parent.getRows()[this.selectedRowIndexes[parseInt(p.toString(),10)]]:this.parent.getDataRows()[this.selectedRowIndexes[parseInt(p.toString(),10)]],u=this.getRowObj(c);if(u&&(i.push(u.data),n.push(c),a.push(this.selectedRowIndexes[parseInt(p.toString(),10)]),l.push(u.foreignKeyData)),t.isFrozenGrid()){var g=t.getMovableRows();if(g&&g.length&&o.push(g[this.selectedRowIndexes[parseInt(p.toString(),10)]]),t.getFrozenMode()===ri){var f=t.getFrozenRightRows();f&&f.length&&s.push(f[this.selectedRowIndexes[parseInt(p.toString(),10)]])}}}this.selectionSettings.persistSelection&&"ResetOnRowClick"!==this.selectionSettings.checkboxMode&&(this.isRowClicked=!!this.checkSelectAllClicked),this.rowDeselect("rowDeselecting",a,i,n,l,h,o,function(){if(e.isCancelDeSelect&&(e.isRowClicked||e.checkSelectAllClicked||e.isInteracted&&!e.parent.isPersistSelection)){if(e.parent.isPersistSelection)if("Intermediate"===e.getCheckAllStatus(e.parent.element.querySelector(".e-checkselectall")))for(d=0;d<e.selectedRecords.length;d++)e.updatePersistCollection(e.selectedRecords[parseInt(d.toString(),10)],!0);else e.parent.checkAllRows="Check",e.updatePersistSelectedData(!0);return void(e.clearRowCheck&&(e.clearRowCallBack(),e.clearRowCheck=!1,e.selectRowCheck&&(e.selectRowCallBack(),e.selectRowCheck=!1)))}for(var t=[].slice.call(r.filter(function(e){return e.hasAttribute("aria-selected")})),p=0;p<t.length;p++)e.disableUI||(t[parseInt(p.toString(),10)].removeAttribute("aria-selected"),e.addRemoveClassesForRow(t[parseInt(p.toString(),10)],!1,!0,"e-selectionbackground","e-active")),e.isPrevRowSelection||e.updatePersistCollection(t[parseInt(p.toString(),10)],!1),e.updateCheckBoxes(t[parseInt(p.toString(),10)]);for(var d=0,c=e.selectedRowIndexes.length;d<c;d++){var u=e.getSelectedMovableRow(e.selectedRowIndexes[parseInt(d.toString(),10)]);u&&(e.disableUI||(u.removeAttribute("aria-selected"),e.addRemoveClassesForRow(u,!1,!0,"e-selectionbackground","e-active")),e.updateCheckBoxes(u),e.isPrevRowSelection||e.updatePersistCollection(u,!1));var g=e.getSelectedFrozenRightRow(e.selectedRowIndexes[parseInt(d.toString(),10)]);g&&(e.disableUI||(g.removeAttribute("aria-selected"),e.addRemoveClassesForRow(g,!1,!0,"e-selectionbackground","e-active")),e.updateCheckBoxes(g),e.isPrevRowSelection||e.updatePersistCollection(g,!1))}e.selectedRowIndexes=[],e.selectedRecords=[],e.isRowSelected=!1,e.selectRowIndex(-1),e.isPrevRowSelection=!1,e.rowDeselect("rowDeselected",a,i,n,l,h,o,void 0,s),e.clearRowCheck&&(e.clearRowCallBack(),e.clearRowCheck=!1,e.selectRowCheck&&(e.selectRowCallBack(),e.selectRowCheck=!1))},s)}else this.clearRowCheck&&(this.clearRowCallBack(),this.clearRowCheck=!1,this.selectRowCheck&&(this.selectRowCallBack(),this.selectRowCheck=!1))},i.prototype.rowDeselect=function(e,r,i,n,o,s,a,l,h){var p=this;if(this.selectionSettings.persistSelection&&(this.isRowClicked||this.checkSelectAllClicked||this.focus.activeKey&&this.focus.currentInfo.element.classList.contains("e-gridchkbox")&&"space"===this.focus.activeKey)||!this.selectionSettings.persistSelection){var d=1===r.length&&1===this.deSelectedData.length,c={rowIndex:r[0],data:this.selectionSettings.persistSelection&&"Uncheck"===this.parent.checkAllRows&&!d&&"ResetOnRowClick"!==this.selectionSettings.checkboxMode?this.deSelectedData:i,foreignKeyData:o,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked};"rowDeselected"===e&&delete c.cancel;c.row=n,c.target=this.actualTarget,this.actualTarget&&!t.isNullOrUndefined(t.closest(this.actualTarget,"thead"))||r.length>1?(c.rowIndex=r[0],c.rowIndexes=r):1===r.length&&(c.data=c.data[0],c.row=c.row[0],c.foreignKeyData=c.foreignKeyData[0],this.isAddRowsToSelection&&(c.rowIndexes=r)),this.parent.trigger(e,this.parent.isFrozenGrid()?vn({},c,{mRow:a,frozenRightRow:h}):c,function(e){p.isCancelDeSelect=e.cancel,p.isCancelDeSelect&&(p.isRowClicked||p.isInteracted||p.checkSelectAllClicked)||(p.updatePersistCollection(n[0],!1),p.updateCheckBoxes(n[0],void 0,r[0]),a&&p.updateCheckBoxes(a[0],void 0,r[0]),h&&p.updateCheckBoxes(h[0],void 0,r[0])),void 0!==l&&l()})}else this.selectionSettings.persistSelection&&!this.isInteracted&&void 0!==l&&l()},i.prototype.getRowObj=function(e){return void 0===e&&(e=this.currentIndex),t.isNullOrUndefined(e)?{}:("number"==typeof e&&(e=this.parent.getRowByIndex(e)),e?this.parent.getRowObjectFromUID(e.getAttribute("data-uid"))||{}:{})},i.prototype.getSelectedMovableCell=function(e){var t=this.parent,r=t.getColumnByIndex(e.cellIndex);return t.isFrozenGrid()&&"movable"===r.getFreezeTableName()?t.getMovableCellFromIndex(e.rowIndex,this.getColIndex(e.rowIndex,e.cellIndex)):null},i.prototype.selectCell=function(e,r){if(this.isCellType()){var i,n=this.parent,o=this.getSelectedMovableCell(e);o||(o=n.getCellFromIndex(e.rowIndex,this.getColIndex(e.rowIndex,e.cellIndex))),this.currentIndex=e.rowIndex;var s=this.getCurrentBatchRecordChanges()[this.currentIndex];if(this.isCellType()&&o&&!this.isEditing()){var a=o.classList.contains("e-cellselectionbackground");if(r=r?!t.isUndefined(this.prevCIdxs)&&e.rowIndex===this.prevCIdxs.rowIndex&&e.cellIndex===this.prevCIdxs.cellIndex&&a:r)this.successCallBack(i,r,e,o,s)(i);else{(i={data:s,cellIndex:e,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0,cancel:!1}).currentCell=o;i.previousRowCellIndex=this.prevECIdxs,this.parent.trigger("cellSelecting",this.fDataUpdate(i),this.successCallBack(i,r,e,o,s)),this.cellselected=!0}}}},i.prototype.successCallBack=function(e,r,i,n,o){var s=this;return function(e){if((t.isNullOrUndefined(e)||!0!==e.cancel)&&(r||(e.currentCell=e.currentCell?e.currentCell:n),s.clearCell(),r||s.updateCellSelection(n,i.rowIndex,i.cellIndex),!r)){var a={data:o,cellIndex:i,currentCell:n,selectedRowCellIndex:s.selectedRowCellIndexes,previousRowCell:s.prevECIdxs?s.getCellIndex(s.prevECIdxs.rowIndex,s.prevECIdxs.cellIndex):void 0};a.previousRowCellIndex=s.prevECIdxs,s.updateCellProps(i,i),s.onActionComplete(a,"cellSelected")}}},i.prototype.getCellIndex=function(e,t){return this.parent.getFrozenColumns()&&t>=this.parent.getFrozenColumns()?this.parent.getMovableCellFromIndex(e,t):this.parent.getCellFromIndex(e,t)},i.prototype.selectCellsByRange=function(e,r){var i=this;if(this.isCellType()){var n=this.parent,o=this.getSelectedMovableCell(e),s=n.getFrozenColumns();o||(o=n.getCellFromIndex(e.rowIndex,e.cellIndex));var a,l,h,p=e,d=r=r||e;this.currentIndex=e.rowIndex;var c=this.getCurrentBatchRecordChanges()[this.currentIndex];if(!this.isSingleSel()&&this.isCellType()&&!this.isEditing()){var u={data:c,cellIndex:e,currentCell:o,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};u.previousRowCellIndex=this.prevECIdxs,this.parent.trigger("cellSelecting",this.fDataUpdate(u),function(u){if(t.isNullOrUndefined(u)||!0!==u.cancel){if(i.clearCell(),e.rowIndex>r.rowIndex){var g=e;e=r,r=g}for(var f=e.rowIndex;f<=r.rowIndex;f++){i.selectionSettings.cellSelectionMode.indexOf("Box")<0?(a=f===e.rowIndex?e.cellIndex:0,l=f===r.rowIndex?r.cellIndex:i.getLastColIndex(f)):(a=e.cellIndex,l=r.cellIndex),h=[];for(var m=a<l?a:l,y=a>l?a:l;m<=y;m++)(o=s?m<s?n.getCellFromIndex(f,m):n.getMovableCellFromIndex(f,m):n.getCellFromIndex(f,m))&&(h.push(m),i.updateCellSelection(o),i.addAttribute(o));i.selectedRowCellIndexes.push({rowIndex:f,cellIndexes:h})}var v={data:c,cellIndex:d,currentCell:n.getCellFromIndex(d.rowIndex,d.cellIndex),selectedRowCellIndex:i.selectedRowCellIndexes,previousRowCell:i.prevECIdxs?i.getCellIndex(i.prevECIdxs.rowIndex,i.prevECIdxs.cellIndex):void 0};v.previousRowCellIndex=i.prevECIdxs,i.isDragged||(i.onActionComplete(v,"cellSelected"),i.cellselected=!0),i.updateCellProps(p,d)}})}}},i.prototype.selectCells=function(e){if(this.isCellType()){var t=this.parent,r=this.getSelectedMovableCell(e[0]),i=t.getFrozenColumns();r||(r=t.getCellFromIndex(e[0].rowIndex,e[0].cellIndexes[0])),this.currentIndex=e[0].rowIndex;var n=this.getCurrentBatchRecordChanges()[this.currentIndex];if(!this.isSingleSel()&&this.isCellType()&&!this.isEditing()){var o={data:n,cellIndex:e[0].cellIndexes[0],currentCell:r,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};o.previousRowCellIndex=this.prevECIdxs,this.onActionBegin(o,"cellSelecting");for(var s=0,a=e.length;s<a;s++)for(var l=0,h=e[parseInt(s.toString(),10)].cellIndexes.length;l<h;l++)(r=i?e[parseInt(s.toString(),10)].cellIndexes[parseInt(l.toString(),10)]<i?t.getCellFromIndex(e[parseInt(s.toString(),10)].rowIndex,e[parseInt(s.toString(),10)].cellIndexes[parseInt(l.toString(),10)]):t.getMovableCellFromIndex(e[parseInt(s.toString(),10)].rowIndex,e[parseInt(s.toString(),10)].cellIndexes[parseInt(l.toString(),10)]):t.getCellFromIndex(e[parseInt(s.toString(),10)].rowIndex,e[parseInt(s.toString(),10)].cellIndexes[parseInt(l.toString(),10)]))&&(this.updateCellSelection(r),this.addAttribute(r),this.addRowCellIndex({rowIndex:e[parseInt(s.toString(),10)].rowIndex,cellIndex:e[parseInt(s.toString(),10)].cellIndexes[parseInt(l.toString(),10)]}));this.updateCellProps({rowIndex:e[0].rowIndex,cellIndex:e[0].cellIndexes[0]},{rowIndex:e[0].rowIndex,cellIndex:e[0].cellIndexes[0]});var p={data:n,cellIndex:e[0].cellIndexes[0],currentCell:r,selectedRowCellIndex:this.selectedRowCellIndexes,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};p.previousRowCellIndex=this.prevECIdxs,this.onActionComplete(p,"cellSelected")}}},i.prototype.addCellsToSelection=function(e){if(this.isCellType()){var r,i,n=this.parent;this.currentIndex=e[0].rowIndex;var o=this.getCurrentBatchRecordChanges()[this.currentIndex],s=n.getFrozenLeftCount(),a=n.getMovableColumnsCount();if(!this.isSingleSel()&&this.isCellType()&&!this.isEditing()){this.hideAutoFill();var l,h=n.getColumnByIndex(e[0].cellIndex);Ne(this.parent,function(t,r){l=r[e[0].rowIndex]},[h.getFreezeTableName()&&h.getFreezeTableName()!==ni?[]:n.getRowsObject(),"movable"===h.getFreezeTableName()?n.getMovableRowsObject():[],h.getFreezeTableName()===ii?n.getFrozenRightRowsObject():[]]),n.groupSettings.columns.length>0&&(l=n.getRowObjectFromUID(this.target.parentElement.getAttribute("data-uid")));for(var p=[],d=0,c=e;d<c.length;d++){for(var u=c[d],g=0,f=this.selectedRowCellIndexes.length;g<f;g++)if(this.selectedRowCellIndexes[parseInt(g.toString(),10)].rowIndex===u.rowIndex){i=g;break}(r=this.getSelectedMovableCell(u))||(r=n.getCellFromIndex(u.rowIndex,this.getColIndex(u.rowIndex,u.cellIndex)));var m="movable"===h.getFreezeTableName()?u.cellIndex-s:h.getFreezeTableName()===ii?u.cellIndex-(s+a):u.cellIndex;n.groupSettings.columns.length>0?p.push(l.cells[m+n.groupSettings.columns.length].foreignKeyData):p.push(l.cells[parseInt(m.toString(),10)].foreignKeyData);var y={cancel:!1,data:o,cellIndex:e[0],isShiftPressed:this.isMultiShiftRequest,currentCell:r,isCtrlPressed:this.isMultiCtrlRequest,previousRowCell:this.prevECIdxs?n.getCellFromIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};y.previousRowCellIndex=this.prevECIdxs;var v=i>-1;if(v){var C=this.selectedRowCellIndexes[parseInt(i.toString(),10)].cellIndexes;C.indexOf(u.cellIndex)>-1?(this.cellDeselect("cellDeselecting",[{rowIndex:u.rowIndex,cellIndexes:[u.cellIndex]}],o,[r],p),C.splice(C.indexOf(u.cellIndex),1),0===C.length&&this.selectedRowCellIndexes.splice(i,1),r.classList.remove("e-cellselectionbackground"),r.removeAttribute("aria-selected"),this.cellDeselect("cellDeselected",[{rowIndex:u.rowIndex,cellIndexes:[u.cellIndex]}],o,[r],p)):(v=!1,this.onActionBegin(y,"cellSelecting"),this.addRowCellIndex({rowIndex:u.rowIndex,cellIndex:u.cellIndex}),this.updateCellSelection(r),this.addAttribute(r))}else{if(this.onActionBegin(y,"cellSelecting"),!t.isNullOrUndefined(y)&&!0===y.cancel)return;this.updateCellSelection(r,u.rowIndex,u.cellIndex)}if(!v){var S={data:o,cellIndex:e[0],currentCell:r,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0,selectedRowCellIndex:this.selectedRowCellIndexes};S.previousRowCellIndex=this.prevECIdxs,this.onActionComplete(S,"cellSelected"),this.cellselected=!0}this.updateCellProps(u,u)}}}},i.prototype.getColIndex=function(e,t){var r=this.parent.isFrozenGrid(),i=this.parent.getColumnByIndex(t),n=je(this.parent,i,e);if(n)for(var o=0;o<n.length;o++)if(parseInt(n[parseInt(o.toString(),10)].getAttribute(oi),10)===t)return r&&("movable"===i.getFreezeTableName()?o+=this.parent.getFrozenLeftCount():i.getFreezeTableName()===ii&&(o+=this.parent.getFrozenLeftColumnsCount()+this.parent.getMovableColumnsCount())),o;return-1},i.prototype.getLastColIndex=function(e){var t=this.parent.getFrozenColumns()?this.parent.getMovableDataRows()[parseInt(e.toString(),10)].querySelectorAll("td.e-rowcell"):this.parent.getDataRows()[parseInt(e.toString(),10)].querySelectorAll("td.e-rowcell");return parseInt(t[t.length-1].getAttribute(oi),10)},i.prototype.clearCell=function(){this.clearCellSelection()},i.prototype.cellDeselect=function(e,r,i,n,o){n[0]&&n[0].classList.contains($r)&&this.updateCheckBoxes(t.closest(n[0],"tr"));var s={cells:n,data:i,cellIndexes:r,foreignKeyData:o,cancel:!1};this.parent.trigger(e,s),this.isPreventCellSelect=s.cancel},i.prototype.updateCellSelection=function(e,r,i){t.isNullOrUndefined(r)||this.addRowCellIndex({rowIndex:r,cellIndex:i}),e.classList.add("e-cellselectionbackground"),e.classList.contains($r)&&this.updateCheckBoxes(t.closest(e,"tr"),!0),this.addAttribute(e)},i.prototype.addAttribute=function(e){this.target=e,t.isNullOrUndefined(e)||(e.setAttribute("aria-selected","true"),this.preventFocus||this.focus.onClick({target:e},!0))},i.prototype.updateCellProps=function(e,t){this.prevCIdxs=e,this.prevECIdxs=t,this.isCellSelected=this.selectedRowCellIndexes.length&&!0},i.prototype.addRowCellIndex=function(e){for(var t,r,i=0,n=this.selectedRowCellIndexes.length;i<n;i++)if(this.selectedRowCellIndexes[parseInt(i.toString(),10)].rowIndex===e.rowIndex){t=!0,r=i;break}t?this.selectedRowCellIndexes[parseInt(r.toString(),10)].cellIndexes.indexOf(e.cellIndex)<0&&this.selectedRowCellIndexes[parseInt(r.toString(),10)].cellIndexes.push(e.cellIndex):this.selectedRowCellIndexes.push({rowIndex:e.rowIndex,cellIndexes:[e.cellIndex]})},i.prototype.clearCellSelection=function(){if(this.isCellSelected){var e=this.parent,t=this.getSelectedCellsElement(),r=this.selectedRowCellIndexes,i=[],n=[],o=[],s=this.getCurrentBatchRecordChanges(),a=e.isFrozenGrid();this.hideAutoFill();for(var l=0,h=r.length;l<h;l++){i.push(s[r[parseInt(l.toString(),10)].rowIndex]);for(var p=this.getRowObj(r[parseInt(l.toString(),10)].rowIndex),d=0,c=r[parseInt(l.toString(),10)].cellIndexes.length;d<c;d++)if(a){var u=e.getColumnByIndex(r[parseInt(l.toString(),10)].cellIndexes[parseInt(d.toString(),10)]);n.push(Ve(this.parent,u,r[parseInt(l.toString(),10)].rowIndex,r[parseInt(l.toString(),10)].cellIndexes[parseInt(d.toString(),10)]))}else p.cells&&o.push(p.cells[r[parseInt(l.toString(),10)].cellIndexes[parseInt(d.toString(),10)]].foreignKeyData),n.push(e.getCellFromIndex(r[parseInt(l.toString(),10)].rowIndex,r[parseInt(l.toString(),10)].cellIndexes[parseInt(d.toString(),10)]))}if(this.cellDeselect("cellDeselecting",r,i,n,o),!0===this.isPreventCellSelect)return;for(var l=0,h=t.length;l<h;l++)t[parseInt(l.toString(),10)].classList.remove("e-cellselectionbackground"),t[parseInt(l.toString(),10)].removeAttribute("aria-selected");this.bdrElement&&this.showHideBorders("none"),this.selectedRowCellIndexes=[],this.isCellSelected=!1,!this.isDragged&&this.cellselected&&this.cellDeselect("cellDeselected",r,i,n,o)}},i.prototype.getSelectedCellsElement=function(){var e,t=this.parent,r=t.getDataRows();t.isFrozenGrid()&&(e=t.getMovableDataRows(),r=t.addMovableRows(r,e),t.getFrozenMode()===ri&&(r=t.addMovableRows(r,t.getFrozenRightDataRows())));for(var i=[],n=0,o=r.length;n<o;n++)i=i.concat([].slice.call(r[parseInt(n.toString(),10)].getElementsByClassName("e-cellselectionbackground")));return i},i.prototype.mouseMoveHandler=function(e){e.preventDefault();var r,i=this.parent.element.getBoundingClientRect(),n=this.x,o=this.y,s=B(e),a=s.x-i.left,l=s.y-i.top,h=t.closest(e.target,"tr");if(this.isDragged=!0,this.isCellDrag||(h||(h=t.closest(document.elementFromPoint(this.parent.element.offsetLeft+2,e.clientY),"tr")),n>a&&(r=a,a=n,n=r),o>l&&(r=l,l=o,o=r),this.element.style.left=n+"px",this.element.style.top=o+"px",this.element.style.width=a-n+"px",this.element.style.height=l-o+"px"),h&&!e.ctrlKey&&!e.shiftKey){var p=parseInt(h.getAttribute(si),10);if(this.isCellDrag){var d=O(e.target,Ur);d&&(this.startAFCell=this.startCell,this.endAFCell=O(e.target,Ur),this.selectLikeExcel(e,p,parseInt(d.getAttribute(oi),10)))}else this.hideAutoFill(),this.selectRowsByRange(this.startDIndex,p),this.isRowDragSelected=!0}},i.prototype.selectLikeExcel=function(e,t,r){this.isAutoFillSel?(this.showAFBorders(),this.selectLikeAutoFill(e)):(this.clearCellSelection(),this.selectCellsByRange({rowIndex:this.startDIndex,cellIndex:this.startDCellIndex},{rowIndex:t,cellIndex:r}),this.drawBorders())},i.prototype.drawBorders=function(){"BoxWithBorder"===this.selectionSettings.cellSelectionMode&&this.selectedRowCellIndexes.length&&!this.parent.isEdit?(this.parent.element.classList.add("e-enabledboxbdr"),this.bdrElement||this.createBorders(),this.positionBorders()):this.showHideBorders("none")},i.prototype.isLastCell=function(e){var t=[].slice.call(e.parentElement.querySelectorAll(".e-rowcell:not(.e-hide)"));return t[t.length-1]===e},i.prototype.isLastRow=function(e){var r=[].slice.call(t.closest(e,li).querySelectorAll(".e-row:not(.e-hiddenrow)"));return e.parentElement===r[r.length-1]},i.prototype.isFirstRow=function(e){var r=[].slice.call(t.closest(e,li).querySelectorAll(".e-row:not(.e-hiddenrow)"));return e.parentElement===r[0]},i.prototype.isFirstCell=function(e){return[].slice.call(e.parentElement.querySelectorAll(".e-rowcell:not(.e-hide)"))[0]===e},i.prototype.setBorders=function(e,t,r){var i=[].slice.call(e.getElementsByClassName("e-cellselectionbackground")).filter(function(e){return""===e.style.display});if(i.length){var n=this.parent.isFrozenGrid(),o=i[0],s=i[i.length-1],a=o.getBoundingClientRect(),l=s.getBoundingClientRect(),h=o.offsetParent.getBoundingClientRect(),p=!this.isLastRow(s)||"1"!==r&&"2"!==r&&"5"!==r?0:2,d=this.parent.frozenRows&&("1"===r||"2"===r)&&this.isFirstRow(o)?1.5:0,c=n&&("2"===r||"4"===r)&&this.isFirstCell(o)?1:0,u=("Right"!==this.parent.getFrozenMode()||"1"!==r&&"3"!==r)&&(this.parent.getFrozenMode()!==ri||"5"!==r&&"6"!==r)||!this.isFirstCell(o)?0:1;this.parent.enableRtl?(t.style.right=h.right-a.right-c+"px",t.style.width=a.right-l.left+c+1+"px"):(t.style.left=a.left-h.left-c-u+"px",t.style.width=l.right-a.left+c-u+1+"px"),t.style.top=a.top-h.top-d+"px",t.style.height=l.top-a.top>0?l.top-h.top+l.height+1-(a.top-h.top)-p+d+"px":l.height+d-p+1+"px",this.selectDirection+=r}else t.style.display="none"},i.prototype.positionBorders=function(){this.updateStartEndCells(),this.startCell&&this.bdrElement&&this.selectedRowCellIndexes.length&&(this.selectDirection="",this.showHideBorders(""),this.setBorders(this.parent.getContentTable(),this.bdrElement,"1"),this.parent.isFrozenGrid()&&(this.setBorders(this.parent.contentModule.getMovableContent(),this.mcBdrElement,"2"),this.parent.getFrozenMode()===ri&&this.setBorders(this.parent.contentModule.getFrozenRightContent(),this.frcBdrElement,"5")),this.parent.frozenRows&&(this.setBorders(this.parent.getHeaderTable(),this.fhBdrElement,"3"),this.parent.isFrozenGrid()&&(this.setBorders(this.parent.headerModule.getMovableHeader(),this.mhBdrElement,"4"),this.parent.getFrozenMode()===ri&&this.setBorders(this.parent.headerModule.getFrozenRightHeader(),this.frhBdrElement,"6"))),this.applyBorders(this.selectDirection))},i.prototype.applyBothFrozenBorders=function(e){var t=this.parent.enableRtl;switch(e.length){case 6:this.bdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.mcBdrElement.style.borderWidth=this.bottom,this.fhBdrElement.style.borderWidth=t?this.top_right:this.top_left,this.mhBdrElement.style.borderWidth=this.top,this.frcBdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom,this.frhBdrElement.style.borderWidth=t?this.top_left:this.top_right;break;case 4:e.includes("1")&&e.includes("2")&&e.includes("3")&&e.includes("4")&&(this.fhBdrElement.style.borderWidth=t?this.top_right:this.top_left,this.mhBdrElement.style.borderWidth=t?this.top_left:this.top_right,this.bdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.mcBdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom),e.includes("2")&&e.includes("4")&&e.includes("5")&&e.includes("6")&&(this.mcBdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.mhBdrElement.style.borderWidth=t?this.top_right:this.top_left,this.frcBdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom,this.frhBdrElement.style.borderWidth=t?this.top_left:this.top_right);break;case 3:this.bdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.mcBdrElement.style.borderWidth=this.top_bottom,this.frcBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.mhBdrElement.style.borderWidth=this.top_bottom,this.frcBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom);break;case 2:e.includes("1")&&(this.mcBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=this.top_right_left)),e.includes("2")&&(this.bdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.frcBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.parent.frozenRows&&(this.mhBdrElement.style.borderWidth=this.top_right_left)),e.includes("3")&&(this.mhBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.bdrElement.style.borderWidth=this.right_bottom_left),e.includes("4")&&(this.fhBdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.frhBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.mcBdrElement.style.borderWidth=this.right_bottom_left),e.includes("5")&&(this.mcBdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.parent.frozenRows&&(this.frhBdrElement.style.borderWidth=this.top_right_left)),e.includes("6")&&(this.mhBdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.frcBdrElement.style.borderWidth=this.right_bottom_left);break;default:this.bdrElement.style.borderWidth=this.all_border,this.mcBdrElement.style.borderWidth=this.all_border,this.frcBdrElement.style.borderWidth=this.all_border,this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=this.all_border,this.mhBdrElement.style.borderWidth=this.all_border,this.frhBdrElement.style.borderWidth=this.all_border)}},i.prototype.applyBorders=function(e){var t=this.parent.enableRtl;if(this.parent.getFrozenMode()===ri)this.applyBothFrozenBorders(e);else switch(e.length){case 4:"Right"===this.parent.getFrozenMode()?(this.bdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom,this.mcBdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.fhBdrElement.style.borderWidth=t?this.top_left:this.top_right,this.mhBdrElement.style.borderWidth=t?this.top_right:this.top_left):(this.bdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.mcBdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom,this.fhBdrElement.style.borderWidth=t?this.top_right:this.top_left,this.mhBdrElement.style.borderWidth=t?this.top_left:this.top_right);break;case 2:"Right"===this.parent.getFrozenMode()?(this.bdrElement.style.borderWidth=e.includes("2")?t?this.top_bottom_left:this.top_right_bottom:this.right_bottom_left,this.mcBdrElement.style.borderWidth=e.includes("1")?t?this.top_right_bottom:this.top_bottom_left:this.right_bottom_left,this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=e.includes("1")?this.top_right_left:t?this.top_bottom_left:this.top_right_bottom,this.mhBdrElement.style.borderWidth=e.includes("2")?this.top_right_left:t?this.top_right_bottom:this.top_bottom_left)):(this.bdrElement.style.borderWidth=e.includes("2")?t?this.top_right_bottom:this.top_bottom_left:this.right_bottom_left,this.parent.isFrozenGrid()&&(this.mcBdrElement.style.borderWidth=e.includes("1")?t?this.top_bottom_left:this.top_right_bottom:this.right_bottom_left),this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=e.includes("1")?this.top_right_left:t?this.top_right_bottom:this.top_bottom_left,this.parent.isFrozenGrid()&&(this.mhBdrElement.style.borderWidth=e.includes("2")?this.top_right_left:t?this.top_bottom_left:this.top_right_bottom)));break;default:this.bdrElement.style.borderWidth=this.all_border,this.parent.isFrozenGrid()&&(this.mcBdrElement.style.borderWidth=this.all_border),this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=this.all_border,this.parent.isFrozenGrid()&&(this.mhBdrElement.style.borderWidth=this.all_border))}},i.prototype.createBorders=function(){this.bdrElement||(this.bdrElement=this.parent.getContentTable().parentElement.appendChild(t.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_bdr",styles:"width: 2px; border-width: 0;"})),this.parent.isFrozenGrid()&&(this.mcBdrElement=this.parent.contentModule.getMovableContent().appendChild(t.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_mcbdr",styles:"height: 2px; border-width: 0;"})),this.parent.getFrozenMode()===ri&&(this.frcBdrElement=this.parent.contentModule.getFrozenRightContent().appendChild(t.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_frcbdr",styles:"height: 2px; border-width: 0;"})))),this.parent.frozenRows&&(this.fhBdrElement=this.parent.getHeaderTable().parentElement.appendChild(t.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_fhbdr",styles:"height: 2px;"}))),this.parent.frozenRows&&this.parent.isFrozenGrid()&&(this.mhBdrElement=this.parent.headerModule.getMovableHeader().appendChild(t.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_mhbdr",styles:"height: 2px;"})),this.parent.getFrozenMode()===ri&&(this.frhBdrElement=this.parent.headerModule.getFrozenRightHeader().appendChild(t.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_frhbdr",styles:"height: 2px;"})))))},i.prototype.showHideBorders=function(e){this.bdrElement&&(this.bdrElement.style.display=e,this.parent.isFrozenGrid()&&(this.mcBdrElement.style.display=e,this.parent.getFrozenMode()===ri&&(this.frcBdrElement.style.display=e)),this.parent.frozenRows&&(this.fhBdrElement.style.display=e),this.parent.frozenRows&&this.parent.isFrozenGrid()&&(this.mhBdrElement.style.display=e,this.parent.getFrozenMode()===ri&&(this.frhBdrElement.style.display=e)))},i.prototype.drawAFBorders=function(){this.bdrAFBottom||this.createAFBorders(),this.positionAFBorders()},i.prototype.positionAFBorders=function(){if(this.startCell&&this.bdrAFLeft){var e=this.startAFCell.getBoundingClientRect(),t=this.endAFCell.getBoundingClientRect(),r=t.top-e.top>0?1:0,i=t.top-e.top>=0&&(O(this.startAFCell,Wr)||O(this.startAFCell,"e-frozencontent"))&&this.isFirstRow(this.startAFCell)?1.5:0,n=(O(this.startAFCell,Wr)||O(this.startAFCell,Kr))&&this.isFirstCell(this.startAFCell)?1:0,o=this.isLastRow(this.endAFCell)&&(O(this.endAFCell,Wr)||O(this.endAFCell,"e-frozencontent"))?2:0,s=this.startAFCell.offsetParent.getBoundingClientRect(),a=this.parent.element.getBoundingClientRect(),l=this.startAFCell.offsetParent.parentElement.scrollTop,h=this.startAFCell.offsetParent.parentElement.scrollLeft,p=l-this.startAFCell.offsetTop,d=h-this.startAFCell.offsetLeft,c=this.parent.element.clientHeight,u=this.parent.element.clientWidth;p=p>0?Math.floor(p)-1:0,d=d>0?d:0;var g=e.left-a.left;if(this.parent.enableRtl){var f=O(this.startAFCell,Wr)||O(this.startAFCell,Kr)?e.right-this.startAFCell.offsetParent.parentElement.getBoundingClientRect().width-a.left:0;this.bdrAFLeft.style.right=a.right-t.right-2+t.width+"px",this.bdrAFLeft.style.width=u<=parseInt(this.bdrAFLeft.style.right,10)?"0px":"2px",this.bdrAFRight.style.right=a.right-e.right-n+f-1+"px",this.bdrAFTop.style.left=t.left-a.left-.5+"px",this.bdrAFTop.style.width=parseInt(this.bdrAFLeft.style.right,10)-parseInt(this.bdrAFRight.style.right,10)-n+1+"px",parseInt(this.bdrAFTop.style.left,10)<0&&(this.bdrAFTop.style.width=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)+"px",this.bdrAFTop.style.left="0px")}else if(this.bdrAFLeft.style.left=g-n+d-1+"px",this.bdrAFRight.style.left=t.left-a.left-2+t.width+"px",this.bdrAFRight.style.width=u<=parseInt(this.bdrAFRight.style.left,10)?"0px":"2px",this.bdrAFTop.style.left=g+d-.5+"px",this.bdrAFTop.style.width=parseInt(this.bdrAFRight.style.left,10)-parseInt(this.bdrAFLeft.style.left,10)-n+1+"px",u<=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)){var m=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)-u;this.bdrAFTop.style.width=parseInt(this.bdrAFTop.style.width,10)-m+"px"}if(this.bdrAFLeft.style.top=e.top-a.top-i+p+"px",this.bdrAFLeft.style.height=t.top-e.top>0?t.top-s.top+t.height+1-(e.top-s.top)+i-o-p+"px":t.height+i-o-p+"px",this.bdrAFRight.style.top=this.bdrAFLeft.style.top,this.bdrAFRight.style.height=parseInt(this.bdrAFLeft.style.height,10)+"px",this.bdrAFTop.style.top=this.bdrAFRight.style.top,this.bdrAFBottom.style.left=this.bdrAFTop.style.left,this.bdrAFBottom.style.top=parseFloat(this.bdrAFLeft.style.top)+parseFloat(this.bdrAFLeft.style.height)-r-1+"px",this.bdrAFBottom.style.width=c<=parseFloat(this.bdrAFBottom.style.top)?"0px":this.bdrAFTop.style.width,c<=parseInt(this.bdrAFLeft.style.height,10)+parseInt(this.bdrAFLeft.style.top,10)){var y=parseInt(this.bdrAFLeft.style.height,10)+parseInt(this.bdrAFLeft.style.top,10)-c;this.bdrAFLeft.style.height=parseInt(this.bdrAFLeft.style.height,10)-y+"px",this.bdrAFRight.style.height=parseInt(this.bdrAFLeft.style.height,10)+"px"}}},i.prototype.createAFBorders=function(){this.bdrAFLeft||(this.bdrAFLeft=this.parent.element.appendChild(t.createElement("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafleft",styles:"width: 2px;"})),this.bdrAFRight=this.parent.element.appendChild(t.createElement("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafright",styles:"width: 2px;"})),this.bdrAFBottom=this.parent.element.appendChild(t.createElement("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafbottom",styles:"height: 2px;"})),this.bdrAFTop=this.parent.element.appendChild(t.createElement("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdraftop",styles:"height: 2px;"})))},i.prototype.showAFBorders=function(){this.bdrAFLeft&&(this.bdrAFLeft.style.display="",this.bdrAFRight.style.display="",this.bdrAFBottom.style.display="",this.bdrAFTop.style.display="")},i.prototype.hideAFBorders=function(){this.bdrAFLeft&&(this.bdrAFLeft.style.display="none",this.bdrAFRight.style.display="none",this.bdrAFBottom.style.display="none",this.bdrAFTop.style.display="none")},i.prototype.updateValue=function(e,t,r){var i=this.createBeforeAutoFill(e,t,r);if(!i.cancel){var n=this.parent.getColumnByIndex(t);this.parent.editModule&&r&&("number"===n.type?this.parent.editModule.updateCell(e,n.field,parseFloat(i.value)):this.parent.editModule.updateCell(e,n.field,i.value))}},i.prototype.createBeforeAutoFill=function(e,t,r){var i={column:this.parent.getColumnByIndex(t),value:r.innerText};return this.parent.trigger("beforeAutoFill",i),i},i.prototype.getAutoFillCells=function(e,t){var r=".e-cellselectionbackground",i=[].slice.call(this.parent.getDataRows()[parseInt(e.toString(),10)].querySelectorAll(r));return this.parent.isFrozenGrid()&&(i=i.concat([].slice.call(this.parent.getMovableDataRows()[parseInt(e.toString(),10)].querySelectorAll(r))),this.parent.getFrozenMode()===ri&&(i=i.concat([].slice.call(this.parent.getFrozenRightDataRows()[parseInt(e.toString(),10)].querySelectorAll(r))))),i},i.prototype.selectLikeAutoFill=function(e,t){var r=parseInt(O(this.startAFCell,Zr).getAttribute(si),10),i=parseInt(this.startAFCell.getAttribute(oi),10),n=parseInt(O(this.endAFCell,Zr).getAttribute(si),10),o=parseInt(this.endAFCell.getAttribute(oi),10),s=this.selectedRowCellIndexes.length-1,a=this.selectedRowCellIndexes[0].cellIndexes.length-1;switch(!0){case!t&&this.endAFCell.classList.contains("e-cellselectionbackground")&&!!O(e.target,Ur):this.startAFCell=this.parent.getCellFromIndex(r,i),this.endAFCell=this.parent.getCellFromIndex(r+s,i+a),this.drawAFBorders();break;case this.autoFillRLselection&&i+a<o&&o-i-a+1>n-r-s&&o-i-a+1>r-n:if(this.endAFCell=this.parent.getCellFromIndex(r+s,o),n=parseInt(O(this.endAFCell,Zr).getAttribute(si),10),o=parseInt(this.endAFCell.getAttribute(oi),10),t){for(var l=parseInt(this.endCell.getAttribute(oi),10),h=r;h<=n;h++)for(var p=this.getAutoFillCells(h,i),d=0,c=l+1;c<=o;c++)d>a&&(d=0),this.updateValue(h,c,p[parseInt(d.toString(),10)]),d++;this.selectCellsByRange({rowIndex:r,cellIndex:this.startCellIndex},{rowIndex:n,cellIndex:o})}else this.drawAFBorders();break;case this.autoFillRLselection&&i>o&&i-o+1>n-r-s&&i-o+1>r-n:if(this.startAFCell=this.parent.getCellFromIndex(r,o),this.endAFCell=this.endCell,t){for(h=r;h<=r+s;h++){(p=this.getAutoFillCells(h,i)).reverse();for(var d=0,c=this.startCellIndex-1;c>=o;c--)d>a&&(d=0),this.updateValue(h,c,p[parseInt(d.toString(),10)]),d++}this.selectCellsByRange({rowIndex:r,cellIndex:o},{rowIndex:r+s,cellIndex:this.startCellIndex+a})}else this.drawAFBorders();break;case r>n:if(this.startAFCell=this.parent.getCellFromIndex(n,i),this.endAFCell=this.endCell,t){for(var u=g=parseInt(this.endCell.parentElement.getAttribute(si),10),h=r-1;h>=n;h--){u===this.startIndex-1&&(u=g);var p=this.getAutoFillCells(u,i),d=0;u--;for(c=this.startCellIndex;c<=this.startCellIndex+a;c++)this.updateValue(h,c,p[parseInt(d.toString(),10)]),d++}this.selectCellsByRange({rowIndex:n,cellIndex:i+a},{rowIndex:r+s,cellIndex:i})}else this.drawAFBorders();break;default:if(this.endAFCell=this.parent.getCellFromIndex(n,i+a),t){for(var g=parseInt(this.endCell.parentElement.getAttribute(si),10),u=this.startIndex,h=g+1;h<=n;h++){u===g+1&&(u=this.startIndex);p=this.getAutoFillCells(u,i);u++;for(var d=0,f=this.startCellIndex;f<=this.startCellIndex+a;f++)this.updateValue(h,f,p[parseInt(d.toString(),10)]),d++}this.selectCellsByRange({rowIndex:g-s,cellIndex:i},{rowIndex:n,cellIndex:i+a})}else this.drawAFBorders()}},i.prototype.mouseUpHandler=function(e){document.body.classList.remove("e-disableuserselect"),this.element&&t.remove(this.element),this.isDragged&&1===this.selectedRowCellIndexes.length&&1===this.selectedRowCellIndexes[0].cellIndexes.length?this.mUPTarget=O(e.target,Ur):this.mUPTarget=null;var r=t.closest(e.target,".e-rowcell");if(this.isDragged&&!this.isAutoFillSel&&"Cell"===this.selectionSettings.mode&&r&&r.classList.contains(Ur)){var i=parseInt(r.parentElement.getAttribute(si),10),n=parseInt(r.getAttribute(oi),10);this.isDragged=!1,this.clearCellSelection(),this.selectCellsByRange({rowIndex:this.startDIndex,cellIndex:this.startDCellIndex},{rowIndex:i,cellIndex:n})}if(this.isDragged=!1,this.updateAutoFillPosition(),this.isAutoFillSel){var o=O(e.target,Ur);this.endAFCell=o||(this.endCell===this.endAFCell?this.startAFCell:this.endAFCell),this.startAFCell=this.startCell,this.updateStartCellsIndex(),this.selectLikeAutoFill(e,!0),this.updateAutoFillPosition(),this.hideAFBorders(),this.positionBorders(),this.isAutoFillSel=!1}t.EventHandler.remove(this.parent.getContent(),"mousemove",this.mouseMoveHandler),this.parent.frozenRows&&t.EventHandler.remove(this.parent.getHeaderContent(),"mousemove",this.mouseMoveHandler),t.EventHandler.remove(document,"mouseup",this.mouseUpHandler)},i.prototype.hideAutoFill=function(){this.autofill&&(this.autofill.style.display="none")},i.prototype.updateAutoFillPosition=function(){if(this.parent.enableAutoFill&&!this.parent.isEdit&&this.selectionSettings.cellSelectionMode.indexOf("Box")>-1&&!this.isRowType()&&!this.isSingleSel()&&this.selectedRowCellIndexes.length){var e=parseInt(this.target.getAttribute(oi),10),r=parseInt(this.target.getAttribute("index"),10),i=this.selectedRowCellIndexes[this.selectedRowCellIndexes.length-1].rowIndex,n=this.getAutoFillCells(i,e).filter(function(e){return""===e.style.display}),o=this.parent.getColumnByIndex(e),s="movable"===o.getFreezeTableName(),a=r<this.parent.frozenRows,l=this.parent.getFrozenMode()===ri&&o.getFreezeTableName()===ii;t.select("#"+this.parent.element.id+"_autofill",O(this.target,Jr))||(t.select("#"+this.parent.element.id+"_autofill",this.parent.element)&&t.select("#"+this.parent.element.id+"_autofill",this.parent.element).remove(),this.autofill=t.createElement("div",{className:"e-autofill",id:this.parent.element.id+"_autofill"}),this.autofill.style.display="none",a?s?this.parent.headerModule.getMovableHeader().appendChild(this.autofill):this.parent.getHeaderTable().parentElement.appendChild(this.autofill):s?this.parent.contentModule.getMovableContent().appendChild(this.autofill):this.parent.getContentTable().parentElement.appendChild(this.autofill),l&&(a?this.parent.getFrozenRightHeader().appendChild(this.autofill):this.parent.getFrozenRightContent().appendChild(this.autofill)));var h=n[n.length-1];if(h&&h.offsetParent){var p=h.getBoundingClientRect(),d=h.offsetParent.getBoundingClientRect(),c=this.isLastCell(h)?4:0,u=this.isLastRow(h)?3:0;this.parent.enableRtl?this.autofill.style.right=d.right-p.right+p.width-4-c+"px":this.autofill.style.left=p.left-d.left+p.width-4-c+"px",this.autofill.style.top=p.top-d.top+p.height-5-u+"px"}this.autofill.style.display=""}else this.hideAutoFill()},i.prototype.mouseDownHandler=function(e){this.mouseButton=e.button;var r,i=e.target,n=this.parent,o=O(i,"e-grid");if(!(o&&o.id!==n.element.id||O(i,_r)&&!this.parent.frozenRows||O(i,"e-editedbatchcell")||O(i,ei))){if((e.shiftKey||e.ctrlKey)&&e.preventDefault(),O(i,Ur)&&!e.shiftKey&&!e.ctrlKey){if(n.selectionSettings.cellSelectionMode.indexOf("Box")>-1&&!this.isRowType()&&!this.isSingleSel())this.isCellDrag=!0,r=!0;else if(n.allowRowDragAndDrop&&!n.isEdit&&!this.parent.selectionSettings.checkboxOnly){if(this.isRowDragSelected=!1,!this.isRowType()||this.isSingleSel()||t.closest(i,"td").classList.contains("e-selectionbackground"))return void(this.isDragged=!1);r=!0,this.element=this.parent.createElement("div",{className:"e-griddragarea"}),n.getContent().appendChild(this.element)}r&&this.enableDrag(e,!0)}this.updateStartEndCells(),(i.classList.contains("e-autofill")||i.classList.contains("e-xlsel"))&&(this.isCellDrag=!0,this.isAutoFillSel=!0,this.enableDrag(e))}},i.prototype.updateStartEndCells=function(){var e=[].slice.call(this.parent.element.getElementsByClassName("e-cellselectionbackground"));this.startCell=e[0],this.endCell=e[e.length-1],this.startCell&&(this.startIndex=parseInt(this.startCell.parentElement.getAttribute(si),10),this.startCellIndex=parseInt(O(this.startCell,Ur).getAttribute(oi),10))},i.prototype.updateStartCellsIndex=function(){this.startCell&&(this.startIndex=parseInt(this.startCell.parentElement.getAttribute(si),10),this.startCellIndex=parseInt(O(this.startCell,Ur).getAttribute(oi),10))},i.prototype.enableDrag=function(e,r){var i=this.parent;if(r){var n=t.closest(e.target,"tr");this.startDIndex=parseInt(n.getAttribute(si),10),this.startDCellIndex=parseInt(O(e.target,Ur).getAttribute(oi),10)}document.body.classList.add("e-disableuserselect");var o=i.element.getBoundingClientRect(),s=B(e);this.x=s.x-o.left,this.y=s.y-o.top,t.EventHandler.add(i.getContent(),"mousemove",this.mouseMoveHandler,this),this.parent.frozenRows&&t.EventHandler.add(i.getHeaderContent(),"mousemove",this.mouseMoveHandler,this),t.EventHandler.add(document,"mouseup",this.mouseUpHandler,this)},i.prototype.clearSelAfterRefresh=function(e){var t=this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.requestType;if("virtualscroll"===e.requestType||this.parent.isPersistSelection||t||this.clearSelection(),("virtualscroll"===e.requestType||t)&&this.parent.isPersistSelection&&this.isPartialSelection&&this.isHdrSelectAllClicked){var r=this.parent.getRowsObject().filter(function(e){return e.isSelectable}),i=[];this.selectedRowState={},this.persistSelectedData=[];for(var n=0;n<r.length;n++){i.push(r[parseInt(n.toString(),10)].index);var o=this.getPkValue(this.primaryKey,r[parseInt(n.toString(),10)].data);this.selectedRowState[""+o]=!0,this.persistSelectedData.push(r[parseInt(n.toString(),10)].data)}this.selectedRowIndexes=i}},i.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:Jt,handler:this.enableAfterRender},{event:Qt,handler:this.initializeSelection},{event:"rowselected",handler:this.onActionComplete},{event:"cellselected",handler:this.onActionComplete},{event:$t,handler:this.onPropertyChanged},{event:"cellfocused",handler:this.onCellFocused},{event:"beforeFragAppend",handler:this.clearSelAfterRefresh},{event:pr,handler:this.columnPositionChanged},{event:Yt,handler:this.initialEnd},{event:cr,handler:this.rowsRemoved},{event:rr,handler:this.refreshHeader},{event:lr,handler:this.destroy}],Ze(this.parent,this.evtHandlers,!0,this),this.actionBeginFunction=this.actionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.parent.addEventListener(Bt,this.actionBeginFunction),this.parent.addEventListener(Nt,this.actionCompleteFunction),this.addEventListener_checkbox())},i.prototype.removeEventListener=function(){this.parent.isDestroyed||(Ze(this.parent,this.evtHandlers,!1),this.parent.removeEventListener(Bt,this.actionBeginFunction),this.parent.removeEventListener(Nt,this.actionCompleteFunction),this.removeEventListener_checkbox())},i.prototype.wireEvents=function(){this.isMacOS=-1!==navigator.userAgent.indexOf("Mac OS"),this.isMacOS?(t.EventHandler.add(this.parent.element,"keydown",this.keyDownHandler,this),t.EventHandler.add(this.parent.element,"keyup",this.keyUpHandler,this)):this.parent.allowKeyboard||t.EventHandler.add(this.parent.element,"keydown",this.keyDownHandler,this)},i.prototype.unWireEvents=function(){this.isMacOS?(t.EventHandler.remove(this.parent.element,"keydown",this.keyDownHandler),t.EventHandler.remove(this.parent.element,"keyup",this.keyUpHandler)):this.parent.allowKeyboard||t.EventHandler.remove(this.parent.element,"keydown",this.keyDownHandler)},i.prototype.columnPositionChanged=function(){this.parent.isPersistSelection||this.clearSelection()},i.prototype.refreshHeader=function(){this.setCheckAllState()},i.prototype.rowsRemoved=function(e){for(var t=0;t<e.records.length;t++){var r=this.getPkValue(this.primaryKey,e.records[parseInt(t.toString(),10)]);delete this.selectedRowState[""+r],--this.totalRecordsCount}this.setCheckAllState()},i.prototype.beforeFragAppend=function(e){"virtualscroll"===e.requestType||this.parent.isPersistSelection||this.clearSelection()},i.prototype.getCheckAllBox=function(){return this.parent.getHeaderContent().querySelector(".e-checkselectall")},i.prototype.enableAfterRender=function(e){e.module===this.getModuleName()&&e.enable&&(this.render(),this.initPerisistSelection())},i.prototype.render=function(e){t.EventHandler.add(this.parent.getContent(),"mousedown",this.mouseDownHandler,this),t.EventHandler.add(this.parent.getHeaderContent(),"mousedown",this.mouseDownHandler,this)},i.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName()){var r=this.parent;t.isNullOrUndefined(e.properties.type)||"Single"!==this.selectionSettings.type||(this.selectedRowCellIndexes.length>1&&(this.clearCellSelection(),this.prevCIdxs=void 0),this.selectedRowIndexes.length>1&&(this.clearRowSelection(),this.prevRowIndex=void 0),this.selectedColumnsIndexes.length>1&&(this.clearColumnSelection(),this.prevColIndex=void 0),this.enableSelectMultiTouch=!1,this.hidePopUp()),t.isNullOrUndefined(e.properties.mode)&&t.isNullOrUndefined(e.properties.cellSelectionMode)||(this.clearSelection(),this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevColIndex=void 0),this.isPersisted=!0,this.checkBoxSelectionChanged(),this.isPersisted=!1,this.parent.isCheckBoxSelection||this.initPerisistSelection(),this.parent.getColumns().filter(function(e){return"checkbox"===e.type}).length&&(r.isCheckBoxSelection=!("ResetOnRowClick"===this.selectionSettings.checkboxMode)),this.drawBorders()}},i.prototype.hidePopUp=function(){this.parent.element.querySelector(".e-gridpopup").getElementsByClassName("e-rowselect").length&&(this.parent.element.querySelector(".e-gridpopup").style.display="none")},i.prototype.initialEnd=function(e){var t=this.parent.isFrozenGrid(),r=this.parent.getFrozenMode()===ri;(!t||t&&!r&&!e.args.isFrozen||r&&e.args.renderFrozenRightContent)&&!this.selectedRowIndexes.length&&(this.parent.off(Yt,this.initialEnd),this.selectRow(this.parent.selectedRowIndex))},i.prototype.checkBoxSelectionChanged=function(){var e=this.parent;e.off(Yt,this.checkBoxSelectionChanged);var r=e.getColumns().filter(function(e){return"checkbox"===e.type});r.length>0&&(e.isCheckBoxSelection=!0,this.chkField=r[0].field,this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount,t.isNullOrUndefined(this.totalRecordsCount)&&(this.totalRecordsCount=this.getCurrentBatchRecordChanges().length),this.isSingleSel()?(e.selectionSettings.type="Multiple",e.dataBind()):this.initPerisistSelection()),e.isCheckBoxSelection||this.isPersisted||(this.chkField=null,this.initPerisistSelection())},i.prototype.initPerisistSelection=function(){var e=this.parent;this.parent.selectionSettings.persistSelection&&this.parent.getPrimaryKeyFieldNames().length>0?(e.isPersistSelection=!0,this.ensureCheckboxFieldSelection()):this.parent.getPrimaryKeyFieldNames().length>0?(e.isPersistSelection=!1,this.ensureCheckboxFieldSelection()):(e.isPersistSelection=!1,this.selectedRowState={})},i.prototype.ensureCheckboxFieldSelection=function(){var e=this.parent;if(this.primaryKey=this.parent.getPrimaryKeyFieldNames()[0],!e.enableVirtualization&&this.chkField&&(e.isPersistSelection&&0===Object.keys(this.selectedRowState).length||!e.isPersistSelection)){var t=this.parent.getDataModule(),i=(new r.Query).where(this.chkField,"equal",!0);i.params||(i.params=this.parent.query.params);var n=t.getData({},i),o=this;this.parent.showSpinner(),n.then(function(e){o.dataSuccess(e.result),o.refreshPersistSelection(),o.parent.hideSpinner()})}},i.prototype.dataSuccess=function(e){for(var r=0;r<e.length;r++){var i=this.getPkValue(this.primaryKey,e[parseInt(r.toString(),10)]);t.isNullOrUndefined(this.selectedRowState[""+i])&&e[parseInt(r.toString(),10)][this.chkField]&&(this.selectedRowState[""+i]=e[parseInt(r.toString(),10)][this.chkField])}this.persistSelectedData=e},i.prototype.setRowSelection=function(e){if(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)if(e){var r=Object.keys(this.selectedRowState),i=Object.keys(this.unSelectedRowState);if(!this.isCheckboxReset)for(var n=0,o=this.parent.currentViewData;n<o.length;n++){var s=(f=o[n])[this.primaryKey].toString();-1===r.indexOf(s)&&-1===i.indexOf(s)&&(this.selectedRowState[f[this.primaryKey]]=!0)}}else this.selectedRowState={},this.unSelectedRowState={},this.rmtHdrChkbxClicked=!1;else if(e)if(this.isPartialSelection&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling))for(var a=0,l=this.parent.getRowsObject().filter(function(e){return e.isSelectable});a<l.length;a++){var h=l[a];this.selectedRowState[this.getPkValue(this.primaryKey,h.data)]=!0}else{var p=this.isPartialSelection?this.parent.partialSelectedRecords:this.getData();if(this.parent.groupSettings.columns.length)for(var d=0,c=this.isPartialSelection?p:p.records;d<c.length;d++){f=c[d];this.selectedRowState[this.getPkValue(this.primaryKey,f)]=!0}else for(var u=0,g=p;u<g.length;u++){var f=g[u];this.selectedRowState[this.getPkValue(this.primaryKey,f)]=!0}}else this.selectedRowState={}},i.prototype.getData=function(){return this.parent.getDataModule().dataManager.executeLocal(this.parent.getDataModule().generateQuery(!0))},i.prototype.getAvailableSelectedData=function(){var e=new r.DataManager(this.persistSelectedData).executeLocal(this.parent.getDataModule().generateQuery(!0));return this.parent.groupSettings.columns.length&&e&&e.records&&(e=e.records.slice()),e},i.prototype.refreshPersistSelection=function(){var e=this.parent.getRows();if(this.parent.isCheckBoxSelection&&this.parent.isFrozenGrid()&&(this.parent.getMovableContentTbody().querySelector(".e-checkselect")&&(e=this.parent.getMovableRows()),this.parent.getFrozenMode()===ri&&this.parent.getFrozenRightContentTbody().querySelector(".e-checkselect")&&(e=this.parent.getFrozenRightRows())),this.totalRecordsCount=this.parent.getCurrentViewRecords().length,this.parent.allowPaging&&(this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount),!t.isNullOrUndefined(e)&&e.length>0&&(this.parent.isPersistSelection||this.chkField)){for(var r=[],i=0;i<e.length;i++){var n=this.getRowObj(e[parseInt(i.toString(),10)]),o=n&&n.data?this.getPkValue(this.primaryKey,n.data):null;if(null===o)return;if(!this.isPartialSelection||n.isSelectable){var s=void 0,a=e[parseInt(i.toString(),10)].querySelector(".e-checkselect");this.selectedRowState[""+o]||"Check"===this.parent.checkAllRows&&this.selectedRowState[""+o]&&this.totalRecordsCount===Object.keys(this.selectedRowState).length&&this.chkAllCollec.indexOf(o)<0||"Uncheck"===this.parent.checkAllRows&&this.chkAllCollec.indexOf(o)>0&&!this.parent.selectedRowIndex||"Intermediate"===this.parent.checkAllRows&&!t.isNullOrUndefined(this.chkField)&&n.data[this.chkField]?(r.push(parseInt(e[parseInt(i.toString(),10)].getAttribute(si),10)),s=!0):(s=!1,this.checkedTarget!==a&&this.parent.isCheckBoxSelection&&a&&se(a.nextElementSibling,s)),this.updatePersistCollection(e[parseInt(i.toString(),10)],s)}}this.isSingleSel()&&r.length>0?this.selectRow(r[0],!0):this.selectRows(r)}(this.parent.isCheckBoxSelection||"ResetOnRowClick"===this.parent.selectionSettings.checkboxMode)&&this.getCurrentBatchRecordChanges().length>0&&this.setCheckAllState()},i.prototype.actionBegin=function(e){if("save"===e.requestType&&this.parent.isPersistSelection){var r=this.parent.element.querySelector(".e-edit-checkselect");if(!t.isNullOrUndefined(r)){var i=t.closest(r,"."+ei);if(i){"Dialog"===this.parent.editSettings.mode&&(i=this.parent.element.querySelector(".e-dlgeditrow"));var n=this.getRowObj(i);if(!n)return;this.selectedRowState[this.getPkValue(this.primaryKey,n.data)]=n.isSelected=r.checked}else this.isCheckedOnAdd=r.checked}}this.parent.isPersistSelection&&this.isPartialSelection&&("paging"===e.requestType&&(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&(this.selectedRowIndexes=[]),"filtering"!==e.requestType&&"searching"!==e.requestType||(this.parent.partialSelectedRecords=[],this.parent.disableSelectedRecords=[]))},i.prototype.actionComplete=function(e){if("save"===e.requestType&&this.parent.isPersistSelection){if("add"===e.action){if(this.isCheckedOnAdd){var r=this.parent.getRowObjectFromUID(this.parent.getRows()[e.selectedRow].getAttribute("data-uid"));this.selectedRowState[this.getPkValue(this.primaryKey,r.data)]=r.isSelected=this.isCheckedOnAdd}this.isHdrSelectAllClicked=!1,this.setCheckAllState()}this.refreshPersistSelection()}if("delete"===e.requestType&&this.parent.isPersistSelection){for(var i=e.data.slice(),n=0;n<i.length;n++){var o=this.getPkValue(this.primaryKey,i[parseInt(n.toString(),10)]);t.isNullOrUndefined(o)||this.updatePersistDelete(o,this.isPartialSelection)}this.isHdrSelectAllClicked=!1,this.setCheckAllState(),this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount}if("paging"===e.requestType){if(this.parent.isPersistSelection&&this.isPartialSelection&&this.isHdrSelectAllClicked){for(var s=this.parent.getRowsObject(),a=[],n=0;n<s.length;n++)s[parseInt(n.toString(),10)].isSelectable&&a.push(s[parseInt(n.toString(),10)].index);a.length&&this.selectRows(a)}this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevECIdxs=void 0}},i.prototype.onDataBound=function(){if(!this.parent.enableVirtualization&&this.parent.isPersistSelection&&this.selectedRecords.length&&(this.isPrevRowSelection=!0),(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&this.rmtHdrChkbxClicked&&("Intermediate"===this.parent.checkAllRows?this.setRowSelection(!0):"Uncheck"===this.parent.checkAllRows&&this.setRowSelection(!1)),this.parent.enableVirtualization&&this.setCheckAllState(),this.parent.isPersistSelection&&this.refreshPersistSelection(),this.initialRowSelection=!!(this.isRowType()&&this.parent.element.querySelectorAll(".e-selectionbackground")&&this.parent.getSelectedRows().length),this.parent.isCheckBoxSelection&&!this.initialRowSelection){for(var e=this.parent.getRowsObject(),r=[],i=0;i<e.length;i++)e[parseInt(i.toString(),10)].isSelected&&r.push(i);r.length&&this.selectRows(r),this.initialRowSelection=!0}},i.prototype.updatePersistSelectedData=function(e){if(this.parent.isPersistSelection){for(var r=this.parent.getRows(),i=0;i<r.length;i++)this.updatePersistCollection(r[parseInt(i.toString(),10)],e);"Uncheck"===this.parent.checkAllRows?(this.setRowSelection(!1),this.persistSelectedData=this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result?this.persistSelectedData:[]):"Check"===this.parent.checkAllRows&&(this.setRowSelection(!0),this.persistSelectedData=this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result||this.isPartialSelection?this.persistSelectedData:this.parent.groupSettings.columns.length?this.getData().records.slice():this.getData().slice())}},i.prototype.checkSelectAllAction=function(e){var r=this.getRenderer(),i=this.parent.element.querySelector(".e-gridform");if(this.checkedTarget=this.getCheckAllBox(),e&&this.getCurrentBatchRecordChanges().length?(this.parent.checkAllRows="Check",this.updatePersistSelectedData(e),this.selectRowsByRange(r.getVirtualRowIndex(0),r.getVirtualRowIndex(this.getCurrentBatchRecordChanges().length-1))):(this.parent.checkAllRows="Uncheck",this.updatePersistSelectedData(e),this.clearSelection()),this.chkAllCollec=[],!t.isNullOrUndefined(i)){var n=i.querySelector(".e-edit-checkselect");t.isNullOrUndefined(n)||se(n.nextElementSibling,e)}},i.prototype.checkSelectAll=function(e){var r=this,i=this.getCheckAllStatus(e),n="Check"===i;this.isHeaderCheckboxClicked=!0,(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&("Uncheck"===i||this.isCheckboxReset)?this.rmtHdrChkbxClicked=!0:this.rmtHdrChkbxClicked=!1,this.rmtHdrChkbxClicked&&this.isCheckboxReset&&(this.unSelectedRowState={}),this.isCheckboxReset=!1,"Intermediate"===i&&(n=this.getCurrentBatchRecordChanges().some(function(e){return r.getPkValue(r.primaryKey,e)in r.selectedRowState}),this.parent.enableVirtualization&&this.parent.isPersistSelection&&(n=!0)),this.parent.isPersistSelection&&this.parent.allowPaging&&(this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount),this.checkSelectAllAction(!n),this.target=null,this.getCurrentBatchRecordChanges().length>0&&(this.setCheckAllState(),this.updateSelectedRowIndexes()),this.triggerChkChangeEvent(e,!n)},i.prototype.getCheckAllStatus=function(e){var t=e?e.nextElementSibling.classList:this.getCheckAllBox().nextElementSibling.classList;return t.contains("e-check")?"Check":t.contains("e-uncheck")?"Uncheck":t.contains("e-stop")?"Intermediate":"None"},i.prototype.checkSelect=function(e){var r=t.closest(this.checkedTarget,"."+Ur),i=this.parent;this.isMultiCtrlRequest=!0;var n=0;if(this.isHeaderCheckboxClicked=!1,ue(i)){var o=r.parentElement.getAttribute("data-uid");n=i.getRows().map(function(e){return e.getAttribute("data-uid")}).indexOf(o)}else n=parseInt(r.parentElement.getAttribute(si),10);this.parent.isPersistSelection&&this.parent.element.getElementsByClassName(ti).length>0&&"Top"===this.parent.editSettings.newRowPosition&&++n,this.rowCellSelectionHandler(n,parseInt(r.getAttribute(oi),10)),this.moveIntoUncheckCollection(t.closest(r,"."+Zr)),this.setCheckAllState(),this.isMultiCtrlRequest=!1,this.triggerChkChangeEvent(e,e.nextElementSibling.classList.contains("e-check"))},i.prototype.moveIntoUncheckCollection=function(e){if("Check"===this.parent.checkAllRows||"Uncheck"===this.parent.checkAllRows){var t=this.getRowObj(e),r=t&&t.data?this.getPkValue(this.primaryKey,t.data):null;if(!r)return;this.chkAllCollec.indexOf(r)<0?this.chkAllCollec.push(r):this.chkAllCollec.splice(this.chkAllCollec.indexOf(r),1)}},i.prototype.triggerChkChangeEvent=function(e,t){this.parent.trigger("checkBoxChange",{checked:t,selectedRowIndexes:this.parent.getSelectedRowIndexes(),target:e}),this.parent.isEdit||(this.checkedTarget=null)},i.prototype.updateSelectedRowIndexes=function(){if(this.parent.isCheckBoxSelection&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&this.isPartialSelection&&!(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&this.parent.selectionSettings.persistSelection&&"Uncheck"!==this.parent.checkAllRows)for(var e=0,r=this.parent.getRowsObject().filter(function(e){return e.isSelectable});e<r.length;e++){var i=r[e];this.selectedRowIndexes.push(i.index)}},i.prototype.updateSelectedRowIndex=function(e){if(this.parent.isCheckBoxSelection&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&!(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&!this.isPartialSelection)if("Check"===this.parent.checkAllRows){this.selectedRowIndexes=[];for(var r=this.getData().length,i=0;i<r;i++)this.selectedRowIndexes.push(i)}else if("Uncheck"===this.parent.checkAllRows)this.selectedRowIndexes=[];else{var n=this.parent.getRowByIndex(e);if(e&&n&&"false"===n.getAttribute("aria-selected")){var o=this.selectedRowIndexes.indexOf(e);this.selectedRowIndexes.splice(o,1)}}},i.prototype.isAllSelected=function(e){if(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)return this.getAvailableSelectedData().length===(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling?this.parent.totalDataRecordsCount:this.totalRecordsCount);if(this.isPartialSelection){if(this.parent.allowPaging&&this.parent.pageSettings.pageSize<this.parent.pageSettings.totalRecordsCount){for(var r=this.parent.partialSelectedRecords,i=0;i<r.length;i++){n=this.getPkValue(this.primaryKey,r[parseInt(i.toString(),10)]);if(!this.selectedRowState[""+n])return!1}return!0}return this.isSelectAllRowCount(e)}for(var r=this.getData(),i=0;i<r.length;i++){var n=this.getPkValue(this.primaryKey,r[parseInt(i.toString(),10)]);if(!this.selectedRowState[""+n])return!1}return!0},i.prototype.someDataSelected=function(){if((this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&(this.parent.searchSettings.key.length||this.parent.filterSettings.columns.length))for(var e=this.getAvailableSelectedData(),r=0;r<e.length;r++){n=this.getPkValue(this.primaryKey,e[parseInt(r.toString(),10)]);if(this.selectedRowState[""+n])return!1}for(var i=this.isPartialSelection?this.parent.partialSelectedRecords:this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result?[]:this.getData(),r=0;r<i.length;r++){var n=this.getPkValue(this.primaryKey,i[parseInt(r.toString(),10)]);if(this.selectedRowState[""+n])return!1}return!0},i.prototype.setCheckAllState=function(e,r){if(this.parent.isCheckBoxSelection||"ResetOnRowClick"===this.parent.selectionSettings.checkboxMode){var i=!1,n=!1,o=Object.keys(this.selectedRowState).length;this.parent.isPersistSelection||(o=this.selectedRowIndexes.length,this.totalRecordsCount=this.getCurrentBatchRecordChanges().length),!this.parent.isPersistSelection||(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&this.isPartialSelection||!this.parent.searchSettings.key.length&&!this.parent.filterSettings.columns.length||(n=!0,i=this.isAllSelected(o));var s=this.getCheckAllBox();if(s){var a=s.nextElementSibling;t.removeClass([a],["e-check","e-stop","e-uncheck"]),ne(s,!1),s.indeterminate=!1,i&&n&&(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result||this.getData().length)||!n&&(o===this.totalRecordsCount&&this.totalRecordsCount&&!this.isPartialSelection&&(!(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)||this.parent.allowPaging)||!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling&&this.isPartialSelection&&(this.isSelectAllRowCount(o)||this.isHdrSelectAllClicked)||(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&!this.parent.allowPaging&&(!(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&this.getData().length&&o===this.getData().length||(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&!this.isPartialSelection&&o===this.parent.totalDataRecordsCount||this.isPartialSelection&&(this.isHdrSelectAllClicked||this.isSelectAllRowCount(o))))?(t.addClass([a],["e-check"]),ne(s,!0),r&&this.getRenderer().setSelection(null,!0,!0),this.parent.checkAllRows="Check"):(!this.selectedRowIndexes.length&&(!this.parent.enableVirtualization||!this.persistSelectedData.length&&!n||n&&this.someDataSelected())||0===o&&0===this.getCurrentBatchRecordChanges().length)&&!this.parent.allowPaging||this.parent.allowPaging&&(0===o||o&&n&&this.someDataSelected())?(t.addClass([a],["e-uncheck"]),r&&this.getRenderer().setSelection(null,!1,!0),this.parent.checkAllRows="Uncheck"):(t.addClass([a],["e-stop"]),this.parent.checkAllRows="Intermediate",s.indeterminate=!0),0===o&&0===this.getCurrentBatchRecordChanges().length?t.addClass([a.parentElement],["e-checkbox-disabled"]):t.removeClass([a.parentElement],["e-checkbox-disabled"]),this.isPartialSelection&&(0===this.parent.getRowsObject().filter(function(e){return e.isSelectable}).length&&a.parentElement.querySelector(".e-frame").classList.contains("e-uncheck")?t.addClass([a.parentElement],["e-checkbox-disabled"]):t.removeClass([a.parentElement],["e-checkbox-disabled"])),!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling||this.parent.allowPaging||this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result||this.updateSelectedRowIndex(e)}}},i.prototype.isSelectAllRowCount=function(e){var r=0,i=this.parent.getRowsObject();return this.parent.selectionSettings.persistSelection&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)?(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result?this.parent.totalDataRecordsCount:this.getData()&&this.getData().length)===i.length&&((r=i.filter(function(e){return e.isSelectable}).length)&&e===r):this.parent.allowPaging&&this.parent.selectionSettings.persistSelection?(r=this.parent.partialSelectedRecords.length+this.parent.disableSelectedRecords.length)===this.totalRecordsCount&&(this.parent.partialSelectedRecords.length&&e===this.parent.partialSelectedRecords.length):(r=i.filter(function(e){return e.isSelectable}).length)&&e===r},i.prototype.keyDownHandler=function(e){(("chrome"===t.Browser.info.name||"safari"===t.Browser.info.name)&&(91===e.keyCode||93===e.keyCode)||"opera"===t.Browser.info.name&&17===e.keyCode||"mozilla"===t.Browser.info.name&&224===e.keyCode)&&(this.cmdKeyPressed=!0);var r=O(e.target,"e-headercell"),i=O(e.target,Ur);(r?r.children[0].classList.contains("e-headerchkcelldiv"):!!i&&i.classList.contains("e-gridchkbox"))&&!this.parent.allowKeyboard&&32===e.keyCode&&e.preventDefault()},i.prototype.keyUpHandler=function(e){(("chrome"===t.Browser.info.name||"safari"===t.Browser.info.name)&&(91===e.keyCode||93===e.keyCode)||"opera"===t.Browser.info.name&&17===e.keyCode||"mozilla"===t.Browser.info.name&&224===e.keyCode)&&(this.cmdKeyPressed=!1)},i.prototype.clickHandler=function(e){var r=e.target;this.actualTarget=r,this.selectionSettings.persistSelection&&(this.deSelectedData=I(this.persistSelectedData)),(O(r,Zr)||O(r,"e-headerchkcelldiv")||this.selectionSettings.allowColumnSelection&&r.classList.contains("e-headercell"))&&(this.isInteracted=!0),this.isMultiCtrlRequest=e.ctrlKey||this.enableSelectMultiTouch||this.isMacOS&&this.cmdKeyPressed,this.parent.allowKeyboard?this.isMultiShiftRequest=e.shiftKey:(this.isMultiShiftRequest=!1,this.isMultiCtrlRequest=!1),this.popUpClickHandler(e);var i=!1;this.preventFocus=!0;var n,o=O(r,"e-checkbox-wrapper");if(this.checkSelectAllClicked=!!(o&&o.getElementsByClassName("e-checkselectall")||this.selectionSettings.persistSelection&&O(r,Zr)),this.selectionSettings.persistSelection&&this.isPartialSelection&&O(r,"e-headerchkcelldiv")&&!r.querySelector(".e-checkbox-disabled")&&(this.isHdrSelectAllClicked=!0),o&&o.querySelectorAll(".e-checkselect,.e-checkselectall").length>0&&(n=o.querySelector('input[type="checkbox"]'),i=!0),this.drawBorders(),this.updateAutoFillPosition(),r=O(r,Ur),this.parent.isReact&&r&&!r.parentElement&&r.classList.contains("e-rowcell")&&(r=this.parent.getCellFromIndex(parseInt(r.getAttribute("index"),10),parseInt(r.getAttribute("data-colindex"),10))),(r&&r.parentElement.classList.contains(Zr)&&!this.parent.selectionSettings.checkboxOnly||i)&&!this.isRowDragSelected){if(this.parent.isCheckBoxSelection&&(this.isMultiCtrlRequest=!0),this.target=r,t.isNullOrUndefined(n)){var s=this.parent,a=0;if(ue(s)){l=r.parentElement.getAttribute("data-uid");a=s.getRows().map(function(e){return e.getAttribute("data-uid")}).indexOf(l)}else a=parseInt(r.parentElement.getAttribute(si),10);this.parent.isPersistSelection&&this.parent.element.getElementsByClassName(ti).length>0&&++a,this.mUPTarget&&this.mUPTarget.isEqualNode(r)||this.rowCellSelectionHandler(a,parseInt(r.getAttribute(oi),10)),this.parent.hoverFrozenRows(e),this.parent.isCheckBoxSelection&&(this.moveIntoUncheckCollection(t.closest(r,"."+Zr)),this.setCheckAllState())}else this.checkedTarget=n,n.classList.contains("e-checkselectall")?this.checkSelectAll(n):this.checkSelect(n);this.parent.isCheckBoxSelection||!t.Browser.isDevice||this.isSingleSel()||this.showPopup(e)}else if(e.target.classList.contains("e-headercell")&&!e.target.classList.contains("e-stackedheadercell")){var l=e.target.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");this.headerSelectionHandler(this.parent.getColumnIndexByUid(l))}this.isMultiCtrlRequest=!1,this.isMultiShiftRequest=!1,t.isNullOrUndefined(t.closest(e.target,".e-unboundcell"))&&(this.preventFocus=!1)},i.prototype.popUpClickHandler=function(e){var r=e.target;t.closest(r,".e-headercell")||e.target.classList.contains(Ur)||t.closest(r,".e-gridpopup")?r.classList.contains("e-rowselect")&&(r.classList.contains("e-spanclicked")?(r.classList.remove("e-spanclicked"),this.enableSelectMultiTouch=!1,this.parent.element.querySelector(".e-gridpopup").style.display="none"):(r.classList.add("e-spanclicked"),this.enableSelectMultiTouch=!0)):this.parent.element.querySelector(".e-gridpopup").style.display="none"},i.prototype.showPopup=function(e){this.selectionSettings.enableSimpleMultiRowSelection||z(this.parent.element.querySelector(".e-gridpopup"),e,"e-rowselect e-icons e-icon-rowselect"+(!this.isSingleSel()&&(this.selectedRecords.length>(this.parent.getFrozenColumns()?2:1)||this.selectedRowCellIndexes.length>1)?" e-spanclicked":""))},i.prototype.rowCellSelectionHandler=function(e,r){!this.isMultiCtrlRequest&&!this.isMultiShiftRequest||this.isSingleSel()?(this.isDragged||this.selectRow(e,this.selectionSettings.enableToggle),this.selectCell({rowIndex:e,cellIndex:r},this.selectionSettings.enableToggle),this.selectedRowCellIndexes.length&&this.updateAutoFillPosition(),this.drawBorders()):this.isMultiShiftRequest?(this.parent.isCheckBoxSelection||!this.parent.isCheckBoxSelection&&!t.closest(this.target,"."+Ur).classList.contains($r)?this.selectRowsByRange(t.isUndefined(this.prevRowIndex)?e:this.prevRowIndex,e):this.addRowsToSelection([e]),this.selectCellsByRange(t.isUndefined(this.prevCIdxs)?{rowIndex:e,cellIndex:r}:this.prevCIdxs,{rowIndex:e,cellIndex:r}),this.updateAutoFillPosition(),this.drawBorders()):(this.addRowsToSelection([e]),this.addCellsToSelection([{rowIndex:e,cellIndex:r}]),this.showHideBorders("none")),this.isDragged=!1},i.prototype.onCellFocused=function(e){if(this.parent.frozenRows&&e.container.isHeader&&e.byKey)if("upArrow"===e.keyArgs.action)this.parent.allowFiltering?e.isJump="INPUT"===e.element.tagName:e.isJump="TH"===e.element.tagName;else if("downArrow"===e.keyArgs.action){var r=Number(e.element.parentElement.getAttribute(si));e.isJump=0===r}else"ctrlHome"===e.keyArgs.action&&(e.isJump=!0);var i=this.parent.isFrozenGrid()?(e.container.isHeader&&"TD"!==e.element.tagName&&e.isJump&&!this.selectionSettings.allowColumnSelection||(e.container.isContent||"TD"===e.element.tagName)&&!(e.container.isSelectable||"TD"===e.element.tagName))&&!(e.byKey&&"space"===e.keyArgs.action):(e.container.isHeader&&e.isJump||e.container.isContent&&!e.container.isSelectable)&&!(e.byKey&&"space"===e.keyArgs.action)&&!(e.element.classList.contains("e-detailrowexpand")||e.element.classList.contains("e-detailrowcollapse")),n=e.container.isHeader&&"TD"!==e.element.tagName&&!t.closest(e.element,"."+Ur)&&!(e.byKey&&"space"===e.keyArgs.action);if(!e.byKey||i)return void(i&&!this.parent.isCheckBoxSelection&&this.clearSelection());var o=e.container.isContent?e.container.indexes:e.indexes,s=o[0],a=o[1],l=this.focus.getPrevIndexes();if(this.parent.frozenRows)if(e.container.isHeader&&("TD"===e.element.tagName||t.closest(e.element,"."+Ur))){var h=this.parent.getHeaderTable().querySelector("thead").childElementCount;s-=h,l.rowIndex=t.isNullOrUndefined(l.rowIndex)?null:l.rowIndex-h}else s+=this.parent.frozenRows,l.rowIndex=0!==l.rowIndex&&t.isNullOrUndefined(l.rowIndex)?null:l.rowIndex+this.parent.frozenRows;if(this.parent.isFrozenGrid()){var p=Number(e.element.getAttribute(oi)),d=this.parent.getSelectedRowCellIndexes();d.length&&0===l.cellIndex&&(l.cellIndex=d[d.length-1].cellIndexes[0]),l.cellIndex=t.isNullOrUndefined(l.cellIndex)?null:l.cellIndex===a?p:p-1,a=p}if(this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache&&(s=parseInt(e.element.parentElement.getAttribute("data-rowindex"),10)),!(n||-1===["ctrlPlusA","escape"].indexOf(e.keyArgs.action)&&"space"!==e.keyArgs.action&&s===l.rowIndex&&a===l.cellIndex)||this.selectionSettings.allowColumnSelection){this.preventFocus=!0;var c=this.getKeyColIndex(e);if(this.needColumnSelection&&(a=c),this.parent.element.classList.contains("e-gridcell-read")&&("tab"===e.keyArgs.action||"shiftTab"===e.keyArgs.action||"rightArrow"===e.keyArgs.action||"leftArrow"===e.keyArgs.action)){var u=this.target.getAttribute("aria-label");u=this.target.innerHTML+" column header "+this.parent.getColumnByIndex(a).field,this.target.setAttribute("aria-label",u)}switch(e.keyArgs.action){case"downArrow":case"upArrow":case"enter":case"shiftEnter":this.target=e.element,this.isKeyAction=!0,this.applyDownUpKey(s,a);break;case"rightArrow":case"leftArrow":this.applyRightLeftKey(s,a);break;case"shiftDown":case"shiftUp":this.shiftDownKey(s,a);break;case"shiftLeft":case"shiftRight":this.applyShiftLeftRightKey(s,a);break;case"home":case"end":a="end"===e.keyArgs.action?this.getLastColIndex(s):0,this.applyHomeEndKey(s,a);break;case"ctrlHome":case"ctrlEnd":this.applyCtrlHomeEndKey(s,a);break;case"escape":this.clearSelection();break;case"ctrlPlusA":this.ctrlPlusA();break;case"space":this.applySpaceSelection(e.element);break;case"tab":this.parent.editSettings.allowNextRowEdit&&this.selectRow(s)}this.needColumnSelection=!1,this.preventFocus=!1,this.positionBorders(),this.updateAutoFillPosition()}},i.prototype.getKeyColIndex=function(e){var t,r=null,i=e.element.querySelector(".e-stackedheadercelldiv");if(this.selectionSettings.allowColumnSelection&&O(e.element,"e-columnheader"))if(this.needColumnSelection=!!e.container.isHeader,i){if("rightArrow"===e.keyArgs.action||"leftArrow"===e.keyArgs.action)return r;t=i.getAttribute("e-mappinguid");var n=this.getstackedColumns(this.parent.getColumnByUid(t).columns),o=this.parent.getColumnIndexByUid(n[n.length-1].uid),s=this.parent.getColumnIndexByUid(n[0].uid);r=this.prevColIndex>=o?s:o}else r=this.parent.getColumnIndexByUid(e.element.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));return r},i.prototype.ctrlPlusA=function(){this.isRowType()&&!this.isSingleSel()&&this.selectRowsByRange(0,this.getCurrentBatchRecordChanges().length-1),this.isCellType()&&!this.isSingleSel()&&this.selectCellsByRange({rowIndex:0,cellIndex:0},{rowIndex:this.parent.getRows().length-1,cellIndex:this.parent.getColumns().length-1})},i.prototype.applySpaceSelection=function(e){e.classList.contains("e-checkselectall")?(this.checkedTarget=e,this.checkSelectAll(this.checkedTarget)):e.classList.contains("e-checkselect")&&(this.checkedTarget=e,this.checkSelect(this.checkedTarget))},i.prototype.applyDownUpKey=function(e,t){var r=this.parent;!this.parent.isCheckBoxSelection||"Check"!==this.parent.checkAllRows||this.selectionSettings.persistSelection||this.selectionSettings.checkboxOnly||(this.checkSelectAllAction(!1),this.checkedTarget=null),this.isRowType()&&!this.selectionSettings.checkboxOnly&&(this.parent.frozenRows,this.selectRow(e,!0),this.applyUpDown(r.selectedRowIndex)),this.isCellType()&&this.selectCell({rowIndex:e,cellIndex:t},!0),this.selectionSettings.allowColumnSelection&&this.needColumnSelection&&this.selectColumn(t)},i.prototype.applyUpDown=function(e){if(!(e<0)){this.target||(this.target=this.parent.getRows()[0].children[this.parent.groupSettings.columns.length||0]);var t=parseInt(this.target.getAttribute(oi),10),r=this.parent.getFrozenColumns();if(r)this.target=t>=r?this.contentRenderer.getMovableRowByIndex(e).getElementsByClassName(Ur)[t-r]:this.contentRenderer.getRowByIndex(e).getElementsByClassName(Ur)[parseInt(t.toString(),10)];else{var i=this.contentRenderer.getRowByIndex(e);i&&(this.target=i.getElementsByClassName(Ur)[parseInt(t.toString(),10)])}if(this.addAttribute(this.target),this.parent.element.classList.contains("e-gridcell-read")){var n=this.target.getAttribute("aria-label");n=this.target.innerHTML,this.target.setAttribute("aria-label",n)}}},i.prototype.applyRightLeftKey=function(e,t){this.selectionSettings.allowColumnSelection&&this.needColumnSelection?this.selectColumn(t):this.isCellType()&&(this.selectCell({rowIndex:e,cellIndex:t},!0),this.addAttribute(this.target))},i.prototype.applyHomeEndKey=function(e,t){this.isCellType()?this.selectCell({rowIndex:e,cellIndex:t},!0):this.addAttribute(this.parent.getCellFromIndex(e,t))},i.prototype.shiftDownKey=function(e,r){this.isMultiShiftRequest=!0,this.isRowType()&&!this.isSingleSel()&&(t.isUndefined(this.prevRowIndex)?this.isPartialSelection?this.selectRow(e,!0):this.selectRow(0,!0):(this.selectRowsByRange(this.prevRowIndex,e),this.applyUpDown(e))),this.isCellType()&&!this.isSingleSel()&&this.selectCellsByRange(this.prevCIdxs||{rowIndex:0,cellIndex:0},{rowIndex:e,cellIndex:r}),this.isMultiShiftRequest=!1},i.prototype.applyShiftLeftRightKey=function(e,t){this.isMultiShiftRequest=!0,this.selectionSettings.allowColumnSelection&&this.needColumnSelection?this.selectColumnsByRange(this.prevColIndex,t):this.selectCellsByRange(this.prevCIdxs,{rowIndex:e,cellIndex:t}),this.isMultiShiftRequest=!1},i.prototype.getstackedColumns=function(e){for(var t=[],r=0,i=e.length;r<i;r++)e[parseInt(r.toString(),10)].columns?this.getstackedColumns(e[parseInt(r.toString(),10)].columns):t.push(e[parseInt(r.toString(),10)]);return t},i.prototype.applyCtrlHomeEndKey=function(e,t){this.isRowType()&&(this.selectRow(e,!0),this.addAttribute(this.parent.getCellFromIndex(e,t))),this.isCellType()&&this.selectCell({rowIndex:e,cellIndex:t},!0)},i.prototype.addRemoveClassesForRow=function(e,t,r){for(var i=[],n=3;n<arguments.length;n++)i[n-3]=arguments[n];if(e){var o=[].slice.call(e.getElementsByClassName(Ur)),s=e.querySelector(".e-detailrowcollapse")||e.querySelector(".e-detailrowexpand"),a=e.querySelector(".e-rowdragdrop");s&&o.push(s),a&&o.push(a),$.apply(void 0,[o,t].concat(i))}this.getRenderer().setSelection(e?e.getAttribute("data-uid"):null,t,r)},i.prototype.isRowType=function(){return"Row"===this.selectionSettings.mode||"Both"===this.selectionSettings.mode},i.prototype.isCellType=function(){return"Cell"===this.selectionSettings.mode||"Both"===this.selectionSettings.mode},i.prototype.isSingleSel=function(){return"Single"===this.selectionSettings.type},i.prototype.getRenderer=function(){return t.isNullOrUndefined(this.contentRenderer)&&(this.contentRenderer=this.factory.getRenderer(e.RenderType.Content)),this.contentRenderer},i.prototype.getSelectedRecords=function(){return!this.selectionSettings.persistSelection&&this.selectedRecords.length?this.parent.getRowsObject().filter(function(e){return e.isSelected}).map(function(e){return e.data}):this.persistSelectedData},i.prototype.selectColumn=function(e){var r=this.parent;if(!t.isNullOrUndefined(r.getColumns()[parseInt(e.toString(),10)])){var i=r.getColumnByIndex(e),n=r.getColumnHeaderByUid(i.uid),o=n.classList.contains("e-columnselection");if(r.selectionSettings.allowColumnSelection){var s=this.selectedColumnsIndexes.length>1&&this.selectedColumnsIndexes.indexOf(e)>-1;if(this.clearColDependency(),!o||!this.selectionSettings.enableToggle||s){var a={columnIndex:e,headerCell:n,column:i,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest};if(this.onActionBegin(a,"columnSelecting"),a.cancel)return void this.disableInteracted();r.selectionSettings.enableToggle&&e===this.prevColIndex&&o&&!s||this.updateColSelection(n,e);var l={columnIndex:e,headerCell:n,column:i,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(l,"columnSelected")}this.updateColProps(e)}}},i.prototype.selectColumnsByRange=function(e,r){var i=this.parent;if(!t.isNullOrUndefined(i.getColumns()[parseInt(e.toString(),10)])){var n=[];if("Single"===i.selectionSettings.type||t.isNullOrUndefined(r))n[0]=e;else for(var o=e<r,s=e;o?s<=r:s>=r;o?s++:s--)n.push(s);this.selectColumns(n)}},i.prototype.selectColumns=function(e){var t=this.parent,r=this.getselectedCols();if("Single"===t.selectionSettings.type&&(e=[e[0]]),t.selectionSettings.allowColumnSelection){this.clearColDependency();var i={columnIndex:e[0],headerCell:r,columnIndexes:e,column:t.getColumnByIndex(e[0]),cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest};if(this.onActionBegin(i,"columnSelecting"),i.cancel)return void this.disableInteracted();for(var n=0,o=e.length;n<o;n++)this.updateColSelection(t.getColumnHeaderByUid(t.getColumnByIndex(e[parseInt(n.toString(),10)]).uid),e[parseInt(n.toString(),10)]);r=this.getselectedCols();var s={columnIndex:e[0],headerCell:r,columnIndexes:e,column:t.getColumnByIndex(e[0]),target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(s,"columnSelected"),this.updateColProps(e[0])}},i.prototype.selectColumnWithExisting=function(e){var r=this.parent;if(!t.isNullOrUndefined(r.getColumns()[parseInt(e.toString(),10)])){var i=r.getColumnHeaderByUid(r.getColumnByIndex(e).uid),n=this.getselectedCols();if("Single"===r.selectionSettings.type&&this.clearColDependency(),r.selectionSettings.allowColumnSelection){if(this.selectedColumnsIndexes.indexOf(e)>-1)this.clearColumnSelection(e);else{var o={columnIndex:e,headerCell:n,columnIndexes:this.selectedColumnsIndexes,column:r.getColumnByIndex(e),cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest};if(this.onActionBegin(o,"columnSelecting"),o.cancel)return void this.disableInteracted();this.updateColSelection(i,e);var s={columnIndex:e,headerCell:n=this.getselectedCols(),column:r.getColumnByIndex(e),columnIndexes:this.selectedColumnsIndexes,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(s,"columnSelected")}this.updateColProps(e)}}},i.prototype.clearColumnSelection=function(e){if(this.isColumnSelected){var r=this.parent;if(!t.isNullOrUndefined(e)&&-1===this.selectedColumnsIndexes.indexOf(e))return;var i=t.isNullOrUndefined(e)?this.selectedColumnsIndexes[this.selectedColumnsIndexes.length-1]:e,n=r.getColumnByIndex(i),o=void 0,s=r.getColumnByIndex(i),a={columnIndex:i,headerCell:o=n.getFreezeTableName()===ii?r.getFrozenRightColumnHeaderByIndex(i):"movable"===n.getFreezeTableName()?r.getMovableColumnHeaderByIndex(i):r.getColumnHeaderByUid(s.uid),columnIndexes:this.selectedColumnsIndexes,column:s,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted};if(this.columnDeselect(a,"columnDeselecting"))return void this.disableInteracted();for(var l=t.isNullOrUndefined(e)?[].slice.call(r.getHeaderContent().getElementsByClassName("e-columnselection")):[o],h=this.getSelectedColumnCells(e),p=0,d=l.length;p<d;p++)$([l[parseInt(p.toString(),10)]],!1,"e-columnselection");for(var p=0,d=h.length;p<d;p++)$([h[parseInt(p.toString(),10)]],!1,"e-columnselection");t.isNullOrUndefined(e)?(this.columnDeselect(a,"columnDeselected"),this.selectedColumnsIndexes=[],this.isColumnSelected=!1,this.parent.getColumns().filter(function(e){return e.isSelected=!1})):(this.selectedColumnsIndexes.splice(this.selectedColumnsIndexes.indexOf(e),1),this.parent.getColumns()[parseInt(e.toString(),10)].isSelected=!1)}},i.prototype.getselectedCols=function(){var e,t=this.parent;if(this.selectedColumnsIndexes.length>1){e=[];for(var r=0;r<this.selectedColumnsIndexes.length;r++)e.push(t.getColumnHeaderByUid(t.getColumnByIndex(this.selectedColumnsIndexes[parseInt(r.toString(),10)]).uid))}else e=t.getColumnHeaderByUid(t.getColumnByIndex(this.selectedColumnsIndexes[0]).uid);return e},i.prototype.getSelectedColumnCells=function(e){var r,i,n=this.parent,o=!t.isNullOrUndefined(this.parent.rowTemplate),s=o?n.getRows():n.getDataRows();n.isFrozenGrid()&&n.getContent().querySelector("."+Wr)&&(r=o?n.getMovableRows():n.getMovableDataRows(),s=n.addMovableRows(s,r),n.getFrozenMode()===ri&&(i=o?n.getFrozenRightRows():n.getFrozenRightDataRows(),s=n.addMovableRows(s,i)));for(var a=[],l=t.isNullOrUndefined(e)?".e-columnselection":'[data-colindex="'+e+'"]',h=0,p=s.length;h<p;h++)a=a.concat([].slice.call(s[parseInt(h.toString(),10)].querySelectorAll(l)));return a},i.prototype.columnDeselect=function(e,t){return"columnDeselected"===t&&delete e.cancel,this.onActionComplete(e,t),e.cancel},i.prototype.updateColProps=function(e){this.prevColIndex=e,this.isColumnSelected=this.selectedColumnsIndexes.length&&!0},i.prototype.clearColDependency=function(){this.clearColumnSelection(),this.selectedColumnsIndexes=[]},i.prototype.updateColSelection=function(e,r){if(!t.isNullOrUndefined(this.parent.getColumns()[parseInt(r.toString(),10)])){var i,n=this.parent.getFrozenLeftCount(),o=this.parent.getMovableColumnsCount(),s=this.parent.getColumnByIndex(r),a=!t.isNullOrUndefined(this.parent.rowTemplate);this.selectedColumnsIndexes.push(r),this.parent.getColumns()[parseInt(r.toString(),10)].isSelected=!0,s.getFreezeTableName()===ii?(r-=n+o,i=a?this.parent.getFrozenRightRows():this.parent.getFrozenRightDataRows()):"movable"===s.getFreezeTableName()?(r-=n,i=a?this.parent.getMovableRows():this.parent.getMovableDataRows()):(r+=this.parent.getIndentCount(),i=a?this.parent.getRows():this.parent.getDataRows()),$([e],!0,"e-columnselection");for(var l=0,h=i.length;l<h;l++)i[parseInt(l.toString(),10)].classList.contains(Zr)&&(!i[parseInt(l.toString(),10)].classList.contains(ei)&&!i[parseInt(l.toString(),10)].classList.contains(ti)||"Normal"!==this.parent.editSettings.mode||t.isNullOrUndefined(i[parseInt(l.toString(),10)].querySelector("tr").childNodes[parseInt(r.toString(),10)])?t.isNullOrUndefined(i[parseInt(l.toString(),10)].childNodes[parseInt(r.toString(),10)])||$([i[parseInt(l.toString(),10)].childNodes[parseInt(r.toString(),10)]],!0,"e-columnselection"):$([i[parseInt(l.toString(),10)].querySelector("tr").childNodes[parseInt(r.toString(),10)]],!0,"e-columnselection"))}},i.prototype.headerSelectionHandler=function(e){!this.isMultiCtrlRequest&&!this.isMultiShiftRequest||this.isSingleSel()?this.selectColumn(e):this.isMultiShiftRequest?this.selectColumnsByRange(t.isUndefined(this.prevColIndex)?e:this.prevColIndex,e):this.selectColumnWithExisting(e)},i.prototype.addEventListener_checkbox=function(){var e=this;this.parent.on(Xt,this.dataReady,this),this.onDataBoundFunction=this.onDataBound.bind(this),this.parent.addEventListener(qt,this.onDataBoundFunction),this.parent.on("refresh-infinite-persist-selection",this.onDataBoundFunction),this.parent.on(Yt,this.checkBoxSelectionChanged,this),this.parent.on("before-refresh-on-data-change",this.initPerisistSelection,this),this.parent.on(Zt,this.setCheckAllForEmptyGrid,this),this.actionCompleteFunc=this.actionCompleteHandler.bind(this),this.parent.addEventListener(Nt,this.actionCompleteFunc),this.parent.on(ar,this.clickHandler,this),this.resizeEndFn=function(){e.updateAutoFillPosition(),e.drawBorders()},this.resizeEndFn.bind(this),this.parent.addEventListener("resizeStop",this.resizeEndFn)},i.prototype.removeEventListener_checkbox=function(){this.parent.off(Xt,this.dataReady),this.parent.removeEventListener(qt,this.onDataBoundFunction),this.parent.removeEventListener(Nt,this.actionCompleteFunc),this.parent.off("refresh-infinite-persist-selection",this.onDataBoundFunction),this.parent.off(Zt,this.setCheckAllForEmptyGrid),this.parent.off(ar,this.clickHandler),this.parent.off("before-refresh-on-data-change",this.initPerisistSelection)},i.prototype.setCheckAllForEmptyGrid=function(){var e=this.getCheckAllBox();if(e){this.parent.isCheckBoxSelection=!0;var r=e.nextElementSibling;t.removeClass([r],["e-check","e-stop","e-uncheck"]),t.addClass([r.parentElement],["e-checkbox-disabled"])}},i.prototype.dataReady=function(e){this.isHeaderCheckboxClicked=!1;var t=this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.requestType;"virtualscroll"===e.requestType||this.parent.isPersistSelection||t||(this.disableUI=!this.parent.enableImmutableMode,this.clearSelection(),this.setCheckAllState(),this.disableUI=!1)},i.prototype.actionCompleteHandler=function(e){"save"===e.requestType&&this.parent.isPersistSelection&&this.refreshPersistSelection()},i.prototype.selectRowIndex=function(e){this.parent.isSelectedRowIndexUpdating=!0,t.isNullOrUndefined(this.parent.selectedRowIndex)||-1===this.parent.selectedRowIndex?this.parent.selectedRowIndex=e:this.parent.selectedRowIndex=-1},i.prototype.disableInteracted=function(){this.isInteracted=!1},i.prototype.activeTarget=function(){this.actualTarget=this.isInteracted?this.actualTarget:null},i}(),Sn=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.search=function(e){var r=this.parent;if(e=t.isNullOrUndefined(e)?"":e,Y(r))return void r.notify(Cr,{instance:this,handler:this.search,arg1:e});e!==r.searchSettings.key?(r.searchSettings.key=e.toString(),r.dataBind()):this.refreshSearch&&r.refresh()},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on($t,this.onPropertyChanged,this),this.parent.on("searching-complete",this.onSearchComplete,this),this.parent.on(lr,this.destroy,this),this.actionCompleteFunc=this.onActionComplete.bind(this),this.parent.addEventListener(Nt,this.actionCompleteFunc),this.parent.on("cancel-Begin",this.cancelBeginEvent,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off($t,this.onPropertyChanged),this.parent.off("searching-complete",this.onSearchComplete),this.parent.off(lr,this.destroy),this.parent.removeEventListener(Nt,this.actionCompleteFunc),this.parent.off("cancel-Begin",this.cancelBeginEvent))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.onPropertyChanged=function(e){e.module===this.getModuleName()&&(t.isNullOrUndefined(e.properties.key)?this.parent.notify(er,{requestType:"searching",type:Bt}):this.parent.notify(er,{requestType:"searching",type:Bt,searchString:this.parent.searchSettings.key}))},e.prototype.onSearchComplete=function(e){this.parent.trigger(Nt,t.extend(e,{searchString:this.parent.searchSettings.key,requestType:"searching",type:Nt}))},e.prototype.onActionComplete=function(e){this.refreshSearch="searching"!==e.requestType},e.prototype.cancelBeginEvent=function(e){"searching"===e.requestType&&this.parent.setProperties({searchSettings:{key:""}},!0)},e.prototype.getModuleName=function(){return"search"},e}(),bn=function(){function e(e){this.colName=[],this.isShowHide=!1,this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:"batchCancel",handler:this.batchChanges},{event:"cancelcnfrmDlg",handler:this.resetColumnState}],Ze(this.parent,this.evtHandlers,!0,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||Ze(this.parent,this.evtHandlers,!1)},e.prototype.batchChanges=function(){this.isShowHide&&(this.isShowHide=!1,this.setVisible(this.colName,this.changedCol),this.changedCol=this.colName=[])},e.prototype.show=function(e,t){var r=this.getToggleFields(e),i=this.getColumns(r,t);this.parent.notify("tooltip-destroy",{module:"edit"});for(var n=0;n<i.length;n++)i[parseInt(n.toString(),10)].visible=!0;this.setVisible(i)},e.prototype.hide=function(e,t){var r=this.getToggleFields(e),i=this.getColumns(r,t);this.parent.notify("tooltip-destroy",{module:"edit"});for(var n=0;n<i.length;n++)i[parseInt(n.toString(),10)].visible=!1;this.setVisible(i)},e.prototype.getToggleFields=function(e){return"string"==typeof e?[e]:e},e.prototype.getColumns=function(e,t){var r=this;return w(e,function(e){return w(r.parent.columnModel,function(r){if(r[""+t]===e)return r})[0]})},e.prototype.batchActionPrevent=function(e,t){return void 0===t&&(t=[]),!Y(this.parent)||(this.colName=e,this.changedCol=t,this.parent.closeEdit(),!1)},e.prototype.resetColumnState=function(){if(this.isShowHide)for(var e=0;e<this.colName.length;e++)this.colName[parseInt(e.toString(),10)].visible=!this.colName[parseInt(e.toString(),10)].visible},e.prototype.setVisible=function(e,r){var i=this;if(void 0===r&&(r=[]),this.isShowHide=!0,this.batchActionPrevent(e,r)){var n={requestType:"columnstate",cancel:!1,columns:r=r.length>0?r:e};this.parent.enableInfiniteScrolling&&this.parent.allowGrouping&&this.parent.groupModule.groupSettings.columns.length>0&&(this.parent.contentModule.visibleRows=[]),this.parent.trigger(Bt,n,function(n){var o=i.parent.getColumns();if(e=t.isNullOrUndefined(e)?o:e,n.cancel)return i.parent.notify("reset-columns",{showHideArgs:n}),void(e.length>0&&(e[0].visible=!0));ue(i.parent)&&i.parent.contentModule.emptyVcRows(),i.parent.allowSelection&&i.parent.getSelectedRecords().length&&!i.parent.selectionSettings.persistSelection&&i.parent.clearSelection(),i.parent.enableColumnVirtualization?e.filter(function(e){return o.some(function(t){return e.field===t.field})}).length&&i.parent.notify(hr,e):i.parent.notify(hr,e);var s={requestType:"columnstate",columns:r};i.parent.trigger(Nt,s),"All"!==i.parent.columnQueryMode&&i.parent.refresh()}),this.parent.autoFit&&!this.parent.groupSettings.columns.length&&this.parent.preventAdjustColumns()}},e}(),wn=function(){function e(e){this.previousValues={top:0,left:0},this.oneTimeReady=!0,this.parent=e,this.widthService=new en(e),this.addEventListener()}return e.prototype.getModuleName=function(){return"scroll"},e.prototype.setWidth=function(e){if(this.parent.element.style.width=t.formatUnit(this.parent.width),e&&this.widthService.setWidthToColumns(),this.parent.toolbarModule&&this.parent.toolbarModule.toolbar&&this.parent.toolbarModule.toolbar.element){var r=this.parent.toolbarModule.toolbar.element,i=r.querySelector(".e-toolbar-left"),n=r.querySelector(".e-toolbar-center"),o=r.querySelector(".e-toolbar-right"),s=r.querySelector(".e-toolbar-items"),a=i?i.clientWidth:0,l=n?n.clientWidth:0,h=o?o.clientWidth:0,p=s?s.clientWidth:0,d=r?r.clientWidth:0;(!this.parent.enableAdaptiveUI||a>d||l>d||h>d||p>d)&&this.parent.toolbarModule.toolbar.refreshOverflow()}},e.prototype.setHeight=function(){var r=0,i=this.parent.getContent().querySelector("."+Yr),n=this.parent.height;if(this.parent.isFrozenGrid()&&"auto"!==this.parent.height&&this.parent.height.toString().indexOf("%")<0&&(n=parseInt(n,10)-e.getScrollBarWidth()),!this.parent.enableVirtualization&&this.parent.frozenRows&&"auto"!==this.parent.height){var o=this.parent.getHeaderContent().querySelector(li+":not(.e-masked-tbody)");r=o?o.offsetHeight:0,o&&r?r-=o.getElementsByClassName(ti).length*this.parent.getRowHeight():!this.parent.isInitialLoad&&"Shimmer"===this.parent.loadingIndicator.indicatorType&&this.parent.getHeaderContent().querySelector(".e-masked-table")&&(n=parseInt(n,10)-this.parent.frozenRows*this.parent.getRowHeight()),i.style.height=t.formatUnit(n-r)}else i.style.height=t.formatUnit(n);this.ensureOverflow(i),this.parent.isFrozenGrid()&&this.refresh()},e.prototype.setPadding=function(){var t=this.parent.getHeaderContent(),r=e.getScrollBarWidth()-this.getThreshold(),i=this.getCssProperties(),n="Right"===this.parent.getFrozenMode()||this.parent.getFrozenMode()===ri?"0.5px":"1px";t.querySelector("."+_r).style[i.border]=r>0?n:"0px",t.style[i.padding]=r>0?r+"px":"0px"},e.prototype.removePadding=function(e){var t=this.getCssProperties(e),r=this.parent.getHeaderContent().querySelector("."+_r);r.style[t.border]="",r.parentElement.style[t.padding]="";var i=this.parent.getFooterContent();i&&i.classList.contains("e-footerpadding")&&i.classList.remove("e-footerpadding")},e.prototype.refresh=function(){if("100%"===this.parent.height){var e=this.parent.getContent();this.parent.element.style.height="100%";var t=this.widthService.getSiblingsHeight(e);e.style.height="calc(100% - "+t+"px)",this.parent.isFrozenGrid()&&(e.firstElementChild.style.height="calc(100% - "+j()+"px)")}},e.prototype.getThreshold=function(){return"mozilla"===t.Browser.info.name?.5:1},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(Zt,this.wireEvents,this),this.parent.on(Yt,this.wireEvents,this),this.parent.on(Jt,this.onPropertyChanged,this),this.parent.on("textWrapRefresh",this.wireEvents,this),this.parent.on(rr,this.setScrollLeft,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Zt,this.wireEvents),this.parent.off(Yt,this.wireEvents),this.parent.off(Jt,this.onPropertyChanged),this.parent.off("textWrapRefresh",this.wireEvents),this.parent.off(rr,this.setScrollLeft),this.unwireEvents())},e.prototype.unwireEvents=function(){var e,r,i=this.parent.isFrozenGrid();this.content&&(e=this.content.querySelector("."+Wr)),this.header&&(r=this.header.querySelector("."+Kr));var n=this.parent.getContent()?this.parent.getContent().querySelector(".e-movablescrollbar"):null;this.parent.frozenRows&&(this.header&&!i||i&&r)&&(t.EventHandler.remove(i?r:this.header,"touchstart pointerdown",this.setPageXY),t.EventHandler.remove(i?r:this.header,"touchmove pointermove",this.onTouchScroll)),this.parent.isFrozenGrid()?(n&&t.EventHandler.remove(n,"scroll",this.onCustomScrollbarScroll),e&&(t.EventHandler.remove(e,"scroll",this.onCustomScrollbarScroll),t.EventHandler.remove(e,"touchstart pointerdown",this.setPageXY),/macintosh|ipad/.test(t.Browser.userAgent.toLowerCase())&&t.Browser.isDevice||t.EventHandler.remove(e,"touchmove pointermove",this.onTouchScroll)),r&&(t.EventHandler.remove(r,"scroll",this.onCustomScrollbarScroll),t.EventHandler.remove(r,"touchstart pointerdown",this.setPageXY),t.EventHandler.remove(r,"touchmove pointermove",this.onTouchScroll)),this.content&&t.EventHandler.remove(this.content,"scroll",this.onFrozenContentScroll)):(this.content&&t.EventHandler.remove(this.content,"scroll",this.onContentScroll),this.header&&t.EventHandler.remove(this.header,"scroll",this.onContentScroll)),this.parent.aggregates.length&&this.parent.getFooterContent()&&t.EventHandler.remove(this.parent.getFooterContent().firstChild,"scroll",this.onContentScroll)},e.prototype.setScrollLeft=function(){this.parent.isFrozenGrid()?this.parent.headerModule.getMovableHeader().scrollLeft=this.previousValues.left:this.parent.getHeaderContent().querySelector("."+_r).scrollLeft=this.previousValues.left},e.prototype.onFrozenContentScroll=function(){var e=this;return function(r){null===e.content.querySelector(li)||e.parent.isPreventScrollEvent||(!t.isNullOrUndefined(e.parent.infiniteScrollModule)&&e.parent.enableInfiniteScrolling&&e.parent.notify("infinite-scroll-handler",r),e.previousValues.top=r.target.scrollTop)}},e.prototype.onContentScroll=function(e){var r=this,i=e,n=i.classList.contains(_r);return function(e){if(null!==r.content.querySelector(li)&&!r.parent.isPreventScrollEvent){var o=e.target,s=o.scrollLeft;if(!t.isNullOrUndefined(r.parent.infiniteScrollModule)&&r.parent.enableInfiniteScrolling&&r.parent.notify("infinite-scroll-handler",{target:e.target,isLeft:r.previousValues.left!==s}),r.parent.groupSettings.columns.length&&r.parent.groupSettings.enableLazyLoading){var a=r.previousValues.top<r.parent.getContent().firstElementChild.scrollTop;r.parent.notify("lazy-load-scroll-handler",{scrollDown:a})}r.parent.notify("virtual-scroll-edit",{});var l=o.classList.contains("e-summarycontent");if(r.previousValues.left===s)return void(r.previousValues.top=n?o.scrollTop:r.previousValues.top);r.parent.notify("close-filter-dialog",e),i.scrollLeft=s,l&&(r.header.scrollLeft=s),r.previousValues.left=s,r.parent.notify("scroll",{left:s})}}},e.prototype.onCustomScrollbarScroll=function(e,t){var r=this,i=e,n=t;return function(e){if(null!==r.content.querySelector(li)){var t=e.target.scrollLeft;r.previousValues.left!==t&&(i.scrollLeft=t,n.scrollLeft=t,r.previousValues.left=t,r.parent.notify("scroll",{left:t}),r.parent.isDestroyed)}}},e.prototype.onTouchScroll=function(e){var t=this,r=e;return function(e){if("mouse"!==e.pointerType){var i=t.parent.isFrozenGrid(),n=t.getPointXY(e),o=r.scrollLeft+(t.pageXY.x-n.x),s=i?t.parent.getHeaderContent().querySelector("."+Kr):t.parent.getHeaderContent().querySelector("."+_r),a=i?t.parent.getContent().querySelector("."+Wr):t.parent.getContent().querySelector("."+Yr);t.previousValues.left===o||o<0||s.scrollWidth-s.clientWidth<o||(e.preventDefault(),s.scrollLeft=o,a.scrollLeft=o,i&&(t.parent.getContent().querySelector(".e-movablescrollbar").scrollLeft=o),t.pageXY.x=n.x,t.previousValues.left=o)}}},e.prototype.setPageXY=function(){var e=this;return function(t){"mouse"!==t.pointerType&&(e.pageXY=e.getPointXY(t))}},e.prototype.getPointXY=function(e){var t={x:0,y:0};return e.touches&&e.touches.length?(t.x=e.touches[0].pageX,t.y=e.touches[0].pageY):(t.x=e.pageX,t.y=e.pageY),t},e.prototype.getScrollbleParent=function(e){if(null===e)return null;var r=t.isNullOrUndefined(e.tagName)?e.scrollingElement:e,i=document.defaultView.getComputedStyle(r,null).overflowY;return r.scrollHeight>r.clientHeight&&"hidden"!==i&&"visible"!==i||"HTML"===e.tagName||"BODY"===e.tagName?e:this.getScrollbleParent(e.parentNode)},e.prototype.addStickyListener=function(e){this.parentElement=this.getScrollbleParent(this.parent.element.parentElement),e&&this.parentElement?(this.eventElement="HTML"===this.parentElement.tagName||"BODY"===this.parentElement.tagName?document:this.parentElement,t.EventHandler.add(this.eventElement,"scroll",this.makeStickyHeader,this)):this.eventElement&&(t.EventHandler.remove(this.eventElement,"scroll",this.makeStickyHeader),this.eventElement=null)},e.prototype.wireEvents=function(){var e=this;if(this.oneTimeReady){var r=this.parent.isFrozenGrid();this.content=this.parent.getContent().querySelector("."+Yr),this.header=this.parent.getHeaderContent().querySelector("."+_r);var i=this.content.querySelector("."+Wr),n=this.header.querySelector("."+Kr),o=this.parent.getContent().querySelector(".e-movablescrollbar");this.parent.frozenRows&&(t.EventHandler.add(r?n:this.header,"touchstart pointerdown",this.setPageXY(),this),t.EventHandler.add(r?n:this.header,"touchmove pointermove",this.onTouchScroll(r?i:this.content),this)),this.parent.isFrozenGrid()?(t.EventHandler.add(o,"scroll",this.onCustomScrollbarScroll(i,n),this),t.EventHandler.add(i,"scroll",this.onCustomScrollbarScroll(o,n),this),t.EventHandler.add(n,"scroll",this.onCustomScrollbarScroll(o,i),this),t.EventHandler.add(this.content,"scroll",this.onFrozenContentScroll(),this),t.EventHandler.add(n,"touchstart pointerdown",this.setPageXY(),this),t.EventHandler.add(n,"touchmove pointermove",this.onTouchScroll(i),this),t.EventHandler.add(i,"touchstart pointerdown",this.setPageXY(),this),/macintosh|ipad/.test(t.Browser.userAgent.toLowerCase())&&t.Browser.isDevice||t.EventHandler.add(i,"touchmove pointermove",this.onTouchScroll(n),this)):(t.EventHandler.add(this.content,"scroll",this.onContentScroll(this.header),this),t.EventHandler.add(this.header,"scroll",this.onContentScroll(this.content),this)),this.parent.aggregates.length&&t.EventHandler.add(this.parent.getFooterContent().firstChild,"scroll",this.onContentScroll(this.content),this),this.parent.enableStickyHeader&&this.addStickyListener(!0),this.refresh(),this.oneTimeReady=!1}var s,a,l,h=this.parent.getContentTable();m(function(){s=e.header.scrollLeft,a=h.scrollHeight,l=e.parent.getContent().clientHeight},function(){var t={cancel:!1};e.parent.notify("check-scroll-reset",t),a<l&&e.setLastRowCell(),e.parent.enableVirtualization||e.parent.enableInfiniteScrolling||t.cancel||((e.parent.frozenRows>0||e.parent.isFrozenGrid())&&e.header.querySelector("."+Kr)?e.header.querySelector("."+Kr).scrollLeft=e.previousValues.left:e.header.scrollLeft=e.previousValues.left,e.content.scrollLeft=e.previousValues.left,e.content.scrollTop=e.previousValues.top),e.parent.enableColumnVirtualization||(e.content.scrollLeft=s),e.parent.isFrozenGrid()&&e.header.querySelector("."+Kr)&&(e.header.querySelector("."+Kr).scrollLeft=e.content.querySelector("."+Wr).scrollLeft)}),this.parent.isPreventScrollEvent=!1},e.prototype.setLastRowCell=function(){var e=this.parent.getContentTable();if(e.querySelector("tr:nth-last-child(2)")&&t.removeClass(e.querySelector("tr:nth-last-child(2)").querySelectorAll("td"),"e-lastrowcell"),t.addClass(e.querySelectorAll("tr:last-child td"),"e-lastrowcell"),this.parent.isFrozenGrid()){var r=this.parent.getContent().querySelector("."+Wr);if(r.querySelector("tr:nth-last-child(2)")&&t.removeClass(r.querySelector("tr:nth-last-child(2)").querySelectorAll("td"),"e-lastrowcell"),t.addClass(r.querySelectorAll("tr:last-child td"),"e-lastrowcell"),this.parent.getFrozenRightColumnsCount()){var i=this.parent.getContent().querySelector(".e-frozen-right-content");i.querySelector("tr:nth-last-child(2)")&&t.removeClass(i.querySelector("tr:nth-last-child(2)").querySelectorAll("td"),"e-lastrowcell"),t.addClass(i.querySelectorAll("tr:last-child td"),"e-lastrowcell")}}},e.prototype.getCssProperties=function(e){var r={},i=t.isNullOrUndefined(e)?this.parent.enableRtl:e;return r.border=i?"borderLeftWidth":"borderRightWidth",r.padding=i?"paddingLeft":"paddingRight",r},e.prototype.ensureOverflow=function(e){e.style.overflowY="auto"===this.parent.height?"auto":"scroll"},e.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName()){this.setPadding(),this.oneTimeReady=!0,"auto"===this.parent.height&&this.removePadding(),this.wireEvents(),this.setHeight();this.setWidth(!t.isNullOrUndefined(e.properties.width))}},e.prototype.makeStickyHeader=function(){if(this.parent.enableStickyHeader&&this.parent.element&&this.parent.getContent()){var e=this.parent.getContent().getClientRects()[0];if(e){var r=this.parent.getHeaderContent(),i=this.parent.element.querySelector(".e-toolbar"),n=this.parent.element.querySelector(".e-groupdroparea"),o=r.offsetHeight+(i?i.offsetHeight:0)+(n?n.offsetHeight:0),s=this.parentElement.getClientRects()[0].top,a=e.top-(s<0?0:s),l=e.left,h=document.body.querySelector("#"+this.parent.element.id+"_columnmenu");if(a<o&&e.bottom>0){r.classList.add("e-sticky");var p=0;n&&this.parent.groupSettings.showDropArea&&(this.setSticky(n,p,e.width,l,!0),p+=n.getClientRects()[0].height),i&&(this.setSticky(i,p,e.width,l,!0),p+=i.getClientRects()[0].height),this.setSticky(r,p,e.width,l,!0),t.isNullOrUndefined(h)||(h.style.position="fixed",h.style.top=o+"px")}else if(r.classList.contains("e-sticky")){this.setSticky(r,null,null,null,!1),i&&this.setSticky(i,null,null,null,!1),n&&this.setSticky(n,null,null,null,!1);var d=this.parent.element.querySelector(".e-ccdlg");if(d&&d.classList.remove("e-sticky"),!t.isNullOrUndefined(h)){h.style.position="absolute";var c=e.top-s;h.style.top=c+"px"}}this.parent.notify("sticky-scroll-complete",{})}}},e.prototype.setSticky=function(e,t,r,i,n){n?(e.style.width=r+"px",e.classList.add("e-sticky")):e.classList.remove("e-sticky"),e.style.top=null!=t?t+"px":"",e.style.left=null!==i?parseInt(e.style.left,10)!==i?i+"px":e.style.left:""},e.prototype.destroy=function(){var e=this.parent.element;if(e&&(e.querySelector("."+jr)||e.querySelector("."+Vr))){this.removeEventListener();var r=this.parent.getContent().querySelector("."+Yr);t.EventHandler.remove(r,"scroll",this.onContentScroll),this.parent.enableStickyHeader&&this.addStickyListener(!1),this.removePadding(),t.removeClass([this.parent.getHeaderContent().querySelector("."+_r)],_r),t.removeClass([r],Yr),r.style.height="",this.parent.element.style.width=""}},e.getScrollBarWidth=function(){return j()},e}(),In=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Rn=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},xn=function(r){function i(){var e=null!==r&&r.apply(this,arguments)||this;return e.templateFn={},e}return In(i,r),i.prototype.setFormatter=function(e){this.formatFn=e},i.prototype.getFormatter=function(){return this.formatFn},i.prototype.setTemplate=function(r){void 0===r&&(r={}),void 0!==this.footerTemplate&&(this.templateFn[t.getEnumValue(e.CellType,e.CellType.Summary)]={fn:t.compile(this.footerTemplate,r),property:"footerTemplate"}),void 0!==this.groupFooterTemplate&&(this.templateFn[t.getEnumValue(e.CellType,e.CellType.GroupSummary)]={fn:t.compile(this.groupFooterTemplate,r),property:"groupFooterTemplate"}),void 0!==this.groupCaptionTemplate&&(this.templateFn[t.getEnumValue(e.CellType,e.CellType.CaptionSummary)]={fn:t.compile(this.groupCaptionTemplate,r),property:"groupCaptionTemplate"})},i.prototype.getTemplate=function(r){return this.templateFn[t.getEnumValue(e.CellType,r)]},i.prototype.setPropertiesSilent=function(e){this.setProperties(e,!0)},Rn([t.Property()],i.prototype,"type",void 0),Rn([t.Property()],i.prototype,"field",void 0),Rn([t.Property()],i.prototype,"columnName",void 0),Rn([t.Property()],i.prototype,"format",void 0),Rn([t.Property()],i.prototype,"footerTemplate",void 0),Rn([t.Property()],i.prototype,"groupFooterTemplate",void 0),Rn([t.Property()],i.prototype,"groupCaptionTemplate",void 0),Rn([t.Property()],i.prototype,"customAggregate",void 0),i}(t.ChildProperty),Fn=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return In(r,e),Rn([t.Collection([],xn)],r.prototype,"columns",void 0),r}(t.ChildProperty),Tn=function(){function e(e,t){this.copyContent="",this.isSelect=!1,this.parent=e,this.serviceLocator=t,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(Yt,this.initialEnd,this),this.parent.on(sr,this.keyDownHandler,this),this.parent.on(ar,this.clickHandler,this),this.parent.on(Zt,this.initialEnd,this),t.EventHandler.add(this.parent.element,"keydown",this.pasteHandler,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(sr,this.keyDownHandler),this.parent.off(Yt,this.initialEnd),this.parent.off(ar,this.clickHandler),this.parent.off(Zt,this.initialEnd),t.EventHandler.remove(this.parent.element,"keydown",this.pasteHandler))},e.prototype.clickHandler=function(e){var t=e.target;t=O(t,"e-rowcell")},e.prototype.pasteHandler=function(e){var r=this,i=this.parent,n=/(Mac)/i.test(navigator.platform);if(67===e.keyCode&&n&&e.metaKey&&!i.isEdit&&this.copy(),86===e.keyCode&&(e.ctrlKey||n&&e.metaKey)&&!i.isEdit){if(!t.closest(document.activeElement,"."+Ur)||!i.editSettings.allowEditing||"Batch"!==i.editSettings.mode||"Cell"!==i.selectionSettings.mode||"Flow"===i.selectionSettings.cellSelectionMode||!this.clipBoardTextArea)return;this.activeElement=document.activeElement,this.clipBoardTextArea.value="";var o=window.scrollX,s=window.scrollY;this.clipBoardTextArea.focus(),setTimeout(function(){r.activeElement.focus(),window.scrollTo(o,s),r.paste(r.clipBoardTextArea.value,r.parent.getSelectedRowCellIndexes()[0].rowIndex,r.parent.getSelectedRowCellIndexes()[0].cellIndexes[0])},10)}},e.prototype.paste=function(e,r,i){var n,o,s,a=this.parent,l=i,h=r;if(a.editSettings.allowEditing&&"Batch"===a.editSettings.mode&&"Cell"===a.selectionSettings.mode&&"Flow"!==a.selectionSettings.cellSelectionMode){var p,d,c,u=e.split("\n"),g=a.getDataRows(),f=this.parent.isFrozenGrid();f&&(d=a.getMovableDataRows(),a.getFrozenRightColumnsCount()&&(c=a.getFrozenRightDataRows()));for(var m=0;m<u.length;m++){if(p=u[parseInt(m.toString(),10)].split("\t"),l=i,m===u.length-1&&""===u[parseInt(m.toString(),10)]||t.isUndefined(a.getRowByIndex(h))){l++;break}for(var y=0;y<p.length;y++){if(s=a.getCellFromIndex(h,l),f){var v=g[parseInt(h.toString(),10)],C=d[parseInt(h.toString(),10)];s=!!v.querySelector('[data-colindex="'+l+'"]')||C.querySelector('[data-colindex="'+l+'"]'),c&&!s&&(s=c[parseInt(h.toString(),10)].querySelector('[data-colindex="'+l+'"]'))}if(!s){l++;break}if(n=a.getColumnByIndex(l),o=n.getParser()?n.getParser()(p[parseInt(y.toString(),10)]):p[parseInt(y.toString(),10)],n.allowEditing&&!n.isPrimaryKey&&!n.template){var S={column:n,data:o,rowIndex:h};this.parent.trigger("beforePaste",S),h=S.rowIndex,S.cancel||a.editModule&&("number"===n.type?this.parent.editModule.updateCell(h,n.field,parseFloat(S.data)):a.editModule.updateCell(h,n.field,S.data))}l++}h++}a.selectionModule.selectCellsByRange({rowIndex:r,cellIndex:i},{rowIndex:h-1,cellIndex:l-1});var b=this.parent.getCellFromIndex(h-1,l-1);b&&t.classList(b,["e-focus","e-focused"],[])}},e.prototype.initialEnd=function(){this.l10n=this.serviceLocator.getService("localization"),this.parent.off(Yt,this.initialEnd),this.clipBoardTextArea=this.parent.createElement("textarea",{className:"e-clipboard",styles:"opacity: 0",attrs:{tabindex:"-1","aria-label":this.l10n.getConstant("ClipBoard")}}),this.parent.element.appendChild(this.clipBoardTextArea)},e.prototype.keyDownHandler=function(e){"ctrlPlusC"===e.action?this.copy():"ctrlShiftPlusH"===e.action&&this.copy(!0)},e.prototype.setCopyData=function(e){if(""===window.getSelection().toString()){var r=this.parent.isFrozenGrid();this.clipBoardTextArea.value=this.copyContent="";var i=void 0,n=void 0,o=this.parent.getDataRows();if(r&&(i=this.parent.getMovableDataRows(),this.parent.getFrozenMode()!==ri&&"Right"!==this.parent.getFrozenMode()||(n=this.parent.getFrozenRightRows())),"Cell"!==this.parent.selectionSettings.mode){var s=this.parent.getSelectedRowIndexes().sort(function(e,t){return e-t});if(e){for(var a=[],l=0;l<this.parent.getVisibleColumns().length;l++)a[parseInt(l.toString(),10)]=this.parent.getVisibleColumns()[parseInt(l.toString(),10)].headerText;this.getCopyData(a,!1,"\t",e),this.copyContent+="\n"}for(l=0;l<s.length;l++){l>0&&(this.copyContent+="\n");var h=[],p=[],d=[];if(r)d.push.apply(d,[].slice.call(i[s[parseInt(l.toString(),10)]].querySelectorAll(".e-rowcell:not(.e-hide)"))),"Right"!==this.parent.getFrozenMode()&&this.parent.getFrozenMode()!==ri||p.push.apply(p,[].slice.call(n[s[parseInt(l.toString(),10)]].querySelectorAll(".e-rowcell:not(.e-hide)"))),("Left"===this.parent.getFrozenMode()||this.parent.getFrozenMode()===ri||this.parent.isFrozenGrid()&&!this.parent.getFrozenMode())&&h.push.apply(h,[].slice.call(o[s[parseInt(l.toString(),10)]].querySelectorAll(".e-rowcell:not(.e-hide)")));else{var c=s[parseInt(l.toString(),10)];!ue(this.parent)&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache||this.parent.groupSettings.columns.length&&this.parent.groupSettings.enableLazyLoading)&&(c=o.map(function(e){return e.getAttribute("data-rowindex")}).indexOf(s[parseInt(l.toString(),10)].toString())),h.push.apply(h,[].slice.call(o[parseInt(c.toString(),10)].querySelectorAll(".e-rowcell:not(.e-hide)")))}f=h.concat(d).concat(p);this.getCopyData(f,!1,"\t",e)}}else{var u=this.checkBoxSelection();if(u.status){if(e){for(var g=[],l=0;l<u.colIndexes.length;l++)g.push(this.parent.getColumnHeaderByIndex(u.colIndexes[parseInt(l.toString(),10)]));this.getCopyData(g,!1,"\t",e),this.copyContent+="\n"}for(l=0;l<u.rowIndexes.length;l++){l>0&&(this.copyContent+="\n");var f=[].slice.call(o[u.rowIndexes[parseInt(l.toString(),10)]].getElementsByClassName("e-cellselectionbackground"));r&&(f.push.apply(f,[].slice.call(i[u.rowIndexes[parseInt(l.toString(),10)]].getElementsByClassName("e-cellselectionbackground"))),n&&f.push.apply(f,[].slice.call(n[u.rowIndexes[parseInt(l.toString(),10)]].getElementsByClassName("e-cellselectionbackground")))),this.getCopyData(f,!1,"\t",e)}}else this.getCopyData([].slice.call(this.parent.element.getElementsByClassName("e-cellselectionbackground")),!0,"\n",e)}var m={data:this.copyContent,cancel:!1};if(this.parent.trigger("beforeCopy",m),m.cancel)return;this.clipBoardTextArea.value=this.copyContent=m.data,t.Browser.userAgent.match(/ipad|ipod|iphone/i)?this.clipBoardTextArea.setSelectionRange(0,this.clipBoardTextArea.value.length):this.clipBoardTextArea.select(),this.isSelect=!0}},e.prototype.getCopyData=function(e,t,r,i){for(var n="string"!=typeof e[0],o=0;o<e.length;o++){if(i&&t){var s=parseInt(e[parseInt(o.toString(),10)].getAttribute(oi),10);this.copyContent+=this.parent.getColumns()[parseInt(s.toString(),10)].headerText+"\n"}n?e[parseInt(o.toString(),10)].classList.contains("e-hide")||(this.copyContent+=e[parseInt(o.toString(),10)].innerText):this.copyContent+=e[parseInt(o.toString(),10)],o<e.length-1&&(this.copyContent+=r)}},e.prototype.copy=function(e){document.queryCommandSupported("copy")&&this.clipBoardTextArea&&(this.setCopyData(e),document.execCommand("copy"),this.clipBoardTextArea.blur()),this.isSelect&&(window.getSelection().removeAllRanges(),this.isSelect=!1)},e.prototype.getModuleName=function(){return"clipboard"},e.prototype.destroy=function(){this.removeEventListener(),this.clipBoardTextArea&&t.remove(this.clipBoardTextArea)},e.prototype.checkBoxSelection=function(){var e=this.parent,t={status:!1};if("Cell"===e.selectionSettings.mode){var r=e.getSelectedRowCellIndexes(),i=void 0,n=[],o=void 0;for(o=0;o<r.length&&(r[parseInt(o.toString(),10)].cellIndexes.length&&n.push(r[parseInt(o.toString(),10)].rowIndex),!r[parseInt(o.toString(),10)].cellIndexes.length||(i||(i=JSON.stringify(r[parseInt(o.toString(),10)].cellIndexes.sort())),i===JSON.stringify(r[parseInt(o.toString(),10)].cellIndexes.sort())));o++);n.sort(function(e,t){return e-t}),o===r.length&&(t={status:!0,rowIndexes:n,colIndexes:r[0].cellIndexes})}return t},e}(),En=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),zn=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},Mn=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return En(r,e),zn([t.Property()],r.prototype,"field",void 0),zn([t.Property()],r.prototype,"direction",void 0),zn([t.Property(!1)],r.prototype,"isFromGroup",void 0),r}(t.ChildProperty),Dn=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return En(r,e),zn([t.Collection([],Mn)],r.prototype,"columns",void 0),zn([t.Property(!0)],r.prototype,"allowUnsort",void 0),r}(t.ChildProperty),On=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return En(r,e),zn([t.Property()],r.prototype,"field",void 0),zn([t.Property()],r.prototype,"operator",void 0),zn([t.Property()],r.prototype,"value",void 0),zn([t.Property()],r.prototype,"matchCase",void 0),zn([t.Property(!1)],r.prototype,"ignoreAccent",void 0),zn([t.Property()],r.prototype,"predicate",void 0),zn([t.Property({})],r.prototype,"actualFilterValue",void 0),zn([t.Property({})],r.prototype,"actualOperator",void 0),zn([t.Property()],r.prototype,"type",void 0),zn([t.Property()],r.prototype,"ejpredicate",void 0),zn([t.Property()],r.prototype,"uid",void 0),zn([t.Property()],r.prototype,"isForeignKey",void 0),zn([t.Property()],r.prototype,"condition",void 0),r}(t.ChildProperty),kn=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return En(r,e),zn([t.Property(!1)],r.prototype,"enableCache",void 0),zn([t.Property(3)],r.prototype,"maxBlocks",void 0),zn([t.Property(3)],r.prototype,"initialBlocks",void 0),r}(t.ChildProperty),An=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return En(r,e),zn([t.Collection([],On)],r.prototype,"columns",void 0),zn([t.Property("FilterBar")],r.prototype,"type",void 0),zn([t.Property("OnEnter")],r.prototype,"mode",void 0),zn([t.Property(!0)],r.prototype,"showFilterBarStatus",void 0),zn([t.Property(1500)],r.prototype,"immediateModeDelay",void 0),zn([t.Property()],r.prototype,"operators",void 0),zn([t.Property(!1)],r.prototype,"ignoreAccent",void 0),zn([t.Property(!1)],r.prototype,"enableCaseSensitivity",void 0),zn([t.Property(!1)],r.prototype,"showFilterBarOperator",void 0),r}(t.ChildProperty),Ln=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return En(r,e),zn([t.Property("Row")],r.prototype,"mode",void 0),zn([t.Property("Flow")],r.prototype,"cellSelectionMode",void 0),zn([t.Property("Single")],r.prototype,"type",void 0),zn([t.Property(!1)],r.prototype,"checkboxOnly",void 0),zn([t.Property(!1)],r.prototype,"persistSelection",void 0),zn([t.Property("Default")],r.prototype,"checkboxMode",void 0),zn([t.Property(!1)],r.prototype,"enableSimpleMultiRowSelection",void 0),zn([t.Property(!0)],r.prototype,"enableToggle",void 0),zn([t.Property(!1)],r.prototype,"allowColumnSelection",void 0),r}(t.ChildProperty),Pn=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return En(r,e),zn([t.Property([])],r.prototype,"fields",void 0),zn([t.Property("")],r.prototype,"key",void 0),zn([t.Property("wildcard")],r.prototype,"operator",void 0),zn([t.Property(!0)],r.prototype,"ignoreCase",void 0),zn([t.Property(!1)],r.prototype,"ignoreAccent",void 0),r}(t.ChildProperty),Bn=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return En(r,e),zn([t.Property()],r.prototype,"targetID",void 0),r}(t.ChildProperty),Nn=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return En(r,e),zn([t.Property("Both")],r.prototype,"wrapMode",void 0),r}(t.ChildProperty),qn=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return En(r,e),zn([t.Property("Normal")],r.prototype,"mode",void 0),r}(t.ChildProperty),Hn=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return En(r,e),zn([t.Property(!0)],r.prototype,"showDropArea",void 0),zn([t.Property(!1)],r.prototype,"allowReordering",void 0),zn([t.Property(!1)],r.prototype,"showToggleButton",void 0),zn([t.Property(!1)],r.prototype,"showGroupedColumn",void 0),zn([t.Property(!0)],r.prototype,"showUngroupButton",void 0),zn([t.Property(!1)],r.prototype,"disablePageWiseAggregates",void 0),zn([t.Property([])],r.prototype,"columns",void 0),zn([t.Property()],r.prototype,"captionTemplate",void 0),zn([t.Property(!1)],r.prototype,"enableLazyLoading",void 0),r}(t.ChildProperty),Un=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return En(r,e),zn([t.Property(!1)],r.prototype,"allowAdding",void 0),zn([t.Property(!1)],r.prototype,"allowEditing",void 0),zn([t.Property(!1)],r.prototype,"allowDeleting",void 0),zn([t.Property("Normal")],r.prototype,"mode",void 0),zn([t.Property(!0)],r.prototype,"allowEditOnDblClick",void 0),zn([t.Property(!0)],r.prototype,"showConfirmDialog",void 0),zn([t.Property(!1)],r.prototype,"showDeleteConfirmDialog",void 0),zn([t.Property("")],r.prototype,"template",void 0),zn([t.Property("")],r.prototype,"headerTemplate",void 0),zn([t.Property("")],r.prototype,"footerTemplate",void 0),zn([t.Property("Top")],r.prototype,"newRowPosition",void 0),zn([t.Property({})],r.prototype,"dialog",void 0),zn([t.Property(!1)],r.prototype,"allowNextRowEdit",void 0),r}(t.ChildProperty),jn=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return En(r,e),zn([t.Property("Spinner")],r.prototype,"indicatorType",void 0),r}(t.ChildProperty),Vn=function(n){function o(e,r){var i=n.call(this,e,r)||this;return i.isPreventScrollEvent=!1,i.inViewIndexes=[],i.keyA=!1,i.frozenRightCount=0,i.frozenLeftCount=0,i.tablesCount=1,i.movableCount=0,i.visibleFrozenLeft=0,i.visibleFrozenRight=0,i.visibleMovable=0,i.frozenLeftColumns=[],i.frozenRightColumns=[],i.movableColumns=[],i.media={},i.isFreezeRefresh=!1,i.tableIndex=0,i.componentRefresh=t.Component.prototype.refresh,i.isVirtualAdaptive=!1,i.requireTemplateRef=!0,i.vRows=[],i.vcRows=[],i.vGroupOffsets={},i.rowUid=0,i.isManualRefresh=!1,i.isAutoFitColumns=!1,i.enableDeepCompare=!1,i.totalDataRecordsCount=0,i.disableSelectedRecords=[],i.partialSelectedRecords=[],i.islazyloadRequest=!1,i.lockcolPositionCount=0,i.prevPageMoving=!1,i.pageTemplateChange=!1,i.isAutoGen=!1,i.mediaBindInstance={},i.commandDelIndex=void 0,i.asyncTimeOut=50,i.isExportGrid=!1,i.enableLogger=!0,i.needsID=!0,s.Inject(Cn),t.setValue("mergePersistData",i.mergePersistGridData,i),i}En(o,n),s=o,o.prototype.getPersistData=function(){for(var e=["pageSettings","sortSettings","filterSettings","groupSettings","columns","searchSettings","selectedRowIndex","scrollPosition"],r={pageSettings:["template","pageSizes","enableQueryString","totalRecordsCount","pageCount"],filterSettings:["type","mode","showFilterBarStatus","immediateModeDelay","ignoreAccent"],groupSettings:["showDropArea","showToggleButton","showGroupedColumn","showUngroupButton","disablePageWiseAggregates","hideCaptionCount"],searchSettings:["fields","operator","ignoreCase"],sortSettings:[],columns:[],selectedRowIndex:[],scrollPosition:[]},i=0;i<e.length;i++)for(var n=this[e[parseInt(i.toString(),10)]],o=0,s=r[e[parseInt(i.toString(),10)]];o<s.length;o++)delete n[""+s[o]];var a=this.pageSettings.template,l=Object.assign({template:void 0},this.pageSettings);this.setProperties({pageSettings:l},!0),this.isAngular&&delete this.groupSettings.properties.captionTemplate,this.pageTemplateChange=!t.isNullOrUndefined(this.pagerTemplate);var h=this.addOnPersist(e);return l.template=a,this.setProperties({pageSettings:l},!0),h},o.prototype.requiredModules=function(){this.setFrozenCount(),this.enableInfiniteAggrgate();var e=[];return this.isDestroyed?e:(this.allowFiltering&&e.push({member:"filter",args:[this,this.filterSettings,this.serviceLocator]}),this.allowExcelExport&&e.push({member:"ExcelExport",args:[this,this.serviceLocator]}),this.allowPdfExport&&e.push({member:"PdfExport",args:[this]}),this.allowSorting&&e.push({member:"sort",args:[this,this.sortSettings,this.sortedColumns,this.serviceLocator]}),this.allowPaging&&e.push({member:"pager",args:[this,this.pageSettings]}),this.allowSelection&&e.push({member:"selection",args:[this,this.selectionSettings,this.serviceLocator]}),e.push({member:"resize",args:[this]}),this.allowReordering&&e.push({member:"reorder",args:[this]}),this.allowRowDragAndDrop&&e.push({member:"rowDragAndDrop",args:[this]}),this.allowGrouping&&e.push({member:"group",args:[this,this.groupSettings,this.sortedColumns,this.serviceLocator]}),this.aggregates.length&&e.push({member:"aggregate",args:[this,this.serviceLocator]}),this.isDetail()&&e.push({member:"detailRow",args:[this,this.serviceLocator]}),(this.toolbar||this.toolbarTemplate)&&e.push({member:"toolbar",args:[this,this.serviceLocator]}),(this.enableVirtualization||this.enableColumnVirtualization)&&e.push({member:"virtualscroll",args:[this,this.serviceLocator]}),(this.getFrozenColumns()||this.frozenRows||this.frozenRightCount||this.frozenLeftCount)&&e.push({member:"freeze",args:[this,this.serviceLocator]}),this.isCommandColumn(this.columns)&&e.push({member:"commandColumn",args:[this,this.serviceLocator]}),(this.editSettings.allowAdding||this.editSettings.allowDeleting||this.editSettings.allowEditing)&&e.push({member:"edit",args:[this,this.serviceLocator]}),this.extendRequiredModules(e),e)},o.prototype.extendRequiredModules=function(e){this.enableInfiniteScrolling&&e.push({member:"infiniteScroll",args:[this,this.serviceLocator]}),this.groupSettings.enableLazyLoading&&e.push({member:"lazyLoadGroup",args:[this,this.serviceLocator]}),this.contextMenuItems&&e.push({member:"contextMenu",args:[this,this.serviceLocator]}),this.showColumnMenu&&e.push({member:"columnMenu",args:[this,this.serviceLocator]}),this.showColumnChooser&&e.push({member:"columnChooser",args:[this,this.serviceLocator]}),this.isForeignKeyEnabled(this.columns)&&e.push({member:"foreignKey",args:[this,this.serviceLocator]}),this.enableLogger&&e.push({member:"logger",args:[this]})},o.prototype.preRender=function(){this.serviceLocator=new Zi,this.initProperties(),this.initializeServices()},o.prototype.initProperties=function(){this.isInitial=!0,this.sortedColumns=[],this.inViewIndexes=[],this.mediaCol=[],this.isInitialLoad=!1,this.allowServerDataBinding=!1,this.ignoreCollectionWatch=!0,this.mergeCells={},this.isEdit=!1,this.checkAllRows="None",this.isCheckBoxSelection=!1,this.isPersistSelection=!1,this.componentRefresh=t.Component.prototype.refresh,this.filterOperators={contains:"contains",endsWith:"endswith",equal:"equal",greaterThan:"greaterthan",greaterThanOrEqual:"greaterthanorequal",lessThan:"lessthan",lessThanOrEqual:"lessthanorequal",notEqual:"notequal",startsWith:"startswith",wildCard:"wildcard",isNull:"isnull",notNull:"notnull",like:"like"},this.defaultLocale={EmptyRecord:"No records to display",True:"true",False:"false",InvalidFilterMessage:"Invalid Filter Data",GroupDropArea:"Drag a column header here to group its column",UnGroup:"Click here to ungroup",UnGroupButton:"Click here to ungroup",GroupDisable:"Grouping is disabled for this column",FilterbarTitle:"'s filter bar cell",EmptyDataSourceError:"DataSource must not be empty at initial load since columns are generated from dataSource in AutoGenerate Column Grid",Add:"Add",Edit:"Edit",Cancel:"Cancel",Update:"Update",Delete:"Delete",Print:"Print",Pdfexport:"PDF Export",Excelexport:"Excel Export",Wordexport:"Word Export",Csvexport:"CSV Export",Search:"Search",Columnchooser:"Columns",Save:"Save",Item:"item",Items:"items",EditOperationAlert:"No records selected for edit operation",DeleteOperationAlert:"No records selected for delete operation",SaveButton:"Save",OKButton:"OK",CancelButton:"Cancel",EditFormTitle:"Details of ",AddFormTitle:"Add New Record",BatchSaveConfirm:"Are you sure you want to save changes?",BatchSaveLostChanges:"Unsaved changes will be lost. Are you sure you want to continue?",ConfirmDelete:"Are you sure you want to Delete Record?",CancelEdit:"Are you sure you want to Cancel the changes?",ChooseColumns:"Choose Column",SearchColumns:"search columns",Matchs:"No matches found",FilterButton:"Filter",ClearButton:"Clear",StartsWith:"Starts With",NotStartsWith:"Does Not Start With",Like:"Like",EndsWith:"Ends With",NotEndsWith:"Does Not End With",Contains:"Contains",NotContains:"Does Not Contain",IsNull:"Null",NotNull:"Not Null",IsEmpty:"Empty",IsNotEmpty:"Not Empty",Equal:"Equal",NotEqual:"Not Equal",LessThan:"Less Than",LessThanOrEqual:"Less Than Or Equal",GreaterThan:"Greater Than",GreaterThanOrEqual:"Greater Than Or Equal",ChooseDate:"Choose a Date",EnterValue:"Enter the value",Copy:"Copy",Group:"Group by this column",Ungroup:"Ungroup by this column",GroupButton:"Group button",UnGroupAria:"ungroup button",GroupSeperator:"Separator for the grouped columns",UnGroupIcon:"ungroup the grouped column ",GroupedSortIcon:"sort the grouped column ",GroupedDrag:"Drag the grouped column",GroupCaption:" is groupcaption cell",CheckBoxLabel:"checkbox",autoFitAll:"Autofit all columns",autoFit:"Autofit this column",AutoFitAll:"Autofit all columns",AutoFit:"Autofit this column",Export:"Export",FirstPage:"First Page",LastPage:"Last Page",PreviousPage:"Previous Page",NextPage:"Next Page",SortAscending:"Sort Ascending",SortDescending:"Sort Descending",EditRecord:"Edit Record",DeleteRecord:"Delete Record",FilterMenu:"Filter",SelectAll:"Select All",AddCurrentSelection:"Add current selection to filter",Blanks:"Blanks",FilterTrue:"True",FilterFalse:"False",NoResult:"No matches found",ClearFilter:"Clear Filter",Clear:"Clear",NumberFilter:"Number Filters",TextFilter:"Text Filters",DateFilter:"Date Filters",DateTimeFilter:"DateTime Filters",MatchCase:"Match Case",Between:"Between",CustomFilter:"Custom Filter",CustomFilterPlaceHolder:"Enter the value",CustomFilterDatePlaceHolder:"Choose a date",AND:"AND",OR:"OR",ShowRowsWhere:"Show rows where:",FilterMenuDialogARIA:"Filter menu dialog",ExcelFilterDialogARIA:"Excel filter dialog",DialogEditARIA:"Edit dialog",ColumnChooserDialogARIA:"Column chooser",ColumnMenuDialogARIA:"Column menu dialog",CustomFilterDialogARIA:"Customer filter dialog",SortAtoZ:"Sort A to Z",SortZtoA:"Sort Z to A",SortByOldest:"Sort by Oldest",SortByNewest:"Sort by Newest",SortSmallestToLargest:"Sort Smallest to Largest",SortLargestToSmallest:"Sort Largest to Smallest",Sort:"Sort",FilterDescription:"Press Alt Down to open filter Menu",SortDescription:"Press Enter to sort",ColumnMenuDescription:"Press Alt Down to open Column Menu",GroupDescription:"Press Ctrl space to group",ColumnHeader:" column header ",TemplateCell:" is template cell",CommandColumnAria:"is Command column column header ",DialogEdit:"Dialog edit",ClipBoard:"clipboard",AscendingText:"Ascending",DescendingText:"Descending",NoneText:"None",Expanded:"Expanded",Collapsed:"Collapsed"},this.keyConfigs={downArrow:"downarrow",upArrow:"uparrow",rightArrow:"rightarrow",leftArrow:"leftarrow",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",shiftRight:"shift+rightarrow",shiftLeft:"shift+leftarrow",home:"home",end:"end",escape:"escape",ctrlHome:"ctrl+home",ctrlEnd:"ctrl+end",pageUp:"pageup",pageDown:"pagedown",ctrlAltPageUp:"ctrl+alt+pageup",ctrlAltPageDown:"ctrl+alt+pagedown",altPageUp:"alt+pageup",altPageDown:"alt+pagedown",altDownArrow:"alt+downarrow",altUpArrow:"alt+uparrow",ctrlDownArrow:"ctrl+downarrow",ctrlUpArrow:"ctrl+uparrow",ctrlPlusA:"ctrl+A",ctrlPlusP:"ctrl+P",insert:"insert",delete:"delete",f2:"f2",enter:"enter",ctrlEnter:"ctrl+enter",shiftEnter:"shift+enter",tab:"tab",shiftTab:"shift+tab",space:"space",ctrlPlusC:"ctrl+C",ctrlShiftPlusH:"ctrl+shift+H",ctrlSpace:"ctrl+space",ctrlLeftArrow:"ctrl+leftarrow",ctrlRightArrow:"ctrl+rightarrow"}},o.prototype.render=function(){if(this.log(["module_missing","promise_enabled","locale_missing","check_datasource_columns"]),this.ariaService.setOptions(this.element,{datarole:"grid"}),i.createSpinner({target:this.element,cssClass:this.cssClass?this.cssClass:null},this.createElement),this.renderModule=new Xi(this,this.serviceLocator),this.searchModule=new Sn(this),this.scrollModule=new wn(this),this.notify(Kt,{}),!0!==this.getDataModule().dataManager.dataSource.offline&&void 0!==this.getDataModule().dataManager.dataSource.url||(this.isVirtualAdaptive=!0),this.isReact){var e={requireTemplateRef:this.requireTemplateRef};this.trigger("load",e),e.requireTemplateRef||(this.requireTemplateRef=e.requireTemplateRef)}else this.trigger("load");E(this.columns,this.enableColumnVirtualization,this),this.enablePersistence&&this.notify(Tr,{}),this.getMediaColumns(),T(this.columns),this.checkLockColumns(this.columns),this.getColumns(),this.processModel(),this.gridRender(),this.wireEvents(),this.addListener(),this.updateDefaultCursor(),this.updateStackedFilter(),"Spinner"===this.loadingIndicator.indicatorType&&this.showSpinner(),this.notify(Qt,{}),"Shimmer"===this.loadingIndicator.indicatorType&&this.refreshMaskRow(),this.refreshing&&this.trigger("created")},o.prototype.showSpinner=function(){this.isExportGrid||i.showSpinner(this.element)},o.prototype.hideSpinner=function(){this.isExportGrid||i.hideSpinner(this.element)},o.prototype.showMaskRow=function(e,r){if(!t.isNullOrUndefined(this.headerModule)&&!t.isNullOrUndefined(this.contentModule)){var i=this.getHeaderContent().firstChild,n=this.getContent().firstChild,o=this.getFooterContent();if(r){var s=r.querySelector(".e-checkboxlist"),a=Math.floor(s.getBoundingClientRect().height/this.getRowHeight()),l='<div class="e-ftrchk e-mask-ftrchk" style="width: 100%;"><div class="e-checkbox-wrapper" style="width: 100%;"><input class="e-chk-hidden">'+this.getShimmerTemplate()+this.getShimmerTemplate()+"</div></div>";s.innerHTML="";for(var h=0;h<a;h++){s.innerHTML+=l;var p=[].slice.call(s.querySelectorAll(".e-mask:not(.e-mask-checkbox-filter-intent):not(.e-mask-checkbox-filter-span-intent)"));p[0].classList.add("e-mask-checkbox-filter-intent"),p[1].classList.add("e-mask-checkbox-filter-span-intent")}}else{if((!this.enableRtl&&!this.getHeaderContent().style.paddingRight||this.enableRtl&&!this.getHeaderContent().style.paddingLeft)&&(n.style.overflowY="hidden"),!this.isInitialLoad&&!this.getColumns().length){var d=0===(u=n.getBoundingClientRect().height)?this.allowPaging?this.pageSettings.pageSize*this.getRowHeight():window.innerHeight:u,c=Math.ceil(d/this.getRowHeight());return"Vertical"!==this.rowRenderingMode&&(this.headerMaskTable=this.createEmptyMaskTable(i,1)),void(this.contentMaskTable=this.createEmptyMaskTable(n,c))}if(this.maskRowContentScroll=!(!this.enableVirtualization||!e),!(this.contentMaskTable||this.isFrozenGrid()&&this.enableColumnVirtualization&&"X"===e)){g=n;if(this.isFrozenGrid()){if(!this.isInitialLoad&&!this.enableVirtualization&&this.frozenRows&&"auto"!==this.height){var u=g.getBoundingClientRect().height-this.frozenRows*this.getRowHeight();g.style.height=u+"px"}g=g.querySelector(".e-frozen-left-content, .e-frozen-right-content")}else this.enableVirtualization&&(g=g.querySelector(".e-virtualtable"));t.isNullOrUndefined(g.querySelector("tbody"))||(this.contentMaskTable=this.createMaskTable(g,this.getContentMaskColumns(),e))}if(!this.headerMaskTable&&(this.isFrozenGrid()||this.enableColumnVirtualization&&"X"===e)&&(!this.isFrozenGrid()||!(this.enableVirtualization&&"Y"===e||this.enableColumnVirtualization&&"X"===e||this.enableInfiniteScrolling&&"down"===e))){g=i;this.isFrozenGrid()?g=g.querySelector(".e-frozen-left-header, .e-frozen-right-header"):this.enableColumnVirtualization&&"X"===e&&(g=g.querySelector(".e-virtualtable")),this.headerMaskTable=this.createMaskTable(g,this.getContentMaskColumns(),e)}if(!this.movableHeaderMaskTable&&this.isFrozenGrid()&&!(this.enableVirtualization&&"Y"===e||this.enableInfiniteScrolling&&"down"===e)){g=i.querySelector(".e-movableheader");this.enableColumnVirtualization&&(g=g.querySelector(".e-virtualtable")),this.movableHeaderMaskTable=this.createMaskTable(g,this.getMovableContentMaskColumns(),e)}if(this.rightHeaderMaskTable||!this.isFrozenGrid()||"Left-Right"!==this.getFrozenMode()||this.enableVirtualization&&"Y"===e||this.enableInfiniteScrolling&&"down"===e||(this.rightHeaderMaskTable=this.createMaskTable(i.querySelector(".e-frozen-right-header"),this.getRightContentMaskColumns(),e)),!this.movableContentMaskTable&&this.isFrozenGrid()){var g=n.querySelector(".e-movablecontent");this.enableColumnVirtualization&&(g=g.querySelector(".e-virtualtable")),t.isNullOrUndefined(g.querySelector("tbody"))||(this.movableContentMaskTable=this.createMaskTable(g,this.getMovableContentMaskColumns(),e))}if(!this.rightContentMaskTable&&this.isFrozenGrid()&&"Left-Right"===this.getFrozenMode()&&(this.rightContentMaskTable=this.createMaskTable(n.querySelector(".e-frozen-right-content"),this.getRightContentMaskColumns(),e)),o&&o.querySelector(".e-summaryrow")){var f=o.firstChild;if(!this.footerContentMaskTable){var m=f;this.isFrozenGrid()&&(m=m.querySelector(".e-frozen-left-footercontent, .e-frozen-right-footercontent")),this.footerContentMaskTable=this.createMaskTable(m)}this.isFrozenGrid()&&(this.movableFooterContentMaskTable||(this.movableFooterContentMaskTable=this.createMaskTable(f.querySelector(".e-movablefootercontent"))),"Left-Right"!==this.getFrozenMode()||this.rightFooterContentMaskTable||(this.rightFooterContentMaskTable=this.createMaskTable(f.querySelector(".e-frozen-right-footercontent"))))}this.enableVirtualization&&e||t.EventHandler.add(n,"scroll",this.translateMaskRow,this)}}},o.prototype.getContentMaskColumns=function(){var e=this.getColumns();return this.isFrozenGrid()&&("Left"===this.getFrozenMode()||"Left-Right"===this.getFrozenMode()?e=this.frozenColumns?e.slice(0,this.frozenColumns):this.getFrozenLeftColumns():"Right"===this.getFrozenMode()&&(e=this.getFrozenRightColumns())),e},o.prototype.getMovableContentMaskColumns=function(){var e=this.getColumns();return this.frozenColumns?e.slice(this.frozenColumns,e.length):this.getMovableColumns()},o.prototype.getRightContentMaskColumns=function(){return this.getFrozenRightColumns()},o.prototype.createEmptyMaskTable=function(e,t){var r=this.createElement("table",{className:"e-table e-masked-table"}),i=this.createElement("tbody",{className:"e-masked-tbody"}),n=this.createElement("tr",{className:"e-masked-row e-row",attrs:{style:"height: "+this.getRowHeight()+"px;"}}),o=this.createElement("td",{className:"e-masked-cell e-rowcell"});o.innerHTML=this.getShimmerTemplate(),n.appendChild(o);for(var s=0;s<t;s++)i.appendChild(n.cloneNode(!0));return r.appendChild(i),e.appendChild(r),r},o.prototype.createMaskTable=function(e,r,i){var n=e,o=!!t.closest(n,".e-gridheader"),s=!!t.closest(n,".e-gridcontent"),a=!!t.closest(n,".e-gridfooter"),l=this.getContent().firstChild,h=l.scrollHeight,p=n.querySelector("table");this.isFrozenGrid()&&(s&&(n.style.overflow="hidden"),n.style.position="relative");var d=p.cloneNode();d.removeAttribute("role"),d.removeAttribute("id"),d.removeAttribute("aria-multiselectable"),d.removeAttribute("aria-colcount"),d.removeAttribute("aria-rowcount"),d.style.position="absolute",d.style.zIndex="1",d.style.width=p.getBoundingClientRect().width+"px",!o||this.enableColumnVirtualization&&"X"===i||(d.style.transform="translate(0px,"+p.querySelector("thead").getBoundingClientRect().height+"px)"),d.setAttribute("class","e-table e-masked-table");var c=p.querySelector("colgroup").cloneNode(!0);if(c.removeAttribute("id"),c.setAttribute("class","e-masked-colgroup"),d.appendChild(c),o&&this.enableColumnVirtualization&&"X"===i){var u=this.createMaskRow(c,r),g=p.querySelector("thead"),f=[].slice.call(g.querySelectorAll("tr")),m=g.cloneNode();m.removeAttribute("role"),m.setAttribute("class","e-masked-thead");for(var y=f.length,v=0;v<y;v++)m.appendChild(u.cloneNode(!0)),m.childNodes[parseInt(v.toString(),10)].style.height=f[parseInt(v.toString(),10)].getBoundingClientRect().height+"px";d.appendChild(m)}var C=p.querySelector("tbody").cloneNode();C.removeAttribute("role"),C.setAttribute("class","e-masked-tbody");var S=p.querySelector("tbody");if(s||o&&this.isFrozenGrid()){var b=l,y=o&&this.isFrozenGrid()?this.frozenRows:Math.ceil(b.getBoundingClientRect().height/this.getRowHeight());if(S.querySelector(".e-emptyrow")||!S.childNodes.length||s&&this.childGrid){var w=(u=this.createMaskRow(c,r)).cloneNode(!0);w.classList.add("e-altrow");for(v=0;v<y;v++){var I=s&&this.isFrozenGrid()&&this.frozenRows?this.frozenRows+1:1;C.appendChild((v+I)%2==0?w.cloneNode(!0):u.cloneNode(!0))}}else{var f=[].slice.call(S.querySelectorAll('tr:not([style*="display:none"]):not([style*="display: none"])')),R=S.querySelector(".e-addedrow, .e-editedrow"),x=void 0;R&&(x=f.indexOf(R),R.classList.contains("e-addedrow")?f.splice(x,2):f.splice(x,1)),y=o&&this.isFrozenGrid()||this.enableVirtualization&&i?f.length:y<=f.length?y:f.length;for(v=0;v<y;v++)C.appendChild(this.applyMaskRow(f[parseInt(v.toString(),10)].cloneNode(!0),f[parseInt(v.toString(),10)].getBoundingClientRect().height));if(R&&R.classList.contains("e-editedrow")&&x<y){var F=C.childNodes[parseInt(x.toString(),10)];F.style.height=this.getRowHeight()+"px",F.classList.add("e-row"),R.classList.contains("e-altrow")&&F.classList.add("e-altrow")}}}if(d.appendChild(C),a){var T=p.querySelector("tfoot"),E=T.cloneNode();E.setAttribute("class","e-masked-tfoot");for(var f=[].slice.call(T.querySelectorAll("tr")),v=0;v<f.length;v++)E.appendChild(this.applyMaskRow(f[parseInt(v.toString(),10)].cloneNode(!0),f[parseInt(v.toString(),10)].getBoundingClientRect().height));d.appendChild(E)}if(n.insertBefore(d,n.firstChild),o&&this.isFrozenGrid()&&S.getBoundingClientRect().height<d.querySelector("tbody").getBoundingClientRect().height){var z=d.querySelector("tbody").getBoundingClientRect().height-S.getBoundingClientRect().height,M=this.createElement("div",{className:"e-masked-table-holder",attrs:{style:"height: "+z+"px;"}});n.appendChild(M)}else!o||!this.isFrozenGrid()||this.enableColumnVirtualization&&"X"===i||(d.style.height=n.getBoundingClientRect().height-p.querySelector("thead").getBoundingClientRect().height+"px");if(s&&(!this.enableVirtualization||!i)){var D=h-d.getBoundingClientRect().height;D=D<0?0:D;var O=l.scrollTop<=D?l.scrollTop:D;this.enableVirtualization&&(O-=Ie(t.closest(n,".e-virtualtable")).height),d.style.transform="translate(0px,"+O+"px)"}return d},o.prototype.applyMaskRow=function(e,t){var r=e;r.removeAttribute("role"),r.removeAttribute("aria-rowindex"),r.removeAttribute("data-rowindex"),r.removeAttribute("data-uid"),r.classList.add("e-masked-row"),r.style.height=t+"px";for(var i=[].slice.call(r.childNodes),n=0;n<i.length;n++){var o=i[parseInt(n.toString(),10)],s=o.firstChild&&o.firstChild.classList&&o.firstChild.classList.contains("e-checkbox-wrapper");o.removeAttribute("role"),o.removeAttribute("tabindex"),o.removeAttribute("aria-label"),o.removeAttribute("data-colindex"),o.removeAttribute("aria-colindex"),o.removeAttribute("index"),o.removeAttribute("ej-mappingname"),o.removeAttribute("ej-mappingvalue"),o.removeAttribute("e-mappinguid"),o.removeAttribute("aria-expanded"),o.classList.add("e-masked-cell"),o.innerHTML=this.getShimmerTemplate(),o.classList.contains("e-recordplusexpand")||o.classList.contains("e-recordpluscollapse")?o.firstChild.classList.add("e-mask-group-intent"):o.classList.contains("e-gridchkbox")||s?o.firstChild.classList.add("e-mask-checkbox-intent"):o.classList.contains("e-rowdragdrop")?o.firstChild.classList.add("e-mask-drag-intent"):o.classList.contains("e-indentcell")&&(o.innerHTML="")}return r},o.prototype.createMaskRow=function(e,t){var r=e,i=t,n=this.createElement("tr",{className:"e-masked-row e-row"});"Vertical"!==this.rowRenderingMode&&(n.style.height=this.getRowHeight()+"px");for(var o=this.createElement("td",{className:"e-masked-cell e-rowcell"}),s=0,a=0;s<r.childNodes.length;s++){var l=r.childNodes[parseInt(s.toString(),10)],h=o.cloneNode();h.innerHTML=this.getShimmerTemplate(),l.classList.contains("e-group-intent")||l.classList.contains("e-detail-intent")||l.classList.contains("e-drag-intent")?l.classList.contains("e-group-intent")?h.firstChild.classList.add("e-mask-group-intent"):l.classList.contains("e-detail-intent")?h.firstChild.classList.add("e-mask-detail-intent"):l.classList.contains("e-drag-intent")&&h.firstChild.classList.add("e-mask-drag-intent"):("Vertical"===this.rowRenderingMode&&i[parseInt(a.toString(),10)]&&h.setAttribute("data-cell",i[parseInt(a.toString(),10)].headerText?i[parseInt(a.toString(),10)].headerText:i[parseInt(a.toString(),10)].field),"none"===l.style.display?h.classList.add("e-hide"):(h.style.textAlign=i[parseInt(a.toString(),10)]&&i[parseInt(a.toString(),10)].textAlign?i[parseInt(a.toString(),10)].textAlign.toLowerCase():this.enableRtl?"right":"left",i[parseInt(a.toString(),10)]&&("checkbox"===i[parseInt(a.toString(),10)].type||i[parseInt(a.toString(),10)].displayAsCheckBox)&&h.firstChild.classList.add("e-mask-checkbox-intent")),a++),n.appendChild(h)}return n},o.prototype.getShimmerTemplate=function(){return this.maskRowContentScroll?'<span class="e-mask e-skeleton e-skeleton-text"></span>':'<span class="e-mask e-skeleton e-skeleton-text e-shimmer-wave"></span>'},o.prototype.addShimmerEffect=function(){this.maskRowContentScroll=!1;for(var e=[].slice.call(this.element.querySelectorAll(".e-mask:not(.e-shimmer-wave)")),t=0;t<e.length;t++)e[parseInt(t.toString(),10)]&&e[parseInt(t.toString(),10)].classList.add("e-shimmer-wave")},o.prototype.translateMaskRow=function(e){for(var r=e.target,i=r.querySelectorAll(".e-masked-table"),n=0;n<i.length;n++){var o=i[parseInt(n.toString(),10)];if(o){var s=r.scrollHeight-o.getBoundingClientRect().height;s=s<0?0:s;var a=r.scrollTop<=s?r.scrollTop:s;this.enableVirtualization&&(a-=Ie(t.closest(o,".e-virtualtable")).height),o.style.transform="translate(0px,"+a+"px)"}}},o.prototype.removeMaskRow=function(){var e=this.getContent().firstChild;t.EventHandler.remove(e,"scroll",this.translateMaskRow);for(var r=[this.headerMaskTable,this.movableHeaderMaskTable,this.rightHeaderMaskTable,this.contentMaskTable,this.movableContentMaskTable,this.rightContentMaskTable,this.footerContentMaskTable,this.movableFooterContentMaskTable,this.rightFooterContentMaskTable],i=0;i<r.length;i++){var n=r[parseInt(i.toString(),10)];if(n){if(this.isFrozenGrid()&&!t.closest(n,".e-gridfooter")){var o=n.parentElement;if(o.style.overflow="",o.style.position="",t.closest(n,".e-frozen-left-header")||t.closest(n,".e-movableheader")||t.closest(n,".e-frozen-right-header")){var s=o.querySelector(".e-masked-table-holder");s&&t.remove(s)}}t.remove(n)}}this.headerMaskTable=null,this.movableHeaderMaskTable=null,this.rightHeaderMaskTable=null,this.contentMaskTable=null,this.movableContentMaskTable=null,this.rightContentMaskTable=null,this.footerContentMaskTable=null,this.movableFooterContentMaskTable=null,this.rightFooterContentMaskTable=null},o.prototype.refreshMaskRow=function(){var e=this.getHeaderContent().firstChild,t=this.getContent().firstChild;if(this.isInitialLoad||this.getColumns().length){if(this.contentMaskTable&&t.querySelector(".e-masked-table")){r=t;this.isFrozenGrid()?r=r.querySelector(".e-frozen-left-content, .e-frozen-right-content"):this.enableVirtualization&&(r=r.querySelector(".e-virtualtable")),this.refreshMaskRowColgroupWidth(r)}if(this.headerMaskTable&&this.isFrozenGrid()&&this.refreshMaskRowColgroupWidth(e.querySelector(".e-frozen-left-header, .e-frozen-right-header")),this.movableHeaderMaskTable&&this.isFrozenGrid()){r=e.querySelector(".e-movableheader");this.enableColumnVirtualization&&(r=r.querySelector(".e-virtualtable")),this.refreshMaskRowColgroupWidth(r)}if(this.rightHeaderMaskTable&&this.isFrozenGrid()&&"Left-Right"===this.getFrozenMode()&&this.refreshMaskRowColgroupWidth(e.querySelector(".e-frozen-right-header")),this.movableContentMaskTable&&this.isFrozenGrid()){var r=t.querySelector(".e-movablecontent");this.enableColumnVirtualization&&(r=r.querySelector(".e-virtualtable")),this.refreshMaskRowColgroupWidth(r)}this.rightContentMaskTable&&this.isFrozenGrid()&&"Left-Right"===this.getFrozenMode()&&this.refreshMaskRowColgroupWidth(t.querySelector(".e-frozen-right-content"))}},o.prototype.refreshMaskRowColgroupWidth=function(e){var r=e.querySelector("table:not(.e-masked-table)"),i=r.querySelector(hi).cloneNode(!0),n=e.querySelector(".e-masked-table");i.removeAttribute("id"),i.setAttribute("class","e-masked-colgroup");for(var o=0;o<i.childNodes.length;o++)i.childNodes[parseInt(o.toString(),10)].removeAttribute("class");t.remove(n.querySelector(".e-masked-colgroup")),n.insertBefore(i,n.firstChild),n.style.width=r.getBoundingClientRect().width+"px"},o.prototype.updateStackedFilter=function(){this.allowFiltering&&"FilterBar"===this.filterSettings.type&&this.getHeaderContent().getElementsByClassName("e-stackedheadercell").length?this.getHeaderContent().classList.add("e-stackedfilter"):this.getHeaderContent().classList.remove("e-stackedfilter")},o.prototype.getMediaColumns=function(){if(!this.enableColumnVirtualization){var e=this.getColumns();if(this.getShowHideService=this.serviceLocator.getService("showHideService"),!t.isNullOrUndefined(e))for(var r=0;r<e.length;r++)t.isNullOrUndefined(e[parseInt(r.toString(),10)].hideAtMedia)||!t.isNullOrUndefined(e[parseInt(r.toString(),10)].visible)&&!e[parseInt(r.toString(),10)].visible||this.pushMediaColumn(e[parseInt(r.toString(),10)],r)}},o.prototype.pushMediaColumn=function(e,t){this.mediaCol.push(e),this.media[e.uid]=window.matchMedia(e.hideAtMedia),this.mediaQueryUpdate(t,this.media[e.uid]),this.mediaBindInstance[parseInt(t.toString(),10)]=this.mediaQueryUpdate.bind(this,t),this.media[e.uid].addListener(this.mediaBindInstance[parseInt(t.toString(),10)])},o.prototype.updateMediaColumns=function(e){if(!this.enableColumnVirtualization){for(var t=this.getColumnIndexByUid(e.uid),r=0;r<this.mediaCol.length;r++)if(e.uid===this.mediaCol[parseInt(r.toString(),10)].uid)return void this.mediaCol.splice(r,1);this.pushMediaColumn(e,t)}},o.prototype.mediaQueryUpdate=function(e,t){var r=this.getColumns()[parseInt(e.toString(),10)];this.mediaCol.some(function(e){return e.uid===r.uid})&&(r.visible=t.matches,this.isInitialLoad&&(this.invokedFromMedia=!0,r.visible?this.showHider.show(r.headerText,"headerText"):this.showHider.hide(r.headerText,"headerText")))},o.prototype.refreshMediaCol=function(){this.isInitialLoad=!0;var e=this.element.querySelector("."+Gr);this.aggregates.length&&this.element.scrollHeight>this.height&&e&&t.addClass([e],["e-footerpadding"]),this.getColumns().filter(function(e){return"checkbox"===e.type}).length&&"ResetOnRowClick"===this.selectionSettings.checkboxMode&&(this.isCheckBoxSelection=!1),"Vertical"===this.rowRenderingMode&&this.enableHover&&(this.setProperties({enableAdaptiveUI:!0,enableHover:!1},!0),t.removeClass([this.element],"e-gridhover")),this.enableAdaptiveUI&&this.scrollModule&&this.scrollModule.refresh()},o.prototype.removeMediaListener=function(){for(var e=0;e<this.mediaCol.length;e++)this.media[this.mediaCol[parseInt(e.toString(),10)].uid].removeListener(this.mediaBindInstance[this.mediaCol[parseInt(e.toString(),10)].index])},o.prototype.eventInitializer=function(){},o.prototype.destroy=function(){var e=this.element;if(e){var r=!(!e.querySelector("."+jr)||!e.querySelector("."+Vr));r&&this.unwireEvents(),this.removeListener(),this.removeMediaListener(),this.notify(lr,{}),this.destroyDependentModules(),(this.isReact||this.isVue)&&this.destroyTemplate(["template"]),r&&n.prototype.destroy.call(this),this.toolTipObj.destroy(),this.isReact&&!t.Browser.isIE&&(this.element.innerHTML="");for(var i=["renderModule","headerModule","contentModule","valueFormatterService","serviceLocator","ariaService","keyboardModule","widthService","searchModule","showHider","scrollModule","printModule","clipboardModule","focusModule"],o=0;o<i.length;o++)this[i[parseInt(o.toString(),10)]]&&(this[i[parseInt(o.toString(),10)]]=null);this.element.innerHTML="",t.classList(this.element,[],["e-rtl","e-gridhover","e-responsive","e-default","e-device","e-grid-min-height"]),this.isFreezeRefresh=!1}},o.prototype.destroyDependentModules=function(){var e=this.element;e&&(e.querySelector("."+jr)||e.querySelector("."+Vr))&&(this.scrollModule.destroy(),this.keyboardModule.destroy(),this.focusModule.destroy(),this.clipboardModule.destroy(),this.printModule.destroy())},o.prototype.getModuleName=function(){return"grid"},o.prototype.enableBoxSelection=function(){this.enableAutoFill?(this.selectionSettings.cellSelectionMode="BoxWithBorder",this.element.classList.add("e-afenabled")):this.element.classList.remove("e-afenabled")},o.prototype.setCSSClass=function(e){this.cssClass&&t.addClass([this.element],this.cssClass.split(" ")),e&&t.removeClass([this.element],e.split(" "))},o.prototype.onPropertyChanged=function(e,r){var i,n=!1,o=!1,s=!1,a={requestType:"refresh"};if(!this.isDestroyed){this.log("module_missing"),this.isEllipsisTooltip()&&this.toolTipObj.close();var l=Object.keys(e);l.indexOf("columns")>-1&&(this.enableColumnVirtualization&&(this.columnModel=[]),this.updateColumnObject(),o=!0);for(var h=0,p=l;h<p.length;h++){var d=p[h];switch(d){case"allowPaging":this.notify(Jt,{module:"pager",enable:this.allowPaging}),n=!0;break;case"pageSettings":if(this.pageTemplateChange){this.pageTemplateChange=!1,this.notify($t,{module:"pager",properties:e.pageSettings});break}this.notify($t,{module:"pager",properties:e.pageSettings}),(t.isNullOrUndefined(e.pageSettings.currentPage)&&t.isNullOrUndefined(e.pageSettings.pageSize)&&t.isNullOrUndefined(e.pageSettings.totalRecordsCount)||!t.isNullOrUndefined(r.pageSettings)&&e.pageSettings.currentPage!==r.pageSettings.currentPage&&!this.enableColumnVirtualization&&!this.enableVirtualization&&this.pageSettings.totalRecordsCount<=this.pageSettings.pageSize)&&(n=!0);break;case"allowSorting":this.notify(Jt,{module:"sort",enable:this.allowSorting}),n=!0,i=!0;break;case"allowFiltering":this.updateStackedFilter(),this.notify(Jt,{module:"filter",enable:this.allowFiltering}),n=!0,"FilterBar"!==this.filterSettings.type&&this.refreshHeader();break;case"height":case"width":this.notify(Jt,{module:"scroll",properties:{width:e.width,height:e.height}});break;case"allowReordering":this.headerModule.refreshUI(),i=!0;break;case"allowRowDragAndDrop":this.notify(Jt,{module:"rowDragAndDrop",enable:this.allowRowDragAndDrop}),this.renderModule.refresh(),this.headerModule.refreshUI();break;case"allowSelection":this.notify(Jt,{module:"selection",enable:this.allowSelection});break;case"cssClass":this.setCSSClass(r.cssClass);break;case"enableAutoFill":this.selectionModule&&(this.enableBoxSelection(),this.selectionModule.updateAutoFillPosition());break;case"rowTemplate":this.rowTemplateFn=R(this.rowTemplate),n=!0;break;case"detailTemplate":this.detailTemplateFn=R(this.detailTemplate),n=!0;break;case"allowGrouping":this.notify(Jt,{module:"group",enable:this.allowGrouping}),this.headerModule.refreshUI(),n=!0,i=!0;break;case"enableInfiniteScrolling":case"childGrid":n=!0;break;case"toolbar":this.notify(Jt,{module:"toolbar"});break;case"groupSettings":this.notify($t,{module:"group",properties:e.groupSettings,oldProperties:r.groupSettings});break;case"aggregates":!this.aggregates.length&&this.allowGrouping&&this.groupSettings.columns.length&&(n=!0),this.notify(Jt,{module:"aggregate",properties:e});break;case"frozenColumns":case"frozenRows":case"enableVirtualization":case"currencyCode":case"locale":this.log("frozen_rows_columns"),s=!0,o=!0;break;case"query":this.getDataModule().isQueryInvokedFromData||(n=!0),this.getDataModule().isQueryInvokedFromData=!1;break;case"autoFit":this.autoFit?this.preventAdjustColumns():this.restoreAdjustColumns();break;default:this.extendedPropertyChange(d,e,o)}}i&&this.updateDefaultCursor(),o?s||this.getFrozenColumns()||this.frozenRows?this.freezeRefresh():this.refresh():n&&(this.notify(er,a),n=!1,this.maintainSelection(e.selectedRowIndex))}},o.prototype.extendedPropertyChange=function(e,i,n){switch(e){case"enableRtl":this.updateRTL(),this.allowPaging&&(this.element.querySelector(".e-gridpager").ej2_instances[0].enableRtl=i.enableRtl,this.element.querySelector(".e-gridpager").ej2_instances[0].dataBind()),"auto"!==this.height&&(this.scrollModule.removePadding(!i.enableRtl),this.scrollModule.setPadding()),this.toolbar&&this.toolbarModule&&(this.toolbarModule.getToolbar().ej2_instances[0].enableRtl=i.enableRtl,this.toolbarModule.getToolbar().ej2_instances[0].dataBind()),this.contextMenuItems&&this.contextMenuModule&&(this.contextMenuModule.getContextMenu().ej2_instances[0].enableRtl=i.enableRtl,this.contextMenuModule.getContextMenu().ej2_instances[0].dataBind()),this.showColumnMenu&&this.columnMenuModule&&(this.columnMenuModule.getColumnMenu().ej2_instances[0].enableRtl=i.enableRtl,this.columnMenuModule.getColumnMenu().ej2_instances[0].dataBind()),"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&this.refreshHeader(),this.notify("rtl-updated",{});break;case"enableAltRow":this.renderModule.refresh();break;case"allowResizing":this.headerModule.refreshUI(),this.updateResizeLines();break;case"rowHeight":this.rowHeight?t.addClass([this.element],"e-grid-min-height"):t.removeClass([this.element],"e-grid-min-height"),this.renderModule.refresh(),this.headerModule.refreshUI();break;case"gridLines":this.updateGridLines();break;case"showColumnMenu":this.headerModule.refreshUI(),this.notify(Jt,{module:"columnMenu",enable:!0});break;case"columnMenuItems":this.notify(Jt,{module:"columnMenu",enable:this.columnMenuItems});break;case"contextMenuItems":this.notify(Jt,{module:"contextMenu",enable:this.contextMenuItems});break;case"showColumnChooser":this.notify(Jt,{module:"columnChooser",enable:this.showColumnChooser});break;case"filterSettings":this.updateStackedFilter(),this.notify($t,{module:"filter",properties:i.filterSettings});break;case"searchSettings":this.notify($t,{module:"search",properties:i.searchSettings});break;case"sortSettings":this.notify($t,{module:"sort"});break;case"selectionSettings":this.notify($t,{module:"selection",properties:i.selectionSettings});break;case"editSettings":this.notify($t,{module:"edit",properties:i.editSettings});break;case"allowTextWrap":case"textWrapSettings":this.allowTextWrap?this.applyTextWrap():this.removeTextWrap(),this.notify(wr,{case:"textwrap",isModeChg:"textWrapSettings"===e});break;case"dataSource":var o=this.getDataModule().getState();if(Object.getPrototypeOf(i).deepWatch)for(var s=this.getPrimaryKeyFieldNames()[0],a=0,l=Object.keys(i.dataSource);a<l.length;a++)this.setRowData(t.getValue(s,this.dataSource[l[parseInt(a.toString(),10)]]),this.dataSource[l[parseInt(a.toString(),10)]]);else if(o.isPending){for(var h=t.isNullOrUndefined(this.dataSource)?[]:this.dataSource.result,p=o.group||[],a=0;a<p.length;a++)h=r.DataUtil.group(h,p[parseInt(a.toString(),10)],o.aggregates||[]);this.dataSource={result:h,count:this.dataSource.count,aggregates:this.dataSource.aggregates},this.getDataModule().setState({}),o.resolver(this.dataSource)}else this.getDataModule().setState({isDataChanged:!1}),this.notify(fr,{}),n||(this.renderModule.refresh(),this.isCheckBoxSelection&&this.notify("before-refresh-on-data-change",{}));this.scrollRefresh();break;case"enableHover":(i.enableHover?t.addClass:t.removeClass)([this.element],"e-gridhover");break;case"selectedRowIndex":this.isSelectedRowIndexUpdating||this.selectRow(i.selectedRowIndex),this.isSelectedRowIndexUpdating=!1;break;case"resizeSettings":this.widthService.setWidthToTable();break;case"enableAdaptiveUI":this.notify("set-fullscreen-dialog",{});break;case"rowRenderingMode":this.enableVerticalRendering(),this.notify("row-mode-change",{}),this.refresh();break;case"enableStickyHeader":this.scrollModule.addStickyListener(i.enableStickyHeader)}},o.prototype.maintainSelection=function(e){var t=this;if(-1!==e){var r=function(){t.selectRow(e),t.off(Yt,r)};this.on(Yt,r,this)}},o.prototype.setProperties=function(e,t){n.prototype.setProperties.call(this,e,t);e.filterSettings&&this.filterModule&&t&&this.filterModule.refreshFilter()},o.prototype.setTablesCount=function(){var e=this.getFrozenColumns(),t=this.getFrozenLeftColumnsCount(),r=this.getFrozenRightColumnsCount();!e||t||r?e||!t&&!r||(t&&!r||r&&!t?this.tablesCount=2:t&&r&&(this.tablesCount=3)):this.tablesCount=2},o.prototype.getTablesCount=function(){return this.tablesCount},o.prototype.updateDefaultCursor=function(){var e=[].slice.call(this.getHeaderContent().querySelectorAll(".e-headercell:not(.e-stackedheadercell)")),t=[].slice.call(this.getHeaderContent().getElementsByClassName("e-stackedheadercell")),r=this.getColumns();if(this.enableColumnVirtualization&&this.getFrozenColumns()){var i=this.contentModule.getHeaderCells();e=i.length?i:e}for(var n=0;n<e.length;n++){var o=e[parseInt(n.toString(),10)];(this.allowGrouping||this.allowReordering||this.allowSorting)&&(r[parseInt(n.toString(),10)].allowReordering&&r[parseInt(n.toString(),10)].allowSorting&&r[parseInt(n.toString(),10)].allowGrouping?o.classList.add("e-mousepointer"):o.classList.add("e-defaultcursor"))}for(var s=0;s<t.length;s++)this.allowReordering&&t[parseInt(s.toString(),10)].classList.add("e-mousepointer")},o.prototype.updateColumnModel=function(e,r){for(var i=0,n=e.length;i<n;i++)e[parseInt(i.toString(),10)].columns?this.updateColumnModel(e[parseInt(i.toString(),10)].columns,!0):this.columnModel.push(e[parseInt(i.toString(),10)]);!t.isNullOrUndefined(r)&&r||(this.updateColumnLevelFrozen(),this.updateFrozenColumns(),this.updateLockableColumns())},o.prototype.updateColumnLevelFrozen=function(){var e=this.columnModel,t=[],r=[],i=[];if(this.frozenLeftCount||this.frozenRightCount){for(var n=0,o=e.length;n<o;n++){var s=e[parseInt(n.toString(),10)];"Left"===s.freeze?(s.freezeTable=ni,t.push(s)):"Right"===s.freeze?(s.freezeTable=ii,r.push(s)):(s.freezeTable="movable",i.push(s))}this.columnModel=t.concat(i).concat(r)}},o.prototype.updateFrozenColumns=function(){if(!this.frozenLeftCount&&!this.frozenRightCount)for(var e=this.columnModel,r=this.frozenColumns,i=this.getFrozenColumns(),n=0,o=0,s=e.length;o<s;o++){var a=e[parseInt(o.toString(),10)];r&&(a.freezeTable=o<r?ni:"movable"),a.isFrozen&&o>=r?(a.freezeTable=ni,e.splice(this.frozenColumns+n,0,e.splice(o,1)[0]),n++):i&&!r&&(a.freezeTable="movable"),i||r||t.isNullOrUndefined(a.freezeTable)||(a.freezeTable=void 0)}},o.prototype.getFrozenLeftCount=function(){return this.getFrozenColumns()||this.getFrozenLeftColumnsCount()},o.prototype.isFrozenGrid=function(){return 0!==this.getFrozenColumns()||0!==this.getFrozenLeftColumnsCount()||0!==this.getFrozenRightColumnsCount()},o.prototype.getFrozenMode=function(){return this.frozenName},o.prototype.updateLockableColumns=function(){for(var e=this.columnModel,t=0,r=0,i=this.getFrozenColumns(),n=0;n<e.length;n++)e[parseInt(n.toString(),10)].lockColumn&&(n<i?(e.splice(t,0,e.splice(n,1)[0]),t++):(e.splice(i+r,0,e.splice(n,1)[0]),r++))},o.prototype.checkLockColumns=function(e){for(var t=0;t<e.length;t++)e[parseInt(t.toString(),10)].columns?this.checkLockColumns(e[parseInt(t.toString(),10)].columns):e[parseInt(t.toString(),10)].lockColumn&&this.lockcolPositionCount++},o.prototype.getColumns=function(e){var r=this,i=this.inViewIndexes.map(function(e){return e-r.groupSettings.columns.length}).filter(function(e){return e>-1}),n=i.length;(!this.enableColumnVirtualization||t.isNullOrUndefined(this.columnModel)||0===this.columnModel.length||e)&&(this.columnModel=[],this.updateColumnModel(this.columns));var o=0===n?this.columnModel:this.columnModel.slice(i[0],i[n-1]+1);return this.contentModule&&this.enableColumnVirtualization&&this.isFrozenGrid()&&i.length&&i[0]>0&&(o=this.contentModule.ensureFrozenCols(o)),o},o.prototype.getStackedHeaderColumnByHeaderText=function(e,t){for(var r=0;r<t.length;r++){var i=t[parseInt(r.toString(),10)];if(i.field===e||i.headerText===e){this.stackedColumn=i;break}i.columns&&this.getStackedHeaderColumnByHeaderText(e,i.columns)}return this.stackedColumn},o.prototype.getColumnIndexesInView=function(){return this.inViewIndexes},o.prototype.getQuery=function(){return this.query},o.prototype.getLocaleConstants=function(){return this.defaultLocale},o.prototype.setColumnIndexesInView=function(e){this.inViewIndexes=e},o.prototype.getVisibleColumns=function(){return this.getCurrentVisibleColumns()},o.prototype.getHeaderContent=function(){return this.headerModule.getPanel()},o.prototype.setGridHeaderContent=function(e){this.headerModule.setPanel(e)},o.prototype.getContentTable=function(){return this.contentModule.getTable()},o.prototype.setGridContentTable=function(e){this.contentModule.setTable(e)},o.prototype.getContent=function(){return this.contentModule.getPanel()},o.prototype.setGridContent=function(e){this.contentModule.setPanel(e)},o.prototype.getHeaderTable=function(){return this.headerModule.getTable()},o.prototype.setGridHeaderTable=function(e){this.headerModule.setTable(e)},o.prototype.getFooterContent=function(){return this.footerElement=this.element.getElementsByClassName(Gr)[0],this.footerElement},o.prototype.getFooterContentTable=function(){return this.footerElement=this.element.getElementsByClassName(Gr)[0],this.footerElement.firstChild.firstChild},o.prototype.getPager=function(){return this.gridPager},o.prototype.setGridPager=function(e){this.gridPager=e},o.prototype.getRowByIndex=function(e){return this.enableVirtualization&&this.groupSettings.enableLazyLoading?this.lazyLoadRender.getRowByIndex(e):this.contentModule.getRowByIndex(e)},o.prototype.getMovableRowByIndex=function(e){return this.contentModule.getMovableRowByIndex(e)},o.prototype.getFrozenRowByIndex=function(e){return this.getFrozenDataRows()[parseInt(e.toString(),10)]},o.prototype.getRows=function(){return this.contentModule.getRowElements()},o.prototype.getFrozenRightRowByIndex=function(e){return this.contentModule.getFrozenRightRowByIndex(e)},o.prototype.getRowInfo=function(e){var r=e,i={target:e};if(!t.isNullOrUndefined(e)&&t.isNullOrUndefined(O(r,"e-detailrowcollapse")&&t.isNullOrUndefined(O(r,"e-recordplusexpand")))){var n=t.closest(r,"."+Ur);if(!n){var o=t.closest(r,"."+Zr);if(!t.isNullOrUndefined(o)&&!o.classList.contains("e-addedrow")){var s=this.getRowObjectFromUID(o.getAttribute("data-uid")),a=parseInt(o.getAttribute(si),10);i={row:o,rowData:s.data,rowIndex:a}}return i}var l=parseInt(n.getAttribute(oi),10);if(!t.isNullOrUndefined(n)&&!isNaN(l)){var h=t.closest(n,"."+Zr),a=parseInt(h.getAttribute(si),10),p=this.getFrozenColumns(),d=this.columnModel[parseInt(l.toString(),10)].getFreezeTableName(),c=this.contentModule.getRows(),u=l+this.getIndentCount();this.isFrozenGrid()&&(d===ni?c=this.contentModule.getRows():"movable"===d?(u=l-p-this.frozenLeftCount,c=this.contentModule.getMovableRows()):d===ii&&(u=l-(this.frozenLeftCount+this.movableCount),c=this.contentModule.getFrozenRightRows()));var g=c.filter(function(e){return e.uid===h.getAttribute("data-uid")}),f={},m=void 0;Object.keys(g).length&&(f=g[0].data,m=g[0].cells[parseInt(u.toString(),10)].column),i={cell:n,cellIndex:l,row:h,rowIndex:a,rowData:f,column:m,target:e}}}return i},o.prototype.getMovableRows=function(){return this.contentModule.getMovableRowElements()},o.prototype.getFrozenRightRows=function(){return this.contentModule.getFrozenRightRowElements()},o.prototype.getDataRows=function(){return this.getAllDataRows()},o.prototype.getAllDataRows=function(e){if(t.isNullOrUndefined(this.getContentTable().querySelector(li)))return[];var r=this.isFrozenGrid()?this.getFrozenLeftContentTbody():this.getContentTable().querySelector(li),i=[].slice.call(r.children);if(this.frozenRows){var n=this.isFrozenGrid()?this.getHeaderContent().querySelector("."+Xr).querySelector(li):this.getHeaderTable().querySelector(li),o=[].slice.call(n.children);i=this.addMovableRows(o,i)}return this.generateDataRows(i,e)},o.prototype.addMovableRows=function(e,t){for(var r=0,i=t.length;r<i;r++)e.push(t[parseInt(r.toString(),10)]);return e},o.prototype.generateDataRows=function(e,t){for(var r=[],i=0,n=e.length;i<n;i++)!e[parseInt(i.toString(),10)].classList.contains(Zr)||e[parseInt(i.toString(),10)].classList.contains("e-hiddenrow")&&!t||(this.isCollapseStateEnabled()?r[parseInt(e[parseInt(i.toString(),10)].getAttribute("data-rowindex"),10)]=e[parseInt(i.toString(),10)]:r.push(e[parseInt(i.toString(),10)]));return r},o.prototype.getMovableDataRows=function(){return this.getAllMovableDataRows()},o.prototype.getAllMovableDataRows=function(e){if(!this.isFrozenGrid())return[];var t=[].slice.call(this.getContent().querySelector("."+Wr).querySelector(li).children);if(this.frozenRows){var r=[].slice.call(this.getHeaderContent().querySelector("."+Kr).querySelector(li).children);t=this.addMovableRows(r,t)}return this.generateDataRows(t,e)},o.prototype.getFrozenDataRows=function(){return this.getAllFrozenDataRows()},o.prototype.getAllFrozenDataRows=function(e){var t=[].slice.call(this.getContent().querySelector("."+Qr).querySelector(li).children);if(this.frozenRows){var r=[].slice.call(this.getHeaderContent().querySelector("."+Xr).querySelector(li).children);t=this.addMovableRows(r,t)}return this.generateDataRows(t,e)},o.prototype.getFrozenRightDataRows=function(){return this.getAllFrozenRightDataRows()},o.prototype.getAllFrozenRightDataRows=function(e){if("Right"!==this.getFrozenMode()&&"Left-Right"!==this.getFrozenMode())return[];var t=[].slice.call(this.getContent().querySelector(".e-frozen-right-content").querySelector(li).children);if(this.frozenRows){var r=[].slice.call(this.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(li).children);t=this.addMovableRows(r,t)}return this.generateDataRows(t,e)},o.prototype.setCellValue=function(e,r,i){var n="Right"===this.getFrozenMode(),o=this.getPrimaryKeyFieldNames()[0],s=new xi(this,this.serviceLocator),a=this.getColumnIndexByField(r),l=this.getColumnByField(r),h=("movable"===l.getFreezeTableName()?this.contentModule.getMovableRows():"frozen-right"===l.getFreezeTableName()?this.getFrozenRightRowsObject():this.contentModule.getRows()).filter(function(r){return t.getValue(o,r.data)===e})[0],p=h?this.element.querySelector("[data-uid="+h.uid+"]"):null;if(!t.isNullOrUndefined(p)){"string"==typeof i&&(i=this.sanitize(i)),t.setValue(r,i,h.data);var d=this.getFrozenLeftColumnsCount()||this.getFrozenColumns(),c=this.getMovableColumnsCount();this.isRowDragable()&&!n&&d++;var u=d+c,g=this.enableVirtualization?p.children[parseInt(a.toString(),10)]:this.getCellFromIndex(h.index,a);if(!t.isNullOrUndefined(g)){var f="movable"===l.getFreezeTableName()?d:"frozen-right"===l.getFreezeTableName()?u:0;this.groupSettings.columns.length&&(a+=this.groupSettings.columns.length),(this.childGrid||this.detailTemplate)&&a++,this.isRowDragable()&&!n&&a++;var m=h.cells[a-f];s.refreshTD(g,m,h.data,{index:h.index}),this.isReact&&(g=this.enableVirtualization?p.children[parseInt(a.toString(),10)]:this.getCellFromIndex(h.index,a)),this.aggregates.length>0&&(this.notify("refresh-footer-rendered",{}),this.groupSettings.columns.length>0&&this.notify("group-aggregates",{})),t.isNullOrUndefined(h)||t.isNullOrUndefined(h.changes)||(h.changes[""+r]=i),this.trigger("queryCellInfo",{cell:g,column:l,data:h.data})}}},o.prototype.refreshReactColumnTemplateByUid=function(e,t){var r=this;this.isReact&&this.clearTemplate(["columnTemplate"],void 0,function(){var e=!(!r.childGrid||!r.element.querySelectorAll(".e-childgrid").length),i=e?r.getContentTable().querySelectorAll(".e-row"):r.getDataRows();r.refreshReactTemplateTD(i,e);var n=r.getContent().querySelector("."+Wr),o=r.getContent().querySelector(".e-frozen-right-content");n&&n.querySelectorAll(".e-templatecell").length&&r.refreshReactTemplateTD(r.getMovableDataRows(),e,!0),o&&o.querySelectorAll(".e-templatecell").length&&r.refreshReactTemplateTD(r.getFrozenRightDataRows(),e,!0),t&&r.renderTemplates()})},o.prototype.refreshReactTemplateTD=function(e,r,i){for(var n=this.getIndentCount(),o=0,s=!1,a=0;a<e.length;a++){var l=this.getRowObjectFromUID(e[parseInt(a.toString(),10)].getAttribute("data-uid"));if(r&&!l&&O(e[parseInt(a.toString(),10)],"e-childgrid")){var h=O(e[parseInt(a.toString(),10)],"e-childgrid").ej2_instances[0];l=h.getRowObjectFromUID(e[parseInt(a.toString(),10)].getAttribute("data-uid")),o=h.getIndentCount(),s=!0}if(l&&l.isDataRow&&!t.isNullOrUndefined(l.index)&&!e[parseInt(a.toString(),10)].classList.contains("e-editedrow"))for(var p=0;p<l.cells.length;p++){var d=l.cells[parseInt(p.toString(),10)];if(d.isTemplate){var c=new xi(this,this.serviceLocator),u=r?e[parseInt(a.toString(),10)].children[d.index+(s?o:n)]:this.getCellFromIndex(a,i?d.index:p-n);c.refreshTD(u,d,l.data,{index:l.index})}}s=!1}},o.prototype.refreshGroupCaptionFooterTemplate=function(){for(var e=!(!this.childGrid||!this.element.querySelectorAll(".e-childgrid").length),t=this.getContentTable().querySelectorAll(".e-groupcaptionrow, .e-groupfooterrow"),r=0;r<t.length;r++){var i=this,n=this.getRowObjectFromUID(t[parseInt(r.toString(),10)].getAttribute("data-uid"));if(e&&!n&&O(t[parseInt(r.toString(),10)],"e-childgrid")&&(n=(i=O(t[parseInt(r.toString(),10)],"e-childgrid").ej2_instances[0]).getRowObjectFromUID(t[parseInt(r.toString(),10)].getAttribute("data-uid"))),n){var o={cells:n.cells.filter(function(e){return e.isDataCell}),data:n.data,dataUid:n.uid};i.notify("refresh-aggregate-cell",o)}}},o.prototype.refreshReactHeaderTemplateByUid=function(e){if(this.isReact)for(var t=this.headerModule.rows,r=this.getNormalizedColumnIndex(e),i=0;i<t.length;i++){var n=t[parseInt(i.toString(),10)].cells[parseInt(r.toString(),10)];if(n&&n.column.uid===e){var o=new zi(this,this.serviceLocator),s=O(this.element.querySelectorAll("[e-mappinguid="+e+"]")[0],"e-templatecell");o.refresh(n,s)}}},o.prototype.setRowData=function(e,r){var i=this.contentModule.getRows(),n=this.getPrimaryKeyFieldNames()[0];this.groupSettings.columns.length>0&&this.aggregates.length>0&&(i=i.filter(function(e){return e.isDataRow}));var o=i.filter(function(r){return t.getValue(n,r.data)===e})[0],s=o?[].slice.call(this.element.querySelectorAll("[data-uid="+o.uid+"]")):void 0;if(!t.isNullOrUndefined(o)&&s.length){if(o.changes=r,this.isFrozenGrid()){var a=O(s[0],"e-table"),l=a.parentElement.matches(".e-frozen-left-header,.e-frozen-left-content")?"left":a.parentElement.matches(".e-frozen-right-header,.e-frozen-right-content")?"right":"movable",h=this.getMovableRowsObject()[o.index];if(this.setFrozenRowData(h,r),"left"===l){var p=this.getRowsObject()[o.index];this.setFrozenRowData(p,r)}if("right"===l||this.frozenRightColumns.length>0){var d=this.getFrozenRightRowsObject()[o.index];this.setFrozenRowData(d,r)}}else if(this.frozenRows){var c=this.getRowsObject()[o.index];this.setFrozenRowData(c,r)}else this.setFrozenRowData(o,r);this.aggregates.length>0&&(this.notify("refresh-footer-rendered",{}),this.groupSettings.columns.length>0&&this.notify("group-aggregates",{}))}},o.prototype.setFrozenRowData=function(e,t){var r=new fi(this.serviceLocator,null,this);e.changes=t,ae(e,this.getForeignKeyColumns(),e.changes),r.refresh(e,this.getColumns(),!0)},o.prototype.getCellFromIndex=function(e,t){return Ve(this,this.getColumnByIndex(t),e,t)},o.prototype.getMovableCellFromIndex=function(e,t){if(!("Left-Right"===this.frozenName&&t>=this.movableCount)){var r=this.getFrozenColumns()||this.getFrozenLeftColumnsCount();return this.getMovableDataRows()[parseInt(e.toString(),10)]&&this.getMovableDataRows()[parseInt(e.toString(),10)].getElementsByClassName(Ur)[t-r]}},o.prototype.getFrozenRightCellFromIndex=function(e,t){var r=this.getFrozenLeftColumnsCount()+this.getMovableColumnsCount(),i=this.getFrozenRightDataRows();return i[parseInt(e.toString(),10)]&&i[parseInt(e.toString(),10)].getElementsByClassName(Ur)[t-r]},o.prototype.getColumnHeaderByIndex=function(e){return this.getHeaderTable().getElementsByClassName("e-headercell")[parseInt(e.toString(),10)]},o.prototype.getMovableColumnHeaderByIndex=function(e){var t=this.getFrozenColumns()||this.getFrozenLeftColumnsCount();return this.getMovableVirtualHeader().getElementsByClassName("e-headercell")[e-t]},o.prototype.getFrozenRightColumnHeaderByIndex=function(e){var t=this.getFrozenLeftColumnsCount()+this.getMovableColumnsCount();return this.getFrozenRightHeader().getElementsByClassName("e-headercell")[e-t]},o.prototype.getFrozenLeftColumnHeaderByIndex=function(e){return this.getFrozenVirtualHeader().getElementsByClassName("e-headercell")[parseInt(e.toString(),10)]},o.prototype.getRowObjectFromUID=function(e,r,i){var n=this.contentModule.getRows(),o=this.rowObject(n,e);return this.isFrozenGrid()&&(!o||r||i)?((!(o=this.rowObject(this.contentModule.getMovableRows(),e))&&"Left-Right"===this.getFrozenMode()||i)&&(o=this.rowObject(this.contentModule.getFrozenRightRows(),e)),o):t.isNullOrUndefined(o)&&this.enableVirtualization&&this.groupSettings.columns.length>0?o=this.rowObject(this.vRows,e):o},o.prototype.rowObject=function(e,t){if(e)for(var r=0,i=e;r<i.length;r++){var n=i[r];if(n.uid===t)return n}return null},o.prototype.getRowsObject=function(){return this.contentModule.getRows()},o.prototype.getMovableRowsObject=function(){var e=[];return this.isFrozenGrid()&&(e=this.contentModule.getMovableRows()),e},o.prototype.getFrozenRightRowsObject=function(){var e=[];return"Right"!==this.getFrozenMode()&&"Left-Right"!==this.getFrozenMode()||(e=this.contentModule.getFrozenRightRows()),e},o.prototype.getColumnHeaderByField=function(e){var t=this.getColumnByField(e);return t?this.getColumnHeaderByUid(t.uid):void 0},o.prototype.getColumnHeaderByUid=function(e){var t=this.getHeaderContent().querySelector("[e-mappinguid="+e+"]");return t?t.parentElement:void 0},o.prototype.getColumnByIndex=function(e){var t;return this.getColumns().some(function(r,i){return t=r,i===e}),t},o.prototype.getColumnByField=function(e){return w(this.getColumns(),function(t){if(t.field===e)return t})[0]},o.prototype.getColumnIndexByField=function(e){for(var t=this.getColumns(),r=0;r<t.length;r++)if(t[parseInt(r.toString(),10)].field===e)return r;return-1},o.prototype.getColumnByUid=function(e){return w(this.getColumns().concat(this.getStackedColumns(this.columns)),function(t){if(t.uid===e)return t})[0]},o.prototype.getStackedColumns=function(e,t){void 0===t&&(t=[]);for(var r=0,i=e;r<i.length;r++){var n=i[r];n.columns&&(t.push(n),this.getStackedColumns(n.columns,t))}return t},o.prototype.getColumnIndexByUid=function(e){var r=w(this.getColumns(),function(t,r){if(t.uid===e)return r})[0];return t.isNullOrUndefined(r)?-1:r},o.prototype.getUidByColumnField=function(e){return w(this.getColumns(),function(t){if(t.field===e)return t.uid})[0]},o.prototype.getNormalizedColumnIndex=function(e){return this.getColumnIndexByUid(e)+this.getIndentCount()},o.prototype.getIndentCount=function(){var e=0;return this.allowGrouping&&(e+=this.groupSettings.columns.length),this.isDetail()&&e++,this.isRowDragable()&&t.isNullOrUndefined(this.rowDropSettings.targetID)&&e++,e},o.prototype.getColumnFieldNames=function(){for(var e,t=[],r=0,i=this.getColumns().length;r<i;r++)(e=this.getColumns()[parseInt(r.toString(),10)]).visible&&t.push(e.field);return t},o.prototype.getRowTemplate=function(){return this.rowTemplateFn},o.prototype.getDetailTemplate=function(){return this.detailTemplateFn},o.prototype.getEditTemplate=function(){return this.editTemplateFn},o.prototype.getEditHeaderTemplate=function(){return this.editHeaderTemplateFn},o.prototype.getEditFooterTemplate=function(){return this.editFooterTemplateFn},o.prototype.getPrimaryKeyFieldNames=function(){for(var e=[],t=0;t<this.columnModel.length;t++)this.columnModel[parseInt(t.toString(),10)].isPrimaryKey&&e.push(this.columnModel[parseInt(t.toString(),10)].field);return e},o.prototype.refresh=function(){this.isDestroyed||(this.isManualRefresh=!0,this.headerModule.refreshUI(),this.updateStackedFilter(),this.renderModule.refresh())},o.prototype.refreshHeader=function(){this.headerModule.refreshUI()},o.prototype.getSelectedRows=function(){return this.selectionModule?this.selectionModule.selectedRecords:[]},o.prototype.getSelectedRowIndexes=function(){return this.selectionModule?this.selectionModule.selectedRowIndexes:[]},o.prototype.getSelectedRowCellIndexes=function(){return this.selectionModule?this.selectionModule.selectedRowCellIndexes:[]},o.prototype.getSelectedRecords=function(){return this.selectionModule?this.selectionModule.getSelectedRecords():[]},o.prototype.getSelectedColumnsUid=function(){var e=this,t=[];return this.selectionModule&&this.selectionModule.selectedColumnsIndexes.filter(function(r){return t.push(e.getColumns()[parseInt(r.toString(),10)].uid)}),t},o.prototype.getDataModule=function(){return this.renderModule.data},o.prototype.showColumns=function(e,t){t=t||"headerText",this.showHider.show(e,t)},o.prototype.hideColumns=function(e,t){t=t||"headerText",this.showHider.hide(e,t)},o.prototype.getFrozenColumns=function(){return this.frozenColumns+this.getFrozenCount(this.columns,0,0)},o.prototype.getFrozenRightColumnsCount=function(){return this.frozenRightCount},o.prototype.getFrozenLeftColumnsCount=function(){return this.frozenLeftCount},o.prototype.getMovableColumnsCount=function(){return this.movableCount},o.prototype.setFrozenCount=function(){this.frozenLeftCount=this.frozenRightCount=this.movableCount=0,this.visibleFrozenLeft=this.visibleFrozenRight=this.visibleMovable=0,this.frozenLeftColumns=[],this.frozenRightColumns=[],this.movableColumns=[],this.splitFrozenCount(this.columns),this.frozenColumns&&(this.frozenLeftCount||this.frozenRightCount)&&this.setProperties({frozenColumns:0},!0),this.setTablesCount(),this.frozenLeftCount&&!this.frozenRightCount?this.frozenName="Left":this.frozenRightCount&&!this.frozenLeftCount?this.frozenName="Right":this.frozenLeftCount&&this.frozenRightCount?this.frozenName="Left-Right":this.frozenColumns||this.frozenRows?this.frozenName="Left":this.frozenName=void 0},o.prototype.getVisibleFrozenLeftCount=function(){return this.visibleFrozenLeft},o.prototype.getVisibleFrozenRightCount=function(){return this.visibleFrozenRight},o.prototype.getVisibleMovableCount=function(){return this.visibleMovable},o.prototype.getFrozenRightColumns=function(){return this.frozenRightColumns},o.prototype.getFrozenLeftColumns=function(){return this.frozenLeftColumns},o.prototype.getMovableColumns=function(){return this.movableColumns},o.prototype.splitFrozenCount=function(e){for(var t=0;t<e.length;t++)e[parseInt(t.toString(),10)].columns?this.splitFrozenCount(e[parseInt(t.toString(),10)].columns):"Right"===e[parseInt(t.toString(),10)].freeze?(!1!==e[parseInt(t.toString(),10)].visible&&this.visibleFrozenRight++,this.frozenRightColumns.push(e[parseInt(t.toString(),10)]),this.frozenRightCount++):"Left"===e[parseInt(t.toString(),10)].freeze?(!1!==e[parseInt(t.toString(),10)].visible&&this.visibleFrozenLeft++,this.frozenLeftColumns.push(e[parseInt(t.toString(),10)]),this.frozenLeftCount++):(!1!==e[parseInt(t.toString(),10)].visible&&this.visibleMovable++,this.movableColumns.push(e[parseInt(t.toString(),10)]),this.movableCount++)},o.prototype.getVisibleFrozenColumns=function(){return this.getVisibleFrozenColumnsCount()+this.getVisibleFrozenCount(this.columns,0)},o.prototype.getFilterUIInfo=function(){return this.filterModule?this.filterModule.getFilterUIInfo():{}},o.prototype.getVisibleFrozenColumnsCount=function(){for(var e=0,t=this.columnModel,r=0;r<this.frozenColumns;r++)t[parseInt(r.toString(),10)].visible&&e++;if(this.frozenLeftCount||this.frozenRightCount)for(r=0;r<t.length;r++)!t[parseInt(r.toString(),10)].visible||"Left"!==t[parseInt(r.toString(),10)].freeze&&"Right"!==t[parseInt(r.toString(),10)].freeze||e++;return e},o.prototype.getVisibleFrozenCount=function(e,t){if(!this.frozenLeftCount&&!this.frozenRightCount)for(var r=0,i=e.length;r<i;r++)e[parseInt(r.toString(),10)].columns?t=this.getVisibleFrozenCount(e[parseInt(r.toString(),10)].columns,t):e[parseInt(r.toString(),10)].isFrozen&&e[parseInt(r.toString(),10)].visible&&t++;return t},o.prototype.getFrozenCount=function(e,t,r){for(var i=0,n=e.length;i<n;i++)e[parseInt(i.toString(),10)].columns?t=this.getFrozenCount(e[parseInt(i.toString(),10)].columns,t,r):(e[parseInt(i.toString(),10)].isFrozen&&r>this.frozenColumns-1&&t++,r++);return t},o.prototype.goToPage=function(e){this.pagerModule&&this.pagerModule.goToPage(e)},o.prototype.updateExternalMessage=function(e){this.pagerModule&&this.pagerModule.updateExternalMessage(e)},o.prototype.sortColumn=function(e,t,r){this.sortModule&&this.sortModule.sortColumn(e,t,r)},o.prototype.changeDataSource=function(e,r){this.setProperties({sortSettings:{columns:[]}},!0),this.setProperties({filterSettings:{columns:[]}},!0),this.setProperties({searchSettings:{key:""}},!0),this.allowGrouping&&this.setProperties({groupSettings:{columns:[]}},!0),r&&r.length&&this.setProperties({columns:r},!0),e&&(t.isNullOrUndefined(r)&&this.setProperties({columns:[]},!0),this.setProperties({dataSource:e},!0)),this.freezeRefresh()},o.prototype.clearSorting=function(){this.sortModule&&this.sortModule.clearSorting()},o.prototype.removeSortColumn=function(e){this.sortModule&&this.sortModule.removeSortColumn(e)},o.prototype.clearGridActions=function(){this.setProperties({sortSettings:{columns:[]}},!0),this.setProperties({filterSettings:{columns:[]}},!0),this.setProperties({searchSettings:{key:""}},!0),this.allowGrouping?this.setProperties({groupSettings:{columns:[]}},!1):this.freezeRefresh()},o.prototype.filterByColumn=function(e,t,r,i,n,o,s,a){this.filterModule&&this.filterModule.filterByColumn(e,t,r,i,n,o,s,a)},o.prototype.clearFiltering=function(e){this.filterModule&&this.filterModule.clearFiltering(e)},o.prototype.removeFilteredColsByField=function(e,t){this.filterModule&&this.filterModule.removeFilteredColsByField(e,t)},o.prototype.selectRow=function(e,t){this.selectionModule&&this.selectionModule.selectRow(e,t)},o.prototype.selectRows=function(e){this.selectionModule&&this.selectionModule.selectRows(e)},o.prototype.clearSelection=function(){this.selectionModule&&this.selectionModule.clearSelection()},o.prototype.selectCell=function(e,t){this.selectionModule&&this.selectionModule.selectCell(e,t)},o.prototype.selectCellsByRange=function(e,t){this.selectionModule.selectCellsByRange(e,t)},o.prototype.search=function(e){this.searchModule&&this.searchModule.search(e)},o.prototype.print=function(){this.printModule&&this.printModule.print()},o.prototype.deleteRecord=function(e,t){this.editModule&&this.editModule.deleteRecord(e,t)},o.prototype.startEdit=function(){this.editModule&&this.editModule.startEdit()},o.prototype.endEdit=function(){this.editModule&&this.editModule.endEdit()},o.prototype.closeEdit=function(){this.editModule&&this.editModule.closeEdit()},o.prototype.addRecord=function(e,t){this.editModule&&this.editModule.addRecord(e,t)},o.prototype.deleteRow=function(e){this.editModule&&this.editModule.deleteRow(e)},o.prototype.editCell=function(e,t){this.editModule&&this.editModule.editCell(e,t)},o.prototype.saveCell=function(){this.editModule&&this.editModule.saveCell()},o.prototype.updateCell=function(e,t,r){this.editModule&&this.editModule.updateCell(e,t,r)},o.prototype.updateRow=function(e,t){this.editModule&&this.editModule.updateRow(e,t)},o.prototype.getBatchChanges=function(){return this.editModule?this.editModule.getBatchChanges():{}},o.prototype.enableToolbarItems=function(e,t){this.toolbarModule&&this.toolbarModule.enableItems(e,t)},o.prototype.copy=function(e){this.clipboardModule&&this.clipboardModule.copy(e)},o.prototype.recalcIndentWidth=function(){var e=this;if(this.getHeaderTable().querySelector(".e-emptycell")&&(this.groupSettings.columns.length||this.isDetail()||this.isRowDragable())&&!this.getHeaderTable().querySelector(".e-emptycell").getAttribute("indentRefreshed")&&this.getContentTable()){var t=this.getHeaderTable().querySelector(".e-emptycell").parentElement.offsetWidth,r=[].slice.call(this.getHeaderTable().querySelector(hi).childNodes),i=[].slice.call(this.getContentTable().querySelector(hi).childNodes),n=t/30,o="Right"===this.getFrozenMode()?this.frozenRightCount:0,s=this.element.offsetWidth,a=function(t,n){if(Oe(e)){var o=(n/s*100).toFixed(1)+"%";r[parseInt(t.toString(),10)].style.width=o,i[parseInt(t.toString(),10)].style.width=o}else r[parseInt(t.toString(),10)].style.width=n+"px",i[parseInt(t.toString(),10)].style.width=n+"px";e.notify("column-width-changed",{index:t,width:n})};for(n>=1&&(t=30/n),t<1&&(t=1),(this.enableColumnVirtualization||this.isAutoGen||this.columns.length===this.groupSettings.columns.length)&&(t=30);o<this.groupSettings.columns.length;)a(o,t),o++;this.isDetail()&&(a(o,t),o++),this.isRowDragable()&&a(o,t),this.isAutoGen=!1,this.getHeaderTable().querySelector(".e-emptycell").setAttribute("indentRefreshed","true")}},o.prototype.resetIndentWidth=function(){if(Oe(this)&&(this.getHeaderTable().querySelector(".e-emptycell").removeAttribute("indentRefreshed"),this.widthService.setWidthToColumns(),this.recalcIndentWidth(),this.autoFit&&this.preventAdjustColumns()),("auto"===this.width||"string"==typeof this.width&&-1!==this.width.indexOf("%"))&&this.getColumns().filter(function(e){return(!e.width||"auto"===e.width)&&e.minWidth}).length>0){var e=this.widthService.getTableWidth(this.getColumns());this.widthService.setMinwidthBycalculation(e)}this.isFrozenGrid()&&this.widthService&&this.widthService.refreshFrozenScrollbar(),this.allowTextWrap&&"Content"!==this.textWrapSettings.wrapMode&&this.notify(Or,{})},o.prototype.isRowDragable=function(){return this.allowRowDragAndDrop&&!this.rowDropSettings.targetID},o.prototype.reorderColumns=function(e,t){this.reorderModule&&this.reorderModule.reorderColumns(e,t)},o.prototype.reorderColumnByIndex=function(e,t){this.reorderModule&&this.reorderModule.reorderColumnByIndex(e,t)},o.prototype.reorderColumnByTargetIndex=function(e,t){this.reorderModule&&this.reorderModule.reorderColumnByTargetIndex(e,t)},o.prototype.reorderRows=function(e,t){this.rowDragAndDropModule&&this.rowDragAndDropModule.reorderRows(e,t)},o.prototype.refreshDataSource=function(e){this.notify("refreshdataSource",e)},o.prototype.disableRowDD=function(e){var r=this.getHeaderTable(),i=this.getContentTable(),n=r.querySelectorAll("th.e-rowdragheader, th.e-mastercell"),o=this.getRows(),s=e?"none":"";t.setStyleAttribute(r.querySelector(hi).childNodes[0],{display:s}),t.setStyleAttribute(i.querySelector(hi).childNodes[0],{display:s});for(var a=0;a<this.getRows().length;a++){h=o[parseInt(a.toString(),10)].firstElementChild;e?t.addClass([h],"e-hide"):t.removeClass([h],["e-hide"])}for(var l=0;l<r.querySelectorAll("th.e-rowdragheader, th.e-mastercell").length;l++){var h=n[parseInt(l.toString(),10)];e?t.addClass([h],"e-hide"):t.removeClass([h],["e-hide"])}},o.prototype.autoFitColumns=function(e){this.resizeModule&&this.resizeModule.autoFitColumns(e)},o.prototype.preventAdjustColumns=function(){if(!(this.isFrozenGrid()||this.enableAdaptiveUI&&"Vertical"===this.rowRenderingMode||this.allowResizing&&"Auto"===this.resizeSettings.mode)){for(var e=this.getColumns(),r=this.getHeaderTable(),i=0,n=0;n<e.length;n++)if(e[parseInt(n.toString(),10)].visible){if(this.groupSettings.columns.length&&this.groupSettings.columns.indexOf(e[parseInt(n.toString(),10)].field)>-1&&"none"===[].slice.call(r.querySelector("colgroup").querySelectorAll(":not(.e-group-intent):not(.e-detail-intent):not(.e-drag-intent)"))[parseInt(n.toString(),10)].style.display)continue;if(!e[parseInt(n.toString(),10)].width){i=0;break}i+=parseFloat(e[parseInt(n.toString(),10)].width.toString())}if(i){var o=this.isPercentageWidthGrid(),s=this.widthUnit(o),a=this.getContentTable();if(this.groupSettings.columns.length||this.isDetail()||this.isRowDragable())for(var l=this.defaultIndentWidth(o),h=l.toString()+s,p=[].slice.call(r.querySelector("colgroup").querySelectorAll(".e-group-intent, .e-detail-intent, .e-drag-intent")),d=[].slice.call(a.querySelector("colgroup").querySelectorAll(".e-group-intent, .e-detail-intent, .e-drag-intent")),n=0;n<p.length;n++)p[parseInt(n.toString(),10)].style.setProperty("width",h),d[parseInt(n.toString(),10)].style.setProperty("width",h),i+=l;(o&&i<100||!o&&i<a.parentElement.clientWidth)&&t.addClass([r,a],["e-tableborder"]);var c=i.toString()+s;r.style.setProperty("width",c),a.style.setProperty("width",c)}else this.restoreAdjustColumns()}},o.prototype.restoreAdjustColumns=function(){if(!(this.isFrozenGrid()||this.enableAdaptiveUI&&"Vertical"===this.rowRenderingMode||this.allowResizing&&"Auto"===this.resizeSettings.mode)){var e=this.getHeaderTable(),r=this.getContentTable();if(t.removeClass([e,r],["e-tableborder"]),e.style.removeProperty("width"),r.style.removeProperty("width"),this.groupSettings.columns.length||this.isDetail()||this.isRowDragable()){var i=this.isPercentageWidthGrid(),n=this.defaultIndentWidth(i).toString()+this.widthUnit(i);[].slice.call(e.querySelector("colgroup").querySelectorAll(".e-group-intent, .e-detail-intent, .e-drag-intent")).forEach(function(e){e.style.setProperty("width",n)}),e.querySelector(".e-emptycell").removeAttribute("indentRefreshed"),this.recalcIndentWidth()}}},o.prototype.widthUnit=function(e){return e?"%":"px"},o.prototype.defaultIndentWidth=function(e){return e?parseFloat((30/this.element.offsetWidth*100).toFixed(1)):30},o.prototype.isPercentageWidthGrid=function(){return this.getColumns()[0].width.toString().indexOf("%")>-1},o.prototype.createColumnchooser=function(e,t,r){this.columnChooserModule&&this.columnChooserModule.renderColumnChooser(e,t,r)},o.prototype.initializeServices=function(){this.serviceLocator.register("widthService",this.widthService=new en(this)),this.serviceLocator.register("cellRendererFactory",new Yi),this.serviceLocator.register("rendererFactory",new $i),this.serviceLocator.register("localization",this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale)),this.serviceLocator.register("valueFormatter",this.valueFormatterService=new Mt(this.locale)),this.serviceLocator.register("showHideService",this.showHider=new bn(this)),this.serviceLocator.register("ariaService",this.ariaService=new Fi),this.serviceLocator.register("focus",this.focusModule=new rn(this))},o.prototype.processModel=function(){var e,r,i=this.groupSettings.columns,n=this.sortSettings.columns;if(this.allowGrouping)for(var o=this,s=0,a=i.length;s<a;s++)!function(t,s){r=0;for(var a=n.length;r<a;r++)if(n[parseInt(r.toString(),10)].field===i[parseInt(t.toString(),10)]){e=!0;break}if(e?o.allowSorting?o.sortedColumns.push(n[parseInt(r.toString(),10)].field):n[parseInt(r.toString(),10)].direction="Ascending":n.push({field:i[parseInt(t.toString(),10)],direction:"Ascending",isFromGroup:!0}),!o.groupSettings.showGroupedColumn){var l=o.enableColumnVirtualization?o.columns.filter(function(e){return e.field===i[parseInt(t.toString(),10)]})[0]:o.getColumnByField(i[parseInt(t.toString(),10)]);l?l.visible=!1:o.log("initial_action",{moduleName:"group",columnName:i[parseInt(t.toString(),10)]})}}(s);if(!i.length)for(s=0;s<n.length;s++)this.sortedColumns.push(n[parseInt(s.toString(),10)].field);if(this.rowTemplateFn=R(this.rowTemplate),this.detailTemplateFn=R(this.detailTemplate),this.editTemplateFn=R(this.editSettings.template),this.editHeaderTemplateFn=R(this.editSettings.headerTemplate),this.editFooterTemplateFn=R(this.editSettings.footerTemplate),!t.isNullOrUndefined(this.parentDetails)){var l=t.isNullOrUndefined(this.parentDetails.parentKeyFieldValue)?"undefined":this.parentDetails.parentKeyFieldValue;this.query.where(this.queryString,"equal",l,!0)}this.initForeignColumn()},o.prototype.initForeignColumn=function(){this.isForeignKeyEnabled(this.getColumns())&&this.notify("initForeignKeyColumn",this.getForeignKeyColumns())},o.prototype.enableVerticalRendering=function(){"Vertical"===this.rowRenderingMode?this.element.classList.add("e-row-responsive"):this.element.classList.remove("e-row-responsive")},o.prototype.gridRender=function(){this.updateRTL(),"Vertical"===this.rowRenderingMode&&this.element.classList.add("e-row-responsive"),this.enableHover&&this.element.classList.add("e-gridhover"),t.Browser.isDevice&&this.element.classList.add("e-device"),this.rowHeight&&this.element.classList.add("e-grid-min-height"),this.cssClass&&this.element.classList.add(this.cssClass),this.allowRowDragAndDrop&&this.rowDropSettings.targetID&&"mozilla"===t.Browser.info.name&&this.element.classList.add("e-disableuserselect"),t.classList(this.element,["e-responsive","e-default"],[]);var r=this.serviceLocator.getService("rendererFactory");this.headerModule=r.getRenderer(e.RenderType.Header),this.contentModule=r.getRenderer(e.RenderType.Content),this.printModule=new Gn(this,this.scrollModule),this.clipboardModule=new Tn(this,this.serviceLocator),this.renderModule.render(),this.eventInitializer(),this.createGridPopUpElement(),this.widthService.setWidthToColumns(),this.updateGridLines(),this.applyTextWrap(),this.createTooltip(),this.enableBoxSelection()},o.prototype.dataReady=function(){this.scrollModule.setWidth(),this.scrollModule.setHeight(),"auto"!==this.height&&this.scrollModule.setPadding()},o.prototype.updateRTL=function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")},o.prototype.createGridPopUpElement=function(){var e=this.createElement("div",{className:"e-gridpopup",styles:"display:none;"}),r=this.createElement("div",{className:Yr,attrs:{tabIndex:"-1"}});t.append([r,this.createElement("div",{className:"e-uptail e-tail"})],e),r.appendChild(this.createElement("span")),t.append([r,this.createElement("div",{className:"e-downtail e-tail"})],e),this.element.appendChild(e)},o.prototype.updateGridLines=function(){switch(t.classList(this.element,[],["e-verticallines","e-horizontallines","e-hidelines","e-bothlines"]),this.gridLines){case"Horizontal":this.element.classList.add("e-horizontallines");break;case"Vertical":this.element.classList.add("e-verticallines");break;case"None":this.element.classList.add("e-hidelines");break;case"Both":this.element.classList.add("e-bothlines")}this.updateResizeLines()},o.prototype.updateResizeLines=function(){this.allowResizing&&"Vertical"!==this.gridLines&&"Both"!==this.gridLines?this.element.classList.add("e-resize-lines"):this.element.classList.remove("e-resize-lines")},o.prototype.applyTextWrap=function(){if(this.allowTextWrap){var e=[].slice.call(this.element.getElementsByClassName("e-columnheader"));switch(this.textWrapSettings.wrapMode){case"Header":J(this.element,!1),J(this.getContent(),!1),J(e,!0);break;case"Content":J(this.getContent(),!0),J(this.element,!1),J(e,!1);break;default:J(this.element,!0),J(this.getContent(),!1),J(e,!1)}"Content"!==this.textWrapSettings.wrapMode&&this.notify(Or,{})}},o.prototype.removeTextWrap=function(){J(this.element,!1),J([].slice.call(this.element.getElementsByClassName("e-columnheader")),!1),J(this.getContent(),!1),"Content"!==this.textWrapSettings.wrapMode&&this.notify(Or,{})},o.prototype.createTooltip=function(){this.toolTipObj=new i.Tooltip({opensOn:"custom",content:"",cssClass:this.cssClass?this.cssClass:null},this.element)},o.prototype.freezeRefresh=function(){this.isFreezeRefresh=!0,(this.enableVirtualization||this.enableInfiniteScrolling)&&(this.pageSettings.currentPage=1),this.componentRefresh()},o.prototype.getTooltipStatus=function(e){var t=this.getHeaderTable(),r=this.createTable(t,"e-gridheader","header"),i=this.createTable(t,"e-gridheader","content"),n=e.classList.contains("e-headercell")?r:i,o=e.classList.contains("e-headercell")?"th":"tr";n.querySelector(o).className=e.className,n.querySelector(o).innerHTML=e.innerHTML;var s=n.querySelector(o).getBoundingClientRect().width;return document.body.removeChild(r),document.body.removeChild(i),s>e.getBoundingClientRect().width},o.prototype.mouseMoveHandler=function(e){if(this.isEllipsisTooltip()){var r=O(e.target,"e-ellipsistooltip");this.prevElement===r&&"mouseout"!==e.type||this.toolTipObj.close();var i=e.target.tagName,n=["A","BUTTON","INPUT"];if(r&&"mouseout"!==e.type&&(!t.Browser.isDevice||-1===n.indexOf(i))){if(r.getAttribute("data-tooltip-id"))return;if(this.getTooltipStatus(r)){var o=this.getColumns()[parseInt(r.getAttribute(oi),10)],s=o.disableHtmlEncode?"innerText":"innerHTML",a=this.createElement("div");if(r.getElementsByClassName("e-headertext").length){var l=r.getElementsByClassName("e-headertext")[0];a[""+s]=this.sanitize(l.innerText),this.toolTipObj.content=a}else a[""+s]=this.sanitize(r.innerText),this.toolTipObj.content=a;this.prevElement=r,this.enableHtmlSanitizer&&(this.toolTipObj.enableHtmlSanitizer=!0),o.disableHtmlEncode&&(this.toolTipObj.enableHtmlParse=!1),this.toolTipObj.open(r)}}}this.hoverFrozenRows(e)},o.prototype.hoverFrozenRows=function(e){if(this.isFrozenGrid()){var t=O(e.target,Zr);if([].slice.call(this.element.getElementsByClassName("e-frozenhover")).length&&"mouseout"===e.type)for(var r=[].slice.call(this.element.getElementsByClassName("e-frozenhover")),i=0;i<r.length;i++)r[parseInt(i.toString(),10)].classList.remove("e-frozenhover");else if(t){(r=[].slice.call(this.element.querySelectorAll('tr[data-rowindex="'+t.getAttribute(si)+'"]'))).splice(r.indexOf(t),1);for(i=0;i<r.length;i++)"true"!==t.getAttribute("aria-selected")&&r[parseInt(i.toString(),10)]?r[parseInt(i.toString(),10)].classList.add("e-frozenhover"):r[parseInt(i.toString(),10)]&&r[parseInt(i.toString(),10)].classList.remove("e-frozenhover")}}},o.prototype.isEllipsisTooltip=function(){var e=this.getColumns();if("EllipsisWithTooltip"===this.clipMode)return!0;for(var t=0;t<e.length;t++)if("EllipsisWithTooltip"===e[parseInt(t.toString(),10)].clipMode)return!0;return!1},o.prototype.scrollHandler=function(){this.isEllipsisTooltip()&&this.toolTipObj.close()},o.prototype.createTable=function(e,t,r){var i=this.createElement("div");i.className=this.element.className,i.style.cssText="display: inline-block;visibility:hidden;position:absolute";var n=this.createElement("div");n.className=t;var o=this.createElement("table",{attrs:{role:"grid"}});o.className=e.className,o.style.cssText="table-layout: auto;width: auto";var s="header"===r?"th":"td",a=this.createElement("tr"),l=this.createElement(s);return a.appendChild(l),o.appendChild(a),n.appendChild(o),i.appendChild(n),document.body.appendChild(i),i},o.prototype.onKeyPressed=function(e){"tab"!==e.action&&"shiftTab"!==e.action||this.toolTipObj.close()},o.prototype.wireEvents=function(){t.EventHandler.add(this.element,"click",this.mouseClickHandler,this),t.EventHandler.add(this.element,"touchend",this.mouseClickHandler,this),t.EventHandler.add(this.element,"focusout",this.focusOutHandler,this),t.EventHandler.add(this.element,"dblclick",this.dblClickHandler,this),t.EventHandler.add(this.element,"keydown",this.keyPressHandler,this),t.EventHandler.add(window,"resize",this.resetIndentWidth,this),this.allowKeyboard&&(this.element.tabIndex=-1===this.element.tabIndex?0:this.element.tabIndex),this.keyboardModule=new t.KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),t.EventHandler.add(this.getContent().firstElementChild,"scroll",this.scrollHandler,this),t.EventHandler.add(this.element,"mousemove",this.mouseMoveHandler,this),t.EventHandler.add(this.element,"mouseout",this.mouseMoveHandler,this),t.EventHandler.add(this.getContent(),"touchstart",this.tapEvent,this),t.EventHandler.add(document.body,"keydown",this.keyDownHandler,this)},o.prototype.unwireEvents=function(){t.EventHandler.remove(this.element,"click",this.mouseClickHandler),t.EventHandler.remove(this.element,"touchend",this.mouseClickHandler),t.EventHandler.remove(this.element,"focusout",this.focusOutHandler),t.EventHandler.remove(this.element,"dblclick",this.dblClickHandler),t.EventHandler.remove(this.getContent().firstElementChild,"scroll",this.scrollHandler),t.EventHandler.remove(this.element,"mousemove",this.mouseMoveHandler),t.EventHandler.remove(this.element,"mouseout",this.mouseMoveHandler),t.EventHandler.remove(this.element,"keydown",this.keyPressHandler),t.EventHandler.remove(this.getContent(),"touchstart",this.tapEvent),t.EventHandler.remove(document.body,"keydown",this.keyDownHandler),t.EventHandler.remove(window,"resize",this.resetIndentWidth)},o.prototype.addListener=function(){this.isDestroyed||(this.on(Xt,this.dataReady,this),this.on(Yt,this.recalcIndentWidth,this),this.on(rr,this.recalcIndentWidth,this),this.dataBoundFunction=this.refreshMediaCol.bind(this),this.addEventListener(qt,this.dataBoundFunction),this.on(sr,this.onKeyPressed,this))},o.prototype.removeListener=function(){this.isDestroyed||(this.off(Xt,this.dataReady),this.off(Yt,this.recalcIndentWidth),this.off(rr,this.recalcIndentWidth),this.removeEventListener(qt,this.dataBoundFunction),this.off(sr,this.onKeyPressed))},o.prototype.getCurrentViewRecords=function(){return ue(this)?t.isNullOrUndefined(this.currentViewData.records)?this.currentViewData:this.currentViewData.records:this.groupSettings.enableLazyLoading?this.currentViewData:this.allowGrouping&&this.groupSettings.columns.length&&this.currentViewData.length&&this.currentViewData.records?this.currentViewData.records:this.currentViewData},o.prototype.mouseClickHandler=function(e){if(!(this.isChildGrid(e)||O(e.target,"e-gridpopup")&&e.touches||this.element.getElementsByClassName("e-cloneproperties").length||this.checkEdit(e))&&((this.allowRowDragAndDrop||!O(e.target,Vr)&&"TD"!==e.target.tagName)&&(this.allowGrouping||this.allowReordering||!O(e.target,"e-gridheader"))||!e.touches)){O(e.target,"e-gridheader")&&this.allowRowDragAndDrop&&!O(e.target,"e-filterbarcell")&&e.target&&-1===["A","BUTTON","INPUT"].indexOf(e.target.tagName)&&e.preventDefault();var r=this.getRowInfo(e.target);r.cancel=!1;var i=!1,n=t.closest(e.target,"tr");if(n&&n.getAttribute("data-uid")){var o=this.getRowObjectFromUID(n.getAttribute("data-uid"));i=!!o&&o.isDataRow}i&&this.trigger("recordClick",r),this.notify(ar,e)}},o.prototype.checkEdit=function(e){var t=O(e.target,Zr),r="Batch"!==this.editSettings.mode&&this.isEdit&&t&&(t.classList.contains(ei)||t.classList.contains(ti));return!O(e.target,"e-unboundcelldiv")&&(r||O(e.target,Ur)&&O(e.target,Ur).classList.contains("e-editedbatchcell"))},o.prototype.dblClickHandler=function(e){var r=O(e.target,"e-grid");if(!t.isNullOrUndefined(r)&&r.id===this.element.id&&!t.closest(e.target,".e-unboundcelldiv")){var i=!1,n=t.closest(e.target,"tr");if(n&&n.getAttribute("data-uid")){var o=this.getRowObjectFromUID(n.getAttribute("data-uid"));i=!!o&&o.isDataRow}var s=this.getRowInfo(e.target);s.target=e.target,i&&this.trigger("recordDoubleClick",s),this.notify("dblclick",e)}},o.prototype.focusOutHandler=function(e){if(!this.isChildGrid(e)){O(e.target,"e-grid")||(this.element.querySelector(".e-gridpopup").style.display="None");var r=this.element.querySelector(".e-cancel:not(.e-hide)");r&&!r.parentElement.classList.contains("e-tbar-btn")&&r.classList.add("e-hide");var i=e.relatedTarget,n=i?i.getAttribute("aria-owns"):null;i&&(O(i,"e-grid")||(!t.isNullOrUndefined(n)&&n)===e.target.getAttribute("aria-owns"))||this.keyPress||!this.isEdit||t.Browser.isDevice||("Batch"!==this.editSettings.mode||(O(i,"e-ddl")||O(i,"e-ddt"))&&O(i,"e-input-group")||t.isNullOrUndefined(O(i,"e-input-group"))||(this.editModule.saveCell(),this.notify("editNextValCell",{})),"Normal"===this.editSettings.mode&&this.editModule.editFormValidate()),this.keyPress=!1}},o.prototype.isChildGrid=function(e){var r=O(e.target,"e-grid");return!!(r&&r.id!==this.element.id||O(e.target,"e-unboundcelldiv")&&t.isNullOrUndefined(r))},o.prototype.mergePersistGridData=function(e){var r=this.getLocalData();if(!t.isNullOrUndefined(r)&&""!==r||!t.isNullOrUndefined(e)){var i=t.isNullOrUndefined(e)?JSON.parse(r):e;this.enableVirtualization&&i.pageSettings&&(i.pageSettings.currentPage=1);var n=Object.keys(i);this.isProtectedOnChange=!0;for(var o=0,s=n;o<s.length;o++){var a=s[o];"object"!=typeof this[""+a]||t.isNullOrUndefined(this[""+a])?this[""+a]=i[""+a]:Array.isArray(this[""+a])&&"columns"===a?(T(this[""+a]),this.mergeColumns(i[""+a],this[""+a]),this[""+a]=i[""+a]):t.extend(this[""+a],i[""+a])}this.isProtectedOnChange=!1}},o.prototype.mergeColumns=function(e,r){for(var i=e,n=this,o=0;o<i.length;o++)!function(e){var o=r.filter(function(t){return t.index===i[parseInt(e.toString(),10)].index})[0];t.isNullOrUndefined(o)||(o.columns&&o.columns.length?(n.mergeColumns(i[parseInt(e.toString(),10)].columns,o.columns),i[parseInt(e.toString(),10)]=t.extend(o,i[parseInt(e.toString(),10)],{},!0)):i[parseInt(e.toString(),10)]=t.extend(o,i[parseInt(e.toString(),10)],{},!0))}(o)},o.prototype.isDetail=function(){return!t.isNullOrUndefined(this.detailTemplate)||!t.isNullOrUndefined(this.childGrid)},o.prototype.isCommandColumn=function(e){var t=this;return e.some(function(e){return e.columns?t.isCommandColumn(e.columns):!(!e.commands&&!e.commandsTemplate)})},o.prototype.isForeignKeyEnabled=function(e){var t=this;return e.some(function(e){return e.columns?t.isForeignKeyEnabled(e.columns):!(!e.dataSource||!e.foreignKeyValue)})},o.prototype.keyPressHandler=function(e){var r=t.extend(e,{cancel:!1});this.trigger("keyPressed",r),!0===r.cancel&&e.stopImmediatePropagation()},o.prototype.keyDownHandler=function(e){if(e.altKey){if(74===e.keyCode&&(this.keyA?(this.notify("group-collapse",{target:e.target,collapse:!1}),this.keyA=!1):(this.focusModule&&this.focusModule.currentInfo&&this.focusModule.currentInfo.element&&(t.removeClass([this.focusModule.currentInfo.element,this.focusModule.currentInfo.elementToFocus],["e-focused","e-focus"]),this.focusModule.currentInfo.element.tabIndex=-1),this.element.classList.contains("e-childgrid")||this.element.focus())),87===e.keyCode){var r=this.focusModule;if(r){if(!this.currentViewData.length)return;r.focusContent(),r.addOutline()}}65===e.keyCode&&(this.keyA=!0),72===e.keyCode&&this.keyA&&(this.notify("group-collapse",{target:e.target,collapse:!0}),this.keyA=!1)}13===e.keyCode&&this.notify("enter-key-handler",e)},o.prototype.keyActionHandler=function(e){this.isChildGrid(e)||this.isEdit&&"escape"!==e.action&&"enter"!==e.action&&"shiftEnter"!==e.action&&"tab"!==e.action&&"shiftTab"!==e.action||(this.keyPress=!0,this.allowKeyboard&&("ctrlPlusP"===e.action&&(e.preventDefault(),this.print()),this.notify(sr,e)))},o.prototype.setInjectedModules=function(e){this.injectedModules=e},o.prototype.updateColumnObject=function(){E(this.columns,this.enableColumnVirtualization,this),T(this.columns),this.initForeignColumn(),this.notify(yr,{})},o.prototype.getForeignKeyColumns=function(){return this.getColumns().filter(function(e){return e.isForeignColumn()})},o.prototype.getRowHeight=function(){return this.rowHeight?this.rowHeight:V(this.element)},o.prototype.refreshColumns=function(){this.setFrozenCount();var e=this.getContent().querySelector(".e-frozen-left-content"),r=this.getContent().querySelector(".e-frozen-right-content"),i=!this.frozenRightCount&&!this.frozenLeftCount;if(!(0!==this.getFrozenColumns())&&(!e&&this.frozenLeftCount||!r&&this.frozenRightCount||e&&!this.frozenLeftCount||r&&!this.frozenRightCount))this.tableIndex=0,this.tablesCount=1,this.enableColumnVirtualization&&(this.columnModel=[],this.updateColumnModel(this.columns)),this.freezeRefresh();else if(i&&(1===this.getFrozenColumns()&&!e||0===this.getFrozenColumns()&&e))this.tableIndex=0,this.tablesCount=1,this.enableColumnVirtualization&&(this.columnModel=[],this.updateColumnModel(this.columns)),this.freezeRefresh();else if(this.isPreventScrollEvent=!0,this.updateColumnObject(),this.checkLockColumns(this.getColumns()),this.refresh(),this.isFrozenGrid()){var n=this.contentModule.getMovableContent().querySelector("."+Jr);t.remove(n.querySelector(hi));var o=this.getHeaderContent().querySelector("."+Kr).querySelector(hi).cloneNode(!0);if(n.insertBefore(o,n.querySelector(li)),"Left-Right"===this.getFrozenMode()){var s=this.contentModule.getFrozenRightContent().querySelector("."+Jr);t.remove(s.querySelector(hi));var a=this.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(hi).cloneNode(!0);s.insertBefore(a,s.querySelector(li))}}if(this.isFrozenGrid()){var l=this.getContent().querySelector(".e-movablescrollbar").scrollLeft;this.headerModule.getMovableHeader().scrollLeft=l,this.contentModule.getMovableContent().scrollLeft=l}},o.prototype.excelExport=function(e,t,r,i){return this.excelExportModule?this.excelExportModule.Map(this,e,t,r,!1,i):null},o.prototype.csvExport=function(e,t,r,i){return this.excelExportModule?this.excelExportModule.Map(this,e,t,r,!0,i):null},o.prototype.pdfExport=function(e,t,r,i){return this.pdfExportModule?this.pdfExportModule.Map(this,e,t,r,i):null},o.prototype.groupColumn=function(e){this.groupModule&&this.groupModule.groupColumn(e)},o.prototype.groupExpandAll=function(){this.groupModule&&this.groupModule.expandAll()},o.prototype.groupCollapseAll=function(){this.groupModule&&this.groupModule.collapseAll()},o.prototype.clearGrouping=function(){this.groupModule&&this.groupModule.clearGrouping()},o.prototype.ungroupColumn=function(e){this.groupModule&&this.groupModule.ungroupColumn(e)},o.prototype.openColumnChooser=function(e,t){this.columnChooserModule&&this.columnChooserModule.openColumnChooser(e,t)},o.prototype.scrollRefresh=function(){var e=this,t=function(){e.scrollModule.refresh(),e.off(Yt,t)};this.on(Yt,t,this)},o.prototype.detailCollapseAll=function(){this.detailRowModule&&this.detailRowModule.collapseAll()},o.prototype.detailExpandAll=function(){this.detailRowModule&&this.detailRowModule.expandAll()},o.prototype.clearCellSelection=function(){this.selectionModule&&this.selectionModule.clearCellSelection()},o.prototype.clearRowSelection=function(){this.selectionModule&&this.selectionModule.clearRowSelection()},o.prototype.selectCells=function(e){this.selectionModule&&this.selectionModule.selectCells(e)},o.prototype.selectRowsByRange=function(e,t){this.selectionModule&&this.selectionModule.selectRowsByRange(e,t)},o.prototype.isContextMenuOpen=function(){return this.contextMenuModule&&this.contextMenuModule.isOpen},o.prototype.ensureModuleInjected=function(e){return this.getInjectedModules().indexOf(e)>=0},o.prototype.destroyTemplate=function(e,t){this.clearTemplate(e,t)},o.prototype.log=function(e,t){this.loggerModule&&this.loggerModule.log(e,t)},o.prototype.applyBiggerTheme=function(e){this.element.classList.contains("e-bigger")&&e.classList.add("e-bigger")},o.prototype.getPreviousRowData=function(){return this.getRowsObject()[this.getRows().length-1].data},o.prototype.hideScroll=function(){var e=this.getContent().querySelector("."+Yr),t=this.getContent().querySelector(".e-scrollbar");if(e.scrollHeight<=e.clientHeight&&(this.scrollModule.removePadding(),e.style.overflowY="auto"),this.isFrozenGrid()&&t){var r=this.getContent().querySelector(".e-movablescrollbar"),i=this.getContent().querySelector(".e-movablechild");t.style.display="flex",r.offsetWidth>=i.offsetWidth&&(t.style.display="none",this.notify("frozenHeight",0))}},o.prototype.getRowIndexByPrimaryKey=function(e){var t=this.getPrimaryKeyFieldNames()[0];e="object"==typeof e?e[""+t]:e;for(var r=this.getRowsObject(),i=0;i<r.length;i++)if(!r[parseInt(i.toString(),10)].isDetailRow&&!r[parseInt(i.toString(),10)].isCaptionRow){var n=r[parseInt(i.toString(),10)].data[""+t];if(t.split(".").length>1&&(n=Ye(t,r[parseInt(i.toString(),10)].data)),n===e)return r[parseInt(i.toString(),10)].index}return-1},o.prototype.grabColumnByFieldFromAllCols=function(e){var t;this.columnModel=[],this.updateColumnModel(this.columns);for(var r=this.columnModel,i=0;i<r.length;i++)(e===r[parseInt(i.toString(),10)].field||r[parseInt(i.toString(),10)].isForeignColumn()&&e===r[parseInt(i.toString(),10)].foreignKeyValue)&&(t=r[parseInt(i.toString(),10)]);return t},o.prototype.grabColumnByUidFromAllCols=function(e){var t;this.columnModel=[],this.updateColumnModel(this.columns);for(var r=this.columnModel,i=0;i<r.length;i++)e===r[parseInt(i.toString(),10)].uid&&(t=r[parseInt(i.toString(),10)]);return t},o.prototype.getFilteredRecords=function(){if(this.allowFiltering&&this.filterSettings.columns.length){var e=this.renderModule.data.generateQuery(!0);return this.dataSource&&this.renderModule.data.isRemote()&&this.dataSource instanceof r.DataManager?this.renderModule.data.getData(this.dataSource,e):this.dataSource instanceof r.DataManager?this.dataSource.executeLocal(e):new r.DataManager(this.dataSource,e).executeLocal(e)}return[]},o.prototype.getUserAgent=function(){var e=t.Browser.userAgent.toLowerCase();return/iphone|ipod|ipad|macintosh/.test(e)},o.prototype.tapEvent=function(t){this.getUserAgent()&&(e.Global.timer?(clearTimeout(e.Global.timer),e.Global.timer=null,this.dblClickHandler(t),this.notify("double-tap",t)):e.Global.timer=setTimeout(function(){e.Global.timer=null},300))},o.prototype.getRowUid=function(e){return""+e+this.rowUid++},o.prototype.getMovableVirtualContent=function(){return this.getContent().querySelector("."+Wr)},o.prototype.getFrozenVirtualContent=function(){return this.getContent().querySelector("."+Qr)},o.prototype.getMovableVirtualHeader=function(){return this.getHeaderContent().querySelector("."+Kr)},o.prototype.getFrozenVirtualHeader=function(){return this.getHeaderContent().querySelector("."+Xr)},o.prototype.getRowElementByUID=function(e){var t,r=[];if(this.isFrozenGrid()){var i=[].slice.call(this.getFrozenVirtualContent().querySelector(li).children),n=[].slice.call(this.getMovableVirtualContent().querySelector(li).children),o=[];if(3===this.tablesCount&&(o=[].slice.call(this.getContent().querySelector(".e-frozen-right-content").querySelector(li).children)),this.frozenRows){if(r=[].slice.call(this.getFrozenVirtualHeader().querySelector(li).children),r=r.concat([].slice.call(this.getMovableVirtualHeader().querySelector(li).children)),3===this.tablesCount){var s=this.getHeaderContent().querySelector(".e-frozen-right-header");r=r.concat([].slice.call(s.querySelector(li).children)).concat(o)}r=r.concat(i).concat(n)}else r=i.concat(n).concat(o)}else{var a=[].slice.call(this.getContent().querySelector(li).children);r=this.frozenRows?(r=[].slice.call(this.getHeaderContent().querySelector(li).children)).concat(a):a}for(var l=0,h=r;l<h.length;l++){var p=h[l];if(p.getAttribute("data-uid")===e){t=p;break}}return t},o.prototype.getHiddenColumns=function(){for(var e=[],t=0,r=this.columnModel;t<r.length;t++){var i=r[t];!1===i.visible&&e.push(i)}return e},o.prototype.calculatePageSizeByParentHeight=function(e){if(this.allowPaging&&(this.allowTextWrap&&"Header"===this.textWrapSettings.wrapMode||!this.allowTextWrap)){var t=0;if(-1!==e.indexOf("%")&&(e=parseInt(e,10)/100*this.element.clientHeight),e>this.getNoncontentHeight()+this.getRowHeight()){t=(e-this.getNoncontentHeight())/this.getRowHeight()}if(t>0)return Math.floor(t)}return 0},o.prototype.getNoncontentHeight=function(){var e=0;if(t.isNullOrUndefined(this.getHeaderContent().clientHeight)||(e+=this.getHeaderContent().clientHeight),this.toolbar&&!t.isNullOrUndefined(this.element.querySelector(".e-toolbar").clientHeight)&&(e+=this.element.querySelector(".e-toolbar").clientHeight),this.allowPaging&&!t.isNullOrUndefined(this.element.querySelector(".e-gridpager").clientHeight)&&(e+=this.element.querySelector(".e-gridpager").clientHeight),this.showColumnChooser&&!t.isNullOrUndefined(this.element.querySelector(".e-columnheader").clientHeight)&&(e+=this.element.querySelector(".e-columnheader").clientHeight),this.allowGrouping&&this.groupSettings.showDropArea&&!t.isNullOrUndefined(this.element.querySelector(".e-groupdroparea").clientHeight)&&(e+=this.element.querySelector(".e-groupdroparea").clientHeight),this.aggregates.length>0&&!t.isNullOrUndefined(this.element.querySelector(".e-summaryrow").clientHeight))for(var r=0;r<this.element.getElementsByClassName("e-summaryrow").length;r++)e+=this.element.getElementsByClassName("e-summaryrow")[parseInt(r.toString(),10)].clientHeight;return e},o.prototype.getSummaryValues=function(e,t){return r.DataUtil.aggregates[e.type.toLowerCase()](t,e.field)},o.prototype.serverExcelExport=function(e){this.isExcel=!0,this.exportGrid(e)},o.prototype.serverPdfExport=function(e){this.isExcel=!1,this.exportGrid(e)},o.prototype.serverCsvExport=function(e){this.isExcel=!0,this.exportGrid(e)},o.prototype.exportGrid=function(e){var t=this.getDataModule().generateQuery(!0),i=(new r.UrlAdaptor).processQuery(new r.DataManager({url:""}),t),n=JSON.parse(i.data),o=JSON.parse(this.addOnPersist(["allowGrouping","allowPaging","pageSettings","sortSettings","allowPdfExport","allowExcelExport","aggregates","filterSettings","groupSettings","columns","locale","searchSettings"])),s=["field","headerText","type","format","visible","foreignKeyValue","foreignKeyField","template","index","width","textAlign","headerTextAlign","columns"];o.filterSettings.columns=n.where,o.searchSettings.fields=n.search&&n.search[0].fields||[],o.sortSettings.columns=n.sorted,o.columns=this.setHeaderText(o.columns,s);var a=this.createElement("form",{id:"ExportForm",styles:"display:none;"}),l=this.createElement("input",{id:"gridInput",attrs:{name:"gridModel"}});l.value=JSON.stringify(o),a.method="POST",a.action=e,a.appendChild(l),document.body.appendChild(a),a.submit(),a.remove()},o.prototype.setHeaderText=function(e,r){for(var i=0;i<e.length;i++){var n=this.getColumnByUid(e[parseInt(i.toString(),10)].uid);e[parseInt(i.toString(),10)].headerText=n.headerText,t.isNullOrUndefined(n.template)||(e[parseInt(i.toString(),10)].template="true"),e[parseInt(i.toString(),10)].format&&(e[parseInt(i.toString(),10)].format=Qe(this.getFormat(e[parseInt(i.toString(),10)].format),e[parseInt(i.toString(),10)].type,this.isExcel,this.currencyCode)),e[parseInt(i.toString(),10)].columns&&this.setHeaderText(e[parseInt(i.toString(),10)].columns,r);for(var o=Object.keys(e[parseInt(i.toString(),10)]),s=0;s<o.length;s++)r.indexOf(o[parseInt(s.toString(),10)])<0&&delete e[parseInt(i.toString(),10)][o[parseInt(s.toString(),10)]]}return e},o.prototype.getFormat=function(e){return"object"==typeof e?t.isNullOrUndefined(e.format)?e.skeleton:e.format:e},o.prototype.isCollapseStateEnabled=function(){return!1===this.isExpanded},o.prototype.updateRowValue=function(e,t){var r={requestType:"save",data:t};this.showSpinner(),this.notify(vr,r),this.refresh()},o.prototype.setForeignKeyData=function(){this.dataBind();var e=this.getDataModule().getForeignKeyDataState();e.isPending?(this.getDataModule().setForeignKeyDataState({}),e.resolver()):(this.getDataModule().setForeignKeyDataState({isDataChanged:!1}),(this.contentModule||this.headerModule)&&this.renderModule.render())},o.prototype.resetFilterDlgPosition=function(e){var t=this.getColumnHeaderByField(e);if(t){var r=t.querySelector(".e-filtermenudiv"),i=this.element.querySelector(".e-filter-popup");if(r&&i){var n=this.element.getBoundingClientRect(),o=r.getBoundingClientRect();i&&(i.offsetWidth+o.right>n.right?i.style.left=(o.right-i.offsetWidth-n.left).toString()+"px":i.style.left=(o.right-n.left).toString()+"px")}}},o.prototype.renderTemplates=function(e){if(this.parentDetails&&this.parentDetails.parentInstObj&&this.parentDetails.parentInstObj.isReact&&this.portals)this.parentDetails.parentInstObj.portals=this.parentDetails.parentInstObj.portals.concat(this.portals),this.parentDetails.parentInstObj.renderTemplates(e),this.portals=void 0;else{this.notify("reactTemplateRender",this.portals),this.renderReactTemplates(e)}},o.prototype.batchUpdate=function(e){this.processRowChanges(e)},o.prototype.batchAsyncUpdate=function(e){this.processBulkRowChanges(e)},o.prototype.processBulkRowChanges=function(e){var t=this;if(this.dataToBeUpdated)for(var r=["addedRecords","changedRecords","deletedRecords"],i=this.getPrimaryKeyFieldNames()[0],n=0;n<r.length;n++)e[r[parseInt(n.toString(),10)]]&&Ae(this,e,r[parseInt(n.toString(),10)],i);else this.dataToBeUpdated=Object.assign({addedRecords:[],changedRecords:[],deletedRecords:[]},e),setTimeout(function(){t.processRowChanges(t.dataToBeUpdated),t.dataToBeUpdated=null},this.asyncTimeOut)},o.prototype.processRowChanges=function(e){var t=this,r=this.getPrimaryKeyFieldNames()[0];e=Object.assign({addedRecords:[],changedRecords:[],deletedRecords:[]},e);var i=this.getDataModule().saveChanges(e,r,{},this.getDataModule().generateQuery().requiresCount());this.getDataModule().isRemote()?i.then(function(){t.setNewData()}):this.setNewData()},o.prototype.setNewData=function(){var e=this,t=JSON.parse(JSON.stringify(this.getCurrentViewRecords()));this.getDataModule().getData({},this.getDataModule().generateQuery().requiresCount()).then(function(r){e.bulkRefresh(r.result,t,r.count)})},o.prototype.deleteRowElement=function(e){var r=this.getRowElementByUID(e.uid),i=parseInt(r.getAttribute(si),10);if(t.remove(r),this.getFrozenColumns()){var n=this.getMovableRows()[parseInt(i.toString(),10)];t.remove(n)}},o.prototype.bulkRefresh=function(e,t,r){for(var i,n=this,o=this.getRowsObject(),s=this.getPrimaryKeyFieldNames()[0],a=this,l=0;l<o.length;l++)!function(t){e.filter(function(e){return e[""+s]===o[parseInt(t.toString(),10)].data[""+s]}).length||(a.deleteRowElement(o[parseInt(t.toString(),10)]),o.splice(t,1),t--),i=t}(l),l=i;for(var h=this,l=0;l<e.length;l++)!function(r){var i;t.filter(function(t){t[""+s]===e[parseInt(r.toString(),10)][""+s]&&(t!==e[parseInt(r.toString(),10)]&&n.setRowData(e[parseInt(r.toString(),10)][""+s],e[parseInt(r.toString(),10)]),i=!0)}),i||h.renderRowElement(e[parseInt(r.toString(),10)],r)}(l);this.currentViewData=e;var p=[].slice.call(this.getContentTable().getElementsByClassName(Zr));ke(this,this.getRowsObject(),p),Le(this),this.allowPaging&&this.notify($t,{module:"pager",properties:{totalRecordsCount:r}})},o.prototype.renderRowElement=function(e,t){var r,i=new fi(this.serviceLocator,null,this),n=new mi(this).generateRows([e]),o=i.render(n[0],this.getColumns());this.addRowObject(n[0],t);var s=this.getContentTable().querySelector(li);if(s.querySelector(".e-emptyrow")){var a=s.querySelector(".e-emptyrow");if(a.parentNode.removeChild(a),this.getFrozenColumns()){var l=this.getContent().querySelector("."+Wr).querySelector(li);l.firstElementChild.parentNode.removeChild(l.firstElementChild)}}this.getFrozenColumns()&&(r=ce(o,this.getFrozenColumns(),this),(this.frozenRows&&t<this.frozenRows?this.getHeaderContent().querySelector("."+Kr).querySelector(li):this.getContent().querySelector("."+Wr).querySelector(li)).appendChild(r),"auto"===this.height&&this.notify("frozenHeight",{})),s=this.frozenRows&&t<this.frozenRows?this.getHeaderContent().querySelector(li):this.getContent().querySelector(li),(s=this.getContent().querySelector(li)).appendChild(o)},o.prototype.addRowObject=function(e,t){var r=this.getFrozenColumns();if(r){var i=this.getMovableRowsObject(),n=e.clone();n.cells=n.cells.slice(r),e.cells=e.cells.slice(0,r),i.splice(t,1,n)}this.getRowsObject().splice(t,1,e)},o.prototype.updateVisibleExpandCollapseRows=function(){for(var e=this.getRowsObject(),t=0,r=e.length;t<r;t++)(e[parseInt(t.toString(),10)].isDataRow||e[parseInt(t.toString(),10)].isAggregateRow)&&"none"===this.getRowElementByUID(e[parseInt(t.toString(),10)].uid).style.display?e[parseInt(t.toString(),10)].visible=!1:e[parseInt(t.toString(),10)].visible=!0},o.prototype.sanitize=function(e){return this.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(e):e},o.prototype.getHeight=function(e){return e=Number.isInteger(e)||-1===e.indexOf("%")?Number.isInteger(e)||"auto"===this.height?this.height:parseInt(e,10):parseInt(e,10)/100*this.element.clientHeight},o.prototype.getFrozenRightContent=function(){return this.getContent().querySelector(".e-frozen-right-content")},o.prototype.getFrozenRightHeader=function(){return this.getHeaderContent().querySelector(".e-frozen-right-header")},o.prototype.getMovableHeaderTbody=function(){return this.getMovableVirtualHeader().querySelector(li)},o.prototype.getMovableContentTbody=function(){return this.getMovableVirtualContent().querySelector(li)},o.prototype.getFrozenHeaderTbody=function(){return this.getFrozenVirtualHeader().querySelector(li)},o.prototype.getFrozenLeftContentTbody=function(){return this.getFrozenVirtualContent().querySelector(li)},o.prototype.getFrozenRightHeaderTbody=function(){return this.getFrozenRightHeader().querySelector(li)},o.prototype.getFrozenRightContentTbody=function(){var e;return this.getFrozenRightContent()&&(e=this.getFrozenRightContent().querySelector(li)),e},o.prototype.showResponsiveCustomFilter=function(e){this.filterModule&&this.filterModule.showCustomFilter(e||"Vertical"===this.rowRenderingMode)},o.prototype.showResponsiveCustomSort=function(e){this.sortModule&&this.sortModule.showCustomSort(e||"Vertical"===this.rowRenderingMode)},o.prototype.showAdaptiveFilterDialog=function(){this.enableAdaptiveUI&&this.showResponsiveCustomFilter(!0)},o.prototype.showAdaptiveSortDialog=function(){this.enableAdaptiveUI&&this.showResponsiveCustomSort(!0)},o.prototype.getCurrentVisibleColumns=function(e){for(var t=[],r=0,i=e?this.getColumns():this.columnModel;r<i.length;r++){var n=i[r];n.visible&&t.push(n)}return t},o.prototype.enableInfiniteAggrgate=function(){this.enableInfiniteScrolling&&this.groupSettings.columns.length&&!this.groupSettings.disablePageWiseAggregates&&!this.groupSettings.enableLazyLoading&&this.setProperties({groupSettings:{disablePageWiseAggregates:!0}},!0)};var s;return zn([t.Property([])],o.prototype,"currentViewData",void 0),zn([t.Property()],o.prototype,"parentDetails",void 0),zn([t.Property()],o.prototype,"showHider",void 0),zn([t.Property([])],o.prototype,"columns",void 0),zn([t.Property(!0)],o.prototype,"enableAltRow",void 0),zn([t.Property(!0)],o.prototype,"enableHover",void 0),zn([t.Property(!1)],o.prototype,"enableAutoFill",void 0),zn([t.Property(!0)],o.prototype,"allowKeyboard",void 0),zn([t.Property(!1)],o.prototype,"enableStickyHeader",void 0),zn([t.Property(!1)],o.prototype,"enableHtmlSanitizer",void 0),zn([t.Property(!1)],o.prototype,"allowTextWrap",void 0),zn([t.Complex({},Nn)],o.prototype,"textWrapSettings",void 0),zn([t.Complex({},qn)],o.prototype,"resizeSettings",void 0),zn([t.Property(!1)],o.prototype,"allowPaging",void 0),zn([t.Complex({},gn)],o.prototype,"pageSettings",void 0),zn([t.Complex({},jn)],o.prototype,"loadingIndicator",void 0),zn([t.Property(!0)],o.prototype,"enableVirtualMaskRow",void 0),zn([t.Property(!1)],o.prototype,"enableVirtualization",void 0),zn([t.Property(!1)],o.prototype,"enableColumnVirtualization",void 0),zn([t.Property(!1)],o.prototype,"enableInfiniteScrolling",void 0),zn([t.Complex({},Pn)],o.prototype,"searchSettings",void 0),zn([t.Property(!1)],o.prototype,"allowSorting",void 0),zn([t.Property("Ellipsis")],o.prototype,"clipMode",void 0),zn([t.Property(!0)],o.prototype,"allowMultiSorting",void 0),zn([t.Property(!1)],o.prototype,"allowExcelExport",void 0),zn([t.Property(!1)],o.prototype,"allowPdfExport",void 0),zn([t.Complex({},Dn)],o.prototype,"sortSettings",void 0),zn([t.Complex({},kn)],o.prototype,"infiniteScrollSettings",void 0),zn([t.Property(!0)],o.prototype,"allowSelection",void 0),zn([t.Property(-1)],o.prototype,"selectedRowIndex",void 0),zn([t.Complex({},Ln)],o.prototype,"selectionSettings",void 0),zn([t.Property(!1)],o.prototype,"allowFiltering",void 0),zn([t.Property("Horizontal")],o.prototype,"rowRenderingMode",void 0),zn([t.Property(!1)],o.prototype,"enableAdaptiveUI",void 0),zn([t.Property(!1)],o.prototype,"allowReordering",void 0),zn([t.Property(!1)],o.prototype,"allowResizing",void 0),zn([t.Property(!1)],o.prototype,"allowRowDragAndDrop",void 0),zn([t.Complex({},Bn)],o.prototype,"rowDropSettings",void 0),zn([t.Complex({},An)],o.prototype,"filterSettings",void 0),zn([t.Property(!1)],o.prototype,"allowGrouping",void 0),zn([t.Property(!1)],o.prototype,"enableImmutableMode",void 0),zn([t.Property(!1)],o.prototype,"showColumnMenu",void 0),zn([t.Property(!1)],o.prototype,"autoFit",void 0),zn([t.Complex({},Hn)],o.prototype,"groupSettings",void 0),zn([t.Complex({},Un)],o.prototype,"editSettings",void 0),zn([t.Collection([],Fn)],o.prototype,"aggregates",void 0),zn([t.Property(!1)],o.prototype,"showColumnChooser",void 0),zn([t.Complex({},yn)],o.prototype,"columnChooserSettings",void 0),zn([t.Property(!1)],o.prototype,"enableHeaderFocus",void 0),zn([t.Property("auto")],o.prototype,"height",void 0),zn([t.Property("auto")],o.prototype,"width",void 0),zn([t.Property("Default")],o.prototype,"gridLines",void 0),zn([t.Property()],o.prototype,"rowTemplate",void 0),zn([t.Property()],o.prototype,"detailTemplate",void 0),zn([t.Property()],o.prototype,"childGrid",void 0),zn([t.Property()],o.prototype,"queryString",void 0),zn([t.Property("AllPages")],o.prototype,"printMode",void 0),zn([t.Property("Expanded")],o.prototype,"hierarchyPrintMode",void 0),zn([t.Property([])],o.prototype,"dataSource",void 0),zn([t.Property(null)],o.prototype,"rowHeight",void 0),zn([t.Property()],o.prototype,"query",void 0),zn([t.Property("USD")],o.prototype,"currencyCode",void 0),zn([t.Property()],o.prototype,"toolbar",void 0),zn([t.Property()],o.prototype,"contextMenuItems",void 0),zn([t.Property()],o.prototype,"columnMenuItems",void 0),zn([t.Property()],o.prototype,"toolbarTemplate",void 0),zn([t.Property()],o.prototype,"pagerTemplate",void 0),zn([t.Property(0)],o.prototype,"frozenRows",void 0),zn([t.Property(0)],o.prototype,"frozenColumns",void 0),zn([t.Property("")],o.prototype,"cssClass",void 0),zn([t.Property("All")],o.prototype,"columnQueryMode",void 0),zn([t.Property({})],o.prototype,"currentAction",void 0),zn([t.Property("22.1.37")],o.prototype,"ej2StatePersistenceVersion",void 0),zn([t.Event()],o.prototype,"created",void 0),zn([t.Event()],o.prototype,"destroyed",void 0),zn([t.Event()],o.prototype,"load",void 0),zn([t.Event()],o.prototype,"rowDataBound",void 0),zn([t.Event()],o.prototype,"queryCellInfo",void 0),zn([t.Event()],o.prototype,"headerCellInfo",void 0),zn([t.Event()],o.prototype,"actionBegin",void 0),zn([t.Event()],o.prototype,"actionComplete",void 0),zn([t.Event()],o.prototype,"actionFailure",void 0),zn([t.Event()],o.prototype,"dataBound",void 0),zn([t.Event()],o.prototype,"recordDoubleClick",void 0),zn([t.Event()],o.prototype,"recordClick",void 0),zn([t.Event()],o.prototype,"rowSelecting",void 0),zn([t.Event()],o.prototype,"rowSelected",void 0),zn([t.Event()],o.prototype,"rowDeselecting",void 0),zn([t.Event()],o.prototype,"rowDeselected",void 0),zn([t.Event()],o.prototype,"cellSelecting",void 0),zn([t.Event()],o.prototype,"cellSelected",void 0),zn([t.Event()],o.prototype,"cellDeselecting",void 0),zn([t.Event()],o.prototype,"cellDeselected",void 0),zn([t.Event()],o.prototype,"columnSelecting",void 0),zn([t.Event()],o.prototype,"columnSelected",void 0),zn([t.Event()],o.prototype,"columnDeselecting",void 0),zn([t.Event()],o.prototype,"columnDeselected",void 0),zn([t.Event()],o.prototype,"columnDragStart",void 0),zn([t.Event()],o.prototype,"columnDrag",void 0),zn([t.Event()],o.prototype,"columnDrop",void 0),zn([t.Event()],o.prototype,"printComplete",void 0),zn([t.Event()],o.prototype,"beforePrint",void 0),zn([t.Event()],o.prototype,"pdfQueryCellInfo",void 0),zn([t.Event()],o.prototype,"pdfHeaderQueryCellInfo",void 0),zn([t.Event()],o.prototype,"pdfAggregateQueryCellInfo",void 0),zn([t.Event()],o.prototype,"excelAggregateQueryCellInfo",void 0),zn([t.Event()],o.prototype,"exportDetailDataBound",void 0),zn([t.Event()],o.prototype,"excelQueryCellInfo",void 0),zn([t.Event()],o.prototype,"excelHeaderQueryCellInfo",void 0),zn([t.Event()],o.prototype,"beforeExcelExport",void 0),zn([t.Event()],o.prototype,"excelExportComplete",void 0),zn([t.Event()],o.prototype,"beforePdfExport",void 0),zn([t.Event()],o.prototype,"pdfExportComplete",void 0),zn([t.Event()],o.prototype,"rowDragStartHelper",void 0),zn([t.Event()],o.prototype,"detailDataBound",void 0),zn([t.Event()],o.prototype,"rowDragStart",void 0),zn([t.Event()],o.prototype,"rowDrag",void 0),zn([t.Event()],o.prototype,"rowDrop",void 0),zn([t.Event()],o.prototype,"toolbarClick",void 0),zn([t.Event()],o.prototype,"beforeOpenColumnChooser",void 0),zn([t.Event()],o.prototype,"beforeOpenAdaptiveDialog",void 0),zn([t.Event()],o.prototype,"batchAdd",void 0),zn([t.Event()],o.prototype,"batchDelete",void 0),zn([t.Event()],o.prototype,"batchCancel",void 0),zn([t.Event()],o.prototype,"beforeBatchAdd",void 0),zn([t.Event()],o.prototype,"beforeBatchDelete",void 0),zn([t.Event()],o.prototype,"beforeBatchSave",void 0),zn([t.Event()],o.prototype,"beginEdit",void 0),zn([t.Event()],o.prototype,"commandClick",void 0),zn([t.Event()],o.prototype,"cellEdit",void 0),zn([t.Event()],o.prototype,"cellSave",void 0),zn([t.Event()],o.prototype,"cellSaved",void 0),zn([t.Event()],o.prototype,"resizeStart",void 0),zn([t.Event()],o.prototype,"resizing",void 0),zn([t.Event()],o.prototype,"resizeStop",void 0),zn([t.Event()],o.prototype,"keyPressed",void 0),zn([t.Event()],o.prototype,"beforeDataBound",void 0),zn([t.Event()],o.prototype,"contextMenuOpen",void 0),zn([t.Event()],o.prototype,"contextMenuClick",void 0),zn([t.Event()],o.prototype,"columnMenuOpen",void 0),zn([t.Event()],o.prototype,"columnMenuClick",void 0),zn([t.Event()],o.prototype,"checkBoxChange",void 0),zn([t.Event()],o.prototype,"beforeCopy",void 0),zn([t.Event()],o.prototype,"beforePaste",void 0),zn([t.Event()],o.prototype,"beforeAutoFill",void 0),zn([t.Event()],o.prototype,"columnDataStateChange",void 0),zn([t.Event()],o.prototype,"dataStateChange",void 0),zn([t.Event()],o.prototype,"dataSourceChanged",void 0),zn([t.Event()],o.prototype,"exportGroupCaption",void 0),zn([t.Event()],o.prototype,"lazyLoadGroupExpand",void 0),zn([t.Event()],o.prototype,"lazyLoadGroupCollapse",void 0),o=s=zn([t.NotifyPropertyChanges],o)}(t.Component),Gn=function(){function e(e,t){this.isAsyncPrint=!1,this.defered=new r.Deferred,this.parent=e,this.parent.isDestroyed||(this.parent.on(Yt,this.isContentReady(),this),this.actionBeginFunction=this.actionBegin.bind(this),this.parent.addEventListener(Bt,this.actionBeginFunction),this.parent.on(Zt,this.onEmpty.bind(this)),this.parent.on(Rr,this.hierarchyPrint,this),this.scrollModule=t)}return e.prototype.isContentReady=function(){var e=this;return!this.isPrintGrid()||"None"!==this.parent.hierarchyPrintMode&&this.parent.childGrid?function(){e.defered.promise.then(function(){e.contentReady()}),e.isPrintGrid()&&e.hierarchyPrint()}:this.contentReady},e.prototype.hierarchyPrint=function(){this.removeColGroup(this.parent);var e=window.printGridObj;e&&!e.element.querySelector("[aria-busy=true")&&e.printModule.defered.resolve()},e.prototype.print=function(){this.renderPrintGrid()},e.prototype.onEmpty=function(){this.isPrintGrid()&&this.contentReady()},e.prototype.actionBegin=function(){this.isPrintGrid()&&(this.isAsyncPrint=!0)},e.prototype.renderPrintGrid=function(){var e=this.parent,r=t.createElement("div",{id:this.parent.element.id+"_print",className:e.element.className+" e-print-grid"});r.classList.remove("e-gridhover"),document.body.appendChild(r);for(var i=new Vn(ye(e,e.hierarchyPrintMode)),n=0;n<i.columns.length;n++)i.columns[parseInt(n.toString(),10)]=t.extend({},i.columns[parseInt(n.toString(),10)]),e.isFrozenGrid()&&!e.getFrozenColumns()&&(i.columns[parseInt(n.toString(),10)].freeze=void 0);this.parent.isAngular&&(i.viewContainerRef=this.parent.viewContainerRef),i.load=function(){},i.query=e.getQuery().clone(),window.printGridObj=i,i.isPrinting=!0;var o=i.getInjectedModules(),s=e.getInjectedModules();o&&o.length===s.length||i.setInjectedModules(s),e.notify("printGrid-Init",{element:r,printgrid:i}),this.parent.log("exporting_begin",this.getModuleName()),i.registeredTemplate=this.parent.registeredTemplate,i.isVue=this.parent.isVue,i.appendTo(r),e.isVue3||(i.trigger=e.trigger)},e.prototype.contentReady=function(){if(this.isPrintGrid()){var e=this.parent;if(this.isAsyncPrint)return void this.printGrid();var r={requestType:"print",element:e.element,selectedRows:e.getContentTable().querySelectorAll('tr[aria-selected="true"]'),cancel:!1,hierarchyPrintMode:e.hierarchyPrintMode};if(this.isAsyncPrint||e.trigger("beforePrint",r),r.cancel)return void t.detach(e.element);this.isAsyncPrint||this.printGrid()}},e.prototype.printGrid=function(){var e=this.parent;if("auto"!==e.height){var r=this.scrollModule.getCssProperties(),i=e.element.querySelector("."+Yr),n=e.element.querySelector("."+jr);i.style.height="auto",i.style.overflowY="auto",n.style[r.padding]="",n.firstElementChild.style[r.border]=""}e.allowGrouping&&(e.groupSettings.columns.length?this.removeColGroup(e):e.element.querySelector(".e-groupdroparea").style.display="none");for(var o=0,s=[].slice.call(e.element.getElementsByClassName(Yr));o<s.length;o++)(p=s[o]).style.overflowX="hidden";for(var a=[].slice.call(e.element.getElementsByClassName("e-spin-show")),l=0,h=[].slice.call(a);l<h.length;l++){var p=h[l];t.classList(p,["e-spin-hide"],["e-spin-show"])}this.printGridElement(e),e.isPrinting=!1,delete window.printGridObj;var d={element:e.element};e.trigger("printComplete",d),e.destroy(),this.parent.log("exporting_complete",this.getModuleName())},e.prototype.printGridElement=function(e){t.classList(e.element,["e-print-grid-layout"],["e-print-grid"]),e.isPrinting&&t.detach(e.element),this.printWind=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWind.moveTo(0,0),this.printWind.resizeTo(screen.availWidth,screen.availHeight),this.printWind=t.print(e.element,this.printWind)},e.prototype.removeColGroup=function(e){var r=e.groupSettings.columns.length,i=e.element,n="#"+e.element.id;if(r){for(var o=t.selectAll(".e-groupcaption",i),s=o[r-1].getAttribute("colspan"),a=0;a<o.length;a++)o[parseInt(a.toString(),10)].setAttribute("colspan",s);var l=t.selectAll("colgroup"+n+"colgroup",i),h=t.selectAll(".e-content colgroup",i);this.hideColGroup(l,r),this.hideColGroup(h,r)}},e.prototype.hideColGroup=function(e,t){for(var r=0;r<e.length;r++)for(var i=0;i<t;i++)e[parseInt(r.toString(),10)].children[parseInt(i.toString(),10)].style.display="none"},e.prototype.isPrintGrid=function(){return this.parent.element.id.indexOf("_print")>0&&this.parent.isPrinting},e.prototype.destroy=function(){this.parent.isDestroyed||(this.parent.off(Yt,this.contentReady.bind(this)),this.parent.removeEventListener(Bt,this.actionBeginFunction),this.parent.off(Zt,this.onEmpty.bind(this)),this.parent.off(Rr,this.hierarchyPrint))},e.prototype.getModuleName=function(){return"print"},e.printGridProp=["aggregates","allowGrouping","allowFiltering","allowMultiSorting","allowReordering","allowSorting","allowTextWrap","childGrid","columns","currentViewData","dataSource","detailTemplate","enableAltRow","enableColumnVirtualization","filterSettings","gridLines","groupSettings","height","locale","pageSettings","printMode","query","queryString","enableRtl","rowHeight","rowTemplate","sortSettings","textWrapSettings","allowPaging","hierarchyPrintMode","searchSettings","queryCellInfo","beforeDataBound"].concat(["beforePrint","printComplete","load"]),e}(),_n=0,Wn=0,Kn=null;!function(e){e.timer=null}(e.Global||(e.Global={}));var Qn=function(){function e(e){this.isExecuteLocal=!1,this.existingPredicate={},this.foreignKeyQuery=new r.Query,this.filterState=!0,this.values={},this.renderEmpty=!1,this.isCheckboxFilterTemplate=!1,this.parent=e,this.id=this.parent.element.id,this.valueFormatter=new Mt(this.parent.locale),this.cBoxTrue=n.createCheckBox(this.parent.createElement,!1,{checked:!0,label:" "}),this.cBoxFalse=n.createCheckBox(this.parent.createElement,!1,{checked:!1,label:" "}),this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxTrue.firstChild),this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxFalse.firstChild),this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck"),this.parent.enableRtl&&t.addClass([this.cBoxTrue,this.cBoxFalse],["e-rtl"]),this.parent.cssClass&&t.addClass([this.cBoxTrue,this.cBoxFalse],[this.parent.cssClass])}return e.prototype.destroy=function(){this.closeDialog()},e.prototype.wireEvents=function(){t.EventHandler.add(this.dlg,"click",this.clickHandler,this),t.EventHandler.add(this.dlg,"keyup",this.keyupHandler,this),this.searchHandler=t.debounce(this.searchBoxKeyUp,200);var e=this.dialogObj.element.querySelector(".e-searchinput");e&&t.EventHandler.add(e,"keyup",this.searchHandler,this)},e.prototype.unWireEvents=function(){t.EventHandler.remove(this.dlg,"click",this.clickHandler),t.EventHandler.remove(this.dlg,"keyup",this.keyupHandler);var e=this.dialogObj.element.querySelector(".e-searchinput");e&&t.EventHandler.remove(e,"keyup",this.searchHandler)},e.prototype.foreignKeyFilter=function(e,t,r){var i=this,n={},o=[],s=this.foreignKeyQuery.clone();this.options.column.dataSource.executeQuery(s.where(r)).then(function(r){i.options.column.columnData=r.result,i.parent.notify("generateQuery",{predicate:n,column:i.options.column}),e.ejpredicate=n.predicate.predicates;for(var s=n.predicate.predicates,a=0;a<s.length;a++)o.push({field:s[parseInt(a.toString(),10)].field,predicate:"or",matchCase:s[parseInt(a.toString(),10)].ignoreCase,ignoreAccent:s[parseInt(a.toString(),10)].ignoreAccent,operator:s[parseInt(a.toString(),10)].operator,value:s[parseInt(a.toString(),10)].value,type:i.options.type});e.filterCollection=o.length?o:t.filter(function(e){return e.field=i.options.field}),i.options.handler(e)})},e.prototype.foreignFilter=function(e,t){var i=this.options.isRemote?"string"===this.options.column.type?"contains":"equal":this.options.column.type?"contains":"equal",n=new r.Predicate(this.options.column.foreignKeyValue,i,t,!0,this.options.ignoreAccent);this.foreignKeyFilter(e,[e.filterCollection],n)},e.prototype.searchBoxClick=function(e){var t=e.target;t.classList.contains("e-searchclear")&&(this.sInput.value=t.classList.contains("e-chkcancel-icon")?"":this.sInput.value,this.isCheckboxFilterTemplate?this.parent.notify("refreshCheckbox",{event:e}):this.refreshCheckboxes(),this.updateSearchIcon(),this.sInput.focus())},e.prototype.searchBoxKeyUp=function(e){t.isNullOrUndefined(this.parent.loadingIndicator)||"Shimmer"!==this.parent.loadingIndicator.indicatorType||this.parent.showMaskRow(void 0,this.dialogObj.element),this.isCheckboxFilterTemplate?this.parent.notify("refreshCheckbox",{event:e}):this.refreshCheckboxes(),this.updateSearchIcon()},e.prototype.updateSearchIcon=function(){this.sInput.value.length?(t.classList(this.sIcon,["e-chkcancel-icon"],["e-search-icon"]),document.body.querySelector(".e-chkcancel-icon").setAttribute("title",this.localeObj.getConstant("Clear"))):(t.classList(this.sIcon,["e-search-icon"],["e-chkcancel-icon"]),document.body.querySelector(".e-search-icon").setAttribute("title",this.localeObj.getConstant("Search")))},e.prototype.getLocalizedLabel=function(e){return this.localeObj.getConstant(e)},e.prototype.updateDataSource=function(){var e=this.options.dataSource;if(!(e instanceof r.DataManager))for(var t=0;t<e.length;t++)if("object"!=typeof e){var i={};i[this.options.field]=e[parseInt(t.toString(),10)],e[parseInt(t.toString(),10)]=i}},e.prototype.updateModel=function(e){this.options=e,this.existingPredicate=e.actualPredicate||{},this.options.dataSource=e.dataSource,this.options.dataManager=e.dataManager?e.dataManager:e.dataSource,this.updateDataSource(),this.options.type=e.type,this.options.format=e.format||"",this.options.ignoreAccent=e.ignoreAccent||!1,this.options.filteredColumns=e.filteredColumns||this.parent.filterSettings.columns,this.options.query=e.query||new r.Query,this.options.allowCaseSensitive=e.allowCaseSensitive||!1,this.options.uid=e.column.uid,this.options.disableHtmlEncode=e.column.disableHtmlEncode||!1,this.values={},this.localeObj=e.localeObj,this.isFiltered=e.filteredColumns.length},e.prototype.getAndSetChkElem=function(e){if(this.dlg=this.parent.createElement("div",{id:this.id+this.options.type+"_excelDlg",attrs:{uid:this.options.column.uid},className:"e-checkboxfilter e-filter-popup"}),this.sBox=this.parent.createElement("div",{className:"e-searchcontainer"}),!e.hideSearchbox){this.sInput=this.parent.createElement("input",{id:this.id+"_SearchBox",className:"e-searchinput"}),this.sIcon=this.parent.createElement("span",{className:"e-searchclear e-search-icon e-icons e-input-group-icon",attrs:{type:"text",title:this.getLocalizedLabel("Search")}}),this.searchBox=this.parent.createElement("span",{className:"e-searchbox e-fields"}),this.searchBox.appendChild(this.sInput),this.sBox.appendChild(this.searchBox);var t={element:this.sInput,floatLabelType:"Never",properties:{placeholder:this.getLocalizedLabel("Search"),cssClass:this.parent.cssClass}};o.Input.createInput(t,this.parent.createElement),this.searchBox.querySelector(".e-input-group").appendChild(this.sIcon)}return this.spinner=this.parent.createElement("div",{className:"e-spinner"}),this.cBox=this.parent.createElement("div",{id:this.id+this.options.type+"_CheckBoxList",className:"e-checkboxlist e-fields"}),this.spinner.appendChild(this.cBox),this.sBox.appendChild(this.spinner),this.sBox},e.prototype.showDialog=function(e){var r={requestType:"filterbeforeopen",columnName:this.options.field,columnType:this.options.type,cancel:!1};if(r.filterModel=this,this.parent.notify("cbox-filter-begin",r),r.cancel)return void(e.cancel=r.cancel);this.dialogObj=new i.Dialog({visible:!1,content:this.sBox,close:this.closeDialog.bind(this),enableRtl:this.parent.enableRtl,width:!t.isNullOrUndefined(O(e.target,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:255,target:this.parent.element,animationSettings:{effect:"None"},buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton"),cssClass:this.parent.cssClass?"e-primary "+this.parent.cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:this.parent.cssClass?"e-flat "+this.parent.cssClass:"e-flat",content:this.getLocalizedLabel(this.isExcel?"CancelButton":"ClearButton")}}],created:this.dialogCreated.bind(this),open:this.dialogOpen.bind(this),cssClass:this.parent.cssClass?this.parent.cssClass:""});this.dialogObj.isStringTemplate=!0,this.renderResponsiveFilter(e),this.dlg.setAttribute("aria-label",this.getLocalizedLabel("ExcelFilterDialogARIA")),e.isResponsiveFilter?document.querySelector(".e-responsive-dialog > .e-dlg-content > .e-mainfilterdiv").appendChild(this.dlg):this.parent.element.appendChild(this.dlg),this.dialogObj.appendTo(this.dlg),this.dialogObj.element.style.maxHeight=e.isResponsiveFilter?"none":this.options.height+"px",this.dialogObj.show(),this.dialogObj.element.querySelector(".e-dlg-content").appendChild(this.sBox),this.wireEvents(),t.isNullOrUndefined(this.parent.loadingIndicator)||"Shimmer"!==this.parent.loadingIndicator.indicatorType?(i.createSpinner({target:this.spinner,cssClass:this.parent.cssClass?this.parent.cssClass:null},this.parent.createElement),i.showSpinner(this.spinner)):this.parent.showMaskRow(void 0,this.dialogObj.element),this.getAllData()},e.prototype.renderResponsiveFilter=function(e){e.isResponsiveFilter&&(this.dialogObj.buttons=[{}],this.dialogObj.position={X:"",Y:""},this.dialogObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-mainfilterdiv"),this.dialogObj.width="100%")},e.prototype.dialogCreated=function(e){this.options.isResponsiveFilter?this.dialogObj.element.style.left="0px":t.Browser.isDevice?this.dialogObj.position={X:"center",Y:"center"}:te(this.options.target,this.dialogObj),this.options.column.showColumnMenu&&this.parent.notify("filterDialogCreated",e)},e.prototype.openDialog=function(e){this.updateModel(e),this.getAndSetChkElem(e),this.showDialog(e)},e.prototype.closeDialog=function(){if(this.dialogObj&&!this.dialogObj.isDestroyed){this.isBlanks=!1;var e=this.options.columns.filter(function(e){return e.getFilterItemTemplate()}),r=this.parent.registeredTemplate;e.length&&!t.isNullOrUndefined(r)&&r.filterItemTemplate&&this.parent.destroyTemplate(["filterItemTemplate"]),(this.parent.isReact||this.parent.isVue)&&void 0!==this.parent.destroyTemplate&&nt(this.parent,["filterItemTemplate"]),this.parent.notify(Ir,{field:this.options.field}),this.dialogObj.destroy(),this.unWireEvents(),t.remove(this.dlg),this.dlg=null,this.parent.notify("filter-dialog-close",{})}},e.prototype.clearFilter=function(e){var t={instance:this,handler:this.clearFilter,cancel:!1};this.parent.notify(zr,t),t.cancel||this.options.handler({action:"clear-filter",field:e?e.field:this.options.field})},e.prototype.btnClick=function(e){if(this.filterState){if("input"===e.target.tagName.toLowerCase()&&e.target.classList.contains("e-searchinput")||13===e.keyCode)this.isCheckboxFilterTemplate||this.fltrBtnHandler();else{var t=e.target.firstChild.textContent.toLowerCase();this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton").toLowerCase()===t?this.isCheckboxFilterTemplate||this.fltrBtnHandler():this.getLocalizedLabel("ClearButton").toLowerCase()===t&&this.clearFilter()}this.closeDialog()}else"input"!==e.target.tagName.toLowerCase()&&(this.clearFilter(),this.closeDialog());this.options.column.showColumnMenu&&this.parent.notify("after-filter-column-menu-close",{})},e.prototype.fltrBtnHandler=function(){var r=this,i=[].slice.call(this.cBox.querySelectorAll(".e-check:not(.e-selectall):not(.e-add-current)")),n=i,o="equal",s=this.dialogObj.element.querySelector(".e-dropdownlist");s&&(this.options.operator=o=s.ej2_instances[0].value),this.isMenuNotEqual="notequal"===this.options.operator;var a;this.options.hideSearchbox||(a=this.searchBox.querySelector(".e-searchinput"));var l=this.options.allowCaseSensitive,h={field:this.options.field,predicate:this.isMenuNotEqual?"and":"or",uid:this.options.uid,operator:o,type:this.options.type,matchCase:l,ignoreAccent:this.options.ignoreAccent},p=this.itemsCnt!==i.length&&this.itemsCnt-i.length<i.length;p&&a&&""===a.value&&(o=this.isMenuNotEqual?"equal":"notequal",i=[].slice.call(this.cBox.querySelectorAll(".e-uncheck:not(.e-selectall)")),h.predicate=this.isMenuNotEqual?"or":"and",h.operator=o);var d,c,u,g,f=[];if(i.length!==this.itemsCnt||a&&a.value&&""!==a.value){for(var m=0;m<i.length;m++){d=this.values[O(i[parseInt(m.toString(),10)],"e-ftrchk").getAttribute("uid")],g=t.extend({},{value:d},h),d&&!d.toString().length&&(g.operator=p?"notequal":"equal"),""===d||t.isNullOrUndefined(d)?f=f.concat(e.generateNullValuePredicates(h)):f.push(g);var y={instance:this,handler:this.fltrBtnHandler,arg1:g.field,arg2:g.predicate,arg3:g.operator,arg4:g.matchCase,arg5:g.ignoreAccent,arg6:g.value,cancel:!1};if(this.parent.notify(zr,y),y.cancel)return}if("date"!==this.options.type&&"datetime"!==this.options.type||!n.length||(u=n.length-1,c=this.values[O(n[parseInt(u.toString(),10)],"e-ftrchk").getAttribute("uid")],t.isNullOrUndefined(c)&&p&&f.push({field:h.field,matchCase:h.matchCase,operator:"equal",predicate:"and",value:null})),this.cBox.querySelector(".e-add-current")&&this.cBox.querySelector(".e-add-current").classList.contains("e-check")){var v=this.existingPredicate[this.options.field];if(!v)return;for(var C=0;C<v.length;C++)!function(e){f.some(function(t){return t.value===v[parseInt(e.toString(),10)].value})||f.push(v[parseInt(e.toString(),10)])}(C)}this.initiateFilter(f)}else this.options.filteredColumns.some(function(e){return r.options.field===e.field})&&this.clearFilter()},e.generateNullValuePredicates=function(e){var t=[];return"string"===e.type&&t.push({field:e.field,ignoreAccent:e.ignoreAccent,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:""}),t.push({field:e.field,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:null}),t.push({field:e.field,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:void 0}),t},e.prototype.initiateFilter=function(e){var i,n=e[0];if(!t.isNullOrUndefined(n)){i=n.ejpredicate?n.ejpredicate:new r.Predicate(n.field,n.operator,n.value,!n.matchCase,n.ignoreAccent);for(var o=1;o<e.length;o++)i=void 0!==e[parseInt(o.toString(),10)].ejpredicate?i[e[parseInt(o.toString(),10)].predicate](e[parseInt(o.toString(),10)].ejpredicate):i[e[parseInt(o.toString(),10)].predicate](e[parseInt(o.toString(),10)].field,e[parseInt(o.toString(),10)].operator,e[parseInt(o.toString(),10)].value,!e[parseInt(o.toString(),10)].matchCase,e[parseInt(o.toString(),10)].ignoreAccent);var s={action:"filtering",filterCollection:e,field:this.options.field,ejpredicate:r.Predicate.or(i)};this.options.handler(s)}},e.prototype.isForeignColumn=function(e){return!!e.isForeignColumn&&e.isForeignColumn()},e.prototype.refreshCheckboxes=function(){var n=this,o=this.sInput.value,s=this.options.column,a=this.isForeignColumn(s)?this.foreignKeyQuery.clone():this.options.query.clone(),l=this.options.query.clone(),h=a.queries.filter(function(e){return e&&"onWhere"===e.fn})[0];a.queries=[],l.queries=[];var p="string"!==this.options.type&&parseFloat(o)?parseFloat(o):o,d=this.options.isRemote?"string"===this.options.type?"wildcard":"equal":this.options.type?"wildcard":"equal",c=this.options.ignoreAccent,u=this.isForeignColumn(s)?s.foreignKeyValue:s.field;p=""===p||void 0===p?void 0:p;var g,f=[],m={field:u,predicate:"or",uid:this.options.uid,operator:"equal",type:this.options.type,matchCase:!0,ignoreAccent:c},y=this.options.dataManager.adaptor.getModuleName;if("boolean"===this.options.type&&(void 0!==p&&-1!==this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(p.toLowerCase())?p="true":void 0!==p&&-1!==this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(p.toLowerCase())&&(p="false"),void 0!==p&&-1!==this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(p.toLowerCase())&&y?(y(),p=!0):void 0!==p&&-1!==this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(p.toLowerCase())&&y&&(y(),p=!1),d="equal"),("date"===this.options.type||"datetime"===this.options.type||"dateonly"===this.options.type)&&this.options.format){var v=new t.Internationalization,C="string"==typeof this.options.format?this.options.format:this.options.format.format;p=C?v.parseDate(o,{format:C})||new Date(o):new Date(o),"dateonly"===this.options.type&&(p=p.getFullYear()+"-"+pe(p.getMonth()+1)+"-"+pe(p.getDate()))}this.addDistinct(a);var S={requestType:"filtersearchbegin",filterModel:this,columnName:u,column:s,operator:d,matchCase:!0,ignoreAccent:c,filterChoiceCount:null,query:a,value:p};this.parent.trigger(Bt,S,function(y){if(y.operator=y.operator,g=new r.Predicate(u,y.operator,S.value,y.matchCase,y.ignoreAccent),"date"===n.options.type||"datetime"===n.options.type||"dateonly"===n.options.type){var v={field:u,operator:d="equal",value:p,matchCase:!0,ignoreAccent:c};t.isNullOrUndefined(p)||(g=de(v,n.options.type))}if(o&&"string"==typeof o&&n.isBlanks&&n.getLocalizedLabel("Blanks").toLowerCase().indexOf(o.toLowerCase())>=0){f=f.concat(e.generateNullValuePredicates(m));var C=e.generatePredicate(f);C.predicates.push(g),a.where(C)}else o.length?(g=t.isNullOrUndefined(h)?g:g.and(h.e),a.where(g)):t.isNullOrUndefined(h)||a.where(h.e);y.filterChoiceCount=t.isNullOrUndefined(y.filterChoiceCount)?1e3:y.filterChoiceCount;var b={};i.showSpinner(n.spinner),n.renderEmpty=!1,n.isForeignColumn(s)&&o.length?("result"in s.dataSource?new r.DataManager(s.dataSource.result):s.dataSource).executeQuery(a).then(function(e){var t=n.options.column.columnData;n.options.column.columnData=e.result,n.parent.notify("generateQuery",{predicate:b,column:s}),b.predicate.predicates.length?l.where(b.predicate):n.renderEmpty=!0,n.options.column.columnData=t,l.take(y.filterChoiceCount),n.search(y,l)}):(a.take(y.filterChoiceCount),n.search(y,a))})},e.prototype.search=function(e,t){this.parent.dataSource&&"result"in this.parent.dataSource?this.filterEvent(e,t):this.processSearch(t)},e.prototype.getPredicateFromCols=function(t,i){for(var n=e.getPredicate(t,i),o=[],s={},a=void 0!==this.parent.getForeignKeyColumns,l=a?this.parent.getForeignKeyColumns():[],h=0,p=Object.keys(n);h<p.length;h++){var d=p[h],c=void 0;a&&!this.parent.getColumnByField(d)&&(c=he(d,l)),c?(this.parent.notify("generateQuery",{predicate:s,column:c}),s.predicate.predicates.length&&o.push(r.Predicate.or(s.predicate.predicates))):o.push(n[""+d])}return o.length&&r.Predicate.and(o)},e.prototype.getQuery=function(){return this.parent.getQuery?this.parent.getQuery().clone():new r.Query},e.prototype.getAllData=function(){var e=this;this.customQuery=!1;var r=this.getQuery();r.requiresCount(),this.addDistinct(r);var i={requestType:"filterchoicerequest",query:r,filterChoiceCount:null};i.filterModel=this,this.parent.trigger(Bt,i,function(i){i.filterChoiceCount=t.isNullOrUndefined(i.filterChoiceCount)?1e3:i.filterChoiceCount,r.take(i.filterChoiceCount),i.query.distincts.length||(e.customQuery=!0,e.queryGenerate(r)),e.parent.dataSource&&"result"in e.parent.dataSource?e.filterEvent(i,r):e.processDataOperation(r,!0)})},e.prototype.addDistinct=function(e){var t=r.DataUtil.distinct(this.options.filteredColumns,"field");return t.indexOf(this.options.column.field)<=-1&&(t=t.concat(this.options.column.field)),e.distinct(t),e},e.prototype.filterEvent=function(e,t){var r=this,i=Me(e,t);this.parent.trigger("dataStateChange",i.state),i.deffered.promise.then(function(e){r.dataSuccess(e)})},e.prototype.processDataOperation=function(e,t){var i=this;this.options.dataSource=this.options.dataSource instanceof r.DataManager?this.options.dataSource:new r.DataManager(this.options.dataSource);var n=[],o=[];if(this.isForeignColumn(this.options.column)&&t){var s="result"in this.options.column.dataSource?new r.DataManager(this.options.column.dataSource.result):this.options.column.dataSource;this.foreignKeyQuery.params=e.params,n.push(s.executeQuery(this.foreignKeyQuery)),o.push(function(e){return i.foreignKeyData=e})}n.push(this.options.dataSource.executeQuery(e)),o.push(this.dataSuccess.bind(this));var a=0;Promise.all(n).then(function(e){for(var t=0;t<e.length;t++)o[a++](e[parseInt(t.toString(),10)].result)})},e.prototype.dataSuccess=function(t){this.fullData=t;var n={dataSource:this.fullData,executeQuery:!0,field:this.options.field};if(this.parent.notify("beforeCheckboxRenderer",n),n.executeQuery){var o=new r.Query;this.customQuery||(this.isExecuteLocal=!0,this.queryGenerate(o),this.isExecuteLocal=!1);var s=new r.DataManager(n.dataSource).executeLocal(o),a=this.options.column;this.filteredData=e.getDistinct(s,this.options.field,a,this.foreignKeyData).records||[]}var l=n.executeQuery?this.filteredData:n.dataSource;this.processDataSource(null,!0,l,n),this.sInput&&this.sInput.focus();var h={requestType:"filterafteropen",columnName:this.options.field,columnType:this.options.type};h.filterModel=this,this.parent.notify(Er,h),this.isCheckboxFilterTemplate&&i.hideSpinner(this.spinner)},e.prototype.queryGenerate=function(e){if(this.parent.searchSettings&&this.parent.searchSettings.key.length){var t=this.parent.searchSettings,r=t.fields.length?t.fields:this.options.columns.map(function(e){return e.field});e.search(t.key,r,t.operator,t.ignoreCase,t.ignoreAccent)}if(this.options.filteredColumns.length){for(var i=[],n=0;n<this.options.filteredColumns.length;n++){var o=this.options.filteredColumns[parseInt(n.toString(),10)];this.options.uid?(o.uid=o.uid||this.parent.getColumnByField(o.field).uid,o.uid!==this.options.uid&&i.push(this.options.filteredColumns[parseInt(n.toString(),10)])):o.field!==this.options.field&&i.push(this.options.filteredColumns[parseInt(n.toString(),10)])}var s=this.getPredicateFromCols(i,this.isExecuteLocal);s&&e.where(s)}},e.prototype.processDataSource=function(e,t,r,n){i.showSpinner(this.spinner),this.isExecuteLocal=!0,this.updateResult(),this.isExecuteLocal=!1;var o={dataSource:this.fullData,isCheckboxFilterTemplate:!1,column:this.options.column,element:this.cBox,type:this.options.type,format:this.options.type,btnObj:this.options.isResponsiveFilter?null:this.dialogObj.btnObj[0],searchBox:this.searchBox};this.parent.notify("beforeCheckboxfilterRenderer",o),this.isCheckboxFilterTemplate=o.isCheckboxFilterTemplate,this.isCheckboxFilterTemplate||this.createFilterItems(r,t,n)},e.prototype.processSearch=function(e){this.processDataOperation(e)},e.prototype.updateResult=function(){this.result={};var e=this.getPredicateFromCols(this.options.filteredColumns,this.isExecuteLocal),t=new r.Query;e&&t.where(e),this.parent.notify("before-checkbox-renderer-query",{query:t});for(var i=0,n=new r.DataManager(this.fullData).executeLocal(t);i<n.length;i++){var o=n[i];this.result[ge(this.options.field,o)]=!0}},e.prototype.clickHandler=function(e){var r=e.target;if(t.isNullOrUndefined(this.parent.loadingIndicator)||"Shimmer"!==this.parent.loadingIndicator.indicatorType||!O(r,"e-mask-ftrchk")){var i=O(r,"e-checkbox-wrapper");if(O(r,"e-searchbox")&&this.searchBoxClick(e),i&&!this.isCheckboxFilterTemplate){var n=i.querySelector(".e-selectall");n?this.updateAllCBoxes(!n.classList.contains("e-check")):ie(i.parentElement),this.updateIndeterminatenBtn(),i.querySelector(".e-chk-hidden").focus()}this.setFocus(O(i,"e-ftrchk"))}},e.prototype.keyupHandler=function(e){this.setFocus(O(e.target,"e-ftrchk"))},e.prototype.setFocus=function(e){var t=this.dlg.querySelector(".e-chkfocus");t&&t.classList.remove("e-chkfocus"),e&&e.classList.add("e-chkfocus")},e.prototype.updateAllCBoxes=function(e){for(var t=0,r=[].slice.call(this.cBox.querySelectorAll(".e-frame:not(.e-add-current)"));t<r.length;t++){var i=r[t];se(i,e),ne(i.previousSibling,e)}},e.prototype.dialogOpen=function(){this.parent.element.classList.contains("e-device")&&(this.dialogObj.element.querySelector(".e-input-group").classList.remove("e-input-focus"),this.options.isResponsiveFilter||this.dialogObj.element.querySelector(".e-btn").focus())},e.prototype.createCheckbox=function(e,r,i){var n=r?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0);ne(n.querySelector("input"),r);var o=n.querySelector(".e-label"),s=ve({},i,{column:this.options.column,parent:this.parent});if(o[""+(this.options.disableHtmlEncode?"textContent":"innerHTML")]=!t.isNullOrUndefined(e)&&e.toString().length?this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(e):e:this.getLocalizedLabel("Blanks"),o.innerHTML===this.getLocalizedLabel("Blanks")&&(this.isBlanks=!0),"boolean"==typeof e&&(o.innerHTML=!0===e?this.getLocalizedLabel("FilterTrue"):this.getLocalizedLabel("FilterFalse")),t.addClass([o],["e-checkboxfiltertext"]),this.options.template&&i[this.options.column.field]!==this.getLocalizedLabel("SelectAll")&&i[this.options.column.field]!==this.getLocalizedLabel("AddCurrentSelection")){o.innerHTML="";var a=this.parent.isReact&&this.options.column.filter&&"string"!=typeof this.options.column.filter.itemTemplate,l=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact;a||l?(this.options.template(s,this.parent,"filterItemTemplate",null,null,null,o),this.parent.renderTemplates()):q(o,this.options.template(s,this.parent,"filterItemTemplate"))}return n},e.prototype.updateIndeterminatenBtn=function(){var e=this.cBox.children.length-1,r=[],i=!1,n=this.cBox.querySelector(".e-selectall"),o=this.cBox.querySelectorAll(".e-check:not(.e-selectall):not(.e-add-current)").length;this.cBox.querySelector(".e-add-current")&&(e-=1);var s;this.options.isResponsiveFilter||((s=this.dialogObj.btnObj[0]).disabled=!1);var a=n.previousSibling;ne(a,!1),a.indeterminate=!1,e===o?(r=["e-check"],ne(a,!0)):o?(r=["e-stop"],a.indeterminate=!0):(r=["e-uncheck"],i=!0,s&&(s.disabled=!0)),s&&(this.filterState=!s.disabled,s.dataBind()),t.removeClass([n],["e-check","e-stop","e-uncheck"]),t.addClass([n],r),this.parent.notify("refresh-cutsom-filter-ok-button",{disabled:i})},e.prototype.createFilterItems=function(e,n,o){var s,a,l,h=this.parent.createElement("div"),p=!1;this.options.isResponsiveFilter||(l=this.dialogObj.btnObj[0]);var d=-1,c="ejValue";o.executeQuery||(c=o.field);for(I=0;I<e.length;I++){var u=t.getValue(c,e[parseInt(I.toString(),10)]);(""===u||t.isNullOrUndefined(u))&&(d+=1)}if(this.itemsCnt=-1!==d?e.length-d:e.length,e.length&&!this.renderEmpty){var g=this.getLocalizedLabel("SelectAll"),f=this.cBox.querySelector(".e-checkfltrnmdiv");f&&f.classList.remove("e-checkfltrnmdiv");var m=this.createCheckbox(g,!1,(s={},s[this.options.field]=g,s));this.parent.cssClass&&t.addClass([m],[this.parent.cssClass]);var y=oe(N("cbox"),m,"e-ftrchk");y.querySelector(".e-frame").classList.add("e-selectall"),h.appendChild(y);var v=new r.Predicate("field","equal",this.options.field);this.options.foreignKeyValue&&(v=v.or("field","equal",this.options.foreignKeyValue));var C=new r.DataManager(this.options.filteredColumns).executeLocal((new r.Query).where(v)).length;if(this.sInput.value){var S=this.createCheckbox(this.getLocalizedLabel("AddCurrentSelection"),!1,(a={},a[this.options.field]=this.getLocalizedLabel("AddCurrentSelection"),a));this.parent.cssClass&&t.addClass([S],[this.parent.cssClass]);var b=oe(N("cbox"),S,"e-ftrchk");b.querySelector(".e-frame").classList.add("e-add-current"),h.appendChild(b)}for(var w=void 0,I=0;I<e.length;I++){var R=N("cbox");this.values[""+R]=t.getValue(c,e[parseInt(I.toString(),10)]);var x=t.getValue(this.options.field,e[parseInt(I.toString(),10)]);this.options.formatFn&&(x=this.valueFormatter.toView(x,this.options.formatFn));var F={value:x,column:this.options.column,data:e[parseInt(I.toString(),10)]};if(this.parent.notify("filter-cbox-value",F),""===(x=F.value)||t.isNullOrUndefined(x)){if(w)continue;w=!0}var T=this.createCheckbox(x,this.getCheckedState(C,this.values[""+R]),t.getValue("dataObj",e[parseInt(I.toString(),10)]));h.appendChild(oe(R,T,"e-ftrchk"))}this.cBox.innerHTML="",q(this.cBox,[].slice.call(h.children)),this.updateIndeterminatenBtn(),l&&(l.disabled=!1),p=!1}else h.appendChild(this.parent.createElement("span",{innerHTML:this.getLocalizedLabel("NoResult")})),this.cBox.innerHTML="",this.cBox.appendChild(this.parent.createElement("div",{className:"e-checkfltrnmdiv"})),q(this.cBox.children[0],[].slice.call(h.children)),l&&(l.disabled=!0),p=!0;l&&e.length&&(this.filterState=!l.disabled,l.dataBind());var E={requestType:"filterchoicerequest",dataSource:this.renderEmpty?[]:e};E.filterModel=this,this.parent.notify(Er,E),this.parent.notify("refresh-cutsom-filter-ok-button",{disabled:p}),i.hideSpinner(this.spinner)},e.prototype.getCheckedState=function(e,t){if(this.isFiltered&&e){var r=!!this.sInput.value||this.result[""+t];return"notequal"===this.options.operator?!r:r}return!0},e.getDistinct=function(e,i,n,o){for(var s,a=e.length,l=[],h={},p=!(!n||!n.isForeignColumn)&&n.isForeignColumn();a--;)if(s=e[parseInt(a.toString(),10)],!((s=ge(i,s))in h)){var d={};if(d.ejValue=s,h[""+s]=!0,p){var c=le(n,{},s,o)[0];t.setValue("foreignKeyData",c,e[parseInt(a.toString(),10)]),s=t.getValue(n.foreignKeyValue,c)}t.setValue(i,t.isNullOrUndefined(s)?null:s,d),t.setValue("dataObj",e[parseInt(a.toString(),10)],d),l.push(d)}return r.DataUtil.group(r.DataUtil.sort(l,i,r.DataUtil.fnAscending),"ejValue")},e.getPredicate=function(t,i){for(var n=r.DataUtil.distinct(t,"field",!0)||[],o=[],s={},a=0;a<n.length;a++)0!==(o=new r.DataManager(t).executeLocal((new r.Query).where("field","equal",n[parseInt(a.toString(),10)].field))).length&&(s[n[parseInt(a.toString(),10)].field]=e.generatePredicate(o,i));return s},e.generatePredicate=function(i,n){var o,s=i?i.length:0,a=e.updateDateFilter(i[0]);a.ignoreAccent=!t.isNullOrUndefined(a.ignoreAccent)&&a.ignoreAccent,o="date"===a.type||"datetime"===a.type||"dateonly"===a.type?de(a,a.type,n):a.ejpredicate?a.ejpredicate:new r.Predicate(a.field,a.operator,a.value,!e.getCaseValue(a),a.ignoreAccent);for(var l=1;l<s;l++)i[parseInt(l.toString(),10)]=e.updateDateFilter(i[parseInt(l.toString(),10)]),s>2&&l>1&&"or"===i[parseInt(l.toString(),10)].predicate?"date"===i[parseInt(l.toString(),10)].type||"datetime"===i[parseInt(l.toString(),10)].type||"dateonly"===i[parseInt(l.toString(),10)].type?o.predicates.push(de(i[parseInt(l.toString(),10)],i[parseInt(l.toString(),10)].type,n)):o.predicates.push(new r.Predicate(i[parseInt(l.toString(),10)].field,i[parseInt(l.toString(),10)].operator,i[parseInt(l.toString(),10)].value,!e.getCaseValue(i[parseInt(l.toString(),10)]),i[parseInt(l.toString(),10)].ignoreAccent)):o="date"===i[parseInt(l.toString(),10)].type||"datetime"===i[parseInt(l.toString(),10)].type||"dateonly"===i[parseInt(l.toString(),10)].type?"and"===i[parseInt(l.toString(),10)].predicate&&"equal"===i[parseInt(l.toString(),10)].operator?o.or(de(i[parseInt(l.toString(),10)],i[parseInt(l.toString(),10)].type,n),i[parseInt(l.toString(),10)].type,i[parseInt(l.toString(),10)].ignoreAccent):o[i[parseInt(l.toString(),10)].predicate](de(i[parseInt(l.toString(),10)],i[parseInt(l.toString(),10)].type,n),i[parseInt(l.toString(),10)].type,i[parseInt(l.toString(),10)].ignoreAccent):i[parseInt(l.toString(),10)].ejpredicate?o[i[parseInt(l.toString(),10)].predicate](i[parseInt(l.toString(),10)].ejpredicate):o[i[parseInt(l.toString(),10)].predicate](i[parseInt(l.toString(),10)].field,i[parseInt(l.toString(),10)].operator,i[parseInt(l.toString(),10)].value,!e.getCaseValue(i[parseInt(l.toString(),10)]),i[parseInt(l.toString(),10)].ignoreAccent);return o||null},e.getCaseValue=function(e){return t.isNullOrUndefined(e.matchCase)?!("string"===e.type||t.isNullOrUndefined(e.type)&&"string"==typeof e.value):e.matchCase},e.updateDateFilter=function(e){return("date"===e.type||"datetime"===e.type||"dateonly"===e.type||e.value instanceof Date)&&(e.type=e.type||"date"),e},e}(),Xn=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Yn=function(e){function h(t,r){var i=e.call(this,t)||this;return i.childRefs=[],i.eventHandlers={},i.isDevice=!1,i.customFilterOperators=r,i.isExcel=!0,i}return Xn(h,e),h.prototype.getCMenuDS=function(e,t){var r={number:["Equal","NotEqual","","LessThan","LessThanOrEqual","GreaterThan","GreaterThanOrEqual","Between","","CustomFilter"],string:["Equal","NotEqual","","StartsWith","EndsWith","","Contains","NotContains","","CustomFilter"]};r.date=r.number,r.datetime=r.number,r.dateonly=r.number;for(var i=[],n=0;n<r[""+e].length;n++)r[""+e][parseInt(n.toString(),10)].length?t?i.push({text:this.getLocalizedLabel(r[""+e][parseInt(n.toString(),10)])+"...",iconCss:"e-icons e-icon-check "+(t===r[""+e][parseInt(n.toString(),10)].toLowerCase()?"":"e-emptyicon")}):i.push({text:this.getLocalizedLabel(r[""+e][parseInt(n.toString(),10)])+"..."}):i.push({separator:!0});return i},h.prototype.destroy=function(){if(this.dlg&&(this.unwireExEvents(),e.prototype.closeDialog.call(this)),!this.isDevice&&this.menuObj){var t=this.menuObj.element.querySelector("li.e-focused");t&&O(t,"e-excel-menu")||this.destroyCMenu()}this.dlgObj&&!this.dlgObj.isDestroyed&&this.removeDialog()},h.prototype.createMenu=function(e,t,r,i){var n={string:"TextFilter",date:"DateFilter",dateonly:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"};this.menu=this.parent.createElement("div",{className:"e-contextmenu-wrapper"}),this.parent.enableRtl?this.menu.classList.add("e-rtl"):this.menu.classList.remove("e-rtl"),this.parent.cssClass&&this.menu.classList.add(this.parent.cssClass);var o=this.parent.createElement("ul"),s=t?"e-excl-filter-icon e-filtered":"e-excl-filter-icon";if(this.parent.allowSorting&&"grid"===this.parent.getModuleName()&&!this.options.isResponsiveFilter){var a=this.parent.getColumnHeaderByUid(i.uid).getAttribute("aria-sort"),l=this.parent.getColumnByField(i.field).allowSorting,h=l&&"ascending"!==a?"e-excel-ascending":"e-disabled e-excel-ascending",p=l&&"descending"!==a?"e-excel-descending":"e-disabled e-excel-descending",d="string"===e?this.getLocalizedLabel("SortAtoZ"):"datetime"===e||"date"===e?this.getLocalizedLabel("SortByOldest"):this.getLocalizedLabel("SortSmallestToLargest"),c="string"===e?this.getLocalizedLabel("SortZtoA"):"datetime"===e||"date"===e?this.getLocalizedLabel("SortByNewest"):this.getLocalizedLabel("SortLargestToSmallest");o.appendChild(this.createMenuElem(d,h,"e-sortascending")),o.appendChild(this.createMenuElem(c,p,"e-sortdescending"));var u=this.parent.createElement("li",{className:"e-separator e-menu-item e-excel-separator"});o.appendChild(u)}this.options.isResponsiveFilter||o.appendChild(this.createMenuElem(this.getLocalizedLabel("ClearFilter"),t?"":"e-disabled",s)),"boolean"!==e&&o.appendChild(this.createMenuElem(this.getLocalizedLabel(n[""+e]),"e-submenu",r&&this.ensureTextFilter()?"e-icon-check":s+" e-emptyicon",!0)),this.menu.appendChild(o),this.parent.notify("before-filter-cmenu-open",{element:this.menu}),this.parent.notify("refresh-cutsom-filter-clear-button",{isFiltered:t})},h.prototype.createMenuElem=function(e,t,r,i){var n=this.parent.createElement("li",{className:t+" e-menu-item"});return n.innerHTML=e,n.insertBefore(this.parent.createElement("span",{className:"e-menu-icon e-icons "+r,attrs:{"aria-hidden":"true"}}),n.firstChild),i&&n.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),n},h.prototype.wireExEvents=function(){t.EventHandler.add(this.dlg,"mouseover",this.hoverHandler,this),t.EventHandler.add(this.dlg,"click",this.clickExHandler,this)},h.prototype.unwireExEvents=function(){t.EventHandler.remove(this.dlg,"mouseover",this.hoverHandler),t.EventHandler.remove(this.dlg,"click",this.clickExHandler)},h.prototype.clickExHandler=function(e){var t={string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"},r=O(e.target,"e-menu-item");r&&(this.getLocalizedLabel("ClearFilter")===r.innerText.trim()?(this.clearFilter(),this.closeDialog()):this.options.isResponsiveFilter&&this.getLocalizedLabel(t[this.options.type])===r.innerText.trim()&&this.hoverHandler(e))},h.prototype.destroyCMenu=function(){this.isCMenuOpen=!1,this.menuObj&&!this.menuObj.isDestroyed&&(this.menuObj.destroy(),t.remove(this.cmenu),this.parent.notify("render-responsive-cmenu",{target:null,header:"",isOpen:!1,col:this.options.column}))},h.prototype.hoverHandler=function(e){if(!this.options.isResponsiveFilter||"mouseover"!==e.type){var r,i=e.target.querySelector(".e-contextmenu"),n=O(e.target,"e-menu-item"),o=this.menu.querySelector(".e-focused");if(o&&o.classList.remove("e-focused"),n&&(n.classList.add("e-focused"),r=n.classList.contains("e-submenu")),!i){if(!r){var s=this.menu.querySelector(".e-submenu");t.isNullOrUndefined(s)||s.classList.remove("e-selected"),this.destroyCMenu()}var a=this.ensureTextFilter();if(!this.isCMenuOpen&&r){n.classList.add("e-selected"),this.isCMenuOpen=!0;var h={items:this.getCMenuDS(this.options.type,a?a.replace(/\s/g,""):void 0),select:this.selectHandler.bind(this),onClose:this.destroyCMenu.bind(this),enableRtl:this.parent.enableRtl,animationSettings:{effect:"None"},beforeClose:this.preventClose.bind(this),cssClass:this.options.isResponsiveFilter&&this.parent.cssClass?"e-res-contextmenu-wrapper "+this.parent.cssClass:this.options.isResponsiveFilter?"e-res-contextmenu-wrapper":this.parent.cssClass?this.parent.cssClass:""};this.parent.element.appendChild(this.cmenu),this.menuObj=new l.ContextMenu(h,this.cmenu);var p=this.menu.querySelector(".e-submenu").getBoundingClientRect(),d={top:0,left:0};if(this.options.isResponsiveFilter){var c={string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"},u=document.querySelector(".e-responsive-dialog > .e-dlg-header-content").offsetHeight+4;this.menuObj.element.style.height="calc(100% - "+u+"px)",this.menuObj.open(u,0,document.body);var g=this.getLocalizedLabel(c[this.options.type]);this.parent.notify("render-responsive-cmenu",{target:this.menuObj.element.parentElement,header:g,isOpen:!0})}else{if(t.Browser.isDevice){this.isDevice=!0;var f=this.getContextBounds();d.top=(window.innerHeight-f.height)/2,d.left=(window.innerWidth-f.width)/2,this.closeDialog(),this.isDevice=!1}else d.top=t.Browser.isIE?window.pageYOffset+p.top:window.scrollY+p.top,d.left=this.getCMenuYPosition(this.dlg);this.menuObj.open(d.top,d.left,e.target)}Re(this.parent.element,this.menuObj.element.parentElement)}}}},h.prototype.ensureTextFilter=function(){var e,t=this.existingPredicate[this.options.field];return t&&2===t.length?e="greaterthanorequal"===t[0].operator&&"lessthanorequal"===t[1].operator?"between":"customfilter":t&&1===t.length&&(this.optrData=this.customFilterOperators[this.options.type+"Operator"],e=t[0].operator),e},h.prototype.preventClose=function(e){if(this.options&&this.options.isResponsiveFilter&&e.event){var t=e.event.target,r=t.classList.contains("e-resfilterback")||t.classList.contains("e-res-back-btn")||t.classList.contains("e-menu-item");e.cancel=!r}else e.event instanceof MouseEvent&&e.event.target.classList.contains("e-submenu")&&(e.cancel=!0)},h.prototype.getContextBounds=function(){return this.menuObj.element.style.display="block",this.menuObj.element.getBoundingClientRect()},h.prototype.getCMenuYPosition=function(e){var t=this.getContextBounds().width,r=e.getBoundingClientRect(),i=r.right+t-this.parent.element.clientWidth,n=e.offsetWidth-e.clientWidth;return n=n?n+1:0,i<1?r.right+1-n:r.left-t-1+n},h.prototype.openDialog=function(e){var t=this;if(this.updateModel(e),this.getAndSetChkElem(e),this.showDialog(e),!e.cancel){this.dialogObj.dataBind();var r=this.existingPredicate[e.field]&&this.existingPredicate[e.field].length||this.options.filteredColumns.filter(function(e){return t.options.field===e.field}).length;this.createMenu(e.type,r>0,1===r||2===r,e),this.dlg.insertBefore(this.menu,this.dlg.firstChild),this.dlg.classList.add("e-excelfilter"),this.parent.enableRtl&&this.dlg.classList.add("e-rtl"),this.dlg.classList.remove("e-checkboxfilter"),this.cmenu=this.parent.createElement("ul",{className:"e-excel-menu"}),e.column.showColumnMenu&&this.parent.notify("filterDialogCreated",{}),this.wireExEvents()}},h.prototype.closeDialog=function(){this.destroy()},h.prototype.selectHandler=function(e){e.item&&(this.parent.notify("filter-cmenu-select",{}),this.menuItem=e.item,this.renderDialogue(e))},h.prototype.renderDialogue=function(e){var r=this,n=e?e.element:void 0,o=this.options.field,s=!t.isNullOrUndefined(o)&&_(o),a=!t.isNullOrUndefined(o)&&W(o),l=this.parent.createElement("div",{className:"e-xlfl-maindiv",id:s?a+"-xlflmenu":o+"-xlflmenu"});this.dlgDiv=this.parent.createElement("div",{className:"e-xlflmenu",id:s?a+"-xlfldlg":o+"-xlfldlg"}),this.options.isResponsiveFilter?document.querySelector(".e-resfilter > .e-dlg-content > .e-xl-customfilterdiv").appendChild(this.dlgDiv):this.parent.element.appendChild(this.dlgDiv),this.dlgObj=new i.Dialog({header:this.getLocalizedLabel("CustomFilter"),isModal:!0,overlayClick:this.removeDialog.bind(this),showCloseIcon:!0,closeOnEscape:!1,target:document.body,visible:!1,enableRtl:this.parent.enableRtl,open:function(){var e=r.dlgObj.element.querySelector("table.e-xlfl-table>tr");if(r.options.column.filterTemplate){var t=_(r.options.column.field)?W(r.options.column.field):r.options.column.field,i=r.parent.isReact&&"string"!=typeof r.options.column.filterTemplate,n=r.parent.parentDetails&&r.parent.parentDetails.parentInstObj&&r.parent.parentDetails.parentInstObj.isReact;i||n?r.parent.renderTemplates(function(){e.querySelector("#"+t+"-xlfl-frstvalue").focus()}):e.querySelector("#"+t+"-xlfl-frstvalue").focus()}},close:this.removeDialog.bind(this),created:this.createdDialog.bind(this,n,o),buttons:[{click:this.filterBtnClick.bind(this,o),buttonModel:{content:this.getLocalizedLabel("OKButton"),isPrimary:!0,cssClass:this.parent.cssClass?"e-xlfl-okbtn "+this.parent.cssClass:"e-xlfl-okbtn"}},{click:this.removeDialog.bind(this),buttonModel:{content:this.getLocalizedLabel("CancelButton"),cssClass:this.parent.cssClass?"e-xlfl-cancelbtn "+this.parent.cssClass:"e-xlfl-cancelbtn"}}],content:l,width:430,animationSettings:{effect:"None"},cssClass:this.parent.cssClass?this.parent.cssClass:""});this.dlgObj.isStringTemplate=!0,this.renderResponsiveDialog(),this.dlgDiv.setAttribute("aria-label",this.getLocalizedLabel("CustomFilterDialogARIA")),this.childRefs.push(this.dlgObj),this.dlgObj.appendTo(this.dlgDiv)},h.prototype.renderResponsiveDialog=function(){if(this.options.isResponsiveFilter){var e=document.querySelector(".e-row-responsive-filter");e&&e.classList.remove("e-row-responsive-filter"),this.dlgObj.buttons=[{}],this.dlgObj.header=void 0,this.dlgObj.position={X:"",Y:""},this.dlgObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-xl-customfilterdiv"),this.dlgObj.width="100%",this.dlgObj.isModal=!1,this.dlgObj.showCloseIcon=!1}},h.prototype.removeDialog=function(){this.parent.notify("custom-filter-close",{}),(this.parent.isReact||this.parent.isVue)&&void 0!==this.parent.destroyTemplate&&nt(this.parent,["filterTemplate"]),this.removeObjects(this.childRefs),t.remove(this.dlgDiv),this.parent.notify("filter-dialog-close",{})},h.prototype.createdDialog=function(e,r){if(this.renderCustomFilter(e,r),this.dlgObj.element.style.left="0px",this.options.isResponsiveFilter){var i=document.querySelector(".e-responsive-dialog > .e-dlg-header-content").offsetHeight+4;this.dlgObj.element.style.top=i+"px"}else this.dlgObj.element.style.top="0px";!this.options.isResponsiveFilter&&t.Browser.isDevice&&window.innerWidth<440&&(this.dlgObj.element.style.width="90%"),this.parent.notify("beforeCustomFilterOpen",{column:r,dialog:this.dialogObj}),this.dlgObj.show(),Re(this.parent.element,this.dlgObj.element.parentElement)},h.prototype.renderCustomFilter=function(e,t){var r=this.dlgObj.element.querySelector(".e-xlfl-maindiv"),i=this.parent.createElement("div",{innerHTML:this.getLocalizedLabel("ShowRowsWhere"),className:"e-xlfl-dlgfields"});r.appendChild(i);var n=this.parent.createElement("div",{innerHTML:this.options.displayName,className:"e-xlfl-fieldset"});r.appendChild(n),this.renderFilterUI(t,r)},h.prototype.filterBtnClick=function(e){var r,i=!t.isNullOrUndefined(e)&&_(e),n=!t.isNullOrUndefined(e)&&W(e),o=i?n:e,s=this.dlgDiv.querySelector("#"+o+"-xlfl-frstvalue").ej2_instances[0],a=this.dlgDiv.querySelector("#"+o+"-xlfl-frstoptr").ej2_instances[0],l=this.dlgDiv.querySelector("#"+o+"-xlfl-secndvalue").ej2_instances[0],h=this.dlgDiv.querySelector("#"+o+"-xlfl-secndoptr").ej2_instances[0];"string"===this.options.type&&(r=this.dlgDiv.querySelector("#"+o+"-xlflmtcase").ej2_instances[0].checked);var p=this.dlgDiv.querySelector("#"+o+"e-xlfl-frstpredicate").ej2_instances[0].checked?"and":"or";null===l.value&&(p="or"),this.filterByColumn(this.options.field,a.value,s.value,p,r,this.options.ignoreAccent,h.value,l.value),this.removeDialog()},h.prototype.filterByColumn=function(e,i,n,o,s,a,l,h){var p,d=this.parent.getColumnByField?this.parent.getColumnByField(e):this.options.column,c=this.isForeignColumn(d)?d.foreignKeyValue:e,u=[],g={instance:this,handler:this.filterByColumn,arg1:e,arg2:i,arg3:n,arg4:o,arg5:s,arg6:a,arg7:l,arg8:h,cancel:!1};if(this.parent.notify(zr,g),!g.cancel){u.push({field:c,predicate:o,matchCase:s,ignoreAccent:a,operator:i,value:g.arg3,type:this.options.type}),p=new r.Predicate(c,i.toLowerCase(),g.arg3,!s,a),t.isNullOrUndefined(h)||t.isNullOrUndefined(l)||(u.push({field:c,predicate:o,matchCase:s,ignoreAccent:a,operator:l,value:g.arg8,type:this.options.type}),p=p[""+o](c,l.toLowerCase(),h,!s,a));var f={action:"filtering",filterCollection:u,field:this.options.field,ejpredicate:p,actualPredicate:u};this.isForeignColumn(d)?this.foreignKeyFilter(f,u,p):this.options.handler(f)}},h.prototype.renderOperatorUI=function(e,r,i,n,o){var a=this.parent.createElement("tr",{className:"e-xlfl-fields"});r.appendChild(a);var l=this.parent.createElement("td",{className:"e-xlfl-optr"});a.appendChild(l);var h=this.parent.createElement("div",{className:"e-xlfl-optrdiv"}),p=!t.isNullOrUndefined(e)&&_(e),d=!t.isNullOrUndefined(e)&&W(e),c=this.parent.createElement("input",{id:p?d+i:e+i});h.appendChild(c),l.appendChild(h);var u=this.options.type+"Operator",g=this.customFilterOperators[""+u];this.optrData=g;var f=this.dropSelectedVal(this.options.column,n,o),m="";this.menuItem&&((m=this.menuItem.text.slice(0,-3))!==this.getLocalizedLabel("CustomFilter")&&(f=o?m:void 0),m===this.getLocalizedLabel("Between")&&(f=this.getLocalizedLabel(o?"GreaterThanOrEqual":"LessThanOrEqual")));var y=this.options.column,v=new s.DropDownList(F({dataSource:g,fields:{text:"text",value:"value"},text:f,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:null},y.filter.params));this.childRefs.push(v);var C={open:this.dropDownOpen.bind(this),change:this.dropDownValueChange.bind(this)};return rt(c.id,[pi,"change"],C,this),v.addEventListener(pi,this.eventHandlers[c.id][pi]),v.addEventListener("change",this.eventHandlers[c.id].change),v.appendTo(c),{fieldElement:a,operator:this.getSelectedValue(f)}},h.prototype.removeHandlersFromComponent=function(e){e.element.classList.contains("e-dropdownlist")?it(e,[pi,"change"],this):e.element.classList.contains("e-autocomplete")&&it(e,[Nt,"focus"],this)},h.prototype.dropDownOpen=function(e){e.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()},h.prototype.dropDownValueChange=function(e){e.element.id.includes("-xlfl-frstoptr")?this.firstOperator=e.value.toString():this.secondOperator=e.value.toString()},h.prototype.getFilterUIInfo=function(){return{firstOperator:this.firstOperator,secondOperator:this.secondOperator,field:this.options.field}},h.prototype.getSelectedValue=function(e){var i=new r.DataManager(this.optrData).executeLocal((new r.Query).where("text","equal",e));return t.isNullOrUndefined(i[0])?"":i[0].value},h.prototype.dropSelectedVal=function(e,t,r){var i;return i=t&&t.length>0?2===t.length?r?t[0].operator:t[1].operator:r?t[0].operator:void 0:r&&"string"===e.type&&!e.filter.operator?"startswith":r?e.filter.operator||"equal":void 0,this.getSelectedText(i)},h.prototype.getSelectedText=function(e){var i=new r.DataManager(this.optrData).executeLocal((new r.Query).where("value","equal",e));return t.isNullOrUndefined(i[0])?"":i[0].text},h.prototype.renderFilterUI=function(e,t){var r=this.existingPredicate[""+e],i=this.parent.createElement("table",{className:"e-xlfl-table",attrs:{role:"grid"}});t.appendChild(i);var n=this.parent.createElement(hi);n.innerHTML='<col style="width: 50%"></col><col style="width: 50%"></col>',i.appendChild(n);var o=this.renderOperatorUI(e,i,"-xlfl-frstoptr",r,!0);this.firstOperator=o.operator,this.renderFlValueUI(e,o,"-xlfl-frstvalue",r,!0);var s=this.parent.createElement("tr",{className:"e-xlfl-predicate"});i.appendChild(s),this.renderRadioButton(e,s,r),o=this.renderOperatorUI(e,i,"-xlfl-secndoptr",r,!1),this.secondOperator=o.operator,this.renderFlValueUI(e,o,"-xlfl-secndvalue",r,!1)},h.prototype.renderRadioButton=function(e,r,i){var o=this.parent.createElement("td",{className:"e-xlfl-radio",attrs:{colSpan:"2"}});r.appendChild(o);var s=this.parent.createElement("div",{className:"e-xlfl-radiodiv",attrs:{style:"display: inline-block"}}),a=!t.isNullOrUndefined(e)&&_(e),l=!t.isNullOrUndefined(e)&&W(e),h=this.parent.createElement("input",{id:a?l+"e-xlfl-frstpredicate":e+"e-xlfl-frstpredicate",attrs:{type:"radio"}}),p=this.parent.createElement("input",{id:a?l+"e-xlfl-secndpredicate":e+"e-xlfl-secndpredicate",attrs:{type:"radio"}});s.appendChild(h),s.appendChild(p),o.appendChild(s),"string"===this.options.type&&this.renderMatchCase(e,r,o,"-xlflmtcase",i);var d=new n.RadioButton({label:this.getLocalizedLabel("AND"),name:"default",checked:!0,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.push(d);var c=new n.RadioButton({label:this.getLocalizedLabel("OR"),name:"default",enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.push(c),"and"===(i&&2===i.length?i[1].predicate:"and")?(d.checked=!0,c.checked=!1):(c.checked=!0,d.checked=!1),d.appendTo(h),c.appendTo(p),d.element.nextElementSibling.classList.add("e-xlfl-radio-and"),c.element.nextElementSibling.classList.add("e-xlfl-radio-or")},h.prototype.removeObjects=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];i&&!i.isDestroyed&&(this.removeHandlersFromComponent(i),i.destroy())}},h.prototype.renderFlValueUI=function(e,r,i,n,o){var s=this.parent.createElement("td",{className:"e-xlfl-value"});r.fieldElement.appendChild(s);var a=!t.isNullOrUndefined(e)&&_(e),l=!t.isNullOrUndefined(e)&&W(e),h=this.parent.createElement("div",{className:"e-xlfl-valuediv"}),p=this.options.filteredColumns.some(function(t){return e===t.field}),d=this.options.filteredColumns.filter(function(t){return t.field===e});if(this.options.column.filterTemplate){var c={},u=this.options.column;p&&i&&(c=this.getExcelFilterData(i,c,u,n,d));var g=this.parent.isReact&&"string"!=typeof this.options.column.filterTemplate,f=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,m=this.parent.element.id+u.uid+"filterTemplate";if(g||f)this.options.column.getFilterTemplate()(c,this.parent,"filterTemplate",m,null,null,h);else{var y=this.options.column.getFilterTemplate()(c,this.parent,"filterTemplate",m);q(h,y)}g||f?this.parent.renderTemplates(function(){h.querySelector("input").id=a?l+i:e+i,s.appendChild(h)}):((this.parent.isAngular?h.children[0]:h.querySelector("input")).id=a?l+i:e+i,s.appendChild(h))}else{var v=this.parent.createElement("input",{id:a?l+i:e+i});h.appendChild(v),s.appendChild(h);var C=void 0,S=void 0;n&&n.length>0&&(C=(S=2===n.length?o?n[0]:n[1]:o?n[0]:void 0)&&S.operator===r.operator?S.value:void 0,t.isNullOrUndefined(C)&&(C=void 0)),{string:this.renderAutoComplete.bind(this),number:this.renderNumericTextBox.bind(this),date:this.renderDate.bind(this),dateonly:this.renderDate.bind(this),datetime:this.renderDateTime.bind(this)}[this.options.type](this.options,e,v,C,this.parent.enableRtl)}},h.prototype.getExcelFilterData=function(e,t,r,i,n){var o="-xlfl-frstvalue"===e?0:1;if("-xlfl-frstvalue"===e||n.length>1){t={column:i instanceof Array?i[parseInt(o.toString(),10)]:i};var s=this.options.column.columnData&&n.length>1?1===this.options.column.columnData.length?0:1:o;t[this.options.field]=r.foreignKeyValue?this.options.column.columnData[parseInt(s.toString(),10)][r.foreignKeyValue]:n[parseInt(s.toString(),10)].value,this.options.foreignKeyValue&&(t[this.options.foreignKeyValue]=this.options.column.columnData[parseInt(s.toString(),10)][r.foreignKeyValue])}return t},h.prototype.renderMatchCase=function(e,r,i,o,s){var a=this.parent.createElement("div",{className:"e-xlfl-matchcasediv",attrs:{style:"display: inline-block"}}),l=!t.isNullOrUndefined(e)&&_(e),h=!t.isNullOrUndefined(e)&&W(e),p=this.parent.createElement("input",{id:l?h+o:e+o,attrs:{type:"checkbox"}});a.appendChild(p),i.appendChild(a);var d=!!(s&&s.length>0)&&(s&&2===s.length?s[1].matchCase:s[0].matchCase),c=new n.CheckBox({label:this.getLocalizedLabel("MatchCase"),enableRtl:this.parent.enableRtl,checked:d,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.push(c),c.appendTo(p)},h.prototype.renderDate=function(e,t,r,i,n){var o=fe(e.format,e.type)||e.format,s=new a.DatePicker(F({format:o,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:n,value:new Date(i),locale:this.parent.locale},e.column.filter.params));this.childRefs.push(s),s.appendTo(r)},h.prototype.renderDateTime=function(e,t,r,i,n){var o=fe(e.format,e.type),s=new a.DateTimePicker(F({format:o,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:n,value:new Date(i),locale:this.parent.locale},e.column.filter.params));this.childRefs.push(s),s.appendTo(r)},h.prototype.completeAction=function(e){e.result=ee(e.result)},h.prototype.renderNumericTextBox=function(e,t,r,i,n){var s=new o.NumericTextBox(F({format:e.format,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:n,value:i,locale:this.parent.locale,cssClass:this.parent.cssClass?this.parent.cssClass:null},e.column.filter.params));this.childRefs.push(s),s.appendTo(r)},h.prototype.renderAutoComplete=function(e,t,i,n,o){var a=this.options.column,l=this.isForeignColumn(a),h=l?a.dataSource:e.dataSource,p={value:l?a.foreignKeyValue:t},d=new s.AutoComplete(F({dataSource:h instanceof r.DataManager?h:new r.DataManager(h),fields:p,query:this.getQuery(),sortOrder:"Ascending",locale:this.parent.locale,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",autofill:!0,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:o,text:n},a.filter.params));if(h&&"result"in h){var c=Me({requestType:"stringfilterrequest"},this.getQuery());this.parent.trigger("dataStateChange",c.state),c.deffered.promise.then(function(e){d.dataSource=new r.DataManager(e)})}this.childRefs.push(d);var u={actionComplete:this.acActionComplete(d,t),focus:this.acFocus(d,t,e,i)};rt(i.id,[Nt,"focus"],u,this),d.addEventListener("focus",this.eventHandlers[i.id].focus),d.addEventListener(Nt,this.eventHandlers[i.id][Nt]),d.appendTo(i)},h.prototype.acActionComplete=function(e,r){return function(i){var n=!t.isNullOrUndefined(r)&&_(r);i.result=i.result.filter(function(t,r,i){return i.map(function(t){return n?Ye(e.fields.value,t):t[e.fields.value]}).indexOf(n?Ye(e.fields.value,t):t[e.fields.value])===r})}},h.prototype.acFocus=function(e,r,i,n){var o=this;return function(){var s=!t.isNullOrUndefined(r)&&_(r),a=!t.isNullOrUndefined(r)&&W(r),l=s?a:r;e.filterType=o.dlgDiv.querySelector("#"+l+(n.id===l+"-xlfl-frstvalue"?"-xlfl-frstoptr":"-xlfl-secndoptr")).ej2_instances[0].value,e.ignoreCase="string"!==i.type||!o.dlgDiv.querySelector("#"+l+"-xlflmtcase").ej2_instances[0].checked,e.filterType=t.isNullOrUndefined(e.filterType)?"equal":e.filterType}},h}(Qn),Jn=function(){function r(e,t,r,i){this.contentRefresh=!0,this.isModelChanged=!0,this.aria=new Fi,this.currentTarget=null,this.parent=e,this.sortSettings=t,this.sortedColumns=r,this.serviceLocator=i,this.focus=i.getService("focus"),this.addEventListener(),this.setFullScreenDialog()}return r.prototype.updateModel=function(){var e,t={field:this.columnName,direction:this.direction},r=this.parent.groupSettings.columns,i=!1;if(this.isMultiSort)(e=this.getSortedColsIndexByField(this.columnName))>-1&&this.sortSettings.columns.splice(e,1),this.sortSettings.columns.push(t),this.sortSettings.columns=this.sortSettings.columns;else if(r.length){for(var n=[],o=0,s=r.length;o<s;o++)if(e=this.getSortedColsIndexByField(r[parseInt(o.toString(),10)],n),this.columnName===r[parseInt(o.toString(),10)])i=!0,n.push(t);else{var a=this.getSortColumnFromField(r[parseInt(o.toString(),10)]);n.push({field:a.field,direction:a.direction,isFromGroup:a.isFromGroup})}i||n.push(t),this.sortSettings.columns=n}else this.sortSettings.columns=[t];this.parent.dataBind(),this.lastSortedCol=this.columnName},r.prototype.onActionComplete=function(e){var r=this.isRemove?{requestType:"sorting",type:Nt}:{columnName:this.columnName,direction:this.direction,requestType:"sorting",type:Nt};this.isRemove=!1,this.parent.trigger(Nt,t.extend(e,r))},r.prototype.sortColumn=function(e,t,r){var i=this.parent;return!1===this.parent.getColumnByField(e).allowSorting||this.parent.isContextMenuOpen()?void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:e}):(i.allowMultiSorting||(r=i.allowMultiSorting),this.isActionPrevent()?void i.notify(Cr,{instance:this,handler:this.sortColumn,arg1:e,arg2:t,arg3:r}):(this.backupSettings(),this.columnName=e,this.direction=t,this.isMultiSort=r,this.removeSortIcons(),this.updateSortedCols(e,r),void this.updateModel()))},r.prototype.setFullScreenDialog=function(){this.serviceLocator&&this.serviceLocator.registerAdaptiveService(this,this.parent.enableAdaptiveUI,e.ResponsiveDialogAction.isSort)},r.prototype.backupSettings=function(){this.lastSortedCols=I(this.sortSettings.columns),this.lastCols=this.sortedColumns},r.prototype.restoreSettings=function(){this.isModelChanged=!1,this.isMultiSort=!0,this.parent.setProperties({sortSettings:{columns:this.lastSortedCols}},!0),this.sortedColumns=this.lastCols,this.isModelChanged=!0},r.prototype.updateSortedCols=function(e,t){if(!t)if(this.parent.allowGrouping)for(var r=0,i=this.sortedColumns.length;r<i;r++)this.parent.groupSettings.columns.indexOf(this.sortedColumns[parseInt(r.toString(),10)])<0&&(this.sortedColumns.splice(r,1),i--,r--);else this.sortedColumns.splice(0,this.sortedColumns.length);this.sortedColumns.indexOf(e)<0&&this.sortedColumns.push(e)},r.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName()){if(this.contentRefresh){var t=this.sortSettings.columns.length?{columnName:this.columnName,direction:this.direction,requestType:"sorting",type:Bt,target:this.currentTarget,cancel:!1}:{requestType:"sorting",type:Bt,cancel:!1,target:this.currentTarget};this.parent.notify(er,t)}this.refreshSortSettings(),this.removeSortIcons(),this.addSortIcons()}},r.prototype.refreshSortSettings=function(){this.sortedColumns.length=0;for(var e=this.sortSettings.columns,t=0;t<e.length;t++)e[parseInt(t.toString(),10)].isFromGroup||this.sortedColumns.push(e[parseInt(t.toString(),10)].field)},r.prototype.clearSorting=function(){var e=L(this.sortSettings.columns);if(this.isActionPrevent())return void this.parent.notify(Cr,{instance:this,handler:this.clearSorting});for(var t=0,r=e.length;t<r;t++)this.removeSortColumn(e[parseInt(t.toString(),10)].field)},r.prototype.isActionPrevent=function(){return Y(this.parent)},r.prototype.removeSortColumn=function(e){var t=this.parent,r=this.sortSettings.columns;if(!(0===r.length&&this.sortedColumns.indexOf(e)<0)){if(this.isActionPrevent())return void this.parent.notify(Cr,{instance:this,handler:this.removeSortColumn,arg1:e});this.backupSettings(),this.removeSortIcons();for(var i={requestType:"sorting",type:Bt,target:this.currentTarget},n=0,o=r.length;n<o;n++)if(r[parseInt(n.toString(),10)].field===e){if(t.allowGrouping&&t.groupSettings.columns.indexOf(r[parseInt(n.toString(),10)].field)>-1)continue;this.sortedColumns.splice(this.sortedColumns.indexOf(r[parseInt(n.toString(),10)].field),1),r.splice(n,1),this.isRemove=!0,this.isModelChanged&&this.parent.notify(er,i);break}i.cancel||this.addSortIcons()}},r.prototype.getSortedColsIndexByField=function(e,t){for(var r=t||this.sortSettings.columns,i=0,n=r.length;i<n;i++)if(r[parseInt(i.toString(),10)].field===e)return i;return-1},r.prototype.getModuleName=function(){return"sort"},r.prototype.initialEnd=function(){if(this.parent.off(Yt,this.initialEnd),this.parent.getColumns().length&&this.sortSettings.columns.length){var e=this.parent;this.contentRefresh=!1,this.isMultiSort=this.sortSettings.columns.length>1;for(var t=0,r=e.sortSettings.columns.slice();t<r.length;t++){var i=r[t];this.sortedColumns.indexOf(i.field)>-1&&this.sortColumn(i.field,i.direction,!0)}this.isMultiSort=!1,this.contentRefresh=!0}},r.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:"set-fullscreen-dialog",handler:this.setFullScreenDialog},{event:Yt,handler:this.initialEnd},{event:"sorting-complete",handler:this.onActionComplete},{event:$t,handler:this.onPropertyChanged},{event:ar,handler:this.clickHandler},{event:rr,handler:this.refreshSortIcons},{event:sr,handler:this.keyPressed},{event:"cancel-Begin",handler:this.cancelBeginEvent},{event:lr,handler:this.destroy}],Ze(this.parent,this.evtHandlers,!0,this))},r.prototype.removeEventListener=function(){this.parent.isDestroyed||Ze(this.parent,this.evtHandlers,!1)},r.prototype.destroy=function(){this.isModelChanged=!1;var e=this.parent.element;e&&(e.querySelector("."+jr)||e.querySelector("."+Vr))&&(this.parent.element.querySelector(".e-gridpopup").getElementsByClassName("e-sortdirect").length&&(this.parent.element.querySelector(".e-gridpopup").style.display="none"),this.parent.refreshing||!this.parent.isDestroyed&&this.parent.allowSorting||this.clearSorting(),this.isModelChanged=!0,this.removeEventListener())},r.prototype.cancelBeginEvent=function(e){"sorting"===e.requestType&&(this.restoreSettings(),this.refreshSortIcons(),this.isMultiSort=!0)},r.prototype.clickHandler=function(e){var r=this.parent;this.currentTarget=null,this.popUpClickHandler(e);var i=t.closest(e.target,".e-headercell");if(i&&!e.target.classList.contains("e-grptogglebtn")&&!i.classList.contains("e-resized")&&!e.target.classList.contains("e-rhandler")&&!e.target.classList.contains("e-columnmenu")&&!e.target.classList.contains("e-filtermenudiv")&&!O(e.target,"e-stackedheadercell")&&!(r.allowSelection&&r.selectionSettings.allowColumnSelection&&e.target.classList.contains("e-headercell"))){var n=this.parent.getColumnByUid(i.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));"checkbox"!==n.type&&(this.initiateSort(i,e,n),t.Browser.isDevice&&this.showPopUp(e))}if(i&&i.classList.remove("e-resized"),O(e.target,"e-excel-ascending")||O(e.target,"e-excel-descending")){var o=t.closest(e.target,".e-filter-popup").getAttribute("uid"),s=t.isNullOrUndefined(O(e.target,"e-excel-descending"))?"Ascending":"Descending";this.sortColumn(r.getColumnByUid(o).field,s,!1)}},r.prototype.keyPressed=function(e){var r=e.target;if(!this.parent.isEdit&&("enter"===e.action||"ctrlEnter"===e.action||"shiftEnter"===e.action)&&t.closest(r,".e-headercell")){var i=this.focus.getFocusedElement();if(t.isNullOrUndefined(i)||!i.classList.contains("e-headercell")||!i.querySelector(".e-headercelldiv"))return;var n=this.parent.getColumnByUid(i.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));this.initiateSort(i,e,n)}},r.prototype.initiateSort=function(e,t,r){var i=this.parent,n=r.field;this.currentTarget=t.target;var o=e.getElementsByClassName("e-ascending").length?"Descending":"Ascending";this.isMultiSort=t.ctrlKey||this.enableSortMultiTouch||-1!==navigator.userAgent.indexOf("Mac OS")&&t.metaKey,t.shiftKey||this.sortSettings.allowUnsort&&e.getElementsByClassName("e-descending").length&&!(i.groupSettings.columns.indexOf(n)>-1)?this.removeSortColumn(n):this.sortColumn(n,o,this.isMultiSort)},r.prototype.showPopUp=function(e){var r=t.closest(e.target,".e-headercell");!this.parent.allowMultiSorting||t.isNullOrUndefined(r)&&!this.parent.isContextMenuOpen()||z(this.parent.element.querySelector(".e-gridpopup"),e,"e-sortdirect e-icons e-icon-sortdirect"+(this.sortedColumns.length>1?" e-spanclicked":""))},r.prototype.popUpClickHandler=function(e){var r=e.target;t.closest(r,".e-headercell")||e.target.classList.contains(Ur)||t.closest(r,".e-gridpopup")?r.classList.contains("e-sortdirect")&&(r.classList.contains("e-spanclicked")?(r.classList.remove("e-spanclicked"),this.enableSortMultiTouch=!1,this.parent.element.querySelector(".e-gridpopup").style.display="none"):(r.classList.add("e-spanclicked"),this.enableSortMultiTouch=!0)):this.parent.element.querySelector(".e-gridpopup").style.display="none"},r.prototype.addSortIcons=function(){for(var e,r,i=this.parent,n=this.sortSettings.columns,o=this.parent.getColumns().map(function(e){return e.field}),s=0,a=n.length;s<a;s++)e=i.getColumnHeaderByField(n[parseInt(s.toString(),10)].field),-1===o.indexOf(n[parseInt(s.toString(),10)].field)||t.isNullOrUndefined(e)||(this.aria.setSort(e,n[parseInt(s.toString(),10)].direction.toLowerCase()),n.length>1&&e.querySelector(".e-headercelldiv").insertBefore(this.parent.createElement("span",{className:"e-sortnumber",innerHTML:(s+1).toString()}),e.querySelector(".e-headertext")),r=e.querySelector(".e-sortfilterdiv"),"Ascending"===n[parseInt(s.toString(),10)].direction?t.classList(r,["e-ascending","e-icon-ascending"],[]):t.classList(r,["e-descending","e-icon-descending"],[]))},r.prototype.removeSortIcons=function(e){for(var r,i=this.parent,n=this.sortSettings.columns,o=this.parent.getColumns().map(function(e){return e.field}),s=e||0,a=t.isNullOrUndefined(e)?n.length:e+1;s<a;s++)r=i.getColumnHeaderByField(n[parseInt(s.toString(),10)].field),t.isNullOrUndefined(r)||i.allowGrouping&&i.groupSettings.columns.indexOf(n[parseInt(s.toString(),10)].field)>-1&&!r.querySelector(".e-sortfilterdiv")||-1!==o.indexOf(n[parseInt(s.toString(),10)].field)&&(this.aria.setSort(r,"none"),t.classList(r.querySelector(".e-sortfilterdiv"),[],["e-descending","e-icon-descending","e-ascending","e-icon-ascending"]),r.querySelector(".e-sortnumber")&&r.querySelector(".e-headercelldiv").removeChild(r.querySelector(".e-sortnumber")))},r.prototype.getSortColumnFromField=function(e){for(var t=0,r=this.sortSettings.columns.length;t<r;t++)if(this.sortSettings.columns[parseInt(t.toString(),10)].field===e)return this.sortSettings.columns[parseInt(t.toString(),10)];return!1},r.prototype.updateAriaAttr=function(){for(var e=this.parent.getColumns().map(function(e){return e.field}),t=0,r=this.sortedColumns;t<r.length;t++){var i=r[t];if(-1!==e.indexOf(i)){var n=this.parent.getColumnHeaderByField(i);this.aria.setSort(n,this.getSortColumnFromField(i).direction)}}},r.prototype.refreshSortIcons=function(e){void 0===e&&(e={args:{isFrozen:!1}}),e.args.isFrozen||(this.removeSortIcons(),this.isMultiSort=!0,this.removeSortIcons(),this.addSortIcons(),this.isMultiSort=!1,this.updateAriaAttr())},r.prototype.showCustomSort=function(e){this.responsiveDialogRenderer.isCustomDialog=e,this.responsiveDialogRenderer.showResponsiveDialog()},r}(),Zn=function(){function e(e){this.pagerModule=e}return e.prototype.render=function(){this.pagerElement=this.pagerModule.element,this.renderNumericContainer(),this.refreshNumericLinks(),this.wireEvents()},e.prototype.refresh=function(){this.pagerModule.updateTotalPages(),this.links.length&&this.updateLinksHtml(),this.refreshAriaAttrLabel(),this.updateStyles()},e.prototype.refreshNumericLinks=function(){var e,r=this.pagerModule,i=r.element.querySelector(".e-numericcontainer"),n=document.createDocumentFragment();i.innerHTML="";for(var o=1;o<=r.pageCount;o++)e=t.createElement("a",{className:"e-link e-numericitem e-spacing e-pager-default",attrs:{role:"link",tabindex:"-1","aria-label":r.getLocalizedLabel("Page")+o+r.getLocalizedLabel("Of")+r.totalPages+r.getLocalizedLabel("Pages"),href:"#",name:"Goto page"+o}}),r.currentPage===o&&(t.classList(e,["e-currentitem","e-active"],["e-pager-default"]),e.setAttribute("aria-selected","true"),e.setAttribute("aria-current","page")),n.appendChild(e);i.appendChild(n),this.links=[].slice.call(i.childNodes)},e.prototype.wireEvents=function(){t.EventHandler.add(this.pagerElement,"click",this.clickHandler,this)},e.prototype.unwireEvents=function(){t.EventHandler.remove(this.pagerModule.element,"click",this.clickHandler)},e.prototype.destroy=function(){this.unwireEvents()},e.prototype.refreshAriaAttrLabel=function(){for(var e=this.pagerModule,t=e.element.querySelector(".e-numericcontainer").querySelectorAll("a"),r=0;r<t.length;r++)t[parseInt(r.toString(),10)].hasAttribute("aria-label")&&t[parseInt(r.toString(),10)].hasAttribute("index")&&t[parseInt(r.toString(),10)].setAttribute("aria-label",e.getLocalizedLabel("Page")+t[parseInt(r.toString(),10)].getAttribute("index")+e.getLocalizedLabel("Of")+e.totalPages+e.getLocalizedLabel("Pages"))},e.prototype.renderNumericContainer=function(){this.element=t.createElement("div",{className:"e-pagercontainer",attrs:{role:"navigation"}}),this.renderFirstNPrev(this.element),this.renderPrevPagerSet(this.element),this.element.appendChild(t.createElement("div",{className:"e-numericcontainer"})),this.renderNextPagerSet(this.element),this.renderNextNLast(this.element),this.pagerModule.element.appendChild(this.element)},e.prototype.renderFirstNPrev=function(e){this.first=t.createElement("div",{className:"e-first e-icons e-icon-first",attrs:{title:this.pagerModule.getLocalizedLabel("firstPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("firstPageTooltip"),tabindex:"-1",role:"button"}}),this.prev=t.createElement("div",{className:"e-prev e-icons e-icon-prev",attrs:{title:this.pagerModule.getLocalizedLabel("previousPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("previousPageTooltip"),tabindex:"-1",role:"button"}}),t.append([this.first,this.prev],e)},e.prototype.renderPrevPagerSet=function(e){var r=t.createElement("div");this.PP=t.createElement("a",{className:"e-link e-pp e-spacing",innerHTML:"...",attrs:{title:this.pagerModule.getLocalizedLabel("previousPagerTooltip"),role:"link","aria-label":this.pagerModule.getLocalizedLabel("previousPagerTooltip"),tabindex:"-1",name:this.pagerModule.getLocalizedLabel("previousPagerTooltip"),href:"#"}}),r.appendChild(this.PP),e.appendChild(r)},e.prototype.renderNextPagerSet=function(e){var r=t.createElement("div");this.NP=t.createElement("a",{className:"e-link e-np e-spacing",innerHTML:"...",attrs:{title:this.pagerModule.getLocalizedLabel("nextPagerTooltip"),role:"link","aria-label":this.pagerModule.getLocalizedLabel("nextPagerTooltip"),tabindex:"-1",name:this.pagerModule.getLocalizedLabel("nextPagerTooltip"),href:"#"}}),r.appendChild(this.NP),e.appendChild(r)},e.prototype.renderNextNLast=function(e){this.next=t.createElement("div",{className:"e-next e-icons e-icon-next",attrs:{title:this.pagerModule.getLocalizedLabel("nextPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("nextPageTooltip"),tabindex:"-1",role:"button"}}),this.last=t.createElement("div",{className:"e-last e-icons e-icon-last",attrs:{title:this.pagerModule.getLocalizedLabel("lastPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("lastPageTooltip"),tabindex:"-1",role:"button"}}),t.append([this.next,this.last],e)},e.prototype.clickHandler=function(e){var r=this.pagerModule;return this.target=e.target,this.target.classList.contains("e-numericitem")&&e.preventDefault(),r.previousPageNo=r.currentPage,this.target.classList.contains("e-disable")||t.isNullOrUndefined(this.target.getAttribute("index"))||(r.currentPage=parseInt(this.target.getAttribute("index"),10),r.dataBind()),!1},e.prototype.updateLinksHtml=function(){var e,r,i,n=this.pagerModule,o=this.pagerElement.querySelectorAll('.e-numericitem:not(.e-hide):not([style*="display: none"]):not(.e-np):not(.e-pp)');n.currentPage=1===n.totalPages?1:n.currentPage,n.currentPage>n.totalPages&&n.totalPages&&(n.currentPage=n.totalPages),e=parseInt((n.currentPage/n.pageCount).toString(),10),n.currentPage%n.pageCount==0&&e>0&&(e-=1);for(var s=0;s<n.pageCount;s++){if(n.isPagerResized){var a=this.pagerElement.querySelector(".e-focus"),l=this.target?this.target:a||null,h=!1,p=!1,d=!1,c=!1,u=!1,g=!1,f=!1;if(l){var m=l.classList;if(m.contains("e-icons"))switch(!0){case m.contains("e-prev"):h=!0;break;case m.contains("e-next"):p=!0;break;case m.contains("e-first"):d=!0;break;case m.contains("e-last"):c=!0}else if(m.contains("e-numericitem"))switch(!0){case m.contains("e-np"):g=!0;break;case m.contains("e-pp"):f=!0;break;default:u=m.contains("e-numericitem")}}r=c||"End"===this.pagerModule.keyAction,o=this.pagerElement.querySelectorAll('.e-numericitem:not(.e-hide):not([style*="display: none"]):not(.e-np):not(.e-pp)');var y=Array.from(o).some(function(e){return parseInt(e.getAttribute("index"),10)===n.currentPage});i=d||"Home"===this.pagerModule.keyAction?1+s:c||"End"===this.pagerModule.keyAction?e*n.pageCount+1+s:p||"ArrowRight"===this.pagerModule.keyAction||h||"ArrowLeft"===this.pagerModule.keyAction?y?parseInt(o[0].getAttribute("index"),10)+s:h||"ArrowLeft"===this.pagerModule.keyAction?parseInt(this.PP.getAttribute("index"),10)+s:n.currentPage+s:g||f?n.currentPage+s:u?parseInt(o[0].getAttribute("index"),10)+s:e*n.pageCount+1+s}else i=e*n.pageCount+1+s;i<=n.totalPages?(this.links[parseInt(s.toString(),10)].classList.remove("e-hide"),this.links[parseInt(s.toString(),10)].style.display="",this.links[parseInt(s.toString(),10)].setAttribute("index",i.toString()),this.links[parseInt(s.toString(),10)].innerHTML=n.customText?n.customText+i:i.toString(),n.currentPage!==i?this.links[parseInt(s.toString(),10)].classList.add("e-pager-default"):this.links[parseInt(s.toString(),10)].classList.remove("e-pager-default")):(this.links[parseInt(s.toString(),10)].innerHTML=n.customText?n.customText+i:i.toString(),this.links[parseInt(s.toString(),10)].style.display="none"),t.classList(this.links[parseInt(s.toString(),10)],[],["e-currentitem","e-active"]),this.links[parseInt(s.toString(),10)].removeAttribute("aria-selected"),this.links[parseInt(s.toString(),10)].removeAttribute("aria-current"),this.links[parseInt(s.toString(),10)].setAttribute("role","link")}t.attributes(this.first,{index:"1",title:this.pagerModule.getLocalizedLabel("firstPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("firstPageTooltip")}),t.attributes(this.pagerElement.querySelector(".e-mfirst"),{index:"1",title:this.pagerModule.getLocalizedLabel("firstPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("firstPageTooltip")}),t.attributes(this.last,{index:n.totalPages.toString(),title:this.pagerModule.getLocalizedLabel("lastPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("lastPageTooltip")}),t.attributes(this.pagerElement.querySelector(".e-mlast"),{index:n.totalPages.toString(),title:this.pagerModule.getLocalizedLabel("lastPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("lastPageTooltip")}),t.attributes(this.prev,{index:(n.currentPage-1).toString(),title:this.pagerModule.getLocalizedLabel("previousPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("previousPageTooltip")}),t.attributes(this.pagerElement.querySelector(".e-mprev"),{index:(n.currentPage-1).toString(),title:this.pagerModule.getLocalizedLabel("previousPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("previousPageTooltip")}),t.attributes(this.next,{index:(n.currentPage+1).toString(),title:this.pagerModule.getLocalizedLabel("nextPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("nextPageTooltip")}),t.attributes(this.pagerElement.querySelector(".e-mnext"),{index:(n.currentPage+1).toString(),title:this.pagerModule.getLocalizedLabel("nextPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("nextPageTooltip")});var v=this.pagerModule.isPagerResized&&o.length?r?parseInt(o[0].getAttribute("index"),10)-n.avgNumItems:parseInt(o[0].getAttribute("index"),10)-o.length:parseInt(this.links[0].getAttribute("index"),10)-n.pageCount;t.attributes(this.PP,{index:v<1?"1":v.toString(),title:this.pagerModule.getLocalizedLabel("previousPagerTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("previousPagerTooltip")});var C=this.pagerModule.isPagerResized&&o.length?parseInt(o[o.length-1].getAttribute("index"),10):parseInt(this.links[this.links.length-1].getAttribute("index"),10);t.attributes(this.NP,{index:(C+1).toString(),title:this.pagerModule.getLocalizedLabel("nextPagerTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("nextPagerTooltip")}),this.target=void 0},e.prototype.updateStyles=function(){var e=this;if(this.updateFirstNPrevStyles(),this.updatePrevPagerSetStyles(),this.updateNextPagerSetStyles(),this.updateNextNLastStyles(),this.links.length){var r=this.links.findIndex(function(t){return t.getAttribute("index")===e.pagerModule.currentPage.toString()}),i=this.pagerModule.isPagerResized&&-1!==r?r:(this.pagerModule.currentPage-1)%this.pagerModule.pageCount;t.classList(this.links[parseInt(i.toString(),10)],["e-currentitem","e-active"],[]),this.links[parseInt(i.toString(),10)].setAttribute("aria-selected","true"),this.links[parseInt(i.toString(),10)].setAttribute("aria-current","page"),this.links[parseInt(i.toString(),10)].removeAttribute("role")}},e.prototype.updateFirstNPrevStyles=function(){var e=["e-firstpage","e-pager-default"],r=["e-firstpagedisabled","e-disable"],i=["e-prevpage","e-pager-default"],n=["e-prevpagedisabled","e-disable"];this.pagerModule.totalPages>0&&this.pagerModule.currentPage>1?(t.classList(this.prev,i,n),t.classList(this.first,e,r),t.classList(this.pagerElement.querySelector(".e-mfirst"),e,r),t.classList(this.pagerElement.querySelector(".e-mprev"),i,n)):(t.classList(this.prev,n,i),t.classList(this.first,r,e),t.classList(this.pagerElement.querySelector(".e-mprev"),n,i),t.classList(this.pagerElement.querySelector(".e-mfirst"),r,e))},e.prototype.updatePrevPagerSetStyles=function(){this.pagerModule.currentPage>this.pagerModule.pageCount||this.pagerModule.isPagerResized&&this.links.findIndex(function(e){return 1===parseInt(e.getAttribute("index"),10)})?t.classList(this.PP,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"]):t.classList(this.PP,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"])},e.prototype.updateNextPagerSetStyles=function(){var e=this.pagerModule,r=this.links[0].innerHTML.replace(e.customText,""),i=this.pagerElement.querySelectorAll('.e-numericitem:not(.e-hide):not([style*="display: none"]):not(.e-np):not(.e-pp)');!r.length||!this.links.length||parseInt(r,10)+e.pageCount>e.totalPages||e.isPagerResized&&Array.from(i).some(function(t){return parseInt(t.getAttribute("index"),10)===e.totalPages})?t.classList(this.NP,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"]):t.classList(this.NP,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"])},e.prototype.updateNextNLastStyles=function(){var e=["e-lastpage","e-pager-default"],r=["e-lastpagedisabled","e-disable"],i=["e-nextpage","e-pager-default"],n=["e-nextpagedisabled","e-disable"],o=this.pagerModule;o.currentPage===o.totalPages||0===o.totalRecordsCount?(t.classList(this.last,r,e),t.classList(this.next,n,i),t.classList(this.pagerElement.querySelector(".e-mlast"),r,e),t.classList(this.pagerElement.querySelector(".e-mnext"),n,i)):(t.classList(this.last,e,r),t.classList(this.next,i,n),t.classList(this.pagerElement.querySelector(".e-mlast"),e,r),t.classList(this.pagerElement.querySelector(".e-mnext"),i,n))},e}(),$n=function(){function e(e){this.pagerModule=e}return e.prototype.render=function(){var e=t.createElement("div",{className:"e-parentmsgbar",attrs:{"aria-label":this.pagerModule.getLocalizedLabel("Information")}});this.pageNoMsgElem=t.createElement("span",{className:"e-pagenomsg",styles:"textalign:right"}),this.pageCountMsgElem=t.createElement("span",{className:"e-pagecountmsg",styles:"textalign:right"}),t.append([this.pageNoMsgElem,this.pageCountMsgElem],e),this.pagerModule.element.appendChild(e),this.refresh()},e.prototype.refresh=function(){var e=this.pagerModule;this.pageNoMsgElem.textContent=this.format(e.getLocalizedLabel("currentPageInfo"),[0===e.totalRecordsCount?0:e.currentPage,e.totalPages||0,e.totalRecordsCount||0])+" ",this.pageCountMsgElem.textContent=this.format(e.getLocalizedLabel(e.totalRecordsCount<=1?"totalItemInfo":"totalItemsInfo"),[e.totalRecordsCount||0,e.totalRecordsCount?e.pageSize*(e.currentPage-1)+1:0,e.pageSize*e.currentPage>e.totalRecordsCount?e.totalRecordsCount:e.pageSize*e.currentPage]),this.pageNoMsgElem.parentElement.setAttribute("aria-label",this.pageNoMsgElem.textContent+this.pageCountMsgElem.textContent)},e.prototype.hideMessage=function(){this.pageNoMsgElem&&(this.pageNoMsgElem.style.display="none"),this.pageCountMsgElem&&(this.pageCountMsgElem.style.display="none")},e.prototype.showMessage=function(){this.pageNoMsgElem||this.render(),this.pageNoMsgElem.style.display="",this.pageCountMsgElem.style.display=""},e.prototype.destroy=function(){},e.prototype.format=function(e,t){for(var r,i=0;i<t.length;i++)r=new RegExp("\\{"+i+"\\}","gm"),e=e.replace(r,t[parseInt(i.toString(),10)].toString());return e},e}(),eo=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),to=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},ro=function(e){function r(t,r,i){var n=e.call(this,t,r)||this;return n.hasParent=!1,n.checkAll=!0,n.pageRefresh="pager-refresh",n.firstPagerFocus=!1,n.parent=i,n}return eo(r,e),r.prototype.requiredModules=function(){var e=[];return this.enableExternalMessage&&e.push({member:"externalMessage",args:[this]}),this.checkpagesizes()&&e.push({member:"pagerdropdown",args:[this]}),e},r.prototype.preRender=function(){this.defaultConstants={currentPageInfo:"{0} of {1} pages",totalItemsInfo:"({0} items)",totalItemInfo:"({0} item)",firstPageTooltip:"Go to first page",lastPageTooltip:"Go to last page",nextPageTooltip:"Go to next page",previousPageTooltip:"Go to previous page",nextPagerTooltip:"Go to next pager items",previousPagerTooltip:"Go to previous pager items",pagerDropDown:"Items per page",pagerAllDropDown:"Items",CurrentPageInfo:"{0} of {1} pages",TotalItemsInfo:"({0} items)",FirstPageTooltip:"Go to first page",LastPageTooltip:"Go to last page",NextPageTooltip:"Go to next page",PreviousPageTooltip:"Go to previous page",NextPagerTooltip:"Go to next pager items",PreviousPagerTooltip:"Go to previous pager items",PagerDropDown:"Items per page",PagerAllDropDown:"Items",All:"All",Container:"Pager Container",Information:"Pager Information",ExternalMsg:"Pager external message",Page:"Page ",Of:" of ",Pages:" Pages"},this.containerModule=new Zn(this),this.pagerMessageModule=new $n(this)},r.prototype.render=function(){this.element.setAttribute("data-role","pager"),this.element.setAttribute("tabindex","-1"),this.initLocalization(),this.element.setAttribute("aria-label",this.getLocalizedLabel("Container")),this.cssClass&&t.addClass([this.element],[this.cssClass]),this.hasParent||this.element.setAttribute("tabindex","0"),this.template?this.isReactTemplate()?(this.on(this.pageRefresh,this.pagerTemplate,this),this.notify(this.pageRefresh,{})):this.pagerTemplate():(this.updateRTL(),this.totalRecordsCount=this.totalRecordsCount||0,this.renderFirstPrevDivForDevice(),this.containerModule.render(),this.enablePagerMessage&&this.pagerMessageModule.render(),this.renderNextLastDivForDevice(),this.checkpagesizes()&&this.pagerdropdownModule&&this.pagerdropdownModule.render(),this.addAriaLabel(),this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.render(),this.refresh(),this.trigger("created",{currentPage:this.currentPage,totalRecordsCount:this.totalRecordsCount})),this.wireEvents(),this.addListener()},r.prototype.getPersistData=function(){var e=["currentPage","pageSize"];return this.addOnPersist(e)},r.prototype.destroy=function(){this.isDestroyed||(this.isReactTemplate()&&(this.off(this.pageRefresh,this.pagerTemplate),this.hasParent||this.destroyTemplate(["template"])),this.removeListener(),this.unwireEvents(),e.prototype.destroy.call(this),this.containerModule.destroy(),this.pagerMessageModule.destroy(),this.isReactTemplate()||(this.element.innerHTML=""))},r.prototype.destroyTemplate=function(e,t){this.clearTemplate(e,t)},r.prototype.getModuleName=function(){return"pager"},r.prototype.onPropertyChanged=function(e,t){if(!this.isDestroyed){if(e.pageSize===this.getLocalizedLabel("All")&&t.pageSize===this.totalRecordsCount)return void(this.pageSize=this.totalRecordsCount);e.pageCount!==t.pageCount&&(this.containerModule.refreshNumericLinks(),this.containerModule.refresh());for(var r=0,i=Object.keys(e);r<i.length;r++)switch(i[r]){case"currentPage":this.checkGoToPage(e.currentPage,t.currentPage)&&this.currentPageChanged(e,t);break;case"pageSize":case"totalRecordsCount":case"customText":this.checkpagesizes()&&this.pagerdropdownModule&&(t.pageSize!==e.pageSize&&(this.currentPage=1),this.pagerdropdownModule.setDropDownValue("value",this.pageSize)),e.pageSize!==t.pageSize?(this.pageSize=e.pageSize,this.currentPageChanged(e,t)):this.refresh();break;case"pageSizes":this.checkpagesizes()&&this.pagerdropdownModule&&(this.pagerdropdownModule.destroy(),this.pagerdropdownModule.render()),this.refresh();break;case"template":this.templateFn=this.compile(this.template),this.refresh();break;case"locale":this.initLocalization(),this.refresh();break;case"enableExternalMessage":this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.render();break;case"externalMessage":this.externalMessageModule&&this.externalMessageModule.refresh();break;case"enableRtl":this.updateRTL();break;case"enablePagerMessage":this.enablePagerMessage?this.pagerMessageModule.showMessage():this.pagerMessageModule.hideMessage()}this.resizePager()}},r.prototype.wireEvents=function(){this.hasParent||(t.EventHandler.add(this.element,"keydown",this.keyPressHandler,this),t.EventHandler.add(document.body,"keydown",this.keyDownHandler,this)),t.EventHandler.add(this.element,"focusin",this.onFocusIn,this),t.EventHandler.add(this.element,"focusout",this.onFocusOut,this),t.EventHandler.add(window,"resize",this.resizePager,this),t.EventHandler.add(window,"load",this.resizePager,this)},r.prototype.unwireEvents=function(){this.hasParent||(t.EventHandler.remove(this.element,"keydown",this.keyPressHandler),t.EventHandler.remove(document.body,"keydown",this.keyDownHandler)),t.EventHandler.remove(this.element,"focusin",this.onFocusIn),t.EventHandler.remove(this.element,"focusout",this.onFocusOut),t.EventHandler.remove(window,"resize",this.resizePager),t.EventHandler.remove(window,"load",this.resizePager)},r.prototype.onFocusIn=function(e){var r=this.getFocusedTabindexElement();if(t.isNullOrUndefined(r)){var i=e.target,n=this.getDropDownPage();if(this.hasParent||(this.element.tabIndex=-1),i===this.element&&!this.hasParent){var o=this.getFocusablePagerElements(this.element,[]);return void this.addFocus(o[0],!0)}if(i===this.element)return void(this.element.tabIndex=0);i===n||i.classList.contains("e-disable")||this.addFocus(i,!0)}},r.prototype.onFocusOut=function(e){var r=this.getFocusedElement(),i=this.getDropDownPage();t.isNullOrUndefined(r)||this.removeFocus(r,!0),this.pageSizes&&i&&i.classList.contains("e-input-focus")&&this.removeFocus(i,!0),this.setTabIndexForFocusLastElement(),this.hasParent||(this.element.tabIndex=0),this.hasParent&&(this.element.tabIndex=-1)},r.prototype.keyDownHandler=function(e){if(e.altKey&&74===e.keyCode){var t=this.getFocusablePagerElements(this.element,[]);t.length>0&&t[0].focus()}},r.prototype.keyPressHandler=function(e){var r=t.extend(e,{cancel:!1});this.notify(sr,r),!0===r.cancel&&e.stopImmediatePropagation()},r.prototype.addListener=function(){this.isDestroyed||this.hasParent||this.on(sr,this.onKeyPress,this)},r.prototype.removeListener=function(){this.isDestroyed||this.hasParent||this.off(sr,this.onKeyPress)},r.prototype.onKeyPress=function(e){this.hasParent||(this.checkPagerHasFocus()?this.changePagerFocus(e):(e.preventDefault(),this.setPagerFocus()))},r.prototype.checkPagerHasFocus=function(){return!!this.getFocusedTabindexElement()},r.prototype.setPagerContainerFocus=function(){this.element.focus()},r.prototype.setPagerFocus=function(){var e=this.getFocusablePagerElements(this.element,[]);e.length>0&&e[0].focus()},r.prototype.setPagerFocusForActiveElement=function(){var e=this.getActiveElement();e&&e.focus()},r.prototype.setTabIndexForFocusLastElement=function(){var e=this.getFocusablePagerElements(this.element,[]),r=this.getDropDownPage();this.pageSizes&&r&&!t.isNullOrUndefined(r.offsetParent)?r.tabIndex=0:e.length>0&&(e[e.length-1].tabIndex=0)},r.prototype.changePagerFocus=function(e){this.keyAction=e.key,e.shiftKey&&9===e.keyCode?this.changeFocusByShiftTab(e):9===e.keyCode?this.changeFocusByTab(e):13===e.keyCode||32===e.keyCode?this.navigateToPageByEnterOrSpace(e):37!==e.keyCode&&39!==e.keyCode&&35!==e.keyCode&&36!==e.keyCode||this.navigateToPageByKey(e),this.keyAction=""},r.prototype.getFocusedTabindexElement=function(){for(var e,t=this.element.querySelectorAll('[tabindex]:not([tabindex="-1"])'),r=0;r<t.length;r++){var i=t[parseInt(r.toString(),10)];if(i&&(i.classList.contains("e-focused")||i.classList.contains("e-input-focus"))){e=i;break}}return e},r.prototype.changeFocusByTab=function(e){var t=this.getFocusedTabindexElement(),r=this.getFocusablePagerElements(this.element,[]),i=this.getDropDownPage();if(r.length>0)if(this.pageSizes&&i&&t===r[r.length-1])i.tabIndex=0;else for(var n=0;n<r.length;n++)if(t===r[parseInt(n.toString(),10)]){var o=n+1;o<r.length&&(e.preventDefault(),r[parseInt(o.toString(),10)].focus());break}},r.prototype.changeFocusByShiftTab=function(e){var t=this.getFocusedTabindexElement(),r=this.getFocusablePagerElements(this.element,[]),i=this.getDropDownPage();if(this.pageSizes&&i&&i.classList.contains("e-input-focus"))i.tabIndex=-1,this.addFocus(r[r.length-1],!0);else if(r.length>0)for(var n=0;n<r.length;n++)if(t===r[parseInt(n.toString(),10)]){var o=n-1;if(o>=0)e.preventDefault(),r[parseInt(o.toString(),10)].focus();else if(this.hasParent){var s=this.parent.getRows(),a=s[s.length-1].lastChild;e.preventDefault(),a.focus(),this.firstPagerFocus=!0}break}},r.prototype.checkFirstPagerFocus=function(){return!!this.firstPagerFocus&&(this.firstPagerFocus=!1,!0)},r.prototype.navigateToPageByEnterOrSpace=function(e){var t=this.getFocusedElement();if(t){this.goToPage(parseInt(t.getAttribute("index"),10));var r=this.getActiveElement(),i=this.getClass(t),n=this.getElementByClass(i);"e-first"!==i&&"e-prev"!==i&&"e-next"!==i&&"e-last"!==i&&"e-pp"!==i&&"e-np"!==i||!n||n.classList.contains("e-disable")?this.checkFocusInAdaptiveMode(t)?this.changeFocusInAdaptiveMode(t):r&&r.focus():n.focus()}},r.prototype.navigateToPageByKey=function(e){var r=37===e.keyCode?".e-prev":39===e.keyCode?".e-next":35===e.keyCode?".e-last":36===e.keyCode?".e-first":"",i=this.element.querySelector(r),n=this.getFocusedElement();if(!t.isNullOrUndefined(i)&&i.hasAttribute("index")&&!isNaN(parseInt(i.getAttribute("index"),10))){this.goToPage(parseInt(i.getAttribute("index"),10));var o=this.getActiveElement();this.checkFocusInAdaptiveMode(n)?this.changeFocusInAdaptiveMode(n):o&&o.focus()}},r.prototype.checkFocusInAdaptiveMode=function(e){var t=this.getClass(e);return"e-mfirst"===t||"e-mprev"===t||"e-mnext"===t||"e-mlast"===t},r.prototype.changeFocusInAdaptiveMode=function(e){var t=this.getClass(e),r=this.getElementByClass(t);r&&r.classList.contains("e-disable")&&("e-mnext"===t||"e-mlast"===t?this.element.querySelector(".e-mprev").focus():this.setPagerFocus())},r.prototype.removeTabindexLastElements=function(){var e=this.element.querySelectorAll('[tabindex]:not([tabindex="-1"])');if(e.length>1)for(var t=1;t<e.length;t++){var r=e[parseInt(t.toString(),10)];r&&(r.tabIndex=-1)}},r.prototype.getActiveElement=function(){return this.element.querySelector(".e-active")},r.prototype.getDropDownPage=function(){var e,t=this.element.querySelector(".e-pagerdropdown");return t&&(e=t.children[0]),e},r.prototype.getFocusedElement=function(){return this.element.querySelector(".e-focused")},r.prototype.getClass=function(e){for(var t,r=["e-mfirst","e-mprev","e-first","e-prev","e-pp","e-np","e-next","e-last","e-mnext","e-mlast"],i=0;i<r.length;i++)if(e&&e.classList.contains(r[parseInt(i.toString(),10)]))return t=r[parseInt(i.toString(),10)];return t},r.prototype.getElementByClass=function(e){return this.element.querySelector("."+e)},r.prototype.getFocusablePagerElements=function(e,r){for(var i=e.children,n=r,o=0;o<i.length;o++){var s=i[parseInt(o.toString(),10)];if(s.children.length>0&&!s.classList.contains("e-pagesizes"))n=this.getFocusablePagerElements(s,n);else{var a=i[parseInt(o.toString(),10)];!a.hasAttribute("tabindex")||s.classList.contains("e-disable")||"none"===s.style.display||t.isNullOrUndefined(s.offsetParent)||n.push(a)}}return n},r.prototype.addFocus=function(e,r){r&&t.addClass([e],["e-focused","e-focus"]),e.tabIndex=0},r.prototype.removeFocus=function(e,r){r&&t.removeClass([e],["e-focused","e-focus"]),e.tabIndex=-1},r.prototype.getLocalizedLabel=function(e){return this.localeObj.getConstant(e)},r.prototype.goToPage=function(e){this.checkGoToPage(e)&&(this.currentPage=e,this.dataBind())},r.prototype.setPageSize=function(e){this.pageSize=e,this.dataBind()},r.prototype.checkpagesizes=function(){return!(!0!==this.pageSizes&&!this.pageSizes.length)},r.prototype.checkGoToPage=function(e,r){return e!==this.currentPage&&(this.previousPageNo=this.currentPage),t.isNullOrUndefined(r)||(this.previousPageNo=r),this.previousPageNo!==e&&e>=1&&e<=this.totalPages},r.prototype.currentPageChanged=function(e,t){if(this.enableQueryString&&this.updateQueryString(this.currentPage),e.currentPage!==t.currentPage||e.pageSize!==t.pageSize){var r={currentPage:this.currentPage,newProp:e,oldProp:t,cancel:!1};this.trigger("click",r),r.cancel?t.pageSize&&this.pageSize!==t.pageSize&&this.setProperties({pageSize:t.pageSize},!1):this.refresh()}},r.prototype.pagerTemplate=function(){if(!this.isReactTemplate()||!this.hasParent){var e;this.element.classList.add("e-pagertemplate"),this.compile(this.template);var t={currentPage:this.currentPage,pageSize:this.pageSize,pageCount:this.pageCount,totalRecordsCount:this.totalRecordsCount,totalPages:this.totalPages},r=this.element.parentElement.id+"_template";this.isReactTemplate()&&!this.isVue?(this.getPagerTemplate()(t,this,"template",r,null,null,this.element),this.renderReactTemplates()):(e=this.isVue?this.getPagerTemplate()(t,this,"template"):this.getPagerTemplate()(t),q(this.element,e))}},r.prototype.updateTotalPages=function(){this.totalPages=this.isAllPage?1:this.totalRecordsCount%this.pageSize==0?this.totalRecordsCount/this.pageSize:parseInt((this.totalRecordsCount/this.pageSize).toString(),10)+1},r.prototype.getPagerTemplate=function(){return this.templateFn},r.prototype.compile=function(e){if(e)try{"function"==typeof e?this.templateFn=t.compile(e):document.querySelectorAll(e).length&&(this.templateFn=t.compile(document.querySelector(e).innerHTML.trim()))}catch(r){this.templateFn=t.compile(e)}},r.prototype.refresh=function(){if(this.template)this.isReactTemplate()?(this.updateTotalPages(),this.notify(this.pageRefresh,{})):(this.element.innerHTML="",this.updateTotalPages(),this.pagerTemplate());else{this.updateRTL();var e=this.getFocusedTabindexElement();this.containerModule.refresh(),this.removeTabindexLastElements(),e&&e.classList.contains("e-disable")&&(this.checkFocusInAdaptiveMode(e)?this.changeFocusInAdaptiveMode(e):this.setPagerFocusForActiveElement()),this.enablePagerMessage&&this.pagerMessageModule.refresh(),this.pagerdropdownModule&&this.pagerdropdownModule.refresh(),this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.refresh(),this.setTabIndexForFocusLastElement(),this.resizePager()}},r.prototype.updateRTL=function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")},r.prototype.initLocalization=function(){this.localeObj=new t.L10n(this.getModuleName(),this.defaultConstants,this.locale)},r.prototype.updateQueryString=function(e){var t=this.getUpdatedURL(window.location.href,"page",e.toString());window.history.pushState({path:t},"",t)},r.prototype.getUpdatedURL=function(e,t,r){var i=new RegExp("([?|&])"+t+"=.*?(&|#|$)","i");if(e.match(i))return e.replace(i,"$1"+t+"="+r+"$2");var n="";return-1!==e.indexOf("#")&&(n=e.replace(/.*#/,"#"),e=e.replace(/#.*/,"")),e+(-1!==e.indexOf("?")?"&":"?")+t+"="+r+n},r.prototype.renderFirstPrevDivForDevice=function(){this.element.appendChild(t.createElement("div",{className:"e-mfirst e-icons e-icon-first",attrs:{title:this.getLocalizedLabel("firstPageTooltip"),tabindex:"-1"}})),this.element.appendChild(t.createElement("div",{className:"e-mprev e-icons e-icon-prev",attrs:{title:this.getLocalizedLabel("previousPageTooltip"),tabindex:"-1"}}))},r.prototype.renderNextLastDivForDevice=function(){this.element.appendChild(t.createElement("div",{className:"e-mnext e-icons e-icon-next",attrs:{title:this.getLocalizedLabel("nextPageTooltip"),tabindex:"-1"}})),this.element.appendChild(t.createElement("div",{className:"e-mlast e-icons e-icon-last",attrs:{title:this.getLocalizedLabel("lastPageTooltip"),tabindex:"-1"}}))},r.prototype.addAriaLabel=function(){var e=[".e-mfirst",".e-mprev",".e-mnext",".e-mlast"];if(!t.Browser.isDevice)for(var r=0;r<e.length;r++){var i=this.element.querySelector(e[parseInt(r.toString(),10)]);i.setAttribute("aria-label",i.getAttribute("title"))}},r.prototype.isReactTemplate=function(){return(this.isReact||this.isVue)&&this.template&&"string"!=typeof this.template},r.prototype.resizePager=function(){var e=this,r=this.element.classList.contains("e-pager")?getComputedStyle(this.element).getPropertyValue("border-style").includes("solid"):null;if(!this.template&&r){for(var i=this.element.querySelectorAll(".e-mfirst, .e-mprev, .e-icon-first, .e-icon-prev, .e-pp:not(.e-disable), .e-numericitem:not(.e-hide), .e-numericitem.e-active.e-hide, .e-np:not(.e-disable), .e-icon-next, .e-icon-last, .e-parentmsgbar, .e-mnext, .e-mlast, .e-pagerdropdown, .e-pagerconstant"),n=0,o=0;o<i.length;o++)"none"!==getComputedStyle(i[parseInt(o.toString(),10)]).display&&(n+=i[parseInt(o.toString(),10)].offsetWidth+parseFloat(getComputedStyle(i[parseInt(o.toString(),10)]).marginLeft)+parseFloat(getComputedStyle(i[parseInt(o.toString(),10)]).marginRight));var s=this.element.querySelector(".e-pagercontainer");n+=parseFloat(getComputedStyle(s).marginLeft)+parseFloat(getComputedStyle(s).marginRight);var a=this.element.clientWidth-parseFloat(getComputedStyle(this.element).paddingLeft)-parseFloat(getComputedStyle(this.element).paddingRight)-parseFloat(getComputedStyle(this.element).marginLeft)-parseFloat(getComputedStyle(this.element).marginRight),l=s.querySelectorAll('.e-numericitem:not(.e-hide):not([style*="display: none"]):not(.e-np):not(.e-pp)'),h=s.querySelectorAll('.e-numericitem.e-hide:not([style*="display: none"])'),p=l.length,d=t.isNullOrUndefined(O(this.element,"e-bigger"))?5:10,c=s.querySelector(".e-np"),u=s.querySelector(".e-pp"),g=this.element.querySelectorAll('.e-parentmsgbar:not([style*="display: none"]), .e-pagesizes:not([style*="display: none"])');if(g.length){var f=0;g.forEach(function(e){f+=e.offsetWidth}),this.averageDetailWidth=f/g.length}for(var m=0,o=0;o<l.length;o++)m+=l[parseInt(o.toString(),10)].offsetWidth+parseFloat(getComputedStyle(l[parseInt(o.toString(),10)]).marginLeft)+parseFloat(getComputedStyle(l[parseInt(o.toString(),10)]).marginRight);var y=m/l.length;if(n>=a-(y||0)){this.isPagerResized=!0;b=Math.abs(n-a);if(l.length<=1&&g.length&&window.innerWidth>=768){var v=0;this.element.querySelectorAll(".e-pagercontainer , .e-parentmsgbar, .e-pagesizes").forEach(function(e){v+=e.offsetWidth+parseFloat(getComputedStyle(e).marginLeft)+parseFloat(getComputedStyle(e).marginRight)}),v>a-d&&(g[0].style.display="none")}var C=Math.ceil(b/y);C=0===C?1:C>l.length?l.length-1:C,this.currentPage!==this.totalPages&&t.classList(c,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"]);for(o=1;o<=C;o++){var S=p-parseInt(o.toString(),10);l=s.querySelectorAll('.e-numericitem:not(.e-hide):not([style*="display: none"]):not(.e-np):not(.e-pp)'),1===this.currentPage||parseInt(l[Math.abs(S)].getAttribute("index"),10)!==this.currentPage&&parseInt(l[l.length-1].getAttribute("index"),10)!==this.currentPage||(S=0,t.classList(u,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"])),l[Math.abs(S)].classList.contains("e-currentitem")||l[Math.abs(S)].classList.add("e-hide")}}else if(n<a&&h.length){var b=Math.abs(a-n),w=this.element.querySelectorAll('.e-parentmsgbar[style*="display: none"], .e-pagesizes[style*="display: none"]');if(w.length&&b>this.averageDetailWidth+this.averageDetailWidth/4&&(w[w.length-1].style.display="inline-block"),b>2*y&&!w.length&&window.innerWidth>=768){var I=Math.floor(b/(y+d));I=I>h.length?h.length:I-1;for(var R=Array.from(h).filter(function(t){return parseInt(t.getAttribute("index"),10)<e.currentPage}).sort(function(e,t){return parseInt(t.getAttribute("index"),10)-parseInt(e.getAttribute("index"),10)}),x=Array.from(h).filter(function(t){return parseInt(t.getAttribute("index"),10)>e.currentPage}),F=R.length&&R||x.length&&x,o=1;o<=I;o++){var T=F&&F[Math.abs(1-o)];T&&(T.classList.remove("e-hide"),T===F[F.length-1]&&(F=null))}}}if((l=s.querySelectorAll('.e-numericitem:not(.e-hide):not([style*="display: none"]):not(.e-np):not(.e-pp)')).length){parseInt(l[l.length-1].getAttribute("index"),10)===this.totalPages&&t.classList(c,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"]),1===parseInt(l[0].getAttribute("index"),10)&&t.classList(u,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"]);var E=Array.from(l).some(function(t){return parseInt(t.getAttribute("index"),10)===e.totalPages}),z=parseInt(l[0].getAttribute("index"),10)-(E?this.avgNumItems:l.length);u.setAttribute("index",z<1?"1":z.toString()),c.setAttribute("index",(parseInt(l[l.length-1].getAttribute("index"),10)+1).toString()),this.avgNumItems=E?this.avgNumItems:l.length}}},to([t.Property(!1)],r.prototype,"enableQueryString",void 0),to([t.Property(!1)],r.prototype,"enableExternalMessage",void 0),to([t.Property(!0)],r.prototype,"enablePagerMessage",void 0),to([t.Property(12)],r.prototype,"pageSize",void 0),to([t.Property(10)],r.prototype,"pageCount",void 0),to([t.Property(1)],r.prototype,"currentPage",void 0),to([t.Property()],r.prototype,"totalRecordsCount",void 0),to([t.Property()],r.prototype,"externalMessage",void 0),to([t.Property(!1)],r.prototype,"pageSizes",void 0),to([t.Property()],r.prototype,"template",void 0),to([t.Property("")],r.prototype,"customText",void 0),to([t.Event()],r.prototype,"click",void 0),to([t.Property("")],r.prototype,"cssClass",void 0),to([t.Event()],r.prototype,"dropDownChanged",void 0),to([t.Event()],r.prototype,"created",void 0),r=to([t.NotifyPropertyChanges],r)}(t.Component),io=function(){function e(e){this.pagerModule=e}return e.prototype.getModuleName=function(){return"pagerdropdown"},e.prototype.render=function(){var e=this.pagerModule;this.pagerDropDownDiv=t.createElement("div",{className:"e-pagesizes"});var r=t.createElement("div",{className:"e-pagerdropdown"}),i=t.createElement("div",{className:"e-pagerconstant"}),n=t.createElement("input",{attrs:{type:"text",tabindex:"-1"}});this.pagerCons=t.createElement("span",{className:"e-constant",innerHTML:this.pagerModule.getLocalizedLabel("pagerDropDown")}),r.appendChild(n),i.appendChild(this.pagerCons),this.pagerDropDownDiv.appendChild(r),this.pagerDropDownDiv.appendChild(i),this.pagerModule.element.appendChild(this.pagerDropDownDiv);var o=this.pagerModule.pageSizes,a=o.length?this.convertValue(o):[this.pagerModule.getLocalizedLabel("All"),"5","10","12","20"],l=this.pagerModule.pageSize;this.dropDownListObject=new s.DropDownList({dataSource:a,value:l.toString(),change:this.onChange.bind(this),placeholder:this.pagerModule.getLocalizedLabel("pagerDropDown"),cssClass:this.pagerModule.cssClass?"e-alldrop "+this.pagerModule.cssClass:"e-alldrop"}),this.dropDownListObject.appendTo(n),o.length&&(this.dropDownListObject.element.value=this.pagerModule.pageSize.toString()),e.pageSize=l,e.dataBind(),e.trigger("dropDownChanged",{pageSize:l}),this.addEventListener()},e.prototype.onChange=function(e){this.dropDownListObject.value===this.pagerModule.getLocalizedLabel("All")?(this.pagerModule.pageSize=this.pagerModule.totalRecordsCount,this.pagerModule.isAllPage=!0,this.refresh(),e.value=this.pagerModule.pageSize,document.getElementsByClassName("e-popup-open e-alldrop").length&&(document.getElementsByClassName("e-popup-open e-alldrop")[0].style.display="none")):(this.pagerModule.pageSize=parseInt(this.dropDownListObject.value,10),this.pagerModule.isAllPage=!1,this.pagerCons.innerHTML!==this.pagerModule.getLocalizedLabel("pagerDropDown")&&this.refresh()),this.pagerModule.dataBind(),this.pagerModule.trigger("dropDownChanged",{pageSize:this.pagerModule.isAllPage?this.pagerModule.totalRecordsCount:parseInt(this.dropDownListObject.value,10)})},e.prototype.refresh=function(){this.pagerCons&&(this.isPageSizeAll(this.pagerModule.pageSize)?this.pagerCons.innerHTML=this.pagerModule.getLocalizedLabel("pagerAllDropDown"):this.pagerCons.innerHTML=this.pagerModule.getLocalizedLabel("pagerDropDown"))},e.prototype.beforeValueChange=function(e){if("number"==typeof e.newProp.value){var t=e.newProp.value.toString();e.newProp.value=t}},e.prototype.convertValue=function(e){for(var t=e,r=0;r<t.length;r++)t[parseInt(r.toString(),10)]=parseInt(t[parseInt(r.toString(),10)],10)?t[parseInt(r.toString(),10)].toString():""!==this.pagerModule.getLocalizedLabel(t[parseInt(r.toString(),10)])?this.pagerModule.getLocalizedLabel(t[parseInt(r.toString(),10)]):t[parseInt(r.toString(),10)];return t},e.prototype.isPageSizeAll=function(e){return("string"==typeof e&&e!==this.pagerModule.getLocalizedLabel("All")?parseInt(e,10):e)===this.pagerModule.totalRecordsCount||e===this.pagerModule.getLocalizedLabel("All")},e.prototype.setDropDownValue=function(e,t){if(this.dropDownListObject){var r=this.pagerModule.isAllPage;this.pagerModule.isAllPage=this.isPageSizeAll(t),this.pagerModule.checkAll=!(!r||!this.pagerModule.isAllPage),this.dropDownListObject[""+e]=this.pagerModule.isAllPage?this.pagerModule.getLocalizedLabel("All"):t}},e.prototype.addEventListener=function(){this.dropDownListObject.on("beforeValueChange",this.beforeValueChange,this)},e.prototype.removeEventListener=function(){this.dropDownListObject.off("beforeValueChange",this.beforeValueChange)},e.prototype.destroy=function(e){this.dropDownListObject&&!this.dropDownListObject.isDestroyed&&(this.removeEventListener(),this.dropDownListObject.destroy(),t.remove(this.pagerDropDownDiv))},e}(),no=function(){function e(e){this.pagerModule=e}return e.prototype.getModuleName=function(){return"externalMessage"},e.prototype.render=function(){this.element=t.createElement("div",{className:"e-pagerexternalmsg",attrs:{"aria-label":this.pagerModule.getLocalizedLabel("ExternalMsg")}}),this.pagerModule.element.appendChild(this.element),this.refresh()},e.prototype.refresh=function(){this.pagerModule.externalMessage&&this.pagerModule.externalMessage.toString().length?(this.showMessage(),this.element.innerHTML=this.pagerModule.externalMessage):this.hideMessage()},e.prototype.hideMessage=function(){t.isNullOrUndefined(this.element)||(this.element.style.display="none")},e.prototype.showMessage=function(){this.element.style.display=""},e.prototype.destroy=function(){t.remove(this.element)},e}(),oo=function(){function e(e,t){this.isInitialRender=!0,this.isCancel=!1,ro.Inject(no,io),this.parent=e,this.pageSettings=t,this.addEventListener()}return e.prototype.getModuleName=function(){return"pager"},e.prototype.render=function(){var e=this.parent;this.pagerDestroy(),t.isNullOrUndefined(this.parent.pagerTemplate)||(this.pageSettings.template=this.parent.pagerTemplate,this.parent.pageTemplateChange=!0),this.element=this.parent.createElement("div",{className:"e-gridpager"});var r=F({},t.extend({},D(this.pageSettings)),{click:this.clickHandler.bind(this),dropDownChanged:this.onSelect.bind(this),enableRtl:e.enableRtl,locale:e.locale,created:this.addAriaAttr.bind(this)},["parentObj","propName"]);r.cssClass=this.parent.cssClass?this.parent.cssClass:"",this.pagerObj=new ro(r,void 0,this.parent),this.pagerObj.hasParent=!0,this.pagerObj.on("pager-refresh",this.renderReactPagerTemplate,this),this.pagerObj.allowServerDataBinding=!1},e.prototype.onSelect=function(e){this.pageSettings.pageSize=e.pageSize,this.isInitialLoad||(this.pageSettings.currentPage=1)},e.prototype.addAriaAttr=function(){if(!this.pageSettings.template){for(var e=this.parent.createElement("div",{className:"e-numericcontainer"}),t=this.element.querySelector(".e-pagercontainer"),r=document.createDocumentFragment(),i=this.element.querySelector(".e-numericcontainer"),n=i.querySelectorAll("a"),o=0;o<n.length;o++){this.parent.getContentTable()?n[parseInt(o.toString(),10)].setAttribute("aria-owns",this.parent.getContentTable().id):n[parseInt(o.toString(),10)].setAttribute("aria-owns",this.parent.element.getAttribute("id")+"_content_table");var s=this.parent.createElement("div");s.appendChild(n[parseInt(o.toString(),10)]),r.appendChild(s)}e.appendChild(r),t.replaceChild(e,i);for(var a=[".e-mfirst",".e-mprev",".e-first",".e-prev",".e-next",".e-last",".e-mnext",".e-mlast"],l=0;l<a.length;l++){var h=this.element.querySelector(a[parseInt(l.toString(),10)]);this.parent.getContentTable()&&h.setAttribute("aria-owns",this.parent.getContentTable().id)}}},e.prototype.dataReady=function(e){this.updateModel(e)},e.prototype.refresh=function(){this.pagerObj.refresh()},e.prototype.goToPage=function(e){this.pagerObj.goToPage(e)},e.prototype.setPageSize=function(e){this.pagerObj.setPageSize(e)},e.prototype.updateModel=function(e){this.parent.pageSettings.totalRecordsCount=e.count,("add"===e.action&&"save"===e.requestType||"batchsave"===e.requestType)&&this.pagerObj.isAllPage&&e.count===this.pageSettings.pageSize&&this.pagerObj.setProperties({pageSize:e.count},!0),this.parent.dataBind()},e.prototype.onActionComplete=function(e){this.parent.trigger(Nt,t.extend(e,{currentPage:this.parent.pageSettings.currentPage,requestType:"paging",type:Nt}))},e.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName()){for(var t=e.properties,r=0,i=Object.keys(t);r<i.length;r++){var n=i[r];this.pagerObj[""+n]=t[""+n]}this.pagerObj.dataBind()}},e.prototype.clickHandler=function(e){var r=this.parent;if(this.isForceCancel||Y(r)&&!r.prevPageMoving&&!this.isCancel)return this.isForceCancel?this.isForceCancel=!1:(t.isNullOrUndefined(e.newProp)||t.isNullOrUndefined(e.newProp.pageSize)?e.currentPage&&(r.notify(Cr,{instance:this,handler:this.goToPage,arg1:e.currentPage}),this.pagerObj.currentPage=r.pageSettings.currentPage===this.pagerObj.currentPage?this.pagerObj.previousPageNo:r.pageSettings.currentPage):(r.notify(Cr,{instance:this,handler:this.setPageSize,arg1:e.newProp.pageSize}),this.pagerObj.pageSize=e.oldProp.pageSize,r.pageSettings.pageSize=e.newProp.pageSize),this.isForceCancel=!0,this.pagerObj.dataBind()),void(e.cancel=!0);r.pageSettings.pageSize=this.pagerObj.pageSize,r.prevPageMoving=!1;var i=this.pageSettings.currentPage,n={cancel:!1,requestType:"paging",previousPage:i,currentPage:e.currentPage,pageSize:r.pageSettings.pageSize,type:Bt};if(this.isCancel||(this.pageSettings.currentPage=e.currentPage,this.parent.notify(er,n)),n.cancel)return e.cancel=!0,this.pageSettings.currentPage=i,this.pagerObj.currentPage=i,void(this.isCancel=!0);this.isCancel=!1,this.parent.requestTypeAction="paging"},e.prototype.keyPressHandler=function(e){e.action in so&&(e.preventDefault(),this.element.querySelector(so[e.action]).click())},e.prototype.updateExternalMessage=function(e){this.pagerObj.enableExternalMessage||(this.pagerObj.enableExternalMessage=!0,this.pagerObj.dataBind()),this.pagerObj.externalMessage=e,this.pagerObj.dataBind()},e.prototype.appendToElement=function(){this.isInitialLoad=!0,this.parent.element.appendChild(this.element),this.parent.setGridPager(this.element),this.pagerObj.isReact=this.parent.isReact,this.pagerObj.isVue=this.parent.isVue,this.pagerObj.appendTo(this.element),this.isInitialLoad=!1},e.prototype.enableAfterRender=function(e){e.module===this.getModuleName()&&e.enable&&(this.render(),this.appendToElement(),this.isReactTemplate()&&(this.pagerObj.updateTotalPages(),this.created()))},e.prototype.addEventListener=function(){this.handlers={load:this.render,end:this.appendToElement,ready:this.dataReady,complete:this.onActionComplete,updateLayout:this.enableAfterRender,inboundChange:this.onPropertyChanged,keyPress:this.keyPressHandler,created:this.created},this.parent.isDestroyed||((this.parent.isReact||this.parent.isVue)&&this.parent.addEventListener("created",this.handlers.created.bind(this)),this.evtHandlers=[{event:Kt,handler:this.handlers.load},{event:Qt,handler:this.handlers.end},{event:Xt,handler:this.handlers.ready},{event:"paging-complete",handler:this.handlers.complete},{event:Jt,handler:this.handlers.updateLayout},{event:$t,handler:this.handlers.inboundChange},{event:sr,handler:this.handlers.keyPress},{event:lr,handler:this.destroy}],Ze(this.parent,this.evtHandlers,!0,this))},e.prototype.created=function(){this.isInitialRender&&this.isReactTemplate()&&(this.isInitialRender=!1,this.renderReactPagerTemplate())},e.prototype.isReactTemplate=function(){return(this.parent.isReact||this.parent.isVue)&&this.pagerObj.template&&"string"!=typeof this.pagerObj.template},e.prototype.renderReactPagerTemplate=function(){if(!this.isInitialRender&&this.isReactTemplate()){var e=void 0;this.parent.destroyTemplate(["pagerTemplate"]),this.element.classList.add("e-pagertemplate"),this.pagerObj.compile(this.pagerObj.template);var t=this.parent.pageSettings,r={currentPage:t.currentPage,pageSize:t.pageSize,pageCount:t.pageCount,totalRecordsCount:t.totalRecordsCount,totalPages:this.pagerObj.totalPages},i=this.parent.id+"_pagertemplate";this.parent.isReact?(this.pagerObj.templateFn(r,this.parent,"pagerTemplate",i,null,null,this.pagerObj.element),this.parent.renderTemplates()):(e=this.pagerObj.templateFn(r,this.parent,"pagerTemplate"),q(this.pagerObj.element,e))}},e.prototype.removeEventListener=function(){this.parent.isDestroyed||((this.parent.isReact||this.parent.isVue)&&this.parent.removeEventListener("created",this.handlers.created),this.parent.off("pager-refresh",this.renderReactPagerTemplate),Ze(this.parent,this.evtHandlers,!1))},e.prototype.destroy=function(){this.removeEventListener(),this.isReactTemplate()&&this.parent.destroyTemplate(["pagerTemplate"]),this.pagerObj.destroy()},e.prototype.pagerDestroy=function(){this.pagerObj&&!this.pagerObj.isDestroyed&&(this.pagerObj.destroy(),t.remove(this.element))},e}(),so={pageUp:".e-prev",pageDown:".e-next",ctrlAltPageDown:".e-last",ctrlAltPageUp:".e-first",altPageUp:".e-pp",altPageDown:".e-np"},ao=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),lo=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-filterbarcell"}),t}return ao(r,e),r.prototype.getGui=function(){return this.parent.createElement("div")},r.prototype.render=function(e,r){var i,n=this.parent.element.querySelector(".e-filterbar"),s=this.element.cloneNode(),a=this.getGui(),l=e.column;if(n.appendChild(s),s.setAttribute("e-mappinguid",l.uid),l.filterTemplate){var h={};r&&(h[l.field]=r[l.field]);if(h.column=l,l.visible){var p=this.parent.isReact&&"string"!=typeof l.filterTemplate,d=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,c=this.parent.element.id+l.uid+"filterTemplate";p||d?(l.getFilterTemplate()(h,this.parent,"filterTemplate",c,null,null,s),this.parent.renderTemplates()):q(s,l.getFilterTemplate()(h,this.parent,"filterTemplate",c))}else s.classList.add("e-hide")}else if("checkbox"!==l.type){if(!t.isNullOrUndefined(l.allowFiltering)&&!l.allowFiltering||t.isNullOrUndefined(l.filterBarTemplate)){t.attributes(a,{class:"e-filterdiv e-fltrinputdiv"}),i=this.parent.createElement("input",{id:l.field+"_filterBarcell",className:"e-filtertext",attrs:{type:"search",title:l.headerText+e.attributes.title,value:r[e.column.field]?r[e.column.field]:"",role:"search"}}),a.appendChild(i);u={element:i,floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0,cssClass:this.parent.cssClass}};o.Input.createInput(u,this.parent.createElement)}else if(s.classList.add("e-fltrtemp"),t.attributes(a,{class:"e-fltrtempdiv"}),t.isNullOrUndefined(l.filterBarTemplate.create))i=this.parent.createElement("input",{id:l.field+"_filterBarcell",className:"e-filterUi_input e-filtertext e-fltrTemp",attrs:{type:"search",title:l.headerText}}),a.appendChild(i);else{var u={column:l,node:Element},g=l.filterBarTemplate.create;if("string"==typeof g&&(g=t.getValue(g,window)),"string"==typeof(i=g(u))){var f=this.parent.createElement("div");f.innerHTML=i,i=f.firstChild}t.attributes(a,{class:"e-filterUi_input e-filtertext e-fltrTemp",title:l.headerText,id:l.field+"_filterBarcell"}),a.appendChild(i)}(!1===l.allowFiltering||""===l.field||t.isNullOrUndefined(l.field))&&(i.setAttribute("disabled","true"),i.classList.add("e-disable"));var m=a.querySelector(".e-clear-icon");if(m&&m.setAttribute("title",this.parent.localeObj.getConstant("ClearButton")),l.visible||s.classList.add("e-hide"),this.appendHtml(s,a),this.parent.filterSettings.showFilterBarOperator&&"FilterBar"===this.parent.filterSettings.type&&!this.parent.isPrinting&&t.isNullOrUndefined(l.filterTemplate)&&t.isNullOrUndefined(l.filterBarTemplate)&&this.operatorIconRender(a,l,e),(t.isNullOrUndefined(l.allowFiltering)||l.allowFiltering)&&!t.isNullOrUndefined(l.filterBarTemplate)){var y=l.filterBarTemplate.write,u={element:i,column:l};"string"==typeof y&&(y=t.getValue(y,window)),y.call(this,u)}}return s},r.prototype.appendHtml=function(e,t){return e.appendChild(t),e},r.prototype.operatorIconRender=function(e,r,i){var n,o=this.parent,a=this.parent.createElement("input",{className:" e-filterbaroperator e-icons e-icon-filter",id:i.column.uid});if(e.querySelector("span").appendChild(a),r.filter&&r.filter.operator)n=r.filter.operator;else if(o.filterSettings.columns.length)for(var l=0,h=o.filterSettings.columns;l<h.length;l++){var p=h[parseInt(l.toString(),10)];n=p.field===r.field?p.operator:"equal"}else n="equal";t.isNullOrUndefined(o.filterModule.operators[r.field])||(n=o.filterModule.operators[r.field]),this.dropOptr=new s.DropDownList({fields:{text:"text",value:"value"},popupHeight:"auto",value:n,width:"0px",enabled:r.allowFiltering,popupWidth:"auto",enableRtl:this.parent.enableRtl,change:this.internalEvent.bind(this),beforeOpen:function(){var e=o.filterModule.customOperators;this.dataSource=e[o.getColumnByUid(this.element.id).type+"Operator"];for(var i=0;i<this.dataSource.length;i++)r.filter&&r.filter.operator&&t.isNullOrUndefined(o.filterModule.operators[r.field])&&this.dataSource[parseInt(i.toString(),10)].value===r.filter.operator&&(this.value=r.filter.operator)},cssClass:this.parent.cssClass?"e-popup-flbar "+this.parent.cssClass:"e-popup-flbar"}),this.dropOptr.appendTo(a);var d=t.closest(this.dropOptr.element,"span");d.classList.add("e-filterbardropdown"),d.removeAttribute("tabindex")},r.prototype.internalEvent=function(e){var t=this.parent,r=t.getColumnByUid(e.element.getAttribute("id"));e.column=r,t.filterModule.operators[r.field]=e.value,t.notify("get-filterbar-operator",e)},r}(xi),ho=function(){function e(e,t,r,i){this.ddOpen=this.dropDownOpen.bind(this),this.parent=e,this.serviceLocator=r,this.filterSettings=i,this.customFilterOperators=t,this.parent&&(this.parent.on(Ir,this.destroyDropDownList,this),this.parent.on(lr,this.destroyDropDownList,this))}return e.prototype.renderOperatorUI=function(e,r,i,n,o){this.dialogObj=n;var a=i.type+"Operator";this.optrData=this.customOptr=t.isNullOrUndefined(o)?t.isNullOrUndefined(this.parent.filterSettings.operators)||t.isNullOrUndefined(this.parent.filterSettings.operators[""+a])?this.customFilterOperators[""+a]:this.parent.filterSettings.operators[""+a]:o;var l=this.customOptr,h=this.dropSelectedVal(i,a),p=this.parent.createElement("div",{className:"e-flm_optrdiv"});e.appendChild(p);var d=this.parent.createElement("input",{id:i.uid+"-floptr"});p.appendChild(d),this.dropOptr=new s.DropDownList({dataSource:l,fields:{text:"text",value:"value"},cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",enableRtl:this.parent.enableRtl,text:h,change:function(){var e=document.querySelector(".e-flmenu-valuediv").querySelector("input");"isempty"===this.value||"isnotempty"===this.value||"isnull"===this.value||"isnotnull"===this.value?e.ej2_instances[0].enabled=!1:t.isNullOrUndefined(e.getAttribute("disabled"))||(e.ej2_instances[0].enabled=!0)}}),this.dropOptr.addEventListener(pi,this.ddOpen),this.dropOptr.appendTo("#"+i.uid+"-floptr")},e.prototype.renderResponsiveDropDownList=function(e){e.popup.element.style.width="100%"},e.prototype.dropDownOpen=function(e){e.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString(),this.parent.enableAdaptiveUI&&this.renderResponsiveDropDownList(e)},e.prototype.dropSelectedVal=function(e,i){for(var n="",o=0,s=this.parent.filterSettings.columns;o<s.length;o++){var a=s[o];if(e.field===a.field||e.isForeignColumn()&&e.foreignKeyValue===a.field){var l=new r.DataManager(this.optrData).executeLocal((new r.Query).where("value","equal",a.operator));n=t.isNullOrUndefined(l[0])?"":l[0].text}}if(""===n)if(e.filter.operator)for(var h=Object.keys(this.optrData).length,p=0;p<h;p++)this.optrData[parseInt(p.toString(),10)].value===e.filter.operator&&(n=this.optrData[parseInt(p.toString(),10)].text);else n=this.optrData[0].text;return n},e.prototype.getFlOperator=function(){return this.dropOptr.value},e.prototype.destroyDropDownList=function(){this.dropOptr.isDestroyed||(this.dropOptr.removeEventListener(pi,this.ddOpen),this.dropOptr.destroy(),this.parent.off(Ir,this.destroyDropDownList),this.parent.off(lr,this.destroyDropDownList))},e}(),po=function(){function e(e,t,r){this.parent=e,this.serLocator=t,this.filterSettings=r,this.parent&&(this.parent.on(Ir,this.destroy,this),this.parent.on(lr,this.destroy,this))}return e.prototype.create=function(e){this.instance=this.parent.createElement("input",{className:"e-flmenu-input",id:"strui-"+e.column.uid}),e.target.appendChild(this.instance),this.dialogObj=e.dialogObj,this.processDataOperation(e)},e.prototype.processDataOperation=function(e){var t=this;if(e.column.isForeignColumn())return void this.parent.getDataModule().dataManager.executeQuery(this.parent.getDataModule().generateQuery(!0)).then(function(r){t.getAutoCompleteOptions(e,r)});this.getAutoCompleteOptions(e)},e.prototype.getAutoCompleteOptions=function(e,i){var n,o=e.column.isForeignColumn();if(o){for(var a=Qn.getDistinct(i.result,e.column.field).records||[],l=void 0,h=0;h<a.length;h++)l=l?l.or(e.column.field,"contains",a[parseInt(h.toString(),10)][e.column.field],this.parent.filterSettings.enableCaseSensitivity,this.parent.filterSettings.ignoreAccent):new r.Predicate(e.column.field,"contains",a[parseInt(h.toString(),10)][e.column.field],this.parent.filterSettings.enableCaseSensitivity,this.parent.filterSettings.ignoreAccent);(n=(new r.Query).where(l)).params=this.parent.query.params}var p=o?e.column.dataSource:this.parent.dataSource,d={value:o?e.column.foreignKeyValue:e.column.field},c=new s.AutoComplete(t.extend({dataSource:p instanceof r.DataManager?p:new r.DataManager(p),fields:d,locale:this.parent.locale,enableRtl:this.parent.enableRtl,query:o?n:this.parent.getDataModule().generateQuery(!0,!0),sortOrder:"Ascending",cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",autofill:!0,placeholder:e.localizeText.getConstant("EnterValue"),actionBegin:function(){if(this.query.queries.length&&"onWhere"===this.query.queries[0].fn&&this.query.queries[0].e&&this.query.queries[0].e.predicates){for(var e=0;e<this.query.queries[0].e.predicates.length;e++)this.properties.fields.value===this.query.queries[0].e.predicates[""+e].field&&(this.query.queries[0].e.predicates.splice(e,1),e-=1);this.query.queries[0].e.predicates.length||this.query.queries.splice(0,1)}}},e.column.filter.params));if(this.acFocus=this.focus(c,e),this.acComplete=this.actionComplete(c),this.acOpen=this.openPopup.bind(this),c.addEventListener("focus",this.acFocus),c.addEventListener(pi,this.acOpen),c.addEventListener(Nt,this.acComplete),p&&"result"in p){var u=Me({requestType:"stringfilterrequest"},this.parent.getQuery?this.parent.getQuery().clone():new r.Query);this.parent.trigger("dataStateChange",u.state),u.deffered.promise.then(function(e){c.dataSource=new r.DataManager(e)})}this.actObj=c,this.actObj.appendTo(this.instance),o&&this.parent.filterModule.filterModule.afterRenderFilterUI()},e.prototype.write=function(e){""===e.filteredValue||t.isNullOrUndefined(e.filteredValue)||(document.querySelector("#strui-"+e.column.uid).ej2_instances[0].value=e.filteredValue)},e.prototype.read=function(e,r,i,n){var o=document.querySelector("#strui-"+r.uid).ej2_instances[0];t.Browser.isDevice&&(o.hidePopup(),o.focusOut());var s=o.value;(t.isNullOrUndefined(s)||""===s)&&(s=null),n.filterByColumn(r.field,i,s,"and",this.parent.filterSettings.enableCaseSensitivity)},e.prototype.openPopup=function(e){re(e,this.dialogObj)},e.prototype.focus=function(e,t){return function(){e.filterType=t.getOptrInstance.getFlOperator()}},e.prototype.actionComplete=function(e){return function(r){r.result=r.result.filter(function(r,i,n){return n.map(function(r){return t.getValue(e.fields.value,r)}).indexOf(t.getValue(e.fields.value,r))===i})}},e.prototype.destroy=function(){this.actObj&&!this.actObj.isDestroyed&&(this.actObj.removeEventListener("focus",this.acFocus),this.actObj.removeEventListener(pi,this.acOpen),this.actObj.removeEventListener(Nt,this.acComplete),this.actObj.destroy(),this.parent.off(Ir,this.destroy),this.parent.off(lr,this.destroy))},e}(),co=function(){function e(e,t,r){this.filterSettings=r,this.parent=e,this.serviceLocator=t,this.parent&&(this.parent.on(Ir,this.destroy,this),this.parent.on(lr,this.destroy,this))}return e.prototype.keyEventHandler=function(e){if(13===e.keyCode||9===e.keyCode){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),this.dispatchEvent(t)}},e.prototype.create=function(e){this.instance=this.parent.createElement("input",{className:"e-flmenu-input",id:"numberui-"+e.column.uid}),e.target.appendChild(this.instance),this.numericTxtObj=new o.NumericTextBox(t.extend({format:"string"==typeof e.column.format||t.isUndefined(e.column.format)?e.column.format:e.column.format.format,locale:this.parent.locale,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:e.localizeText.getConstant("EnterValue"),enableRtl:this.parent.enableRtl},e.column.filter.params)),this.numericTxtObj.appendTo(this.instance)},e.prototype.write=function(e){var t=document.querySelector("#numberui-"+e.column.uid).ej2_instances[0];t.element.addEventListener("keydown",this.keyEventHandler),t.value=e.filteredValue},e.prototype.read=function(e,t,r,i){var n=document.querySelector("#numberui-"+t.uid).ej2_instances[0].value;i.filterByColumn(t.field,r,n,"and",!0)},e.prototype.destroy=function(){this.numericTxtObj&&!this.numericTxtObj.isDestroyed&&(this.numericTxtObj.destroy(),this.parent.off(Ir,this.destroy),this.parent.off(lr,this.destroy))},e}(),uo=function(){function e(e,t,r){this.parent=e,this.serviceLocator=t,this.filterSettings=r,this.parent&&(this.parent.on(Ir,this.destroy,this),this.parent.on(lr,this.destroy,this))}return e.prototype.create=function(e){var i=e.column.isForeignColumn(),n=i?e.column.dataSource:this.parent.dataSource,o=i?e.column.foreignKeyValue:e.column.field;this.elem=this.parent.createElement("input",{className:"e-flmenu-input",id:"bool-ui-"+e.column.uid}),e.target.appendChild(this.elem),this.dialogObj=e.dialogObj,this.dropInstance=new s.DropDownList(t.extend({dataSource:n instanceof r.DataManager?n:new r.DataManager(n),query:(new r.Query).select(o),fields:{text:o,value:o},placeholder:e.localizeText.getConstant("SelectValue"),cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",locale:this.parent.locale,enableRtl:this.parent.enableRtl},e.column.filter.params)),this.ddOpen=this.openPopup.bind(this),this.ddComplete=this.actionComplete(o),this.dropInstance.addEventListener(pi,this.ddOpen),this.dropInstance.addEventListener(Nt,this.ddComplete),this.dropInstance.appendTo(this.elem)},e.prototype.write=function(e){var r=document.querySelector("#bool-ui-"+e.column.uid).ej2_instances[0];t.isNullOrUndefined(e.filteredValue)||(r.value=e.filteredValue)},e.prototype.read=function(e,t,r,i){var n=document.querySelector("#bool-ui-"+t.uid).ej2_instances[0].value;i.filterByColumn(t.field,r,n,"and",!1)},e.prototype.openPopup=function(e){re(e,this.dialogObj)},e.prototype.actionComplete=function(e){return function(t){t.result=r.DataUtil.distinct(t.result,e,!0)}},e.prototype.destroy=function(){this.dropInstance&&!this.dropInstance.isDestroyed&&(this.dropInstance.removeEventListener(pi,this.ddOpen),this.dropInstance.removeEventListener(Nt,this.ddComplete),this.dropInstance.destroy(),this.parent.off(Ir,this.destroy),this.parent.off(lr,this.destroy))},e}(),go=function(){function e(e,t,r){this.dpOpen=this.openPopup.bind(this),this.parent=e,this.locator=t,this.fltrSettings=r,this.parent&&(this.parent.on(Ir,this.destroy,this),this.parent.on(lr,this.destroy,this))}return e.prototype.create=function(e){var r=fe(e.column.format,e.column.type);this.dialogObj=e.dialogObj,this.inputElem=this.parent.createElement("input",{className:"e-flmenu-input",id:"dateui-"+e.column.uid}),e.target.appendChild(this.inputElem),"date"===e.column.type||"dateonly"===e.column.type?this.datePickerObj=new a.DatePicker(t.extend({format:r,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:e.localizeText.getConstant("ChooseDate"),width:"100%",locale:this.parent.locale,enableRtl:this.parent.enableRtl},e.column.filter.params)):"datetime"===e.column.type&&(this.datePickerObj=new a.DateTimePicker(t.extend({format:r,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:e.localizeText.getConstant("ChooseDate"),width:"100%",locale:this.parent.locale,enableRtl:this.parent.enableRtl},e.column.filter.params))),this.datePickerObj.addEventListener(pi,this.dpOpen),this.datePickerObj.appendTo(this.inputElem)},e.prototype.write=function(e){document.querySelector("#dateui-"+e.column.uid).ej2_instances[0].value=t.isNullOrUndefined(e.filteredValue)?null:new Date(e.filteredValue)},e.prototype.read=function(e,r,i,n){var o=document.querySelector("#dateui-"+r.uid).ej2_instances[0].value;o=t.isNullOrUndefined(o)?null:o,n.filterByColumn(r.field,i,o,"and",!0)},e.prototype.openPopup=function(e){e.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()},e.prototype.destroy=function(){this.parent.off(Ir,this.destroy),this.parent.off(lr,this.destroy),t.isNullOrUndefined(this.datePickerObj)||this.datePickerObj.isDestroyed||(this.datePickerObj.removeEventListener(pi,this.dpOpen),this.datePickerObj.destroy())},e}(),fo=function(){function e(e,t,r,i,n){this.isDialogOpen=!1,this.maxHeight="350px",this.isMenuCheck=!1,this.colTypes={string:po,number:co,date:go,dateonly:go,boolean:uo,datetime:go},this.parent=e,this.filterSettings=t,this.serviceLocator=r,this.customFilterOperators=i,this.filterObj=n,this.flMuiObj=new ho(this.parent,this.customFilterOperators,this.serviceLocator),this.l10n=this.serviceLocator.getService("localization"),this.menuFilterBase=new Qn(e)}return e.prototype.clearCustomFilter=function(e){this.clearBtnClick(e)},e.prototype.applyCustomFilter=function(e){this.filterBtnClick(e.col)},e.prototype.openDialog=function(e){this.options=e,this.col=this.parent.getColumnByField(e.field),(t.isNullOrUndefined(this.col.filter)||t.isNullOrUndefined(this.col.filter.type)||"Menu"===this.col.filter.type)&&this.renderDlgContent(e.target,this.col)},e.prototype.closeDialog=function(e){if(this.dlgObj){(this.parent.isReact||this.parent.isVue)&&nt(this.parent,["filterTemplate"]);var r=document.getElementById(this.dlgObj.element.id);if(this.dlgObj&&!this.dlgObj.isDestroyed&&r){var i={cancel:!1,column:this.col,target:e,element:r};if(this.parent.notify(Ir,i),i.cancel)return;this.isDialogOpen=!1,this.isMenuCheck&&(this.menuFilterBase.unWireEvents(),this.parent.off(Er,this.actionComplete),this.isMenuCheck=!1),this.dlgObj.destroy(),t.remove(r)}this.parent.notify("filter-dialog-close",{})}},e.prototype.renderDlgContent=function(e,r){var n={requestType:"filterbeforeopen",columnName:r.field,columnType:r.type};n.filterModel=this,this.parent.trigger(Bt,n);var o=this.parent.createElement("div",{className:"e-flmenu-maindiv",id:r.uid+"-flmenu"});this.dlgDiv=this.parent.createElement("div",{className:"e-flmenu",id:r.uid+"-flmdlg"}),this.dlgDiv.setAttribute("aria-label",this.l10n.getConstant("FilterMenuDialogARIA")),this.parent.enableAdaptiveUI?document.querySelector(".e-resfilter > .e-dlg-content > .e-mainfilterdiv").appendChild(this.dlgDiv):this.parent.element.appendChild(this.dlgDiv),this.dlgObj=new i.Dialog({showCloseIcon:!1,closeOnEscape:!1,locale:this.parent.locale,visible:!1,enableRtl:this.parent.enableRtl,created:this.dialogCreated.bind(this,e,r),position:this.parent.element.classList.contains("e-device")?{X:"center",Y:"center"}:{X:"",Y:""},target:this.parent.element.classList.contains("e-device")?document.body:this.parent.element,buttons:[{click:this.filterBtnClick.bind(this,r),buttonModel:{content:this.l10n.getConstant("FilterButton"),isPrimary:!0,cssClass:this.parent.cssClass?"e-flmenu-okbtn "+this.parent.cssClass:"e-flmenu-okbtn"}},{click:this.clearBtnClick.bind(this,r),buttonModel:{content:this.l10n.getConstant("ClearButton"),cssClass:this.parent.cssClass?"e-flmenu-cancelbtn "+this.parent.cssClass:"e-flmenu-cancelbtn"}}],content:o,width:!t.isNullOrUndefined(O(e,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:250,animationSettings:{effect:"None"},cssClass:this.parent.cssClass?"e-filter-popup "+this.parent.cssClass:"e-filter-popup"});this.dlgObj.isStringTemplate=!0,this.renderResponsiveDialog(),this.dlgObj.appendTo(this.dlgDiv)},e.prototype.renderResponsiveDialog=function(){this.parent.enableAdaptiveUI&&(this.dlgObj.position={X:"",Y:""},this.dlgObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-mainfilterdiv"),this.dlgObj.width="100%",this.dlgObj.isModal=!1,this.dlgObj.buttons=[{}])},e.prototype.dialogCreated=function(e,r){!t.Browser.isDevice&&e&&te(e,this.dlgObj),this.currentDialogCreatedColumn=r,this.renderFilterUI(e,r),r.isForeignColumn()&&(t.isNullOrUndefined(r.filter)||t.isNullOrUndefined(r.filter.ui)||t.isNullOrUndefined(r.filter.ui.create))||this.afterRenderFilterUI()},e.prototype.afterRenderFilterUI=function(){var e=this.currentDialogCreatedColumn;e.showColumnMenu&&this.parent.notify("filterDialogCreated",{}),this.parent.enableAdaptiveUI?(this.dlgObj.element.style.left="0px",this.dlgObj.element.style.maxHeight="none"):this.dlgObj.element.style.maxHeight=this.maxHeight,this.dlgObj.show();var r=this.dlgObj.element.querySelector(".e-flm_optrdiv").querySelector("input"),i=this.dlgObj.element.querySelector(".e-flmenu-valuediv").querySelector("input");"Empty"===r.value||"Not Empty"===r.value||"Null"===r.value||"Not Null"===r.value?i.ej2_instances[0].enabled=!1:t.isNullOrUndefined(i&&i.getAttribute("disabled"))||(i.ej2_instances[0].enabled=!0),e.filterTemplate||this.writeMethod(e,this.dlgObj.element.querySelector("#"+e.uid+"-flmenu"));var n={requestType:"filterafteropen",columnName:e.field,columnType:e.type};n.filterModel=this,this.isDialogOpen=!0,this.isMenuCheck||this.parent.trigger(Nt,n)},e.prototype.renderFilterUI=function(e,t){var r=this.dlgObj.element.querySelector(".e-flmenu-maindiv");this.parent.log("column_type_missing",{column:t}),this.renderOperatorUI(r,e,t),this.renderFlValueUI(r,e,t)},e.prototype.renderOperatorUI=function(e,t,r){this.flMuiObj.renderOperatorUI(e,t,r,this.dlgObj,this.filterObj.menuOperator)},e.prototype.renderFlValueUI=function(e,r,i){var n=this.parent.createElement("div",{className:"e-flmenu-valuediv"}),o=this.filterObj;e.appendChild(n);var s=new this.colTypes[i.type](this.parent,this.serviceLocator,this.parent.filterSettings);if(i.filterTemplate){var a={};a[i.field]=a.value=o.values[i.field],i.foreignKeyValue&&(a[i.foreignKeyValue]=o.values[i.field],a[i.field]=void 0);a.column=i;var l=this.parent.isReact&&"string"!=typeof i.filterTemplate,h=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,p=this.parent.element.id+i.uid+"filterTemplate";l||h?(i.getFilterTemplate()(a,this.parent,"filterTemplate",p,null,null,n),this.parent.renderTemplates()):q(n,i.getFilterTemplate()(a,this.parent,"filterTemplate",p)),this.isMenuCheck&&(this.menuFilterBase.cBox=this.dlgObj.element.querySelector(".e-checkboxlist.e-fields"),this.menuFilterBase.wireEvents(),this.parent.on(Er,this.actionComplete,this),this.menuFilterBase.getAllData())}else if(t.isNullOrUndefined(i.filter)||t.isNullOrUndefined(i.filter.ui)||t.isNullOrUndefined(i.filter.ui.create))s.create({column:i,target:n,getOptrInstance:this.flMuiObj,localizeText:this.l10n,dialogObj:this.dlgObj});else{var d=i.filter.ui.create;"string"==typeof d&&(d=t.getValue(d,window)),d({column:i,target:n,getOptrInstance:this.flMuiObj,dialogObj:this.dlgObj})}},e.prototype.writeMethod=function(e,r){for(var i,n=r.querySelector(".e-flmenu-valinput"),o=new this.colTypes[e.type](this.parent,this.serviceLocator,this.parent.filterSettings),s=0,a=this.filterSettings.columns;s<a.length;s++){var l=a[s];e.uid===l.uid&&(i=l.value)}if(t.isNullOrUndefined(e.filter)||t.isNullOrUndefined(e.filter.ui)||t.isNullOrUndefined(e.filter.ui.write))o.write({column:e,target:n,parent:this.parent,filteredValue:i});else{var h=e.filter.ui.write;"string"==typeof h&&(h=t.getValue(h,window)),h({column:e,target:n,parent:this.parent,filteredValue:i})}},e.prototype.filterBtnClick=function(e){var r=this.dlgObj.element.querySelector(".e-flmenu-valuediv input"),i=this.flMuiObj.getFlOperator(),n=new this.colTypes[e.type](this.parent,this.serviceLocator,this.parent.filterSettings);if(e.filterTemplate){var o=this.dlgDiv.querySelector(".e-flmenu-valuediv"),s=void 0;if(o.children[0].value)s=o.children[0].value;else if(t.isNullOrUndefined(o.children[0].ej2_instances)){var a=o.querySelector(".e-control");s="boolean"===e.type?a.checked:t.isNullOrUndefined(a.ej2_instances)?a.value:a.ej2_instances[0].value}else s=(this.parent.isAngular?o.children[0]:o.querySelector("input")).ej2_instances[0].value;this.filterObj.filterByColumn(e.field,i,s)}else if(t.isNullOrUndefined(e.filter)||t.isNullOrUndefined(e.filter.ui)||t.isNullOrUndefined(e.filter.ui.read))n.read(r,e,i,this.filterObj);else{var l=e.filter.ui.read;"string"==typeof l&&(l=t.getValue(l,window)),l({element:r,column:e,operator:i,fltrObj:this.filterObj})}this.closeDialog(),this.parent.showColumnMenu&&this.parent.notify("after-filter-column-menu-close",{})},e.prototype.closeResponsiveDialog=function(){this.closeDialog()},e.prototype.clearBtnClick=function(e){this.filterObj.removeFilteredColsByField(e.field),this.closeDialog();var t=this.parent.showColumnMenu&&e.showColumnMenu?".e-columnmenu":".e-icon-filter",r=this.parent.element.querySelector('[e-mappinguid="'+e.uid+'"]').parentElement.querySelector(t);r&&r.classList.remove("e-filtered")},e.prototype.destroy=function(){this.closeDialog()},e.prototype.getFilterUIInfo=function(){return{field:this.col.field,operator:this.flMuiObj.getFlOperator()}},e.prototype.renderCheckBoxMenu=function(){return this.isMenuCheck=!0,this.menuFilterBase.updateModel(this.options),this.menuFilterBase.getAndSetChkElem(this.options),this.dlgObj.buttons=[{click:this.menuFilterBase.btnClick.bind(this.menuFilterBase),buttonModel:{content:this.menuFilterBase.getLocalizedLabel("FilterButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.menuFilterBase.btnClick.bind(this.menuFilterBase),buttonModel:{cssClass:"e-flat",content:this.menuFilterBase.getLocalizedLabel("ClearButton")}}],this.menuFilterBase.dialogObj=this.dlgObj,this.menuFilterBase.dlg=this.dlgObj.element,this.menuFilterBase.dlg.classList.add("e-menucheckbox"),this.menuFilterBase.dlg.classList.remove("e-checkboxfilter"),this.maxHeight="800px",this.menuFilterBase.sBox.innerHTML},e.prototype.actionComplete=function(e){this.isMenuCheck&&this.parent.trigger(Nt,e)},e}(),mo=function(){function e(e,t,r){this.parent=e,this.isresetFocus=!0,this.checkBoxBase=new Qn(e),this.addEventListener()}return e.prototype.destroy=function(){this.removeEventListener(),this.checkBoxBase.closeDialog()},e.prototype.openDialog=function(e){this.checkBoxBase.openDialog(e),this.parent.log("column_type_missing",{column:e.column})},e.prototype.closeDialog=function(){this.destroy(),this.isresetFocus&&this.parent.notify("restore-Focus",{})},e.prototype.closeResponsiveDialog=function(){this.checkBoxBase.closeDialog()},e.prototype.getModuleName=function(){return"checkboxFilter"},e.prototype.actionBegin=function(e){this.parent.trigger(Bt,e)},e.prototype.actionComplete=function(e){this.parent.trigger(Nt,e)},e.prototype.actionPrevent=function(e){Y(this.parent)&&(this.parent.notify(Cr,e),e.cancel=!0)},e.prototype.clearCustomFilter=function(e){this.checkBoxBase.clearFilter(e)},e.prototype.applyCustomFilter=function(){this.checkBoxBase.fltrBtnHandler(),this.checkBoxBase.closeDialog()},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on("cbox-filter-begin",this.actionBegin,this),this.parent.on(Er,this.actionComplete,this),this.parent.on(zr,this.actionPrevent,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("cbox-filter-begin",this.actionBegin),this.parent.off(Er,this.actionComplete),this.parent.off(zr,this.actionPrevent))},e}(),yo=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),vo=function(e){function t(t,r,i,n){var o=e.call(this,t,r,i)||this;return o.parent=t,o.isresetFocus=!0,o.excelFilterBase=new Yn(t,n),o}return yo(t,e),t.prototype.destroy=function(){this.excelFilterBase.closeDialog()},t.prototype.openDialog=function(e){this.excelFilterBase.openDialog(e)},t.prototype.closeDialog=function(){this.excelFilterBase.closeDialog(),this.isresetFocus&&this.parent.notify("restore-Focus",{})},t.prototype.clearCustomFilter=function(e){this.excelFilterBase.clearFilter(e)},t.prototype.closeResponsiveDialog=function(e){e?this.excelFilterBase.removeDialog():this.closeDialog()},t.prototype.applyCustomFilter=function(e){e.isCustomFilter?this.excelFilterBase.filterBtnClick(e.col.field):(this.excelFilterBase.fltrBtnHandler(),this.excelFilterBase.closeDialog())},t.prototype.filterByColumn=function(e,t,r,i,n,o,s,a){this.excelFilterBase.filterByColumn(e,t,r,i,n,o,s,a)},t.prototype.getFilterUIInfo=function(){return this.excelFilterBase.getFilterUIInfo()},t.prototype.getModuleName=function(){return"excelFilter"},t}(mo),Co=function(){function i(e,t,r){this.predicate="and",this.contentRefresh=!0,this.filterByMethod=!0,this.refresh=!0,this.values={},this.operators={},this.cellText={},this.nextFlMenuOpen="",this.type={Menu:fo,CheckBox:mo,Excel:vo},this.filterOperators={contains:"contains",endsWith:"endswith",equal:"equal",greaterThan:"greaterthan",greaterThanOrEqual:"greaterthanorequal",lessThan:"lessthan",lessThanOrEqual:"lessthanorequal",notEqual:"notequal",startsWith:"startswith",wildCard:"wildcard",isNull:"isnull",notNull:"notnull",like:"like"},this.fltrDlgDetails={field:"",isOpen:!1},this.skipNumberInput=["="," ","!"],this.skipStringInput=[">","<","="],this.actualPredicate={},this.parent=e,this.filterSettings=t,this.serviceLocator=r,this.addEventListener(),this.setFullScreenDialog()}return i.prototype.render=function(i){if(!(r.DataUtil.getObject("args.isFrozen",i)||this.parent.getFrozenMode()===ri&&r.DataUtil.getObject("args.renderFrozenRightContent",i))){var n=this.parent;if(this.l10n=this.serviceLocator.getService("localization"),this.getLocalizedCustomOperators(),"FilterBar"===this.parent.filterSettings.type&&n.columns.length){var o=this.parent.element.querySelector(".e-filterbar");o&&t.remove(o);var s=new fi(this.serviceLocator,e.CellType.Filter,n);this.serviceLocator.getService("cellRendererFactory").addCellRenderer(e.CellType.Filter,new lo(this.parent,this.serviceLocator)),this.valueFormatter=this.serviceLocator.getService("valueFormatter"),s.element=this.parent.createElement("tr",{className:"e-filterbar"});var a=this.generateRow();a.data=this.values,"Right"===n.getFrozenMode()?n.getFrozenRightHeader().querySelector("thead").appendChild(s.element):this.parent.getHeaderContent().querySelector("thead:not(.e-masked-thead)").appendChild(s.element);var l=this.parent.element.querySelector(".e-rowdragheader");this.element=s.render(a,n.getColumns(),null,null,s.element);var h=this.element.querySelector(".e-detailheadercell");h&&(h.className="e-filterbarcell e-mastercell"),l&&(l.className="e-dragheadercell e-mastercell");var p=[].slice.call(this.element.getElementsByClassName("e-grouptopleftcell"));p.length&&p[p.length-1].classList.add("e-lastgrouptopleftcell"),this.wireEvents(),this.parent.notify(wr,{case:"filter"})}}},i.prototype.showCustomFilter=function(e){this.responsiveDialogRenderer.isCustomDialog=e,this.responsiveDialogRenderer.showResponsiveDialog(this.column)},i.prototype.setFilterModel=function(e){var t=e.filter.type||this.parent.filterSettings.type;this.filterModule=new this.type[""+t](this.parent,this.parent.filterSettings,this.serviceLocator,this.customOperators,this)},i.prototype.destroy=function(){var e=this.parent.element;if(e&&(e.querySelector("."+jr)||e.querySelector("."+Vr))){if(this.filterModule&&this.filterModule.destroy(),this.parent.refreshing||!this.parent.isDestroyed&&this.parent.allowFiltering||(this.filterSettings.columns=[]),this.updateFilterMsg(),this.removeEventListener(),this.unWireEvents(),"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator)for(var r=[].slice.call(this.element.getElementsByClassName("e-filterbaroperator")),i=0;i<r.length;i++)r[parseInt(i.toString(),10)].ej2_instances[0]&&r[parseInt(i.toString(),10)].ej2_instances[0].destroy();if(this.element){this.element.parentElement&&t.remove(this.element);var n=this.parent.getHeaderContent().querySelector(".e-filterbar");this.parent.isFrozenGrid()&&n&&t.remove(n)}}},i.prototype.setFullScreenDialog=function(){this.serviceLocator&&this.serviceLocator.registerAdaptiveService(this,this.parent.enableAdaptiveUI,e.ResponsiveDialogAction.isFilter)},i.prototype.generateRow=function(){var e=new Nr({});return e.cells=this.generateCells(),e},i.prototype.generateCells=function(){var t=[];if(this.parent.allowGrouping)for(var r=0,i=this.parent.groupSettings.columns.length;r<i;r++)t.push(this.generateCell({},e.CellType.HeaderIndent));(this.parent.detailTemplate||this.parent.childGrid)&&t.push(this.generateCell({},e.CellType.DetailHeader)),this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()&&t.push(this.generateCell({},e.CellType.RowDragHIcon));for(var n=0,o=this.parent.getColumns();n<o.length;n++){var s=o[n];t.push(this.generateCell(s))}return"Right"===this.parent.getFrozenMode()&&t.push(this.generateCell({},e.CellType.RowDragHIcon)),t},i.prototype.generateCell=function(t,r){var i={visible:t.visible,isDataCell:!1,rowId:"",column:t,cellType:r||e.CellType.Filter,attributes:{title:this.l10n.getConstant("FilterbarTitle")}};return new qr(i)},i.prototype.updateModel=function(){var e=this.column.isForeignColumn()?this.parent.getColumnByUid(this.column.uid):this.parent.getColumnByField(this.fieldName);this.filterObjIndex=this.getFilteredColsIndexByField(e),this.prevFilterObject=this.filterSettings.columns[this.filterObjIndex];for(var r=Array.isArray(this.value)?this.value:[this.value],i=this.parent.dataSource.adaptor&&this.parent.dataSource.adaptor.getModuleName?this.parent.dataSource.adaptor.getModuleName():void 0,n=0,o=r.length;n<o;n++){var s=e.isForeignColumn()?e.foreignKeyValue:this.fieldName,a="notequal"===this.operator;this.currentFilterObject={field:s,uid:e.uid,isForeignKey:e.isForeignColumn(),operator:this.operator,value:r[parseInt(n.toString(),10)],predicate:this.predicate,matchCase:this.matchCase,ignoreAccent:this.ignoreAccent,actualFilterValue:{},actualOperator:{}};var l=this.getFilteredColsIndexByField(e);if(l>-1&&!Array.isArray(this.value)?this.filterSettings.columns[parseInt(l.toString(),10)]=this.currentFilterObject:this.filterSettings.columns.push(this.currentFilterObject),!this.column.isForeignColumn()&&t.isNullOrUndefined(this.value)&&("equal"===this.operator||"notequal"===this.operator)&&"ODataAdaptor"!==i&&"ODataV4Adaptor"!==i){for(var h=0;h<this.filterSettings.columns.length;h++)this.filterSettings.columns[""+h].field!==s||"equal"!==this.filterSettings.columns[""+h].operator&&"notequal"!==this.filterSettings.columns[""+h].operator||!t.isNullOrUndefined(this.filterSettings.columns[""+h].value)||(this.filterSettings.columns.splice(h,1),h-=1);"string"===e.type&&this.filterSettings.columns.push({field:s,ignoreAccent:this.ignoreAccent,matchCase:this.matchCase,operator:this.operator,predicate:a?"and":"or",value:""}),this.filterSettings.columns.push({field:s,ignoreAccent:this.ignoreAccent,matchCase:this.matchCase,operator:this.operator,predicate:a?"and":"or",value:void 0}),this.filterSettings.columns.push({field:s,ignoreAccent:this.ignoreAccent,matchCase:this.matchCase,operator:this.operator,predicate:a?"and":"or",value:null})}}this.filterSettings.columns=this.filterSettings.columns,this.parent.dataBind()},i.prototype.getFilteredColsIndexByField=function(e){for(var t=this.filterSettings.columns,r=0,i=t.length;r<i;r++)if(t[parseInt(r.toString(),10)].uid===e.uid||e.isForeignColumn()&&this.parent.getColumnByUid(e.uid).field===e.foreignKeyValue)return r;return-1},i.prototype.onActionComplete=function(e){var r=this.isRemove?{requestType:"filtering",type:Nt}:{currentFilterObject:this.currentFilterObject,currentFilteringColumn:t.isNullOrUndefined(this.column)?void 0:this.column.field,columns:this.filterSettings.columns,requestType:"filtering",type:Nt};this.parent.trigger(Nt,t.extend(e,r)),this.isRemove=!1},i.prototype.wireEvents=function(){t.EventHandler.add(this.parent.getHeaderContent(),"keyup",this.keyUpHandlerImmediate,this)},i.prototype.unWireEvents=function(){t.EventHandler.remove(this.parent.getHeaderContent(),"keyup",this.keyUpHandlerImmediate)},i.prototype.enableAfterRender=function(e){e.module===this.getModuleName()&&e.enable&&(this.parent.getHeaderTable().classList.add("e-sortfilter"),this.render())},i.prototype.refreshFilterValue=function(){this.parent.removeEventListener("beforeDataBound",this.refreshFilterValueFn),"FilterBar"===this.filterSettings.type&&this.filterSettings.columns.length&&!this.parent.getCurrentViewRecords().length&&this.initialEnd()},i.prototype.initialEnd=function(){if(this.parent.off(Yt,this.initialEnd),this.parent.getColumns().length&&this.filterSettings.columns.length){var e=this.parent;this.contentRefresh=!1,this.initialLoad=!0;for(var t=0,r=e.filterSettings.columns;t<r.length;t++){var i=r[t];this.filterByColumn(i.field,i.operator,i.value,i.predicate,i.matchCase,i.ignoreAccent,i.actualFilterValue,i.actualOperator)}this.initialLoad=!1,this.updateFilterMsg(),this.contentRefresh=!0}},i.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on("set-fullscreen-dialog",this.setFullScreenDialog,this),this.parent.on(Jt,this.enableAfterRender,this),this.parent.on("filtering-complete",this.onActionComplete,this),this.parent.on($t,this.onPropertyChanged,this),this.parent.on(sr,this.keyUpHandler,this),this.parent.on(pr,this.columnPositionChanged,this),this.parent.on(rr,this.render,this),this.parent.on(Yt,this.initialEnd,this),this.parent.on(Ir,this.filterMenuClose,this),this.docClickHandler=this.clickHandler.bind(this),t.EventHandler.add(document,"click",this.docClickHandler,this),t.EventHandler.add(this.parent.element,"mousedown",this.refreshClearIcon,this),this.parent.on("filterOpen",this.columnMenuFilter,this),this.parent.on(ar,this.filterIconClickHandler,this),this.parent.on("persist-data-changed",this.initialEnd,this),this.parent.on("close-filter-dialog",this.clickHandler,this),this.parent.on(lr,this.destroy,this),this.refreshFilterValueFn=this.refreshFilterValue.bind(this),this.parent.addEventListener("beforeDataBound",this.refreshFilterValueFn))},i.prototype.removeEventListener=function(){t.EventHandler.remove(document,"click",this.docClickHandler),t.EventHandler.remove(this.parent.element,"mousedown",this.refreshClearIcon),this.parent.isDestroyed||(this.parent.off("set-fullscreen-dialog",this.setFullScreenDialog),this.parent.off(Jt,this.enableAfterRender),this.parent.off("filtering-complete",this.onActionComplete),this.parent.off($t,this.onPropertyChanged),this.parent.off(sr,this.keyUpHandler),this.parent.off(pr,this.columnPositionChanged),this.parent.off(rr,this.render),this.parent.off("filterOpen",this.columnMenuFilter),this.parent.off(Ir,this.filterMenuClose),this.parent.off(ar,this.filterIconClickHandler),this.parent.off("close-filter-dialog",this.clickHandler),this.parent.off(lr,this.destroy))},i.prototype.refreshClearIcon=function(e){if(this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type&&e.target.closest("th")&&e.target.closest("th").classList.contains("e-filterbarcell")&&e.target.classList.contains("e-clear-icon")){var t=e.target.previousElementSibling;o.Input.setValue(null,t,"Never",!0),"Immediate"===this.filterSettings.mode&&this.removeFilteredColsByField(t.id.slice(0,-14))}},i.prototype.filterMenuClose=function(){this.fltrDlgDetails.isOpen=!1},i.prototype.filterByColumn=function(e,r,i,n,o,s,a,l){var h,p=this,d=this.parent;if(this.column=d.grabColumnByFieldFromAllCols(e),"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&t.isNullOrUndefined(this.column.filterBarTemplate)&&t.isNullOrUndefined(this.column.filterTemplate)&&(r=this.getOperatorName(e)),"like"===r&&-1===i.indexOf("%")&&(i="%"+i+"%"),this.column){if("FilterBar"===this.filterSettings.type&&(h=d.getHeaderContent().querySelector("[id='"+this.column.field+"_filterBarcell']")),!t.isNullOrUndefined(this.column.allowFiltering)&&!this.column.allowFiltering)return void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:this.column.headerText});if(Y(d))return void d.notify(Cr,{instance:this,handler:this.filterByColumn,arg1:e,arg2:r,arg3:i,arg4:n,arg5:o,arg6:s,arg7:a,arg8:l});if(this.predicate=n||(Array.isArray(i)?"or":"and"),this.value=i,this.matchCase=o||!1,this.ignoreAccent=this.ignoreAccent=t.isNullOrUndefined(s)?this.parent.filterSettings.ignoreAccent:s,this.fieldName=e,this.operator=r,""===(i=t.isNullOrUndefined(i)?i:i.toString())&&(i=null),"number"!==this.column.type&&"date"!==this.column.type||(this.matchCase=!0),d.getColumnHeaderByField(this.column.isForeignColumn()?this.column.field:e).setAttribute("aria-filtered","true"),h&&"FilterBar"===this.filterSettings.type){if(i&&i.length<1||!this.filterByMethod&&this.checkForSkipInput(this.column,i))return this.filterStatusMsg=i&&i.length<1?"":this.l10n.getConstant("InvalidFilterMessage"),void this.updateFilterMsg();h.value!==i&&(h.value=i)}t.isNullOrUndefined(this.column.format)?this.values[this.column.field]=i:(this.applyColumnFormat(i),this.initialLoad&&"FilterBar"===this.filterSettings.type&&(h.value=this.values[this.column.field]));var c={field:this.fieldName,predicate:n,matchCase:o,ignoreAccent:s,operator:this.operator,value:this.value,type:this.column.type};this.parent.filterSettings.columns.filter(function(e){return e.field===p.fieldName}).length>1&&!t.isNullOrUndefined(this.actualPredicate[this.fieldName])?this.actualPredicate[this.fieldName].push(c):this.actualPredicate[this.fieldName]=[c],this.checkAlreadyColFiltered(this.column.field)||this.updateModel()}},i.prototype.applyColumnFormat=function(e){var t=this,r="date"===this.column.type||"datetime"===this.column.type||"dateonly"===this.column.type?new Date(e):parseFloat(e);("date"===this.column.type||"datetime"===this.column.type||"dateonly"===this.column.type)&&e&&Array.isArray(this.value)&&e.split(",").length>1?this.values[this.column.field]=e.split(",").map(function(e){return""===e&&(e=null),t.setFormatForFlColumn(new Date(e),t.column)}):this.values[this.column.field]=this.setFormatForFlColumn(r,this.column)},i.prototype.skipUid=function(e){for(var t=!0,r=Object.keys(e),i=0;i<r.length;i++){var n=Object.keys(e[r[parseInt(i.toString(),10)]]);1===n.length&&"uid"===n[0]&&(t=!1)}return t},i.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName())for(var r=0,i=Object.keys(e.properties);r<i.length;r++){var n=i[r];switch(n){case"columns":var o={currentFilterObject:this.currentFilterObject,currentFilteringColumn:this.column?this.column.field:void 0,action:"filter",columns:this.filterSettings.columns,requestType:"filtering",type:Bt,cancel:!1};if(this.contentRefresh&&this.skipUid(e.properties.columns)){if(this.parent.notify(er,o),o.cancel)return void(t.isNullOrUndefined(this.prevFilterObject)?this.filterSettings.columns.splice(this.filterSettings.columns.length-1,1):this.filterSettings.columns[this.filterObjIndex]=this.prevFilterObject);this.updateFilterIcon(),this.refreshFilterSettings(),this.updateFilterMsg(),this.updateFilter()}break;case"showFilterBarStatus":e.properties[""+n]?this.updateFilterMsg():this.parent.allowPaging&&this.parent.updateExternalMessage("");break;case"showFilterBarOperator":case"type":this.parent.refreshHeader(),this.refreshFilterSettings()}}},i.prototype.refreshFilterSettings=function(){if("FilterBar"===this.filterSettings.type){for(n=0;n<this.filterSettings.columns.length;n++){this.column=this.parent.grabColumnByUidFromAllCols(this.filterSettings.columns[parseInt(n.toString(),10)].uid);var e=this.filterSettings.columns[parseInt(n.toString(),10)].value;if(e=!t.isNullOrUndefined(e)&&e.toString(),t.isNullOrUndefined(this.column.format)){var r=this.filterSettings.columns[parseInt(n.toString(),10)].field;this.values[""+r]=this.filterSettings.columns[parseInt(n.toString(),10)].value}else this.applyColumnFormat(e);(o=this.getFilterBarElement(this.column.field))&&(""===this.cellText[this.filterSettings.columns[parseInt(n.toString(),10)].field]||t.isNullOrUndefined(this.cellText[this.filterSettings.columns[parseInt(n.toString(),10)].field])?o.value=this.filterSettings.columns[parseInt(n.toString(),10)].value:o.value=this.cellText[this.column.field])}if(0===this.filterSettings.columns.length)for(var i=this.parent.getColumns(),n=0;n<i.length;n++){var o=this.getFilterBarElement(i[parseInt(n.toString(),10)].field);o&&""!==o.value&&(o.value="",delete this.values[i[parseInt(n.toString(),10)].field])}}},i.prototype.updateFilterIcon=function(){if(0===this.filterSettings.columns.length&&this.parent.element.querySelector(".e-filtered"))for(var e=[].slice.call(this.parent.element.getElementsByClassName("e-filtered")),t=0,r=e.length;t<r;t++)e[parseInt(t.toString(),10)].removeAttribute("aria-filtered"),e[parseInt(t.toString(),10)].classList.remove("e-filtered")},i.prototype.getFilterBarElement=function(e){var r,i="[id='"+e+"_filterBarcell']";return i&&!t.isNullOrUndefined(this.element)&&(r=this.element.querySelector(i)),r},i.prototype.refreshFilter=function(){this.refreshFilterSettings(),this.updateFilterMsg()},i.prototype.clearFiltering=function(e){var r=this,i=L(this.filterSettings.columns);if(!t.isNullOrUndefined(e))return this.refresh=!1,e.forEach(function(e){r.removeFilteredColsByField(e,!1)}),this.parent.setProperties({filterSettings:{columns:this.filterSettings.columns}},!0),this.parent.renderModule.refresh(),void(this.refresh=!0);if(Y(this.parent))return void this.parent.notify(Cr,{instance:this,handler:this.clearFiltering});for(s=0;s<i.length;s++)i[parseInt(s.toString(),10)].uid=i[parseInt(s.toString(),10)].uid||this.parent.getColumnByField(i[parseInt(s.toString(),10)].field).uid;var n=i.map(function(e){return e.uid}),o=n.filter(function(e,t){return n.indexOf(e)===t});this.refresh=!1;for(var s=0,a=o.length;s<a;s++)this.removeFilteredColsByField(this.parent.getColumnByUid(o[parseInt(s.toString(),10)]).field,!1);if(this.refresh=!0,o.length&&this.parent.renderModule.refresh(),0===this.parent.filterSettings.columns.length&&this.parent.element.querySelector(".e-filtered"))for(var l=[].slice.call(this.parent.element.getElementsByClassName("e-filtered")),s=0,a=l.length;s<a;s++)l[0].removeAttribute("aria-filtered"),l[0].classList.remove("e-filtered");this.isRemove=!0,this.filterStatusMsg="",this.updateFilterMsg()},i.prototype.checkAlreadyColFiltered=function(e){for(var t=0,r=this.filterSettings.columns;t<r.length;t++){var i=r[t];if(i.field===e&&i.value===this.value&&i.operator===this.operator&&i.predicate===this.predicate)return!0}return!1},i.prototype.columnMenuFilter=function(e){this.column=e.col;var r=t.closest(e.target,"#"+e.id);e.isClose&&!r?this.filterModule.closeDialog():r&&this.filterDialogOpen(this.column,e.target)},i.prototype.filterDialogOpen=function(e,t,r,i){this.filterModule&&this.filterModule.closeDialog(),this.setFilterModel(e),this.filterModule.openDialog(this.createOptions(e,t,r,i))},i.prototype.createOptions=function(e,r,i,n){var o=this.parent,s=e.filter.dataSource||o.dataSource&&"result"in o.dataSource?o.dataSource:o.getDataModule().dataManager,a=e.filter.type||this.parent.filterSettings.type;return{type:e.type,field:e.field,displayName:e.headerText,dataSource:s,format:e.format,height:800,columns:o.getColumns(),filteredColumns:o.filterSettings.columns,target:r,dataManager:o.getDataModule().dataManager,formatFn:e.getFormatter(),ignoreAccent:o.filterSettings.ignoreAccent,parserFn:e.getParser(),query:o.query,template:e.getFilterItemTemplate(),hideSearchbox:!t.isNullOrUndefined(e.filter.hideSearchbox)&&e.filter.hideSearchbox,handler:this.filterHandler.bind(this),localizedStrings:o.getLocaleConstants(),position:{X:i,Y:n},column:e,foreignKeyValue:e.foreignKeyValue,actualPredicate:this.actualPredicate,localeObj:o.localeObj,isRemote:o.getDataModule().isRemote(),allowCaseSensitive:this.filterSettings.enableCaseSensitivity,isResponsiveFilter:this.parent.enableAdaptiveUI,operator:this.actualPredicate[e.field]&&"Menu"===a?this.actualPredicate[e.field][0].operator:"equal"}},i.prototype.removeFilteredColsByField=function(e,t){var r,i=this.filterSettings.columns;if(Y(this.parent)){var n={instance:this,handler:this.removeFilteredColsByField,arg1:e,arg2:t};return void this.parent.notify(Cr,n)}for(var o=i.map(function(e){return e.uid}),s=o.filter(function(e,t){return o.indexOf(e)===t}),a=this,l=0,h=s.length;l<h&&"break"!==function(n,o){i[parseInt(n.toString(),10)].uid=i[parseInt(n.toString(),10)].uid||a.parent.getColumnByField(i[parseInt(n.toString(),10)].field).uid;var l=i.length,h=a.parent.grabColumnByUidFromAllCols(s[parseInt(n.toString(),10)]);if(h.field===e||h.field===h.foreignKeyValue&&h.isForeignColumn()){var p=a.filterSettings.columns.filter(function(e){return e.uid===h.uid})[0];if("FilterBar"===a.filterSettings.type&&!t){var d="[id='"+h.field+"_filterBarcell']";(r=a.parent.getHeaderContent().querySelector(d))&&(r.value="",delete a.values[""+e])}for(;l--;)i[parseInt(l.toString(),10)].uid===h.uid&&i.splice(l,1);var c=a.parent.getColumnHeaderByField(h.field);if(c.removeAttribute("aria-filtered"),"FilterBar"!==a.filterSettings.type||a.parent.showColumnMenu){var u=a.parent.showColumnMenu&&h.showColumnMenu?".e-columnmenu":".e-icon-filter";c.querySelector(u).classList.remove("e-filtered")}return a.isRemove=!0,a.actualPredicate[""+e]&&delete a.actualPredicate[""+e],a.values[""+e]&&delete a.values[""+e],a.refresh&&a.parent.notify(er,{requestType:"filtering",type:Bt,currentFilterObject:p,currentFilterColumn:h,action:"clearFilter"}),"break"}}(l);l++);this.updateFilterMsg()},i.prototype.getModuleName=function(){return"filter"},i.prototype.keyUpHandlerImmediate=function(e){13!==e.keyCode&&this.keyUpHandler(e)},i.prototype.keyUpHandler=function(e){var r=this.parent,i=e.target;if(i&&t.matches(i,".e-filterbar input")){var n=t.closest(i,"th.e-filterbarcell");if(this.column=r.getColumnByUid(n.getAttribute("e-mappinguid")),!this.column)return;if("altDownArrow"===e.action&&this.parent.filterSettings.showFilterBarOperator){var o=t.closest(i,"span").querySelector(".e-filterbaroperator");o.ej2_instances[0].showPopup(),o.focus()}"Immediate"!==this.filterSettings.mode&&(13!==e.keyCode||e.target.classList.contains("e-filterbaroperator"))||9===e.keyCode||this.column.filterTemplate||(this.value=i.value.trim(),this.processFilter(e))}if("altDownArrow"===e.action&&"FilterBar"!==this.filterSettings.type){var s=r.focusModule.currentInfo.element;if(s&&s.classList.contains("e-headercell")){var a=r.getColumnByUid(s.firstElementChild.getAttribute("e-mappinguid"));this.openMenuByField(a.field),this.parent.focusModule.clearIndicator()}}"escape"===e.action&&"Menu"===this.filterSettings.type&&this.filterModule&&(this.filterModule.closeDialog(),r.notify("restore-Focus",{}))},i.prototype.updateCrossIcon=function(e){e.value.length&&e.nextElementSibling.classList.remove("e-hide")},i.prototype.updateFilterMsg=function(){if("FilterBar"===this.filterSettings.type){var e=this.parent,r=void 0,i=this.filterSettings.columns,n=void 0;if(!this.filterSettings.showFilterBarStatus)return;if(i.length>0&&this.filterStatusMsg!==this.l10n.getConstant("InvalidFilterMessage")){this.filterStatusMsg="";for(var o=0;o<i.length;o++)if(n=e.grabColumnByUidFromAllCols(i[parseInt(o.toString(),10)].uid)||e.grabColumnByFieldFromAllCols(i[parseInt(o.toString(),10)].field),o&&(this.filterStatusMsg+=" && "),t.isNullOrUndefined(n.format))this.filterStatusMsg+=n.headerText+": "+this.values[n.field];else{var s="date"===n.type||"datetime"===n.type||"dateonly"===n.type?this.valueFormatter.fromView(this.values[n.field],n.getParser(),"dateonly"===n.type?"date":n.type):this.values[n.field];r="date"!==n.type&&"datetime"!==n.type&&"dateonly"!==n.type?this.serviceLocator.getService("valueFormatter").toView(s,n.getParser()).toString():this.setFormatForFlColumn(s,n),this.filterStatusMsg+=n.headerText+": "+r}}e.allowPaging&&e.updateExternalMessage(this.filterStatusMsg),this.filterStatusMsg=""}},i.prototype.setFormatForFlColumn=function(e,t){return this.serviceLocator.getService("valueFormatter").toView(e,t.getFormatter()).toString()},i.prototype.checkForSkipInput=function(e,t){var i;if("number"===e.type)(r.DataUtil.operatorSymbols[""+t]||this.skipNumberInput.indexOf(t)>-1)&&(i=!0);else if("string"===e.type)for(var n=0,o=t;n<o.length;n++){var s=o[n];this.skipStringInput.indexOf(s)>-1&&(i=!0)}return i},i.prototype.processFilter=function(e){this.stopTimer(),this.startTimer(e)},i.prototype.startTimer=function(e){var t=this;this.timer=window.setInterval(function(){t.onTimerTick()},13===e.keyCode?0:this.filterSettings.immediateModeDelay)},i.prototype.stopTimer=function(){window.clearInterval(this.timer)},i.prototype.onTimerTick=function(){var e="[id='"+this.column.field+"_filterBarcell']",r=this.element.querySelector(e);!r&&this.parent.isFrozenGrid()&&(r=this.parent.getHeaderContent().querySelector(e));var i;if(this.cellText[this.column.field]=r.value,this.stopTimer(),t.isNullOrUndefined(this.column.filterBarTemplate))i=JSON.parse(JSON.stringify(r.value));else{var n=this.column.filterBarTemplate.read;"string"==typeof n&&(n=t.getValue(n,window)),t.isNullOrUndefined(n)||(this.value=n.call(this,r))}if(t.isNullOrUndefined(this.value)||""===this.value)return void this.removeFilteredColsByField(this.column.field);this.validateFilterValue(this.value),this.filterByMethod=!1,this.filterByColumn(this.column.field,this.operator,this.value,this.predicate,this.filterSettings.enableCaseSensitivity,this.ignoreAccent),this.filterByMethod=!0,r.value=i,this.updateFilterMsg()},i.prototype.validateFilterValue=function(e){var r,i;switch(this.matchCase=this.filterSettings.enableCaseSensitivity,this.column.type){case"number":this.column.filter.operator?this.operator=this.column.filter.operator:this.operator=this.filterOperators.equal,r=[">","<","=","!"];for(var n=0;n<e.length;n++)if(r.indexOf(e[parseInt(n.toString(),10)])>-1){i=n;break}this.getOperator(e.substring(i)),0!==i&&(this.value=e.substring(0,i)),""!==this.value&&e.length>=1&&(this.value=this.valueFormatter.fromView(this.value,this.column.getParser(),this.column.type)),isNaN(this.value)&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage"));break;case"date":case"datetime":this.operator=this.filterOperators.equal,""===this.value||this.value instanceof Date||(this.getOperator(e),this.value=this.valueFormatter.fromView(this.value,this.column.getParser(),this.column.type),t.isNullOrUndefined(this.value)&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage")));break;case"string":this.matchCase=!1,this.column.filter.operator?this.operator=this.column.filter.operator:-1!==e.indexOf("*")||-1!==e.indexOf("?")||-1!==e.indexOf("%3f")?this.operator=this.filterOperators.wildCard:-1!==e.indexOf("%")?this.operator=this.filterOperators.like:this.operator=this.filterOperators.startsWith;break;case"boolean":"true"===e.toLowerCase()||"1"===e?this.value=!0:"false"===e.toLowerCase()||"0"===e?this.value=!1:e.length&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage")),this.operator=this.filterOperators.equal;break;default:this.column.filter.operator?this.operator=this.column.filter.operator:this.operator=this.filterOperators.equal}},i.prototype.getOperator=function(e){var i=e.charAt(0),n=e.slice(0,2),o=t.extend({"=":this.filterOperators.equal,"!":this.filterOperators.notEqual},r.DataUtil.operatorSymbols);(o.hasOwnProperty(i)||o.hasOwnProperty(n))&&(this.operator=o[""+i],this.value=e.substring(1),this.operator||(this.operator=o[""+n],this.value=e.substring(2))),this.operator!==this.filterOperators.lessThan&&this.operator!==this.filterOperators.greaterThan||"="===this.value.charAt(0)&&(this.operator=this.operator+"orequal",this.value=this.value.substring(1))},i.prototype.columnPositionChanged=function(){this.parent.filterSettings.type},i.prototype.getLocalizedCustomOperators=function(){var e=[{value:"equal",text:this.l10n.getConstant("Equal")},{value:"greaterthan",text:this.l10n.getConstant("GreaterThan")},{value:"greaterthanorequal",text:this.l10n.getConstant("GreaterThanOrEqual")},{value:"lessthan",text:this.l10n.getConstant("LessThan")},{value:"lessthanorequal",text:this.l10n.getConstant("LessThanOrEqual")},{value:"notequal",text:this.l10n.getConstant("NotEqual")},{value:"isnull",text:this.l10n.getConstant("IsNull")},{value:"isnotnull",text:this.l10n.getConstant("NotNull")}];this.customOperators={stringOperator:[{value:"startswith",text:this.l10n.getConstant("StartsWith")},{value:"endswith",text:this.l10n.getConstant("EndsWith")},{value:"contains",text:this.l10n.getConstant("Contains")},{value:"equal",text:this.l10n.getConstant("Equal")},{value:"isempty",text:this.l10n.getConstant("IsEmpty")},{value:"doesnotstartwith",text:this.l10n.getConstant("NotStartsWith")},{value:"doesnotendwith",text:this.l10n.getConstant("NotEndsWith")},{value:"doesnotcontain",text:this.l10n.getConstant("NotContains")},{value:"notequal",text:this.l10n.getConstant("NotEqual")},{value:"isnotempty",text:this.l10n.getConstant("IsNotEmpty")},{value:"like",text:this.l10n.getConstant("Like")}],numberOperator:e,dateOperator:e,datetimeOperator:e,dateonlyOperator:e,booleanOperator:[{value:"equal",text:this.l10n.getConstant("Equal")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}]}},i.prototype.openMenuByField=function(e){var t=this.parent;if(t.enableAdaptiveUI)return void this.showCustomFilter(!1);var r=t.getColumnByField(e),i=t.getColumnHeaderByField(e).querySelector(".e-filtermenudiv");if(i){var n=t.element.getBoundingClientRect(),o=i.getBoundingClientRect();this.filterDialogOpen(r,i,o.right-n.left,o.bottom-n.top)}},i.prototype.filterIconClickHandler=function(e){var t=e.target;if(t.classList.contains("e-filtermenudiv")&&("Menu"===this.parent.filterSettings.type||"CheckBox"===this.parent.filterSettings.type||"Excel"===this.parent.filterSettings.type)){var r=this.parent.getColumnByUid(O(t,"e-headercell").firstElementChild.getAttribute("e-mappinguid"));if(this.column=r,this.fltrDlgDetails.field===r.field&&this.fltrDlgDetails.isOpen)return;this.filterModule&&this.filterModule.closeDialog(),this.fltrDlgDetails={field:r.field,isOpen:!0},this.openMenuByField(r.field)}},i.prototype.clickHandler=function(e){if("FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator){if(O(e.target,"e-filterbarcell")&&e.target.classList.contains("e-input-group-icon")){var r=t.closest(e.target,"div").querySelector(".e-filterbaroperator");r?r.focus():e.target.focus()}if(e.target.classList.contains("e-list-item")){var i=document.querySelector(".e-popup-open").getAttribute("id").replace("_popup","");-1!==i.indexOf("grid-column")&&t.closest(document.getElementById(i),"div").querySelector(".e-filtertext").focus()}}if("Immediate"===this.filterSettings.mode||"Menu"===this.parent.filterSettings.type||"CheckBox"===this.parent.filterSettings.type||"Excel"===this.parent.filterSettings.type){var n=e.target,o=n.classList.contains("e-day"),s=O(this.parent.element,"e-dialog"),a=!1,l=O(n,"e-popup"),h=this.parent.element.classList.contains("e-device")?document.querySelector(".e-filter-popup"):this.parent.element.querySelector(".e-filter-popup");if(s&&l&&(a=s.id===l.id),h&&(O(n,"e-excel-ascending")||O(n,"e-excel-descending"))&&this.filterModule.closeDialog(n),O(n,"e-filter-popup")||n.classList.contains("e-filtermenudiv"))return;!this.filterModule||O(n,"e-popup-wrapper")||t.closest(n,".e-filter-item.e-menu-item")||o||(a&&!O(n,"e-filter-popup")&&!O(n,"e-popup-flmenu")||!l&&h)&&(this.filterModule.isresetFocus=O(n,"e-grid")&&O(n,"e-grid").id===this.parent.element.id,this.filterModule.closeDialog(n))}},i.prototype.filterHandler=function(e){this.actualPredicate[e.field]=e.actualPredicate;for(var t=new r.DataManager(this.filterSettings.columns),i=(new r.Query).where("field",this.filterOperators.equal,e.field),n=t.executeLocal(i),o=0;o<n.length;o++){for(var s=-1,a=0;a<this.filterSettings.columns.length;a++)if(n[parseInt(o.toString(),10)].field===this.filterSettings.columns[parseInt(a.toString(),10)].field){s=a;break}-1!==s&&this.filterSettings.columns.splice(s,1)}this.values[e.field]&&delete this.values[e.field];var l=this.parent.getColumnByField(e.field),h=this.parent.showColumnMenu&&l.showColumnMenu?".e-columnmenu":".e-icon-filter",p=this.parent.getColumnHeaderByField(e.field).querySelector(h);"filtering"===e.action?(this.filterSettings.columns=this.filterSettings.columns.concat(e.filterCollection),this.filterSettings.columns.length&&p&&p.classList.add("e-filtered")):(p&&p.classList.remove("e-filtered"),e.requestType="filtering",this.parent.renderModule.refresh(e)),this.parent.dataBind()},i.prototype.updateFilter=function(){var e=this.filterSettings.columns;this.actualPredicate={};for(var t=0;t<e.length;t++){this.column=this.parent.getColumnByField(e[parseInt(t.toString(),10)].field)||he(e[parseInt(t.toString(),10)].field,this.parent.getForeignKeyColumns());var r=e[parseInt(t.toString(),10)].field;this.parent.getColumnByField(e[parseInt(t.toString(),10)].field)||(r=he(e[parseInt(t.toString(),10)].field,this.parent.getForeignKeyColumns()).field),this.refreshFilterIcon(r,e[parseInt(t.toString(),10)].operator,e[parseInt(t.toString(),10)].value,e[parseInt(t.toString(),10)].type,e[parseInt(t.toString(),10)].predicate,e[parseInt(t.toString(),10)].matchCase,e[parseInt(t.toString(),10)].ignoreAccent,e[parseInt(t.toString(),10)].uid)}},i.prototype.refreshFilterIcon=function(e,t,r,i,n,o,s,a){var l={field:e,predicate:n,matchCase:o,ignoreAccent:s,operator:t,value:r,type:i};this.actualPredicate[""+e]?this.actualPredicate[""+e].push(l):this.actualPredicate[""+e]=[l];var h=a?this.parent.grabColumnByUidFromAllCols(a).field:e;this.addFilteredClass(h)},i.prototype.addFilteredClass=function(e){var t,r=this.parent.getColumnByField(e);this.parent.showColumnMenu&&r.showColumnMenu?t=this.parent.getColumnHeaderByField(e).querySelector(".e-columnmenu"):r&&(t=this.parent.getColumnHeaderByField(e).querySelector(".e-icon-filter")),t&&t.classList.add("e-filtered")},i.prototype.getFilterUIInfo=function(){return this.filterModule?this.filterModule.getFilterUIInfo():{}},i.prototype.getOperatorName=function(e){return document.getElementById(this.parent.getColumnByField(e).uid).ej2_instances[0].value},i.prototype.renderCheckboxOnFilterMenu=function(){return this.filterModule.renderCheckBoxMenu()},i}(),So={root:"e-rhandler",suppress:"e-rsuppress",icon:"e-ricon",helper:"e-rhelper",header:"th.e-headercell",cursor:"e-rcursor"},bo=function(){function r(e){this.tapped=!1,this.isDblClk=!0,this.resizeProcess=!1,this.parent=e,this.parent.isDestroyed||(this.widthService=new en(e),this.addEventListener())}return r.prototype.autoFitColumns=function(e){var t=void 0===e||null===e||e.length<=0?this.parent.getColumns().map(function(e){return e.field}):"string"==typeof e?[e]:e;this.parent.isAutoFitColumns=!0,this.findColumn(t)},r.prototype.autoFit=function(){var e=this.parent.getColumns().filter(function(e){return!0===e.autoFit}).map(function(e){return e.field||e.headerText});e.length>0&&this.autoFitColumns(e),"Auto"===this.parent.resizeSettings.mode&&this.widthService.setWidthToTable()},r.prototype.resizeColumn=function(e,r,i){var n,o,s,a,l,h,p=this.parent,d=0,c=Vr,u=0,g=i||this.parent.getUidByColumnField(e),f=this.parent.getNormalizedColumnIndex(g),m=this.parent.getColumnIndexByField(e),y=p.getFrozenColumns()||p.getFrozenLeftColumnsCount(),v=p.getMovableColumnsCount();if(t.isNullOrUndefined(p.getFooterContent())||(s=p.getFooterContentTable()),p.isFrozenGrid()){var C=p.getColumnByField(e);C.getFreezeTableName()===ni?(n=p.getHeaderTable(),o=p.getContentTable(),a=n.querySelector('[e-mappinguid="'+g+'"]').parentElement.cloneNode(!0),l=o.querySelectorAll("td:nth-child("+(f+1)+")"),s&&(h=s.querySelectorAll("td:nth-child("+(f+1)+")"))):"movable"===C.getFreezeTableName()?(n=p.getHeaderContent().querySelector("."+Kr).children[0],o=p.getContent().querySelector("."+Wr).children[0],a=n.querySelector('[e-mappinguid="'+g+'"]').parentElement.cloneNode(!0),l=o.querySelectorAll("td:nth-child("+(f-y+1)+")"),s&&(h=(s=p.getFooterContent().querySelector(".e-movablefootercontent").children[0]).querySelectorAll("td:nth-child("+(f-y+1)+")"))):C.getFreezeTableName()===ii&&(n=p.getHeaderContent().querySelector(".e-frozen-right-header").children[0],o=p.getContent().querySelector(".e-frozen-right-content").children[0],a=n.querySelector('[e-mappinguid="'+g+'"]').parentElement.cloneNode(!0),l=o.querySelectorAll("td:nth-child("+(f-(y+v)+1)+")"),s&&(h=(s=p.getFooterContent().querySelector(".e-movablefootercontent").children[0]).querySelectorAll("td:nth-child("+(f-(y+v)+1)+")")))}else n=p.getHeaderTable(),o=p.getContentTable(),a=n.querySelector('[e-mappinguid="'+g+'"]').parentElement.cloneNode(!0),l=o.querySelectorAll("td.e-rowcell:nth-child("+(f+1)+"):not(.e-groupcaption):not(.e-detailcell)"),s&&(h=s.querySelectorAll("td:nth-child("+(f+1)+"):not(.e-groupcaption)"));var S=[].slice.call(n.querySelector("tr").getElementsByClassName("e-grouptopleftcell"));if(S.length>0)for(k=0;k<S.length;k++)u+=S[parseInt(k.toString(),10)].offsetWidth;var b=o.querySelector(".e-detailrowcollapse")||o.querySelector(".e-detailrowexpand");(this.parent.detailTemplate||this.parent.childGrid)&&b&&(u+=b.offsetWidth);var w=[a],I=[],R=[];if(s)for(k=0;k<h.length;k++)R[parseInt(k.toString(),10)]=h[parseInt(k.toString(),10)].cloneNode(!0);for(k=0;k<l.length;k++)I[parseInt(k.toString(),10)]=l[parseInt(k.toString(),10)].cloneNode(!0);var x=this.createTable(n,w,"e-gridheader"),F=null,T=null;p.getCurrentViewRecords().length&&(T=this.createTable(o,I,c)),R.length&&(F=this.createTable(s,R,"e-gridfooter"));var E=p.getColumns()[parseInt(m.toString(),10)],z=E.width=t.formatUnit(Math.max(x,T,F)),M=E.maxWidth&&parseFloat(E.maxWidth.toString());if(parseInt(z,10)>M&&(E.width=M),this.widthService.setColumnWidth(p.getColumns()[parseInt(m.toString(),10)]),!1===p.getColumns().some(function(e){return null===e.width||void 0===e.width||e.width.length<=0})){var D=void 0;if(this.parent.isAutoFitColumns&&p.isFrozenGrid()){var O=Be(this.parent);D="frozen-left"===E.freezeTable?O.frozenLeft:"movable"===E.freezeTable?O.movable:O.frozenRight}else D=p.getColumns();for(var k=0;k<D.length;k++)D[parseInt(k.toString(),10)].visible&&(d+=parseFloat(D[parseInt(k.toString(),10)].width))}var A=d+u;d>0&&!p.isFrozenGrid()&&((this.parent.detailTemplate||this.parent.childGrid)&&this.widthService.setColumnWidth(new kt({width:"30px"})),"Auto"===this.parent.resizeSettings.mode&&(A="100%"),n.style.width=t.formatUnit(A),o.style.width=t.formatUnit(A),t.isNullOrUndefined(s)||(s.style.width=t.formatUnit(A))),p.isFrozenGrid()&&(this.parent.isAutoFitColumns&&(n.style.width=t.formatUnit(A),o.style.width=t.formatUnit(A)),this.widthService.refreshFrozenScrollbar());var L=n.offsetWidth;p.getContent().scrollWidth>L?(n.classList.add("e-tableborder"),o.classList.add("e-tableborder")):(n.classList.remove("e-tableborder"),o.classList.remove("e-tableborder")),t.isNullOrUndefined(s)||s.classList.add("e-tableborder")},r.prototype.destroy=function(){var e=this.parent.element;e&&(e.querySelector("."+jr)||e.querySelector("."+Vr))&&(this.widthService=null,this.unwireEvents(),this.removeEventListener())},r.prototype.getModuleName=function(){return"resize"},r.prototype.findColumn=function(e){for(var r=0;r<e.length;r++){var i=e[parseInt(r.toString(),10)],n=this.parent.getColumnIndexByField(i),o=this.parent.getColumns()[parseInt(n.toString(),10)];n>-1&&!t.isNullOrUndefined(o)&&!0===o.visible&&this.resizeColumn(i,n)}this.parent.allowTextWrap&&this.parent.notify(wr,{case:"refreshHeight",isModeChg:!0})},r.prototype.createTable=function(e,t,r){var i=this.parent.createElement("div");i.className=this.parent.element.className,i.style.cssText="display: inline-block;visibility:hidden;position:absolute";var n=this.parent.createElement("div");n.className=r;var o=this.parent.createElement("table",{attrs:{role:"grid"}});o.className=e.className,o.classList.add("e-resizetable"),o.style.cssText="table-layout: auto;width: auto";for(var s=this.parent.createElement("tr"),a=0;a<t.length;a++){var l=s.cloneNode();l.className=e.querySelector("tr").className,l.appendChild(t[parseInt(a.toString(),10)]),o.appendChild(l)}n.appendChild(o),i.appendChild(n),document.body.appendChild(i);var h=o.getBoundingClientRect().width;return document.body.removeChild(i),Math.ceil(h)},r.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(rr,this.refreshHeight,this),this.parent.on(Qt,this.wireEvents,this),this.parent.on(Yt,this.autoFit,this),this.parent.on(Or,this.refreshHeight,this),this.parent.on(lr,this.destroy,this))},r.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(rr,this.refreshHeight),this.parent.off(Qt,this.wireEvents),this.parent.off(Or,this.refreshHeight),this.parent.off(lr,this.destroy))},r.prototype.render=function(){this.unwireEvents(),this.wireEvents(),this.setHandlerHeight()},r.prototype.refreshHeight=function(){if(this.parent.getHeaderTable()){for(var e=this.getResizeHandlers(),t=0;t<e.length;t++)e[parseInt(t.toString(),10)].parentElement.offsetHeight>0&&(e[parseInt(t.toString(),10)].style.height=e[parseInt(t.toString(),10)].parentElement.offsetHeight+"px");this.setHandlerHeight()}},r.prototype.wireEvents=function(){t.EventHandler.add(this.parent.getHeaderContent(),t.Browser.touchStartEvent,this.touchResizeStart,this),t.EventHandler.add(this.parent.getHeaderContent(),"dblclick",this.callAutoFit,this)},r.prototype.unwireEvents=function(){t.EventHandler.remove(this.parent.getHeaderContent(),t.Browser.touchStartEvent,this.touchResizeStart),t.EventHandler.remove(this.parent.getHeaderContent(),"dblclick",this.callAutoFit)},r.prototype.getResizeHandlers=function(){return this.parent.isFrozenGrid()?[].slice.call(this.parent.getHeaderContent().getElementsByClassName(So.root)):[].slice.call(this.parent.getHeaderTable().getElementsByClassName(So.root))},r.prototype.setHandlerHeight=function(){for(var e=[].slice.call(this.parent.getHeaderTable().getElementsByClassName(So.suppress)),t=0;t<e.length;t++)e[parseInt(t.toString(),10)].style.height=e[parseInt(t.toString(),10)].parentElement.offsetHeight+"px"},r.prototype.callAutoFit=function(e){if(e.target.classList.contains("e-rhandler")){var r=this.getTargetColumn(e);if(r.columns)return;this.resizeColumn(r.field,this.parent.getNormalizedColumnIndex(r.uid),r.uid),t.closest(e.target,So.header).classList.add("e-resized")}},r.prototype.touchResizeStart=function(t){if(!e.Global.timer)return e.Global.timer=setTimeout(function(){e.Global.timer=null},300),this.resizeStart(t);clearTimeout(e.Global.timer),e.Global.timer=null,this.callAutoFit(t)},r.prototype.resizeStart=function(e){var r=this;if(e.target.classList.contains("e-rhandler")){if(!this.helper){if(0===this.getScrollBarWidth()){if(this.resizeProcess=!0,this.parent.allowGrouping)for(u=0;u<this.parent.groupSettings.columns.length;u++)this.widthService.setColumnWidth(new kt({width:"30px"}),u);for(var i=0,n=this.refreshColumnWidth();i<n.length;i++){var o=n[i];this.widthService.setColumnWidth(o)}this.widthService.setWidthToTable(),this.resizeProcess=!1}if(this.refreshStackedColumnWidth(),this.element=e.target,this.parent.getVisibleFrozenColumns()){var s=this.parent.getMovableContentTbody(),a=this.parent.getFrozenLeftContentTbody(),l=this.parent.getFrozenRightContentTbody(),h=[].slice.call(s.childNodes),p=[].slice.call(a.childNodes),d=[];this.parent.getFrozenMode()===ri&&l&&(d=[].slice.call(l.childNodes));for(var c=this,u=0;u<h.length;u++)!function(e){Ne(c.parent,function(t,i){r.parent.rowHeight?i[parseInt(e.toString(),10)].style.height=r.parent.rowHeight+"px":i[parseInt(e.toString(),10)].style.removeProperty("height")},[p,h,d])}(u)}this.parentElementWidth=this.parent.element.getBoundingClientRect().width,this.appendHelper(),this.column=this.getTargetColumn(e),this.pageX=this.getPointX(e),this.column.getFreezeTableName()===ii?this.parent.enableRtl?this.minMove=(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0)-parseFloat(t.isNullOrUndefined(this.column.width)?"":this.column.width.toString()):this.minMove=parseFloat(t.isNullOrUndefined(this.column.width)?"":this.column.width.toString())-(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0):this.parent.enableRtl?this.minMove=parseFloat(this.column.width.toString())-(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0):this.minMove=(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0)-parseFloat(t.isNullOrUndefined(this.column.width)?"":this.column.width.toString()),this.minMove+=this.pageX}if(t.Browser.isDevice&&!this.helper.classList.contains(So.icon))this.helper.classList.add(So.icon),t.EventHandler.add(document,t.Browser.touchStartEvent,this.removeHelper,this),t.EventHandler.add(this.helper,t.Browser.touchStartEvent,this.resizeStart,this);else{var g={e:e,column:this.column};this.parent.trigger("resizeStart",g,function(e){if(e.cancel||r.parent.isEdit)return void r.cancelResizeAction();t.EventHandler.add(document,t.Browser.touchEndEvent,r.resizeEnd,r),t.EventHandler.add(r.parent.element,t.Browser.touchMoveEvent,r.resizing,r),r.updateCursor("add")})}}},r.prototype.cancelResizeAction=function(e){e&&(t.EventHandler.remove(this.parent.element,t.Browser.touchMoveEvent,this.resizing),t.EventHandler.remove(document,t.Browser.touchEndEvent,this.resizeEnd),this.updateCursor("remove")),t.Browser.isDevice&&(t.EventHandler.remove(document,t.Browser.touchStartEvent,this.removeHelper),t.EventHandler.remove(this.helper,t.Browser.touchStartEvent,this.resizeStart)),t.detach(this.helper),this.refresh()},r.prototype.getWidth=function(e,t,r){return t&&e<t?t:r&&e>r?r:e},r.prototype.updateResizeEleHeight=function(){for(var e=[].slice.call(this.parent.getHeaderContent().getElementsByClassName("e-rhandler")),t=0;t<e.length;t++)e[parseInt(t.toString(),10)].style.height=this.element.parentElement.offsetHeight+"px"},r.prototype.getColData=function(e,r){return{width:parseFloat(t.isNullOrUndefined(this.widthService.getWidth(e))||"auto"===this.widthService.getWidth(e)?"0":this.widthService.getWidth(e).toString())+r,minWidth:e.minWidth?parseFloat(e.minWidth.toString()):null,maxWidth:e.maxWidth?parseFloat(e.maxWidth.toString()):null}},r.prototype.resizing=function(e){if(!t.isNullOrUndefined(this.column)){var r=0;t.isNullOrUndefined(this.column)&&(r=O(this.element,"th").offsetWidth),this.parent.allowTextWrap&&(this.updateResizeEleHeight(),this.setHelperHeight());var i=this.getPointX(e),n=this.parent.enableRtl?-(i-this.pageX):i-this.pageX;this.column.getFreezeTableName()===ii&&(n=this.parent.enableRtl?i-this.pageX:this.pageX-i);var o=this.getColData(this.column,n);o.width||(o.width=t.closest(this.element,"th").offsetWidth);var s=this.getWidth(o.width,o.minWidth,o.maxWidth);if(this.parent.log("resize_min_max",{column:this.column,width:s}),this.column.getFreezeTableName()===ii&&(this.parent.enableRtl&&this.minMove>=i||!this.parent.enableRtl&&this.minMove<=i)&&(s=this.column.minWidth?parseFloat(this.column.minWidth.toString()):10,this.pageX=i=this.minMove),(this.column.getFreezeTableName()!==ii&&(!this.parent.enableRtl&&this.minMove>=i||this.parent.enableRtl&&this.minMove<=i)||this.column.getFreezeTableName()===ii&&(this.parent.enableRtl&&this.minMove>=i||!this.parent.enableRtl&&this.minMove<=i))&&(s=this.column.minWidth?parseFloat(this.column.minWidth.toString()):10,this.pageX=i=this.minMove),s!==parseFloat(t.isNullOrUndefined(this.column.width)||"auto"===this.column.width?r.toString():this.column.width.toString())){this.pageX=i,this.column.width=t.formatUnit(s);var a={e:e,column:this.column};if(this.parent.trigger("resizing",a),a.cancel)return void this.cancelResizeAction(!0);var l=[this.column],h=[this.column];this.column.columns&&(l=this.getSubColumns(this.column,[]),l=this.calulateColumnsWidth(l,!1,n),h=this.calulateColumnsWidth(l,!0,n)),this.resizeProcess=!0;for(var p=0,d=h;p<d.length;p++){var c=d[p];this.widthService.setColumnWidth(c,null,"resize")}this.resizeProcess=!1,this.updateHelper()}this.isDblClk=!1}},r.prototype.calulateColumnsWidth=function(e,r,i){for(var n=[],o=0,s=e;o<s.length;o++){for(var a=s[o],l=0,h=0;h<e.length;h++)l+=parseFloat(e[parseInt(h.toString(),10)].width.toString());var p=this.getColData(a,parseFloat(a.width)*i/l),d=this.getWidth(p.width,p.minWidth,p.maxWidth);d!==parseFloat(a.width.toString())&&(r&&(a.width=t.formatUnit(d<1?1:d)),n.push(a))}return n},r.prototype.getSubColumns=function(e,t){for(var r=0,i=e.columns;r<i.length;r++){var n=i[r];!1!==n.visible&&n.allowResizing&&(n.columns?this.getSubColumns(n,t):t.push(n))}return t},r.prototype.resizeEnd=function(e){if(this.helper&&!this.parent.isDestroyed){var r=this.parent;t.EventHandler.remove(this.parent.element,t.Browser.touchMoveEvent,this.resizing),t.EventHandler.remove(document,t.Browser.touchEndEvent,this.resizeEnd),this.updateCursor("remove"),t.detach(this.helper);var i={e:e,column:this.column},n=this.parent.getContent().querySelector("."+Yr),o=n.querySelector("."+Wr)?n.querySelector("."+Wr):n;o.scrollHeight>o.clientHeight&&(this.parent.scrollModule.setPadding(),o.style.overflowY="scroll"),this.parent.trigger("resizeStop",i),t.closest(this.element,".e-headercell").classList.add("e-resized"),O(this.element,"e-frozenheader")?this.isFrozenColResized=!0:this.isFrozenColResized=!1,this.parent.isFrozenGrid()&&this.parent.notify(wr,{case:"textwrap"}),this.parent.allowTextWrap&&(this.updateResizeEleHeight(),this.parent.notify("textWrapRefresh",{case:"textwrap"}));var s,a,l,h=r.getFrozenRightColumnsCount();t.isNullOrUndefined(r.getFooterContent())||(l=r.getFooterContentTable()),r.isFrozenGrid()?h>0?(s=r.getHeaderContent().querySelector(".e-frozen-right-header").children[0],a=r.getContent().querySelector(".e-frozen-right-content").children[0]):(s=r.getHeaderContent().querySelector("."+Kr).children[0],a=r.getContent().querySelector("."+Wr).children[0]):(s=r.getHeaderTable(),a=r.getContentTable());var p=s.offsetWidth;r.getContent().scrollWidth>p?t.addClass([s,a],["e-tableborder"]):t.removeClass([s,a],["e-tableborder"]),t.isNullOrUndefined(l)||l.classList.add("e-tableborder"),this.refresh(),this.doubleTapEvent(e),this.isDblClk=!0}},r.prototype.getPointX=function(e){return e.touches&&e.touches.length?e.touches[0].pageX:e.pageX},r.prototype.refreshColumnWidth=function(){for(var e=this.parent.getColumns(),t=0,r=[].slice.apply(this.parent.getHeaderContent().querySelectorAll("th.e-headercell"));t<r.length;t++)for(var i=r[t],n=0,o=e;n<o.length;n++){var s=o[n];if(i.querySelector("[e-mappinguid]")&&i.querySelector("[e-mappinguid]").getAttribute("e-mappinguid")===s.uid&&s.visible){s.width=i.getBoundingClientRect().width;break}}return e},r.prototype.refreshStackedColumnWidth=function(){for(var e=0,t=this.parent.getStackedColumns(this.parent.columns);e<t.length;e++){var r=t[e];r.width=this.getStackedWidth(r,0)}},r.prototype.getStackedWidth=function(e,t){for(var r=0,i=e.columns;r<i.length;r++){var n=i[r];!1!==n.visible&&(n.columns?this.getStackedWidth(n,t):t+=n.width)}return t},r.prototype.getTargetColumn=function(e){var r=t.closest(e.target,So.header),i=(r=r.querySelector(".e-headercelldiv")||r.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid");return this.parent.getColumnByUid(i)},r.prototype.updateCursor=function(e){var t=[].slice.call(this.parent.getHeaderContent().querySelectorAll("th"));t.push(this.parent.element);for(var r=0,i=t;r<i.length;r++)i[r].classList[""+e](So.cursor)},r.prototype.refresh=function(){this.column=null,this.pageX=null,this.element=null,this.helper=null},r.prototype.appendHelper=function(){this.helper=this.parent.createElement("div",{className:So.helper}),this.parent.element.appendChild(this.helper),this.setHelperHeight()},r.prototype.setHelperHeight=function(){var e=this.parent.isFrozenGrid(),r=e?this.parent.getContent().querySelector("."+Yr).offsetHeight:this.parent.getContent().offsetHeight-this.getScrollBarWidth(),i=t.closest(this.element,So.header),n=[].slice.call(this.parent.getHeaderContent().querySelectorAll("tr")),o=this.parent.getFrozenRightColumnsCount();e&&(n=O(i,Kr)?[].slice.call(this.parent.getHeaderContent().querySelector("."+Kr).querySelectorAll("tr")):o&&O(i,"e-frozen-right-header")?[].slice.call(this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelectorAll("tr")):[].slice.call(this.parent.getHeaderContent().querySelector(".e-frozen-left-header").querySelectorAll("tr")));for(var s=n.indexOf(i.parentElement);s<n.length&&s>-1;s++)r+=n[parseInt(s.toString(),10)].offsetHeight;var a=this.calcPos(i);O(i,"e-frozen-right-header")?a.left+=this.parent.enableRtl?i.offsetWidth-2:-1:a.left+=this.parent.enableRtl?-1:i.offsetWidth-2,this.helper.style.cssText="height: "+r+"px; top: "+a.top+"px; left:"+Math.floor(a.left)+"px;",this.parent.enableVirtualization&&this.helper.classList.add("e-virtual-rhandler")},r.prototype.getScrollBarWidth=function(e){var t=this.parent.getContent().firstChild;return t.scrollHeight>t.clientHeight&&e||t.scrollWidth>t.clientWidth?j():0},r.prototype.removeHelper=function(e){var r=e.target.classList;r.contains(So.root)||r.contains(So.icon)||!this.helper||(t.EventHandler.remove(document,t.Browser.touchStartEvent,this.removeHelper),t.EventHandler.remove(this.helper,t.Browser.touchStartEvent,this.resizeStart),t.detach(this.helper),this.refresh())},r.prototype.updateHelper=function(){var e,r=t.closest(this.element,So.header);if((e=O(r,"e-frozen-right-header")?Math.floor(this.calcPos(r).left+(this.parent.enableRtl?r.offsetWidth-2:-1)):Math.floor(this.calcPos(r).left+(this.parent.enableRtl?-1:r.offsetWidth-2)))>this.parentElementWidth&&(e=this.parentElementWidth-2),this.parent.isFrozenGrid()){var i=t.closest(r,"."+Jr).offsetLeft;e<i&&(e=i)}this.helper.style.left=e+"px"},r.prototype.calcPos=function(e){for(var t={top:0,left:0},r=e.getBoundingClientRect(),i=e.ownerDocument,n=O(e,"e-grid")||i.documentElement;n&&(n===i.body||n===i.documentElement)&&"static"===n.style.position;)n=n.parentNode;return n&&n!==e&&1===n.nodeType&&(t=n.getBoundingClientRect()),{top:r.top-t.top,left:r.left-t.left}},r.prototype.doubleTapEvent=function(e){var t=this;this.getUserAgent()&&this.isDblClk&&(this.tapped?(clearTimeout(this.tapped),this.callAutoFit(e),this.tapped=null):this.tapped=setTimeout(function(){t.tapped=null},300))},r.prototype.getUserAgent=function(){var e=t.Browser.userAgent.toLowerCase();return/iphone|ipod|ipad/.test(e)},r.prototype.timeoutHandler=function(){this.tapped=null},r}(),wo=function(){function e(e){this.parent=e,this.parent.isDestroyed||(this.parent.on(gr,this.headerDrop,this),this.parent.on(Jt,this.enableAfterRender,this),this.parent.on(ir,this.onActionComplete,this),this.parent.on(Ut,this.drag,this),this.parent.on(Ht,this.dragStart,this),this.parent.on(ur,this.dragStop,this),this.parent.on(gr,this.headerDrop,this),this.parent.on(rr,this.createReorderElement,this),this.parent.on(sr,this.keyPressHandler,this),this.parent.on(lr,this.destroy,this))}return e.prototype.chkDropPosition=function(e,r){var i=this.parent.getColumnByUid(r.firstElementChild.getAttribute("e-mappinguid")),n=!i||!i.lockColumn;return(e.parentElement.isEqualNode(r.parentElement)||this.parent.enableColumnVirtualization||this.parent.isFrozenGrid()&&Array.prototype.indexOf.call(t.closest(e,"thead").children,e.parentElement)===Array.prototype.indexOf.call(t.closest(r,"thead").children,r.parentElement))&&this.targetParentContainerIndex(e,r)>-1&&n},e.prototype.chkDropAllCols=function(e,t){for(var r,i=this.getHeaderCells();!r&&i.length>0;)r=e!==i.pop()&&this.targetParentContainerIndex(e,t)>-1;return r},e.prototype.findColParent=function(e,t,r){r=r;for(var i=0,n=t.length;i<n;i++){if(e===t[parseInt(i.toString(),10)])return!0;if(t[parseInt(i.toString(),10)].columns){var o=r.length;if(r.push(t[parseInt(i.toString(),10)]),this.findColParent(e,t[parseInt(i.toString(),10)].columns,r))return!0;r.splice(o,r.length-o)}}return!1},e.prototype.getColumnsModel=function(e,r){var i=[],n=[];if(!this.parent.getFrozenColumns()&&this.parent.isFrozenGrid())return this.parent.getColumns();for(var o=0,s=e.length;o<s;o++)t.isNullOrUndefined(e[parseInt(o.toString(),10)])||(e[parseInt(o.toString(),10)].visible?i.push(e[parseInt(o.toString(),10)]):r&&i.push(e[parseInt(o.toString(),10)]),e[parseInt(o.toString(),10)].columns&&(n=n.concat(e[parseInt(o.toString(),10)].columns)));return n.length&&(i=i.concat(this.getColumnsModel(n))),i},e.prototype.headerDrop=function(e){var r=this.parent,i=(this.element.querySelector(".e-headercelldiv")||this.element.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid"),n=r.getColumnByUid(i);if(!t.closest(e.target,"th")||!t.isNullOrUndefined(n)&&(!n.allowReordering||n.lockColumn))return void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:n});var o=t.closest(e.target,".e-headercell"),s=(o.querySelector(".e-headercelldiv")||o.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid");if(!t.isNullOrUndefined(s)){var a=r.getColumnByUid(s);if(t.isNullOrUndefined(a)||!a.allowReordering||a.lockColumn)return void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:n,destColumn:a})}if(o&&this.chkDropPosition(this.element,o)&&this.chkDropAllCols(this.element,o))if(this.parent.enableColumnVirtualization){var l=this.parent.columns,h=this.element.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"),p=null,d=this.parent.columns.filter(function(e){return e.uid===h})[0],c=o.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");l.some(function(e,t){return e.uid===c&&(p=t,e.uid===c)}),t.isNullOrUndefined(p)||this.moveColumns(p,d)}else{var u=this.targetParentContainerIndex(this.element,o),g=this.element.firstElementChild.getAttribute("e-mappinguid");if(this.destElement=o,this.parent.notify("set-reorder-destination-element",{ele:o}),g)this.moveColumns(u,this.parent.getColumnByUid(g));else{var f=this.getHeaderCells(),m=k(this.element,f),l=this.getColumnsModel(this.parent.columns);this.moveColumns(u,l[parseInt(m.toString(),10)])}}},e.prototype.isActionPrevent=function(e){return Y(e)},e.prototype.moveColumns=function(e,t,r,i){var n=this.parent;if(this.isActionPrevent(n))return void n.notify(Cr,{instance:this,handler:this.moveColumns,arg1:e,arg2:t});var o=!n.getFrozenColumns()&&n.isFrozenGrid(),s=this.getColParent(t,this.parent.columns),a=s?s.columns:o?this.parent.getColumns():this.parent.columns,l=A(t,a);if((this.parent.isFrozenGrid()&&s||this.parent.lockcolPositionCount)&&!r&&!this.parent.enableColumnVirtualization){for(p=0;p<a.length;p++)if(a[parseInt(p.toString(),10)].field===t.field){l=p;break}var h=this.parent.getColumnByUid(this.destElement.firstElementChild.getAttribute("e-mappinguid"));if(h){for(p=0;p<a.length;p++)if(a[parseInt(p.toString(),10)].field===h.field){e=p;break}}else for(var p=0;p<a.length;p++)a[parseInt(p.toString(),10)].headerText===this.destElement.innerText.trim()&&(e=p)}if(n.allowReordering&&l!==e&&-1!==l&&-1!==e){a.splice(e,0,a.splice(l,1)[0]);var d={column:t,destIndex:e,columns:a,parent:s,cancel:!1};n.notify("refresh-frozen-columns",d),d.cancel||(n.getColumns(!0),n.notify(pr,{fromIndex:e,toIndex:l}),!1!==i&&n.notify(er,{type:Bt,requestType:"reorder",fromIndex:e,toIndex:l,toColumnUid:t.uid}))}},e.prototype.targetParentContainerIndex=function(e,t){var r=!this.parent.getFrozenColumns()&&this.parent.isFrozenGrid()?this.parent.getColumns():this.parent.columns,i=this.getHeaderCells(),n=this.parent.getStackedColumns(r),o=[];n.length&&(o=this.getAllStackedheaderParentColumns(i));var s=n.length&&o.length?this.getColumnsModel(o):this.getColumnsModel(r,!0),a=this.getColParent(s[k(e,i)],r);return r=a?a.columns:r,A(s[k(t,i)],r)},e.prototype.getAllStackedheaderParentColumns=function(e){for(var t=[],r=0;r<e.length;r++)e[parseInt(r.toString(),10)].classList.contains("e-hide")?(e.splice(r,1),r--):e[parseInt(r.toString(),10)].closest("thead").firstChild===e[parseInt(r.toString(),10)].parentElement&&t.push(this.parent.getColumnByUid(e[parseInt(r.toString(),10)].firstElementChild.getAttribute("e-mappinguid")));return t},e.prototype.getHeaderCells=function(){var e=this.parent.getFrozenColumns();if(e||this.parent.isFrozenGrid()||this.parent.lockcolPositionCount){var t=void 0,r=void 0,i=[],n=[].slice.call(this.parent.getHeaderTable().getElementsByClassName("e-columnheader"));if(e||this.parent.isFrozenGrid()){for(var o=[].slice.call(this.parent.getHeaderContent().querySelector("."+Kr).getElementsByClassName("e-columnheader")),s=0;s<n.length;s++){t=[].slice.call(n[parseInt(s.toString(),10)].getElementsByClassName("e-headercell")),r=[].slice.call(o[parseInt(s.toString(),10)].getElementsByClassName("e-headercell"));for(var a=void 0,l=0;l<t.length;l++){for(d=0;d<r.length;d++)if(r[parseInt(d.toString(),10)].innerText===t[parseInt(l.toString(),10)].innerText&&parseInt(r[parseInt(d.toString(),10)].getAttribute("data-colindex"),10)===parseInt(t[parseInt(l.toString(),10)].getAttribute("data-colindex"),10)){a=!0;break}a||(i=i.concat([t[parseInt(l.toString(),10)]]))}for(d=0;d<r.length;d++)i.push(r[parseInt(d.toString(),10)])}if(this.parent.getFrozenRightColumnsCount())for(var h=[].slice.call(this.parent.getHeaderContent().querySelector(".e-frozen-right-header").getElementsByClassName("e-columnheader")),p=[].slice.call(h[0].getElementsByClassName("e-headercell")),s=0;s<p.length;s++)i.push(p[parseInt(s.toString(),10)])}else for(s=0;s<n.length;s++){r=[].slice.call(n[parseInt(s.toString(),10)].getElementsByClassName("e-headercell"));for(l=0;l<r.length;l++){for(var a=void 0,d=l+1;d<r.length;d++)if(r[parseInt(d.toString(),10)].innerText===r[parseInt(l.toString(),10)].innerText&&parseInt(r[parseInt(d.toString(),10)].getAttribute("data-colindex"),10)===parseInt(r[parseInt(l.toString(),10)].getAttribute("data-colindex"),10)){a=!0;break}a||(i=i.concat([r[parseInt(l.toString(),10)]]))}}return i}return[].slice.call(this.parent.element.getElementsByClassName("e-headercell"))},e.prototype.getColParent=function(e,t){var r=[];return this.findColParent(e,t,r),r[r.length-1]},e.prototype.reorderSingleColumn=function(e,r){var i=this.parent.enableColumnVirtualization?this.parent.columns.filter(function(t){return t.field===e})[0]:this.parent.getColumnByField(e),n=this.parent.enableColumnVirtualization?this.parent.columns.filter(function(e){return e.field===r})[0]:this.parent.getColumnByField(r);if(!t.isNullOrUndefined(i)&&(!i.allowReordering||i.lockColumn)||!t.isNullOrUndefined(n)&&(!n.allowReordering||i.lockColumn))return void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:i,destColumn:n});var o=n,s=this.getColParent(o,this.parent.columns),a=A(o,s?s.columns:this.parent.columns);a>-1&&this.moveColumns(a,i,!0)},e.prototype.reorderMultipleColumns=function(e,r){var i=this.parent.getColumnIndexByField(r),n=this.parent.getColumnByField(r);if(!(i<0)&&(t.isNullOrUndefined(n)||n.allowReordering&&!n.lockColumn)){for(o=0;o<e.length;o++){s=this.parent.getColumnByField(e[parseInt(o.toString(),10)]);if(!t.isNullOrUndefined(s)&&(!s.allowReordering||s.lockColumn))return}for(var o=0;o<e.length;o++){var s=this.parent.getColumnByIndex(i),a=this.getColParent(s,this.parent.columns),l=A(s,a?a.columns:this.parent.columns);l>-1&&this.moveColumns(l,this.parent.getColumnByField(e[parseInt(o.toString(),10)]),!0,!0),this.parent.getColumnIndexByField(e[o+1])>=l&&i++}}},e.prototype.moveTargetColumn=function(e,t){t>-1&&this.moveColumns(t,e,!0)},e.prototype.reorderSingleColumnByTarget=function(e,t){this.moveTargetColumn(this.parent.getColumnByField(e),t)},e.prototype.reorderMultipleColumnByTarget=function(e,t){for(var r=0;r<e.length;r++)this.reorderSingleColumnByTarget(e[parseInt(r.toString(),10)],t)},e.prototype.reorderColumns=function(e,t){"string"==typeof e?(this.reorderSingleColumn(e,t),this.fromCol=e):(this.reorderMultipleColumns(e,t),this.fromCol=e[0])},e.prototype.reorderColumnByIndex=function(e,t){this.moveTargetColumn(this.parent.getColumnByIndex(e),t)},e.prototype.reorderColumnByTargetIndex=function(e,t){"string"==typeof e?this.reorderSingleColumnByTarget(e,t):this.reorderMultipleColumnByTarget(e,t)},e.prototype.enableAfterRender=function(e){e.module===this.getModuleName()&&e.enable&&this.createReorderElement()},e.prototype.createReorderElement=function(e){e&&e.args.isXaxis&&this.setDisplay("none");var t=this.parent.element.querySelector("."+_r);this.upArrow=t.appendChild(this.parent.createElement("div",{className:"e-icons e-icon-reorderuparrow e-reorderuparrow",attrs:{style:"display:none"}})),this.downArrow=t.appendChild(this.parent.createElement("div",{className:"e-icons e-icon-reorderdownarrow e-reorderdownarrow",attrs:{style:"display:none"}}))},e.prototype.onActionComplete=function(e){this.parent.trigger(Nt,t.extend(e,{type:Nt}));var r=this.fromCol&&this.parent.getColumnHeaderByField(this.fromCol);r&&this.parent.focusModule.onClick({target:r},!0)},e.prototype.destroy=function(){var e=this.parent.element;!this.parent.isDestroyed&&e&&(e.querySelector("."+jr)||e.querySelector("."+Vr))&&(this.upArrow.parentNode&&t.remove(this.upArrow),this.downArrow.parentNode&&t.remove(this.downArrow),this.parent.off(gr,this.headerDrop),this.parent.off(Jt,this.enableAfterRender),this.parent.off(ir,this.onActionComplete),this.parent.off(Ut,this.drag),this.parent.off(Ht,this.dragStart),this.parent.off(ur,this.dragStop),this.parent.off(rr,this.createReorderElement),this.parent.off(sr,this.keyPressHandler),this.parent.off(lr,this.destroy))},e.prototype.keyPressHandler=function(e){var t=this.parent;switch(e.action){case"ctrlLeftArrow":case"ctrlRightArrow":var r=t.focusModule.currentInfo.element;if(r&&r.classList.contains("e-headercell")){var i=t.getColumnByUid(r.firstElementChild.getAttribute("e-mappinguid")),n=t.getVisibleColumns(),o=n.indexOf(i),s="ctrlLeftArrow"===e.action?n[o-1]:n[o+1];s&&s.field&&i.field&&this.reorderColumns(i.field,s.field)}}},e.prototype.drag=function(e){var r=this.parent,i=e.target;if(e.column.allowReordering&&!e.column.lockColumn){var n=t.closest(i,".e-headercell:not(.e-stackedHeaderCell)"),o=r.element.querySelector(".e-cloneproperties"),s=r.isFrozenGrid()?r.getMovableVirtualContent():r.getContent().firstElementChild,a=this.x>B(e.event).x+s.scrollLeft;t.removeClass([].slice.call(r.getHeaderTable().getElementsByClassName("e-reorderindicate")),["e-reorderindicate"]),this.setDisplay("none"),this.stopTimer(),t.classList(o,["e-defaultcur"],["e-notallowedcur"]),this.updateScrollPostion(e.event),n&&!n.isEqualNode(this.element)&&(i=n,this.chkDropPosition(this.element,i)&&this.chkDropAllCols(this.element,i)?(this.updateArrowPosition(i,a),t.classList(i,["e-allowDrop","e-reorderindicate"],[])):r.allowGrouping&&O(e.target,"e-groupdroparea")||t.classList(o,["e-notallowedcur"],["e-defaultcur"])),r.trigger(Ut,{target:i,draggableType:"headercell",column:e.column})}},e.prototype.updateScrollPostion=function(e){var t=this,r=B(e).x,i=this.parent.element.getBoundingClientRect(),n=i.right;if(this.parent.isFrozenGrid())this.updateFrozenScrollPosition(r,i);else{var o=i.left,s=this.parent.getContent().firstElementChild;r>o&&r<o+35?this.timer=window.setInterval(function(){t.setScrollLeft(s,!0)},50):r<n&&r>n-35&&(this.timer=window.setInterval(function(){t.setScrollLeft(s,!1)},50))}},e.prototype.updateFrozenScrollPosition=function(e,t){var r=this,i=this.parent.getContent().querySelector("."+Wr),n=this.parent.element.querySelector("."+Kr).getBoundingClientRect(),o=this.parent.getFrozenLeftCount(),s=this.parent.getFrozenRightColumnsCount()?n.right:t.right,a=o?n.left:t.left;e>a&&e<a+35?this.timer=window.setInterval(function(){r.setScrollLeft(i,!0)},50):e<s&&e>s-35&&(this.timer=window.setInterval(function(){r.setScrollLeft(i,!1)},50))},e.prototype.setScrollLeft=function(e,t){var r=e.scrollLeft;e.scrollLeft=e.scrollLeft+(t?-5:5),r!==e.scrollLeft&&this.setDisplay("none")},e.prototype.stopTimer=function(){window.clearInterval(this.timer)},e.prototype.updateArrowPosition=function(e,t){var r=e.getBoundingClientRect(),i=this.parent.element.getBoundingClientRect();if(!(t&&r.left<i.left||!t&&r.right>i.right)){if(this.parent.isFrozenGrid()&&e.classList.contains("e-headercell")){var n=this.parent.getFrozenLeftCount(),o=this.parent.getFrozenRightColumnsCount(),s=this.element.querySelector(".e-headercelldiv"),a=s?this.parent.getColumnByUid(s.getAttribute("data-uid")):null,l=this.parent.getColumnByUid(e.firstElementChild.getAttribute("e-mappinguid")),h=Math.round(this.parent.getFrozenVirtualHeader().getBoundingClientRect().right),p=Math.round(this.parent.getMovableVirtualHeader().getBoundingClientRect().right);if(l){if(n&&!o&&this.parent.getNormalizedColumnIndex(l.uid)>=n&&(t&&Math.round(r.left)<h||!t&&p<r.right))return;if(!n&&o&&a&&a.getFreezeTableName()!==l.getFreezeTableName()&&!t&&Math.round(r.right)<h)return}}var d=this.parent.getHeaderContent().classList.contains("e-sticky");this.upArrow.style.top=d?r.top+r.height+"px":r.top+r.height-i.top+"px",this.downArrow.style.top=d?r.top-7+"px":r.top-i.top-7+"px",this.upArrow.style.left=this.downArrow.style.left=d?(t?r.left:r.right)-4+"px":(t?r.left:r.right)-i.left-4+"px",this.setDisplay("")}},e.prototype.dragStart=function(e){var t=this.parent,r=e.target;if(this.element=r.classList.contains("e-headercell")?r:O(r,"e-headercell"),e.column.allowReordering&&!e.column.lockColumn){var i=t.isFrozenGrid()?t.getMovableVirtualContent():t.getContent().firstElementChild;this.x=B(e.event).x+i.scrollLeft,t.trigger(Ht,{target:r,draggableType:"headercell",column:e.column})}},e.prototype.dragStop=function(e){var r=this.parent;this.setDisplay("none"),this.stopTimer(),e.cancel||r.trigger(jt,{target:e.target,draggableType:"headercell",column:e.column}),t.removeClass([].slice.call(r.getHeaderTable().getElementsByClassName("e-reorderindicate")),["e-reorderindicate"])},e.prototype.setDisplay=function(e){this.upArrow.style.display=e,this.downArrow.style.display=e},e.prototype.getModuleName=function(){return"reorder"},e}(),Io=function(){function e(e){var r=this;this.selectedRows=[],this.isOverflowBorder=!0,this.selectedRowColls=[],this.isRefresh=!0,this.isReplaceDragEle=!0,this.istargetGrid=!1,this.helper=function(e){var i=r.parent,n=r.draggable.currentStateTarget,o=r.parent.createElement("div",{className:"e-cloneproperties e-draganddrop e-grid e-dragclone",styles:'height:"auto", z-index:2, width:'+i.element.offsetWidth}),s=r.parent.createElement("table",{styles:"width:"+i.element.offsetWidth,attrs:{role:"grid"}}),a=r.parent.createElement(li,{attrs:{role:"rowgroup"}});if(document.getElementsByClassName("e-griddragarea").length||i.rowDropSettings.targetID&&(!n.classList.contains("e-selectionbackground")&&"Single"!==i.selectionSettings.type||!O(n,"e-rowcell"))||!i.rowDropSettings.targetID&&!O(n,"e-rowdragdrop"))return!1;i.rowDropSettings.targetID&&"Row"===i.selectionSettings.mode&&"Single"===i.selectionSettings.type&&i.selectRow(parseInt(r.draggable.currentStateTarget.parentElement.getAttribute(si),10)),r.startedRow=t.closest(n,"tr").cloneNode(!0);var l=r.parent.isFrozenGrid();if(l){var h=parseInt(t.closest(n,"tr").getAttribute(si),10);r.startedRow.innerHTML="",r.startedRow.innerHTML+=i.getRowByIndex(h).innerHTML,r.startedRow.innerHTML+=i.getMovableRowByIndex(h).innerHTML,i.getFrozenMode()===ri&&(r.startedRow.innerHTML+=i.getFrozenRightRowByIndex(h).innerHTML)}r.processArgs(n);var p={selectedRow:r.rows,dragelement:n,cloneElement:o,cancel:!1,data:r.rowData},d=i.getSelectedRows();i.trigger(Vt,p);if(p.cancel)return!1;P(r.startedRow,".e-indentcell"),P(r.startedRow,".e-detailrowcollapse"),P(r.startedRow,".e-detailrowexpand"),r.removeCell(r.startedRow,$r);var c=new RegExp("e-active","g");if(r.startedRow.innerHTML=r.startedRow.innerHTML.replace(c,""),a.appendChild(r.startedRow),i.getSelectedRowIndexes().length>1&&r.startedRow.hasAttribute("aria-selected")){var u=i.getFrozenMode()===ri?3:2,g=r.parent.createElement("span",{className:"e-dropitemscount",innerHTML:l?""+d.length/u:""+d.length});o.appendChild(g)}var f=t.closest(n,"tr").querySelector(".e-icon-rowdragicon");return f&&f.classList.add("e-dragstartrow"),s.appendChild(a),o.appendChild(s),i.element.appendChild(o),o},this.dragStart=function(e){var i=r.parent;if(i.enableVirtualization&&i.allowGrouping&&i.groupSettings.columns.length&&!t.isNullOrUndefined(e.target.closest("tr")))for(var n=e.dragElement.querySelectorAll("tr"),o=e.target.closest("tr").querySelectorAll(".e-indentcell"),s=0;s<n.length;s++)for(var a=0;a<o.length;a++){var l=o[parseInt(a.toString(),10)].cloneNode(!0);n[parseInt(s.toString(),10)].insertBefore(l,n[parseInt(s.toString(),10)].firstElementChild)}if(i.element.classList.contains("e-childgrid")&&(r.getParentGrid(i.element).appendChild(e.dragElement),i.element.appendChild(i.createElement("div",{className:"e-drag-ref"}))),document.body.classList.add("e-prevent-select"),!document.getElementsByClassName("e-griddragarea").length){var h=e.target,p=r.parent.element.querySelector(".e-dropitemscount");r.parent.getSelectedRecords().length>1&&p&&(p.style.left=r.parent.element.querySelector(".e-cloneproperties table").offsetWidth-5+"px"),r.processArgs(h),i.trigger(Gt,{rows:r.rows,target:e.target,draggableType:"rows",fromIndex:parseInt(r.rows[0].getAttribute(si),10),data:Object.keys(r.rowData[0]).length>0?r.rowData:r.currentViewData()}),r.dragStartData=r.rowData;var d=document.getElementById(i.rowDropSettings.targetID);i.rowDropSettings.targetID&&d&&d.ej2_instances&&"grid"===d.ej2_instances[0].getModuleName()&&d.ej2_instances[0].getContent().classList.add("e-allowRowDrop")}},this.drag=function(e){var i=r.parent;if(r.isDropGrid=r.parent,r.istargetGrid=!1,r.parent.rowDropSettings.targetID){var n=document.getElementById(i.rowDropSettings.targetID);r.isDropGrid=n.ej2_instances[0],O(e.target,"e-grid")&&(r.istargetGrid=r.parent.rowDropSettings.targetID===O(e.target,"e-grid").id)}var o=r.parent.element.querySelector(".e-cloneproperties");i.element.classList.contains("e-childgrid")&&(o=r.getParentGrid(i.element).querySelector(".e-cloneproperties"));var s=r.getElementFromPosition(o,e.event);t.classList(o,["e-defaultcur"],["e-notallowedcur","e-movecur","e-grabcur"]),r.isOverflowBorder=!0,r.hoverState=i.enableHover;var a=O(s,"e-grid")?t.closest(e.target,"tr"):null;if(e.target){r.processArgs(s);var l={rows:r.rows,target:s,draggableType:"rows",data:r.rowData,originalEvent:e,cancel:!1};if(i.trigger(_t,l),r.stopTimer(),!l.cancel){if(i.element.classList.add("e-rowdrag"),r.dragTarget=a&&(O(s,"e-grid").id===o.parentElement.id||O(s,"e-grid").id)?r.isDropGrid.element.querySelector(".e-emptyrow")?0:parseInt(a.getAttribute("data-rowindex"),10):parseInt(r.startedRow.getAttribute("data-rowindex"),10),i.rowDropSettings.targetID){var h=document.querySelector(".e-drag-ref");!O(s,"e-grid")||O(o.parentElement,"e-grid").id===O(s,"e-grid").id||h&&O(h.parentElement,"e-grid").id===O(s,"e-grid").id?t.classList(o,["e-notallowedcur"],["e-defaultcur"]):t.classList(o,["e-grabcur"],["e-notallowedcur"])}else{var p=O(s,"e-grid");p&&p.id===o.parentElement.id?t.classList(o,["e-movecur"],["e-defaultcur"]):t.classList(o,["e-notallowedcur"],["e-movecur"])}if(O(r.isDropGrid.element,"e-grid")){if((!r.isDropGrid.groupSettings.columns.length||r.isDropGrid.groupSettings.columns.length||e.target.classList.contains("e-selectionbackground"))&&!r.isDropGrid.element.querySelector(".e-emptyrow"))if(O(s,"e-grid")&&O(s,"e-grid").id===r.isDropGrid.element.id&&r.updateScrollPostion(e.event),(r.isOverflowBorder||r.parent.frozenRows>r.dragTarget)&&(parseInt(r.startedRow.getAttribute(si),10)!==r.dragTarget||r.istargetGrid)||r.istargetGrid&&a&&r.isDropGrid.getRowByIndex(r.isDropGrid.getCurrentViewRecords().length-1).getAttribute("data-uid")===a.getAttribute("data-uid"))r.moveDragRows(e,r.startedRow,a);else{var d=void 0;if(r.parent.enableVirtualization)d=a&&parseInt(a.getAttribute(si),10)===r.parent.renderModule.data.dataManager.dataSource.json.length-1;else{var c=r.parent.getRowByIndex(r.parent.getCurrentViewRecords().length-1).getAttribute("data-uid");d=a&&c===a.getAttribute("data-uid")&&c!==r.startedRow.getAttribute("data-uid")}if(d&&!r.parent.rowDropSettings.targetID){var u=r.parent.createElement("div",{className:"e-lastrow-dragborder"}),g=r.parent.getContent();u.style.width=r.parent.element.offsetWidth-r.getScrollWidth()+"px",r.parent.enableVirtualization&&(u.style.zIndex="1"),g.getElementsByClassName("e-lastrow-dragborder").length||!t.isNullOrUndefined(a.nextSibling)&&i.allowGrouping&&i.groupSettings.columns.length||(g.classList.add("e-grid-relative"),g.appendChild(u),u.style.bottom=r.getScrollWidth()+"px")}r.removeBorder(a)}if(s&&s.classList.contains(Yr)&&!r.isDropGrid.element.querySelector(".e-emptyrow")&&r.istargetGrid){r.removeBorder(a);var f=r.isDropGrid.getCurrentViewRecords().length-1,m=".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse",y=[];y=[].slice.call(r.isDropGrid.getRowByIndex(f).querySelectorAll(m)),r.isDropGrid.isFrozenGrid()&&(y=r.borderRowElement(f,m)),y.length>0&&$(y,!0,"e-dragborder")}}}}},this.dragStop=function(e){document.body.classList.remove("e-prevent-select"),Y(r.parent)?r.parent.notify(Cr,{instance:r,handler:r.processDragStop,arg1:e}):r.processDragStop(e)},this.processDragStop=function(e){var i=r.parent;if(!r.parent.isDestroyed){var n=r.getElementFromPosition(e.helper,e.event),o=n&&!n.classList.contains("e-dlg-overlay")?n:e.target;i.element.classList.remove("e-rowdrag");var s=document.getElementById(i.rowDropSettings.targetID);if(i.rowDropSettings.targetID&&s&&s.ej2_instances&&"grid"===s.ej2_instances[0].getModuleName()&&s.ej2_instances[0].getContent().classList.remove("e-allowRowDrop"),O(r.isDropGrid.element,"e-grid")){r.stopTimer(),r.isDropGrid.enableHover=r.hoverState,r.isDropGrid.getContent().classList.remove("e-grid-relative"),r.removeBorder(n);var a=r.isDropGrid.element.querySelector(".e-dragstartrow");a&&a.classList.remove("e-dragstartrow")}r.processArgs(o);var l={target:o,draggableType:"rows",cancel:!1,fromIndex:parseInt(r.rows[0].getAttribute(si),10),dropIndex:r.dragTarget,rows:r.rows,data:Object.keys(r.dragStartData[0]).length>0?r.dragStartData:r.currentViewData()};i.trigger(Wt,l,function(){if(!(O(o,Zr)||O(o,"e-emptyrow")||O(o,Vr))||l.cancel)return r.dragTarget=null,void t.remove(e.helper);r.isRefresh=!1;var n=r.parent.getSelectedRowIndexes();i.isRowDragable()&&(!r.parent.rowDropSettings.targetID&&r.startedRow.querySelector("td.e-selectionbackground")&&n.length>1&&n.length!==r.parent.getCurrentViewRecords().length?r.reorderRows(n,l.dropIndex):r.reorderRows([parseInt(r.startedRow.getAttribute(si),10)],r.dragTarget),r.dragTarget=null,i.rowDropSettings.targetID||(e.helper.classList.contains("e-cloneproperties")&&document.querySelector("."+e.helper.classList[0])&&t.remove(e.helper),!i.enableVirtualization||r.parent.allowGrouping&&i.groupSettings.columns.length?r.rowOrder(l):i.refresh()),r.parent.getContentTable().scrollHeight<r.parent.getContent().clientHeight&&r.parent.scrollModule.setLastRowCell()),r.isRefresh=!0})}},this.removeCell=function(e,t){return[].slice.call(e.querySelectorAll("td")).filter(function(r){r.classList.contains(t)&&e.deleteCell(r.cellIndex)})},this.parent=e,this.parent.isDestroyed||(this.parent.on(Qt,this.initializeDrag,this),this.parent.on(jt,this.columnDrop,this),this.parent.on(nr,this.onActionComplete,this),this.onDataBoundFn=this.onDataBound.bind(this),this.parent.addEventListener(qt,this.onDataBoundFn),this.parent.on(Jt,this.enableAfterRender,this),this.parent.on(lr,this.destroy,this))}return e.prototype.getParentGrid=function(e){for(var t=e,r=!1;!r;)t.ej2_instances[0].parentDetails&&(t=document.getElementById(t.ej2_instances[0].parentDetails.parentID)),t.classList.contains("e-childgrid")||(r=!0);return t},e.prototype.refreshRow=function(e,r,i,n,o,s,a){var l,h,p,d,c=this.parent,u=c.isFrozenGrid(),g=c.getFrozenMode()===ri,f=c.getContentTable().querySelector(li),m=c.getHeaderTable().querySelector(li);u&&(l=c.getMovableHeaderTbody(),h=c.getMovableContentTbody(),g&&(p=c.getFrozenRightHeaderTbody(),d=c.getFrozenRightContentTbody()));for(var y=c.getFrozenMode()===ri?3:2,v=0,C=e.rows.length;v<C;v++)if(u)v%y==0?r.insertBefore(e.rows[parseInt(v.toString(),10)],o):v%y==1?i.insertBefore(e.rows[parseInt(v.toString(),10)],s):n.insertBefore(e.rows[parseInt(v.toString(),10)],a);else{if(c.enableVirtualization&&c.allowGrouping&&c.groupSettings.columns.length&&1===e.rows.length){var S=c.getRowElementByUID(e.rows[parseInt(v.toString(),10)].getAttribute("data-uid"));t.isNullOrUndefined(S)||t.remove(S)}if(r.insertBefore(e.rows[parseInt(v.toString(),10)],o),c.allowGrouping&&c.groupSettings.columns.length){var b=e.rows[parseInt(v.toString(),10)].getAttribute("data-uid"),w=e.target.parentElement.getAttribute("data-uid"),I=c.getRowObjectFromUID(b),R=c.getRowObjectFromUID(w);I.parentUid!==R.parentUid&&c.groupModule.groupReorderHandler(I,R)}}var x,F,T=[].slice.call(r.getElementsByClassName(Zr));if(u&&(x=[].slice.call(i.getElementsByClassName(Zr)),g&&(F=[].slice.call(n.getElementsByClassName(Zr)))),!c.enableVirtualization&&c.allowGrouping&&c.groupSettings.columns.length?(c.groupModule.groupReorderRowObject(e,T),ke(this.parent,c.getRowsObject().filter(function(e){return e.isDataRow}),T),this.parent.notify("refresh-Expand-and-Collapse",{rows:this.parent.getRowsObject()})):c.enableVirtualization&&c.allowGrouping&&c.groupSettings.columns.length?(c.groupModule.groupReorderRowObject(e,T),c.groupModule.vGroupResetRowIndex(),this.parent.notify("refresh-Expand-and-Collapse",{rows:this.parent.vRows})):this.refreshData(T,x,F),this.parent.frozenRows)for(var E=this,v=0,C=T.length;v<C;v++)!function(e,t){e<E.parent.frozenRows?Ke(m,l,p,T,x,F,function(t,r){t.appendChild(r[parseInt(e.toString(),10)])}):Ke(f,h,d,T,x,F,function(t,r){t.appendChild(r[parseInt(e.toString(),10)])})}(v)},e.prototype.updateFrozenRowreOrder=function(e){var t,r,i,n,o=this.parent,s=this.parent.isFrozenGrid(),a=o.getFrozenMode()===ri,l=o.getContentTable().querySelector(li),h=o.getHeaderTable().querySelector(li);s&&(t=o.getMovableHeaderTbody(),r=o.getMovableContentTbody(),a&&(i=o.getFrozenRightHeaderTbody(),n=o.getFrozenRightContentTbody()));var p,d,c=[].slice.call(h.getElementsByClassName(Zr)).concat([].slice.call(l.getElementsByClassName(Zr)));s&&(p=[].slice.call(t.getElementsByClassName(Zr)).concat([].slice.call(r.getElementsByClassName(Zr))),a&&(d=[].slice.call(i.getElementsByClassName(Zr)).concat([].slice.call(n.getElementsByClassName(Zr)))));var u=o.createElement(li,{attrs:{role:"rowgroup"}}),g=o.createElement(li,{attrs:{role:"rowgroup"}}),f=o.createElement(li,{attrs:{role:"rowgroup"}});this.parent.clearSelection();for(var m=this.refreshRowTarget(e),y=0,v=c.length;y<v;y++)u.appendChild(c[parseInt(y.toString(),10)]),s&&(g.appendChild(p[parseInt(y.toString(),10)]),a&&f.appendChild(d[parseInt(y.toString(),10)]));this.refreshRow(e,u,g,f,m.target,m.mTarget,m.frTarget)},e.prototype.refreshRowTarget=function(e){var t,r,i=this.parent,n=parseInt(e.target.parentElement.getAttribute(si),10);i.enableVirtualization&&i.allowGrouping&&i.groupSettings.columns.length&&(n=this.parent.getDataRows().indexOf(e.target.parentElement)),!(e.fromIndex<e.dropIndex||e.fromIndex===e.dropIndex)||i.allowGrouping&&i.groupSettings.columns.length||(n+=1);var o=i.allowGrouping&&i.groupSettings.columns.length&&-1!==n&&e.fromIndex<e.dropIndex?i.getRowByIndex(n).nextSibling:i.getRowByIndex(n);return i.isFrozenGrid()&&(t=i.getMovableRowByIndex(n),i.getFrozenMode()===ri&&(r=i.getFrozenRightRowByIndex(n))),{target:o,mTarget:t,frTarget:r}},e.prototype.updateFrozenColumnreOrder=function(e){var t,r,i=this.parent,n=this.parent.isFrozenGrid(),o=i.getContentTable().querySelector(li);n&&(t=i.getMovableContentTbody(),i.getFrozenMode()===ri&&(r=i.getFrozenRightContentTbody())),this.parent.clearSelection();var s=this.refreshRowTarget(e);this.refreshRow(e,o,t,r,s.target,s.mTarget,s.frTarget)},e.prototype.refreshData=function(e,t,r){for(var i={},n={},o={},s={},a=this.parent.getRowsObject(),l=this.parent.getMovableRowsObject(),h=this.parent.getFrozenRightRowsObject(),p=this.parent.getCurrentViewRecords(),d=0,c=e.length;d<c;d++){var u=parseInt(e[parseInt(d.toString(),10)].getAttribute(si),10);i[parseInt(d.toString(),10)]=a[parseInt(u.toString(),10)],s[parseInt(d.toString(),10)]=p[parseInt(u.toString(),10)],this.parent.isFrozenGrid()&&(n[parseInt(d.toString(),10)]=l[parseInt(u.toString(),10)],r&&(o[parseInt(d.toString(),10)]=h[parseInt(u.toString(),10)]))}var g,f,m=this.parent.getRows();this.parent.isFrozenGrid()&&(g=this.parent.getMovableRows(),r&&(f=this.parent.getFrozenRightRows()));for(var d=0,c=e.length;d<c;d++)m[parseInt(d.toString(),10)]=e[parseInt(d.toString(),10)],a[parseInt(d.toString(),10)]=i[parseInt(d.toString(),10)],p[parseInt(d.toString(),10)]=s[parseInt(d.toString(),10)],this.parent.isFrozenGrid()&&(g[parseInt(d.toString(),10)]=t[parseInt(d.toString(),10)],l[parseInt(d.toString(),10)]=n[parseInt(d.toString(),10)],r&&(f[parseInt(d.toString(),10)]=r[parseInt(d.toString(),10)],h[parseInt(d.toString(),10)]=o[parseInt(d.toString(),10)]));ke(this.parent,a,e),this.parent.isFrozenGrid()&&(ke(this.parent,l,t),r&&ke(this.parent,h,r))},e.prototype.rowOrder=function(e){if(e.dropIndex!==e.fromIndex&&!isNaN(e.dropIndex)){if(this.parent.isDetail()){this.parent.detailCollapseAll();var t=[].slice.call(this.parent.getContentTable().querySelector(li).children),r=this.parent.getRowsObject();t.filter(function(e){e.classList.contains("e-detailrow")&&e.remove()});for(var i=0,n=r.length;i<n&&r[parseInt(i.toString(),10)];i++)r[parseInt(i.toString(),10)].isDetailRow&&(this.parent.getRowsObject().splice(i,1),i--)}if((e.target.classList.contains("e-rowcelldrag")||e.target.classList.contains("e-dtdiagonalright")||e.target.classList.contains("e-dtdiagonaldown"))&&(e.target=e.target.parentElement),!e.target.classList.contains("e-rowcell")&&O(e.target,"e-rowcell")&&(e.target=O(e.target,"e-rowcell")),this.parent.frozenRows?this.updateFrozenRowreOrder(e):this.updateFrozenColumnreOrder(e),this.selectedRowColls.length>0&&(!this.parent.allowGrouping||!this.parent.groupSettings.columns.length)){this.parent.selectRows(this.selectedRowColls);var o=[];if(this.parent.filterSettings.columns.length||this.parent.sortSettings.columns.length){for(var i=0,n=e.rows.length;i<n;i++)o.push(parseInt(e.rows[parseInt(i.toString(),10)].getAttribute(si),10));this.selectedRowColls=o}this.selectedRowColls=[]}}},e.prototype.currentViewData=function(){for(var e=this.parent.getSelectedRowIndexes(),t=[],r=parseInt(this.startedRow.getAttribute(si),10),i=0,n=e.length;i<n;i++){t[parseInt(i.toString(),10)]=this.parent.currentViewData[e[parseInt(i.toString(),10)]]}return this.parent.rowDropSettings.targetID||0!==e.length||(t[0]=this.parent.currentViewData[parseInt(r.toString(),10)]),t},e.prototype.saveChange=function(e,r){var i=this;this.parent.getDataModule().saveChanges(e,this.parent.getPrimaryKeyFieldNames()[0],{},r).then(function(){i.parent.notify(er,{type:Bt,requestType:"rowdraganddrop"})}).catch(function(e){t.isNullOrUndefined(e.error)||t.isNullOrUndefined(e.error.message)||(e.error=e.error.message),i.parent.trigger("actionFailure",e)})},e.prototype.reorderRows=function(e,t){for(var r=this.parent.getSelectedRowIndexes(),i=[],n=[],o=this.parent.renderModule.data.dataManager.dataSource.json,s=this.parent.allowPaging?this.parent.pageSettings.currentPage*this.parent.pageSettings.pageSize-this.parent.pageSettings.pageSize:0,a=t+s,l=e[0]+s,h=0,p=e.length;h<p;h++)n[parseInt(h.toString(),10)]=o[e[parseInt(h.toString(),10)]+s];for(var h=0,p=r.length;h<p;h++)i[parseInt(h.toString(),10)]=o[r[parseInt(h.toString(),10)]+s];for(var h=0,p=n.length;h<p;h++){if(0!==h){for(var d=0,c=o.length;d<c;d++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[parseInt(d.toString(),10)])===JSON.stringify(n[parseInt(h.toString(),10)])){l=d;break}for(var d=0,c=o.length;d<c;d++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[parseInt(d.toString(),10)])===JSON.stringify(n[h-1])){l>d&&(a=d+1);break}}this.reorderRow(l-s,a-s)}this.isRefresh&&this.parent.notify(er,{type:Bt,requestType:"rowdraganddrop"});for(var h=0,p=i.length;h<p;h++)for(var d=0,c=o.length;d<c;d++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[parseInt(d.toString(),10)])===JSON.stringify(i[parseInt(h.toString(),10)])){r[parseInt(h.toString(),10)]=d-s;break}this.selectedRowColls=r},e.prototype.stopTimer=function(){window.clearInterval(this.timer)},e.prototype.onActionComplete=function(e){this.parent.trigger(Nt,t.extend(e,{type:Nt,requestType:"rowdraganddrop"}))},e.prototype.initializeDrag=function(){var e=this.parent;this.draggable=new t.Draggable(e.element,{dragTarget:".e-rowcelldrag, .e-rowdragdrop, .e-rowcell",distance:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop,isReplaceDragEle:this.isReplaceDragEle,isPreventSelect:!1})},e.prototype.updateScrollPostion=function(e){var t=this,r=B(e).y,i=this.isDropGrid.getContent().getBoundingClientRect(),n=this.isDropGrid.getRowHeight()-15,o=this.isDropGrid.getContent().firstElementChild,s=this.parent.enableVirtualization?20:0;if(i.top>=r){var a=-this.isDropGrid.getRowHeight();this.isOverflowBorder=!1,this.timer=window.setInterval(function(){t.setScrollDown(o,a)},200)}else if(i.top+this.isDropGrid.getContent().clientHeight-n-33-s<=r){var l=this.isDropGrid.getRowHeight();this.isOverflowBorder=!1,this.timer=window.setInterval(function(){t.setScrollDown(o,l)},200)}},e.prototype.setScrollDown=function(e,t){e.scrollTop=e.scrollTop+t},e.prototype.moveDragRows=function(e,r,i){var n=this.parent.element.querySelector(".e-cloneproperties");this.parent.element.classList.contains("e-childgrid")&&(n=this.getParentGrid(this.parent.element).querySelector(".e-cloneproperties"));var o=t.closest(e.target,"tr");if(O(o,"e-grid")&&(O(n.parentElement,"e-grid").id===O(o,"e-grid").id||this.istargetGrid)){var s=o||this.startedRow;this.setBorder(s,e.event,r,i)}},e.prototype.setBorder=function(e,r,i,n){var o=this.parent.element;this.istargetGrid&&(o=this.isDropGrid.element);var s=this.parent.element.querySelector(".e-cloneproperties");if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length?this.removeBorder(e):(this.removeFirstRowBorder(e),this.removeLastRowBorder(e)),O(e,"e-grid")&&e.classList.contains(Zr)&&(!this.parent.rowDropSettings.targetID&&O(s.parentElement,"e-grid").id===O(e,"e-grid").id||this.istargetGrid)){t.removeClass(o.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"),["e-dragborder"]);var a=[],l=parseInt(n.getAttribute(si),10);if(n&&0===l)if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length)e=n.previousSibling,a=[].slice.call(e.querySelectorAll(".e-groupcaption,.e-summarycell,.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"));else{var h=this.parent.createElement("div",{className:"e-firstrow-dragborder"}),p=this.isDropGrid.getHeaderContent();p.classList.add("e-grid-relative"),h.style.width=o.offsetWidth-this.getScrollWidth()+"px",p.getElementsByClassName("e-firstrow-dragborder").length||p.appendChild(h)}else this.parent.rowDropSettings.targetID&&n?(e=this.isDropGrid.getRowByIndex(l-1),a=[].slice.call(e.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"))):n&&parseInt(i.getAttribute(si),10)>l?(this.parent.enableVirtualization&&this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&(l=this.parent.getDataRows().indexOf(n)),this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&n.previousSibling.classList.contains("e-groupcaptionrow")?(e=n.previousSibling,a=[].slice.call(e.querySelectorAll(".e-groupcaption,.e-summarycell,.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"))):(e=this.parent.getRowByIndex(l-1),a=[].slice.call(e.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse")))):a=[].slice.call(e.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"));var d=this.parent.isFrozenGrid();if(n&&0!==l&&d){var c=parseInt(e.getAttribute(si),10);a=this.borderRowElement(c,".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse")}a.length>0&&$(a,!0,"e-dragborder")}},e.prototype.borderRowElement=function(e,t){var r=[];return r=[].slice.call(this.isDropGrid.getRowByIndex(e).querySelectorAll(t)).concat([].slice.call(this.isDropGrid.getMovableRowByIndex(e).querySelectorAll(t))),this.isDropGrid.getFrozenMode()===ri&&(r=r.concat([].slice.call(this.isDropGrid.getFrozenRightRowByIndex(e).querySelectorAll(t)))),r},e.prototype.getScrollWidth=function(){var e=this.parent.getContent().firstElementChild;return e.scrollWidth>e.offsetWidth?wn.getScrollBarWidth():0},e.prototype.removeFirstRowBorder=function(e){this.isDropGrid.element.getElementsByClassName("e-firstrow-dragborder").length>0&&e&&0!==e.rowIndex&&t.remove(this.isDropGrid.element.getElementsByClassName("e-firstrow-dragborder")[0])},e.prototype.removeLastRowBorder=function(e){var r;r=this.parent.enableVirtualization?e&&parseInt(e.getAttribute(si),10)!==this.parent.renderModule.data.dataManager.dataSource.json.length-1:e&&this.parent.getRowByIndex(this.parent.getCurrentViewRecords().length-1).getAttribute("data-uid")!==e.getAttribute("data-uid"),this.parent.element.getElementsByClassName("e-lastrow-dragborder").length>0&&e&&r&&t.remove(this.parent.element.getElementsByClassName("e-lastrow-dragborder")[0])},e.prototype.removeBorder=function(e){if(this.removeFirstRowBorder(e),this.parent.rowDropSettings.targetID||this.removeLastRowBorder(e),e=this.parent.allowGrouping&&this.parent.groupSettings.columns.length?[].slice.call(this.isDropGrid.getContentTable().querySelectorAll("tr")).filter(function(e){return e.querySelector("td.e-dragborder")})[0]:(this.isDropGrid.isFrozenGrid()?this.isDropGrid.getMovableRows():this.isDropGrid.getRows()).filter(function(e){return e.querySelector("td.e-dragborder")})[0]){var t=[].slice.call(e.getElementsByClassName("e-dragborder"));if(this.parent.isFrozenGrid()){var r=parseInt(e.getAttribute(si),10);t=this.borderRowElement(r,".e-dragborder")}$(t,!1,"e-dragborder")}},e.prototype.getElementFromPosition=function(e,t){var r=B(t);e.style.display="none";var i=document.elementFromPoint(r.x,r.y);return e.style.display="",i},e.prototype.onDataBound=function(){this.selectedRowColls.length>0&&(this.parent.enableVirtualization||this.parent.allowRowDragAndDrop)&&(this.parent.selectRows(this.selectedRowColls),this.selectedRowColls=[])},e.prototype.getTargetIdx=function(e){return e?parseInt(e.getAttribute(si),10):0},e.prototype.singleRowDrop=function(e){var r=t.closest(e.target,"tr"),i=e.droppedElement.parentElement.ej2_instances[0],n=r?r.rowIndex:i.currentViewData.length-1;this.reorderRow(this.startedRowIndex,n)},e.prototype.columnDrop=function(e){var r=this.parent;if("grouping"!==e.droppedElement.getAttribute("action")&&(O(e.target,Zr)||O(e.target,"e-emptyrow")||O(e.target,Vr))){var i=t.closest(e.target,"tr"),n=void 0,o=void 0,s=document.querySelector(".e-drag-ref");if("true"!==e.droppedElement.querySelector("tr").getAttribute("single-dragrow")&&(e.droppedElement.parentElement.id===r.element.id||s&&s.parentElement.id===r.element.id)||"true"===e.droppedElement.querySelector("tr").getAttribute("single-dragrow")&&e.droppedElement.parentElement.id!==r.element.id)return;if(e.droppedElement.parentElement.id!==r.element.id)s?(n=s.parentElement.ej2_instances[0],t.remove(s)):n=e.droppedElement.parentElement.ej2_instances[0];else if(this.isSingleRowDragDrop||"true"===e.droppedElement.querySelector("tr").getAttribute("single-dragrow"))return void this.singleRowDrop(e);if(n.element.id!==r.element.id&&n.rowDropSettings.targetID!==r.element.id)return;var a=n.getSelectedRecords(),l=o=this.getTargetIdx(i);isNaN(l)&&(l=o=0),r.allowPaging&&(l=l+r.pageSettings.currentPage*r.pageSettings.pageSize-r.pageSettings.pageSize),r.notify(dr,{toIndex:l,records:a}),r.notify(er,{type:Bt,requestType:"rowdraganddrop"});var h=n.getSelectedRowIndexes(),p=n.allowPaging?n.pageSettings.currentPage*n.pageSettings.pageSize-n.pageSettings.pageSize:0;this.selectedRows=[];for(var d=0,c=a.length;d<c;d++)this.selectedRows.push(p+h[parseInt(d.toString(),10)]);n.notify(cr,{indexes:this.selectedRows,records:a}),n.notify(er,{type:Bt,requestType:"rowdraganddrop"})}},e.prototype.reorderRow=function(e,t){var r=this.parent;if(!r.sortSettings.columns.length&&!r.groupSettings.columns.length&&!r.filterSettings.columns.length){var i=r.allowPaging?r.pageSettings.currentPage*r.pageSettings.pageSize-r.pageSettings.pageSize:0;t+=i,this.selectedRows=r.getSelectedRowIndexes(),r.notify(Fr,{fromIndex:e+i,toIndex:t})}},e.prototype.enableAfterRender=function(e){e.module===this.getModuleName()&&e.enable&&this.initializeDrag()},e.prototype.destroy=function(){var e=this.parent.element;!this.parent.isDestroyed&&e&&(e.querySelector("."+jr)||e.querySelector("."+Vr))&&(this.draggable.destroy(),this.parent.off(Qt,this.initializeDrag),this.parent.off(jt,this.columnDrop),this.parent.off(nr,this.onActionComplete),this.parent.removeEventListener(qt,this.onDataBoundFn),this.parent.off(Jt,this.enableAfterRender),this.parent.off(lr,this.destroy))},e.prototype.getModuleName=function(){return"rowDragAndDrop"},e.prototype.processArgs=function(e){var t=this.parent,r=parseInt(this.startedRow.getAttribute(si),10);t.getSelectedRecords().length>0&&!1===this.startedRow.cells[0].classList.contains("e-selectionbackground")||0===t.getSelectedRecords().length?(this.parent.enableVirtualization?this.rows=[this.startedRow]:(this.rows=[this.parent.getRowByIndex(r)],t.isFrozenGrid()&&(this.rows=[t.getRowByIndex(r),t.getMovableRowByIndex(r)],t.getFrozenMode()===ri&&(this.rows=[t.getRowByIndex(r),t.getMovableRowByIndex(r),t.getFrozenRightRowByIndex(r)]))),this.rowData=[this.parent.getRowInfo(this.startedRow.querySelector("."+Ur)).rowData],t.enableVirtualization&&t.allowGrouping&&t.groupSettings.columns.length&&t.getSelectedRows().length&&(this.rows=t.getSelectedRows(),this.rowData=t.getSelectedRecords())):(this.rows=t.getSelectedRows(),this.rowData=t.getSelectedRecords())},e}(),Ro=function(){function e(e,r,i,n){var o=this;this.sortRequired=!0,this.groupSortFocus=!1,this.groupTextFocus=!1,this.groupCancelFocus=!1,this.isAppliedGroup=!1,this.isAppliedUnGroup=!1,this.isAppliedCaptionRowBorder=!1,this.reorderingColumns=[],this.visualElement=t.createElement("div",{className:"e-cloneproperties e-dragclone e-gdclone",styles:"line-height:23px",attrs:{action:"grouping"}}),this.helper=function(e){var t=o.parent,r=e.sender.target,i=r.classList.contains("e-groupheadercell")?r:O(r,"e-groupheadercell");return!(!i||!r.classList.contains("e-drag")&&o.groupSettings.allowReordering)&&(o.column=t.getColumnByField(i.firstElementChild.getAttribute("ej-mappingname")),o.visualElement.textContent=i.textContent,o.visualElement.style.width=i.offsetWidth+2+"px",o.visualElement.style.height=i.offsetHeight+2+"px",o.visualElement.setAttribute("e-mappinguid",o.column.uid),t.element.appendChild(o.visualElement),o.visualElement)},this.dragStart=function(e){o.parent.element.classList.add("e-ungroupdrag")},this.drag=function(e){o.groupSettings.allowReordering&&o.animateDropper(e);var r=e.target,i=o.parent.element.querySelector(".e-cloneproperties");o.parent.trigger(Ut,{target:r,draggableType:"headercell",column:o.column}),o.groupSettings.allowReordering||(t.classList(i,["e-defaultcur"],["e-notallowedcur"]),O(r,Vr)||O(r,"e-headercell")||t.classList(i,["e-notallowedcur"],["e-defaultcur"]))},this.dragStop=function(e){o.parent.element.classList.remove("e-ungroupdrag");var r=!(O(e.target,Vr)||O(e.target,"e-gridheader"));if(o.groupSettings.allowReordering&&r){if(t.remove(e.helper),O(e.target,"e-groupdroparea"))o.rearrangeGroup();else if(!O(e.target,"e-grid")){var i=o.parent.getColumnByUid(e.helper.getAttribute("e-mappinguid")).field;-1!==o.groupSettings.columns.indexOf(i)&&o.ungroupColumn(i)}}else if(r)return void t.remove(e.helper)},this.animateDropper=function(e){var t=o.parent.element.querySelector(".e-cloneproperties").getAttribute("e-mappinguid"),r=o.parent.getColumnByUid(t).field,i=O(e.target,"e-groupdroparea"),n=O(e.target,"e-group-animator"),s=[].slice.call(o.element.getElementsByClassName("e-groupheadercell")).map(function(e){return e.querySelector("div").getAttribute("ej-mappingname")}),a=JSON.parse(JSON.stringify(s));if(n||i){if(n){var l=n.querySelector("div[ej-mappingname]").getAttribute("ej-mappingname"),h=+n.getAttribute("index");if(l!==r){var p=a.indexOf(r);-1!==p&&a.splice(p,1);var d=-1!==h&&p===h;a.splice(h+(d?1:0),0,r)}}else i&&-1===a.indexOf(r)&&a.push(r);o.element.innerHTML="",a.length&&!o.element.classList.contains("e-grouped")&&o.element.classList.add("e-grouped"),o.reorderingColumns=a;for(var c=0;c<a.length;c++)o.addColToGroupDrop(a[parseInt(c.toString(),10)])}else o.addLabel(),o.removeColFromGroupDrop(r)},this.drop=function(e){var r=o.parent,i=r.getColumnByUid(e.droppedElement.getAttribute("e-mappinguid"));if(o.element.classList.remove("e-hover"),t.remove(e.droppedElement),o.aria.setDropTarget(o.parent.element.querySelector(".e-groupdroparea"),!1),o.aria.setGrabbed(o.parent.getHeaderTable().querySelector("[aria-grabbed=true]"),!1),t.isNullOrUndefined(i)||!1===i.allowGrouping||O(r.getColumnHeaderByUid(i.uid),"e-grid").getAttribute("id")!==r.element.getAttribute("id"))return void o.parent.log("action_disabled_column",{moduleName:o.getModuleName(),columnName:i.headerText});o.groupColumn(i.field)},this.contentRefresh=!0,this.aria=new Fi,this.parent=e,this.groupSettings=r,this.serviceLocator=n,this.sortedColumns=i,this.focus=n.getService("focus"),this.addEventListener(),this.groupGenerator=new wi(this.parent)}return e.prototype.addLabel=function(){if(!this.element.getElementsByClassName("e-group-animator").length){var e=this.l10n.getConstant("GroupDropArea");this.element.innerHTML=e,this.element.classList.remove("e-grouped")}},e.prototype.rearrangeGroup=function(){this.sortRequired=!1,this.updateModel()},e.prototype.columnDrag=function(e){this.groupSettings.allowReordering&&e.column.allowGrouping&&this.animateDropper(e);var r=this.parent.element.querySelector(".e-cloneproperties");t.classList(r,["e-defaultcur"],["e-notallowedcur"]),O(e.target,"e-groupdroparea")||this.parent.allowReordering&&O(e.target,"e-headercell")||t.classList(r,["e-notallowedcur"],["e-defaultcur"]),e.target.classList.contains("e-groupdroparea")?this.element.classList.add("e-hover"):this.element.classList.remove("e-hover")},e.prototype.columnDragStart=function(e){if(!e.target.classList.contains("e-stackedheadercell")){var t=this.parent.element.querySelector(".e-groupdroparea");this.aria.setDropTarget(t,e.column.allowGrouping);var r=e.target.classList.contains("e-headercell")?e.target:O(e.target,"e-headercell");this.aria.setGrabbed(r,!0,!e.column.allowGrouping)}},e.prototype.columnDrop=function(e){var r=this.parent;if("grouping"===e.droppedElement.getAttribute("action")){var i=r.getColumnByUid(e.droppedElement.getAttribute("e-mappinguid"));if(t.isNullOrUndefined(i)||!1===i.allowGrouping||O(r.getColumnHeaderByUid(i.uid),"e-grid").getAttribute("id")!==r.element.getAttribute("id"))return;this.ungroupColumn(i.field)}},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(Jt,this.enableAfterRender,this),this.parent.on("grouping-complete",this.onActionComplete,this),this.parent.on("ungrouping-complete",this.onActionComplete,this),this.parent.on($t,this.onPropertyChanged,this),this.parent.on(ar,this.clickHandler,this),this.parent.on(Ut,this.columnDrag,this),this.parent.on(Ht,this.columnDragStart,this),this.parent.on(gr,this.columnDrop,this),this.parent.on(jt,this.columnDrop,this),this.parent.on(rr,this.refreshSortIcons,this),this.parent.on("sorting-complete",this.refreshSortIcons,this),this.parent.on(sr,this.keyPressHandler,this),this.parent.on(Yt,this.initialEnd,this),this.parent.on(Zt,this.initialEnd,this),this.parent.on(Qt,this.render,this),this.parent.on("group-aggregates",this.onGroupAggregates,this),this.parent.on(lr,this.destroy,this),this.parent.on("group-expand-collapse",this.updateExpand,this),this.parent.on("persist-data-changed",this.initialEnd,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Qt,this.render),this.parent.off(Jt,this.enableAfterRender),this.parent.off("grouping-complete",this.onActionComplete),this.parent.off("ungrouping-complete",this.onActionComplete),this.parent.off($t,this.onPropertyChanged),this.parent.off(ar,this.clickHandler),this.parent.off(Ut,this.columnDrag),this.parent.off(Ht,this.columnDragStart),this.parent.off(jt,this.columnDrop),this.parent.off(gr,this.columnDrop),this.parent.off(rr,this.refreshSortIcons),this.parent.off("sorting-complete",this.refreshSortIcons),this.parent.off(sr,this.keyPressHandler),this.parent.off("group-aggregates",this.onGroupAggregates),this.parent.off(lr,this.destroy),this.parent.off("group-expand-collapse",this.updateExpand))},e.prototype.initialEnd=function(){var e=this.parent;if(this.parent.off(Yt,this.initialEnd),this.parent.off(Zt,this.initialEnd),this.parent.getColumns().length&&this.groupSettings.columns.length){this.contentRefresh=!1;for(var t=0,r=e.groupSettings.columns;t<r.length;t++){var i=r[t];this.groupColumn(i)}this.contentRefresh=!0}},e.prototype.keyPressHandler=function(e){var r=this.parent;if(e.target&&O(e.target,"e-groupheadercell")&&("tab"===e.action||"shiftTab"===e.action)){var i=this.getFocusableGroupedItems();if("tab"===e.action&&e.target===i[i.length-1]||"shiftTab"===e.action&&e.target===i[0])return;for(l=0;l<i.length;l++)if(e.target===i[parseInt(l.toString(),10)]){e.preventDefault();var n="tab"===e.action?l+1:l-1;return void i[parseInt(n.toString(),10)].focus()}}if("ctrlSpace"===e.action||this.groupSettings.columns.length&&-1!==["altDownArrow","altUpArrow","ctrlDownArrow","ctrlUpArrow","enter"].indexOf(e.action))switch(e.preventDefault(),e.action){case"altDownArrow":case"altUpArrow":var o=r.allowSelection?r.getSelectedRowIndexes():[];if(o.length){for(var s=r.getContentTable().querySelector(li).children,a=void 0,l=r.getDataRows()[o[o.length-1]].rowIndex;l>=0;l--)if(!s[parseInt(l.toString(),10)].classList.contains(Zr)&&!s[parseInt(l.toString(),10)].classList.contains("e-detailrow")){a=s[parseInt(l.toString(),10)];break}this.expandCollapseRows(a.querySelector("altUpArrow"===e.action?".e-recordplusexpand":".e-recordpluscollapse"))}break;case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"enter":if(e.target.classList.contains("e-groupsort")){this.groupSortFocus=!0,this.applySortFromTarget(e.target);break}if(e.target.classList.contains("e-ungroupbutton")){this.groupCancelFocus=!0,this.unGroupFromTarget(e.target);break}if(this.parent.isEdit||null!==t.closest(e.target,"#"+this.parent.element.id+"_searchbar")||O(e.target,"e-pager")||O(e.target,"e-toolbar"))return;var h=this.focus.getFocusedElement();h&&(h.classList.contains("e-icon-grightarrow")||h.classList.contains("e-icon-gdownarrow"))&&(h=h.parentElement);var p=h?h.parentElement.querySelector('[class^="e-record"]'):null;if(!p)break;h.children.length&&(h.children[0].classList.contains("e-icon-grightarrow")||h.children[0].classList.contains("e-icon-gdownarrow"))&&this.expandCollapseRows(p);break;case"ctrlSpace":var d=r.focusModule.currentInfo.element;if(d&&d.classList.contains("e-headercell")){var c=r.getColumnByUid(d.firstElementChild.getAttribute("e-mappinguid"));c.field&&r.groupSettings.columns.indexOf(c.field)<0?this.groupColumn(c.field):this.ungroupColumn(c.field)}}},e.prototype.getFocusableGroupedItems=function(){var e=[];if(this.groupSettings.columns.length)for(var t=this.element.querySelectorAll(".e-groupheadercell"),r=0;r<t.length;r++)e.push(t[parseInt(r.toString(),10)].querySelector(".e-grouptext")),e.push(t[parseInt(r.toString(),10)].querySelector(".e-groupsort")),e.push(t[parseInt(r.toString(),10)].querySelector(".e-ungroupbutton"));return e},e.prototype.wireEvent=function(){t.EventHandler.add(this.element,"focusin",this.onFocusIn,this),t.EventHandler.add(this.element,"focusout",this.onFocusOut,this)},e.prototype.unWireEvent=function(){t.EventHandler.remove(this.element,"focusin",this.onFocusIn),t.EventHandler.remove(this.element,"focusout",this.onFocusOut)},e.prototype.onFocusIn=function(e){this.parent.focusModule.currentInfo&&this.parent.focusModule.currentInfo.element&&(t.removeClass([this.parent.focusModule.currentInfo.element,this.parent.focusModule.currentInfo.elementToFocus],["e-focused","e-focus"]),this.parent.focusModule.currentInfo.element.tabIndex=-1),this.addOrRemoveFocus(e)},e.prototype.onFocusOut=function(e){this.addOrRemoveFocus(e)},e.prototype.addOrRemoveFocus=function(e){if(e.target.classList.contains("e-groupdroparea")||e.target.classList.contains("e-grouptext")||e.target.classList.contains("e-groupsort")||e.target.classList.contains("e-ungroupbutton")){var r=e.target.classList.contains("e-grouptext")?e.target.parentElement.parentElement:e.target;"focusin"===e.type?(this.parent.focusModule.currentInfo.element=e.target,this.parent.focusModule.currentInfo.elementToFocus=e.target,t.addClass([r],["e-focused","e-focus"]),e.target.tabIndex=0):(t.removeClass([r],["e-focused","e-focus"]),e.target.tabIndex=-1)}},e.prototype.clickHandler=function(e){e.target.classList.contains("e-grouptext")&&(this.groupTextFocus=!0),e.target.classList.contains("e-groupsort")&&(this.groupSortFocus=!0),e.target.classList.contains("e-ungroupbutton")&&(this.groupCancelFocus=!0),(e.target.classList.contains("e-icon-grightarrow")||e.target.classList.contains("e-icon-gdownarrow"))&&e.preventDefault();var t=O(e.target,"e-recordplusexpand")||O(e.target,"e-recordpluscollapse");t&&(t.children[0].classList.contains("e-icon-gdownarrow")||t.children[0].classList.contains("e-icon-grightarrow"))&&this.expandCollapseRows(e.target),this.applySortFromTarget(e.target),this.unGroupFromTarget(e.target),this.toogleGroupFromHeader(e.target)},e.prototype.unGroupFromTarget=function(e){e.classList.contains("e-ungroupbutton")&&this.ungroupColumn(e.parentElement.getAttribute("ej-mappingname"))},e.prototype.toogleGroupFromHeader=function(e){this.groupSettings.showToggleButton&&(e.classList.contains("e-grptogglebtn")?e.classList.contains("e-toggleungroup")?this.ungroupColumn(this.parent.getColumnByUid(e.parentElement.getAttribute("e-mappinguid")).field):this.groupColumn(this.parent.getColumnByUid(e.parentElement.getAttribute("e-mappinguid")).field):e.classList.contains("e-toggleungroup")&&this.ungroupColumn(e.parentElement.getAttribute("ej-mappingname")))},e.prototype.applySortFromTarget=function(e){var r=this.parent,i=t.closest(e,".e-groupheadercell");if(r.allowSorting&&i&&!e.classList.contains("e-ungroupbutton")&&!e.classList.contains("e-toggleungroup")){var n=i.firstElementChild.getAttribute("ej-mappingname");r.getColumnHeaderByField(n).getElementsByClassName("e-ascending").length?r.sortColumn(n,"Descending",!0):r.sortColumn(n,"Ascending",!0)}},e.prototype.expandCollapseRows=function(e){var r=O(e,"e-recordplusexpand")||O(e,"e-recordpluscollapse");if(r){var i=this.parent.getContentTable().querySelector(li).children,n=void 0,o=this.parent,s=r.parentElement.getElementsByClassName("e-indentcell").length,a=r.parentElement.getAttribute("data-uid"),l=o.getRowObjectFromUID(a),h=!1;if(r.classList.contains("e-recordpluscollapse")?(t.addClass([r],"e-recordplusexpand"),t.removeClass([r],"e-recordpluscollapse"),r.firstElementChild.className="e-icons e-gdiagonaldown e-icon-gdownarrow",r.firstElementChild.setAttribute("title","expanded"),h=!0,l.isExpand=!0,ue(o)&&this.updateVirtualRows(o,e,h,void 0,void 0),this.parent.groupSettings.enableLazyLoading&&((this.parent.filterSettings.columns.length||this.parent.sortSettings.columns.length||this.parent.searchSettings.key.length)&&0===this.parent.getContent().firstElementChild.scrollTop&&(this.parent.contentModule.isTop=!0),(this.parent.enableVirtualization?this.parent.lazyLoadRender:this.parent.contentModule).captionExpand(r.parentElement))):(n=!0,l.isExpand=!1,t.removeClass([r],"e-recordplusexpand"),t.addClass([r],"e-recordpluscollapse"),r.firstElementChild.className="e-icons e-gnextforward e-icon-grightarrow",r.firstElementChild.setAttribute("title","collapsed"),ue(o)&&this.updateVirtualRows(o,e,!n,void 0,void 0),this.parent.groupSettings.enableLazyLoading&&(this.parent.enableVirtualization?this.parent.lazyLoadRender:this.parent.contentModule).captionCollapse(r.parentElement)),this.aria.setExpand(r,h),!ue(o)&&!this.parent.groupSettings.enableLazyLoading){for(var p=o.getRowsObject(),d=p.indexOf(l),c={},u=o.enableInfiniteScrolling&&o.infiniteScrollSettings&&o.infiniteScrollSettings.enableCache&&p.length!==i.length?Array.from(i).indexOf(r.parentElement):void 0,g=d;g<p.length&&!(g>d&&p[parseInt(g.toString(),10)].indent===s);g++){if(p[parseInt(g.toString(),10)].isDetailRow){var f=p[g-1].isExpand&&p[g-1].visible;u&&u>0&&u<i.length?i[parseInt(u.toString(),10)].style.display=f?"":"none":t.isNullOrUndefined(u)&&(i[parseInt(g.toString(),10)].style.display=f?"":"none")}else if(!1===c[p[parseInt(g.toString(),10)].parentUid])p[parseInt(g.toString(),10)].visible=!1,u&&u>0&&u<i.length?i[parseInt(u.toString(),10)].style.display="none":t.isNullOrUndefined(u)&&(i[parseInt(g.toString(),10)].style.display="none");else{if(!(p[parseInt(g.toString(),10)].isDataRow||p[parseInt(g.toString(),10)].isCaptionRow||p[parseInt(g.toString(),10)].isDetailRow||p[parseInt(g.toString(),10)].isAggregateRow)&&(f=p[parseInt(g.toString(),10)].cells.some(function(e){return e.isDataCell&&e.visible}))===p[parseInt(g.toString(),10)].visible)continue;p[parseInt(g.toString(),10)].visible=!0,u&&u>0&&u<i.length?(i[parseInt(u.toString(),10)].style.display="",i[parseInt(u.toString(),10)].classList.remove("e-hide")):t.isNullOrUndefined(u)&&(i[parseInt(g.toString(),10)].style.display="",i[parseInt(g.toString(),10)].classList.remove("e-hide"))}p[parseInt(g.toString(),10)].isCaptionRow&&(c[p[parseInt(g.toString(),10)].uid]=p[parseInt(g.toString(),10)].isExpand&&p[parseInt(g.toString(),10)].visible),t.isNullOrUndefined(u)||u++}this.lastCaptionRowBorder(),this.parent.notify("refresh-Expand-and-Collapse",{rows:this.parent.getRowsObject()})}this.parent.enableInfiniteScrolling&&this.parent.groupSettings.enableLazyLoading||this.parent.notify("infinite-group-collapse",{isCollapse:n,parentUid:a})}},e.prototype.lastCaptionRowBorder=function(){var e=this.parent.getContentTable(),r=this.parent.getContent().clientHeight;if(!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling&&(e.scrollHeight<r||this.isAppliedCaptionRowBorder)){if(this.isAppliedCaptionRowBorder){for(var i=e.querySelectorAll(".e-lastrowcell"),n=0,o=i.length;n<o;n++)t.removeClass([i[parseInt(n.toString(),10)]],"e-lastrowcell");this.isAppliedCaptionRowBorder=!1}var s=this.parent.getContentTable().querySelector(li).children,a=s[s.length-1];if("none"===a.style.display||a.classList.contains("e-groupcaptionrow")){for(var n=s.length-1,o=0;n>o;n--)if("none"!==s[parseInt(n.toString(),10)].style.display&&s[parseInt(n.toString(),10)].classList.contains("e-groupcaptionrow")&&s[parseInt(n.toString(),10)].querySelector(".e-recordpluscollapse")){t.addClass(s[parseInt(n.toString(),10)].childNodes,"e-lastrowcell"),this.isAppliedCaptionRowBorder=!0;break}}else e.scrollHeight<r&&(t.addClass(e.querySelectorAll("tr:last-child td"),"e-lastrowcell"),this.isAppliedCaptionRowBorder=!0)}},e.prototype.updateVirtualRows=function(e,t,r,i,n){var o=e.getRowObjectFromUID(t.closest("tr").getAttribute("data-uid"));o.isExpand=r,C(e),this.parent.notify("refresh-virtual-max-page",{}),(i=e.getDataModule().generateQuery(!1)).queries=e.getDataModule().aggregateQuery(e.getQuery().clone()).queries;var s={requestType:"virtualscroll",rowObject:o};e.contentModule&&(s.virtualInfo=e.contentModule.prevInfo),e.getDataModule().getData(s,i.requiresCount()).then(function(t){return e.renderModule.dataManagerSuccess(t,s)})},e.prototype.expandCollapse=function(e){if(this.parent.groupSettings.columns.length){e||this.parent.notify("initial-collapse",e);for(var t,r=this.parent.getContentTable().querySelector(li).children,i=this.parent.getRowsObject(),n=0,o=r.length;n<o;n++)r[parseInt(n.toString(),10)].querySelectorAll(".e-recordplusexpand, .e-recordpluscollapse").length?((t=r[parseInt(n.toString(),10)].querySelector(e?".e-recordpluscollapse":".e-recordplusexpand"))&&(e?(t.className="e-recordplusexpand",t.firstElementChild.className="e-icons e-gdiagonaldown e-icon-gdownarrow",t.setAttribute("aria-expanded","true"),t.firstElementChild.setAttribute("title","expanded")):(t.className="e-recordpluscollapse",t.firstElementChild.className="e-icons e-gnextforward e-icon-grightarrow",t.setAttribute("aria-expanded","false"),t.firstElementChild.setAttribute("title","collapsed"))),r[parseInt(n.toString(),10)].firstElementChild.classList.contains("e-recordplusexpand")||r[parseInt(n.toString(),10)].firstElementChild.classList.contains("e-recordpluscollapse")||(r[parseInt(n.toString(),10)].style.display=e?"":"none")):r[parseInt(n.toString(),10)].style.display=e?"":"none",i[parseInt(n.toString(),10)].isCaptionRow&&(i[parseInt(n.toString(),10)].isExpand=!!e);this.parent.updateVisibleExpandCollapseRows(),this.lastCaptionRowBorder(),this.parent.notify("refresh-Expand-and-Collapse",{rows:this.parent.getRowsObject()})}},e.prototype.expandAll=function(){this.expandCollapse(!0)},e.prototype.collapseAll=function(){this.expandCollapse(!1)},e.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization"),this.renderGroupDropArea(),this.initDragAndDrop(),this.refreshToggleBtn(),this.wireEvent()},e.prototype.renderGroupDropArea=function(){var e=this.parent.element.querySelector(".e-groupdroparea");e&&t.remove(e),this.element=this.parent.createElement("div",{className:"e-groupdroparea",attrs:{tabindex:"-1"}}),this.groupSettings.allowReordering&&this.element.classList.add("e-group-animate"),this.updateGroupDropArea(),this.parent.element.insertBefore(this.element,this.parent.element.firstChild),this.groupSettings.showDropArea||(this.element.style.display="none")},e.prototype.updateGroupDropArea=function(e){if(this.groupSettings.showDropArea&&!this.groupSettings.columns.length){var t=this.l10n.getConstant("GroupDropArea");this.element.innerHTML=t,this.element.classList.remove("e-grouped")}else(this.element.innerHTML===this.l10n.getConstant("GroupDropArea")&&(1===this.groupSettings.columns.length||!this.isAppliedGroup&&!this.isAppliedUnGroup)||e)&&(this.element.innerHTML=""),this.element.classList.add("e-grouped")},e.prototype.initDragAndDrop=function(){this.initializeGHeaderDrop(),this.initializeGHeaderDrag()},e.prototype.initializeGHeaderDrag=function(){new t.Draggable(this.element,{dragTarget:this.groupSettings.allowReordering?".e-drag":".e-groupheadercell",distance:this.groupSettings.allowReordering?-10:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop})},e.prototype.initializeGHeaderDrop=function(){new t.Droppable(this.element,{accept:".e-dragclone",drop:this.drop})},e.prototype.groupColumn=function(e){var r=this.parent,i=r.getColumnByField(e);return t.isNullOrUndefined(i)||!1===i.allowGrouping||this.contentRefresh&&this.groupSettings.columns.indexOf(e)>-1?void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:i.headerText}):Y(r)?void r.notify(Cr,{instance:this,handler:this.groupColumn,arg1:e}):(i.visible=r.groupSettings.showGroupedColumn,this.colName=e,this.isAppliedGroup=!0,this.contentRefresh?this.updateModel():this.addColToGroupDrop(e),this.updateGroupDropArea(),void(this.isAppliedGroup=!1))},e.prototype.ungroupColumn=function(e){var r=this.parent,i=this.parent.enableColumnVirtualization?this.parent.columns.filter(function(t){return t.field===e})[0]:r.getColumnByField(e);if(!(t.isNullOrUndefined(i)||!1===i.allowGrouping||this.groupSettings.columns.indexOf(e)<0)){if(Y(r))return void r.notify(Cr,{instance:this,handler:this.ungroupColumn,arg1:e});i.visible=!0,this.colName=i.field;var n=JSON.parse(JSON.stringify(this.groupSettings.columns));if(n.splice(n.indexOf(this.colName),1),this.sortedColumns.indexOf(e)<0)for(var o=0,s=r.sortSettings.columns.length;o<s;o++)if(e===r.sortSettings.columns[parseInt(o.toString(),10)].field){r.sortSettings.columns.splice(o,1);break}this.groupSettings.allowReordering&&(this.reorderingColumns=n),this.groupSettings.columns=n,r.allowGrouping&&(this.isAppliedUnGroup=!0,this.parent.dataBind())}},e.prototype.updateModel=function(){var e=JSON.parse(JSON.stringify(this.groupSettings.columns));e=this.reorderingColumns.length?JSON.parse(JSON.stringify(this.reorderingColumns)):e,this.sortRequired&&(-1===e.indexOf(this.colName)&&e.push(this.colName),this.groupAddSortingQuery(this.colName)),this.sortRequired=!0,this.parent.groupSettings.columns=e,this.parent.dataBind()},e.prototype.onActionComplete=function(e){"grouping"===e.requestType?this.addColToGroupDrop(this.colName):this.removeColFromGroupDrop(this.colName);var r=this.groupSettings.columns.indexOf(this.colName)>-1?{columnName:this.colName,requestType:"grouping",type:Nt}:{requestType:"ungrouping",type:Nt};this.parent.trigger(Nt,t.extend(e,r)),this.colName=null},e.prototype.groupAddSortingQuery=function(e){for(var t=0;t<this.parent.sortSettings.columns.length&&this.parent.sortSettings.columns[parseInt(t.toString(),10)].field!==e;)t++;this.parent.sortSettings.columns.length===t?this.parent.sortSettings.columns.push({field:e,direction:"Ascending",isFromGroup:!0}):this.parent.allowSorting||(this.parent.sortSettings.columns[parseInt(t.toString(),10)].direction="Ascending")},e.prototype.createElement=function(e){var t=this.parent,r="Ascending",i=this.parent.createElement("div",{className:"e-grid-icon e-group-animator"}),n=this.parent.createElement("div",{className:"e-grid-icon e-groupheadercell"}),o=this.parent.createElement("div",{attrs:{"ej-mappingname":e}});_(e)&&o.setAttribute("ej-complexname",W(e));var s=this.parent.getColumnByField(e),a=t.getColumnHeaderByUid(s.uid);return this.groupSettings.allowReordering&&o.appendChild(this.parent.createElement("span",{className:"e-drag e-icons e-icon-drag",innerHTML:"&nbsp;",attrs:{title:"Drag",tabindex:"-1","aria-label":this.l10n.getConstant("GroupedDrag")}})),o.appendChild(this.parent.createElement("span",{className:"e-grouptext",innerHTML:s.headerText,attrs:{tabindex:"-1","aria-label":this.l10n.getConstant("GroupedSortIcon")+s.headerText}})),this.groupSettings.showToggleButton&&o.appendChild(this.parent.createElement("span",{className:"e-togglegroupbutton e-icons e-icon-ungroup e-toggleungroup",innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":this.l10n.getConstant("UnGroupAria")}})),a.querySelectorAll(".e-ascending,.e-descending").length&&(r=a.querySelector(".e-ascending")?"Ascending":"Descending"),o.appendChild(this.parent.createElement("span",{className:"e-groupsort e-icons e-"+r.toLowerCase()+" e-icon-"+r.toLowerCase(),innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":this.l10n.getConstant("GroupedSortIcon")+s.headerText,role:"button"}})),o.appendChild(this.parent.createElement("span",{className:"e-ungroupbutton e-icons e-icon-hide",innerHTML:"&nbsp;",attrs:{title:this.l10n.getConstant("UnGroup"),tabindex:"-1","aria-label":this.l10n.getConstant("UnGroupIcon")+s.headerText,role:"button"},styles:this.groupSettings.showUngroupButton?"":"display:none"})),n.appendChild(o),this.groupSettings.allowReordering&&(i.appendChild(n),i.appendChild(this.createSeparator()),n=i),n},e.prototype.addColToGroupDrop=function(e){var r=_(e)?this.parent.element.querySelector(".e-groupdroparea div[ej-complexname="+K(W(e))+"]"):this.parent.element.querySelector(".e-groupdroparea div[ej-mappingname="+K(e)+"]");if(!this.groupSettings.allowReordering||!r){var i=this.parent.getColumnByField(e);if(!t.isNullOrUndefined(i)){var n=this.createElement(e);if(this.groupSettings.allowReordering){var o=this.element.getElementsByClassName("e-group-animator").length;n.setAttribute("index",o.toString())}this.element.appendChild(n);var s=this.parent.focusModule;s.setActive(!0);var a=[0,0];0===s.active.matrix.matrix[a[0]][a[1]]&&(a=ht(s.active.matrix.matrix,a,!0)),s.active.matrix.current=a,s.active.getTable().rows[s.active.matrix.current[0]].cells[s.active.matrix.current[1]].focus()}}},e.prototype.createSeparator=function(){return this.parent.createElement("span",{className:"e-nextgroup e-icons e-icon-next",innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":this.l10n.getConstant("GroupSeperator")},styles:this.groupSettings.showUngroupButton?"":"display:none"})},e.prototype.refreshToggleBtn=function(e){if(this.groupSettings.showToggleButton)for(var r=[].slice.call(this.parent.getHeaderTable().getElementsByClassName("e-headercelldiv")),i=0,n=r.length;i<n;i++)if(!r[parseInt(i.toString(),10)].classList.contains("e-emptycell")&&!r[parseInt(i.toString(),10)].classList.contains("e-headerchkcelldiv")){var o=this.parent.getColumnByUid(r[parseInt(i.toString(),10)].getAttribute("e-mappinguid"));(!this.parent.showColumnMenu||this.parent.showColumnMenu&&!o.showColumnMenu)&&(r[parseInt(i.toString(),10)].getElementsByClassName("e-grptogglebtn").length&&t.remove(r[parseInt(i.toString(),10)].querySelectorAll(".e-grptogglebtn")[0]),e||r[parseInt(i.toString(),10)].appendChild(this.parent.createElement("span",{className:"e-grptogglebtn e-icons "+(this.groupSettings.columns.indexOf(o.field)>-1?"e-toggleungroup e-icon-ungroup":"e-togglegroup e-icon-group"),attrs:{tabindex:"-1","aria-label":t.isNullOrUndefined(this.l10n)?this.parent.localeObj.getConstant("GroupButton"):this.l10n.getConstant("GroupButton")}})))}},e.prototype.removeColFromGroupDrop=function(e){if(!t.isNullOrUndefined(this.getGHeaderCell(e))){var r=this.getGHeaderCell(e);if(this.groupSettings.allowReordering){var i=O(r,"e-group-animator");t.remove(i)}else t.remove(r);this.updateGroupDropArea()}this.isAppliedUnGroup=!1},e.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName())for(var t=0,r=Object.keys(e.properties);t<r.length;t++){var i=r[t];switch(i){case"columns":var n=void 0;if(this.contentRefresh){if(this.isAppliedUnGroup)n={columnName:this.colName,requestType:"ungrouping",type:Bt};else{if(!this.isAppliedGroup){this.updateGroupDropArea(!0);for(var o=0;o<this.parent.sortSettings.columns.length;o++)this.parent.sortSettings.columns[parseInt(o.toString(),10)].isFromGroup&&(this.parent.sortSettings.columns.splice(o,1),o--);for(a=0;a<this.groupSettings.columns.length;a++)this.colName=this.groupSettings.columns[parseInt(a.toString(),10)],this.parent.getColumnByField(this.colName).visible=this.parent.groupSettings.showGroupedColumn,this.groupAddSortingQuery(this.colName),a<this.groupSettings.columns.length-1&&this.addColToGroupDrop(this.groupSettings.columns[parseInt(a.toString(),10)])}n={columnName:this.colName,requestType:e.properties[""+i].length?"grouping":"ungrouping",type:Bt}}if(!this.groupSettings.showGroupedColumn)for(var s=e.oldProperties[""+i],a=0;a<s.length;a++)-1===e.properties[""+i].indexOf(s[parseInt(a.toString(),10)])&&(this.parent.getColumnByField(s[parseInt(a.toString(),10)]).visible=!0);this.parent.notify(er,n)}break;case"showDropArea":this.updateGroupDropArea(),this.groupSettings.showDropArea?(this.element.style.display="",this.parent.headerModule.refreshUI()):this.element.style.display="none";break;case"showGroupedColumn":this.updateGroupedColumn(this.groupSettings.showGroupedColumn),this.parent.notify(er,{requestType:"refresh"});break;case"showUngroupButton":this.updateButtonVisibility(this.groupSettings.showUngroupButton,"e-ungroupbutton");break;case"showToggleButton":this.updateButtonVisibility(this.groupSettings.showToggleButton,"e-togglegroupbutton "),this.parent.refreshHeader();break;case"enableLazyLoading":this.parent.freezeRefresh()}}},e.prototype.updateGroupedColumn=function(e){for(var t=0;t<this.groupSettings.columns.length;t++)this.parent.getColumnByField(this.groupSettings.columns[parseInt(t.toString(),10)]).visible=e},e.prototype.updateButtonVisibility=function(e,t){for(var r=[].slice.call(this.element.getElementsByClassName(t)),i=0;i<r.length;i++)r[parseInt(i.toString(),10)].style.display=e?"":"none"},e.prototype.enableAfterRender=function(e){e.module===this.getModuleName()&&e.enable&&this.render()},e.prototype.destroy=function(){var e=this.parent.element;e&&(e.querySelector("."+jr)||e.querySelector("."+Vr))&&(!this.parent.isDestroyed&&this.parent.allowGrouping||this.parent.refreshing||this.clearGrouping(),this.unWireEvent(),this.removeEventListener(),this.refreshToggleBtn(!0),this.element.parentNode&&t.remove(this.element))},e.prototype.clearGrouping=function(){var e=JSON.parse(JSON.stringify(this.groupSettings.columns));this.contentRefresh=!1;for(var t=0,r=e.length;t<r;t++)t===r-1&&(this.contentRefresh=!0),this.ungroupColumn(e[parseInt(t.toString(),10)]);this.contentRefresh=!0},e.prototype.getModuleName=function(){return"group"},e.prototype.refreshSortIcons=function(){var e,r=this.parent,i=r.sortSettings.columns,n=r.groupSettings.columns,o=this.parent.getColumns().map(function(e){return e.field});this.refreshToggleBtn();for(var s=0,a=i.length;s<a;s++)-1!==o.indexOf(i[parseInt(s.toString(),10)].field)&&(e=r.getColumnHeaderByField(i[parseInt(s.toString(),10)].field),!r.allowSorting&&(this.sortedColumns.indexOf(i[parseInt(s.toString(),10)].field)>-1||this.groupSettings.columns.indexOf(i[parseInt(s.toString(),10)].field)>-1)?(t.classList(e.querySelector(".e-sortfilterdiv"),["e-ascending","e-icon-ascending"],[]),i.length>1&&e.querySelector(".e-headercelldiv").appendChild(this.parent.createElement("span",{className:"e-sortnumber",innerHTML:(s+1).toString()}))):this.getGHeaderCell(i[parseInt(s.toString(),10)].field)&&this.getGHeaderCell(i[parseInt(s.toString(),10)].field).getElementsByClassName("e-groupsort").length&&("Ascending"===i[parseInt(s.toString(),10)].direction?t.classList(this.getGHeaderCell(i[parseInt(s.toString(),10)].field).querySelector(".e-groupsort"),["e-ascending","e-icon-ascending"],["e-descending","e-icon-descending"]):t.classList(this.getGHeaderCell(i[parseInt(s.toString(),10)].field).querySelector(".e-groupsort"),["e-descending","e-icon-descending"],["e-ascending","e-icon-ascending"])));for(var s=0,a=n.length;s<a;s++)-1!==o.indexOf(n[parseInt(s.toString(),10)])&&r.getColumnHeaderByField(n[parseInt(s.toString(),10)]).setAttribute("aria-grouped","true")},e.prototype.getGHeaderCell=function(e){return this.element&&this.element.querySelector('[ej-mappingname="'+e+'"]')?this.element.querySelector('[ej-mappingname="'+e+'"]').parentElement:null},e.prototype.onGroupAggregates=function(e){if(this.parent.groupSettings.enableLazyLoading)return void("Batch"!==this.parent.editSettings.mode&&this.updateLazyLoadGroupAggregates(e));var t=this.iterateGroupAggregates(e),r=this.groupGenerator.generateRows(t,{}),i=this.parent.getRowsObject().filter(function(e){return!e.isDataRow}),n=r.filter(function(e){return!e.isDataRow});(this.parent.isReact||this.parent.isVue)&&this.parent.destroyTemplate(["groupFooterTemplate","groupCaptionTemplate","footerTemplate"]);for(var o=0;o<n.length;o++){var s=n[parseInt(o.toString(),10)],a={cells:s.cells.filter(function(e){return e.isDataCell}),data:s.data,dataUid:i[parseInt(o.toString(),10)]?i[parseInt(o.toString(),10)].uid:""};this.parent.notify("refresh-aggregate-cell",a)}},e.prototype.updateLazyLoadGroupAggregates=function(e,t){var r=this,i=this.getGroupAggregateTemplates(!0),n=this.getGroupAggregateTemplates(!1);if(i.length||n.length)for(var o=this.parent,s=o.getDataModule().isRemote(),a=e[0],l=e.row,h=o.groupSettings.columns,p=o.contentModule,d=p.getGroupCache()[o.pageSettings.currentPage],c=t||[],u=this,g=0;g<h.length&&"break"!==function(t){var g=h[parseInt(t.toString(),10)],f=a[""+g],m=u.getGroupCaptionRowObject(l,h.length-t);if(s&&c.length){if(0!==t){var y=h[t-1],v=a[""+y];c=c.find(function(e){return e.key===v}).items}u.updateLazyLoadGroupAggregatesRow(c,f,m,d,i,n)}else{var C=o.renderModule.data.generateQuery();if(0!==t){var S=d.filter(function(e){return e.isCaptionRow&&e.parentUid===m.parentUid}).indexOf(m),b=o.groupSettings.columns.slice(0,t).reverse(),w=at(st(b,b.map(function(e){return a[""+e]}),p)),I={level:t,skip:S,take:1,where:w};C.lazyLoad.push({key:"onDemandGroupInfo",value:I})}if(o.renderModule.data.getData({},C).then(function(o){s?r.updateLazyLoadGroupAggregates(e,o.result):r.updateLazyLoadGroupAggregatesRow(o.result,f,m,d,i,n),(t===h.length-1||s)&&r.destroyRefreshGroupCaptionFooterTemplate()}).catch(function(e){return o.renderModule.dataManagerFailure(e,{requestType:"grouping"})}),s)return"break"}}(g);g++);},e.prototype.destroyRefreshGroupCaptionFooterTemplate=function(){var e=this.parent;(e.isAngular||e.isReact||e.isVue)&&e.destroyTemplate(["groupCaptionTemplate","groupFooterTemplate"]),e.refreshGroupCaptionFooterTemplate(),e.removeMaskRow(),e.hideSpinner()},e.prototype.updateLazyLoadGroupAggregatesRow=function(e,t,r,i,n,o){var s=e.find(function(e){return e.key===t});if(n.length&&this.updateLazyLoadGroupAggregatesCell(s,r,n),o.length){var a=i.find(function(e){return e.isAggregateRow&&e.parentUid===r.uid});this.updateLazyLoadGroupAggregatesCell(s,a,o)}},e.prototype.updateLazyLoadGroupAggregatesCell=function(e,t,r){var i=t.data,n=e.aggregates;t.isCaptionRow&&(i.aggregates=n);for(var o=0;o<r.length;o++){var s=r[parseInt(o.toString(),10)],a=s.field+" - "+s.type,l=i[s.field];l[""+a]=n[""+a],l[pt(s.type)]=n[""+a],l[s.type]&&(l[s.type]=n[""+a])}},e.prototype.getGroupCaptionRowObject=function(e,t){for(var r=this.parent,i=e.getAttribute("data-uid"),n=r.getRowObjectFromUID(i),o=0;o<t;o++)n=r.getRowObjectFromUID(n.parentUid);return n},e.prototype.getGroupAggregateTemplates=function(e){for(var t=[],r=this.parent.aggregates,i=0;i<r.length;i++)for(var n=r[parseInt(i.toString(),10)],o=0;o<n.columns.length;o++)if(e&&n.columns[parseInt(o.toString(),10)].groupCaptionTemplate||!e&&n.columns[parseInt(o.toString(),10)].groupFooterTemplate){var s={};s={type:n.columns[parseInt(o.toString(),10)].type.toString().toLowerCase(),field:n.columns[parseInt(o.toString(),10)].field},t.push(s)}return t},e.prototype.groupedRowReorder=function(e,r){var i=this.parent.getRowElementByUID(e.uid),n=this.parent.getRowElementByUID(r.uid),o={rows:[i],target:n,fromIndex:e.index,dropIndex:r.index};if(!t.isNullOrUndefined(e)&&!t.isNullOrUndefined(r)&&e.parentUid!==r.parentUid){n?("none"===n.style.display&&(i.style.display="none"),o.fromIndex>o.dropIndex?this.parent.getContentTable().querySelector(li).insertBefore(i,n):this.parent.getContentTable().querySelector(li).insertBefore(i,n.nextSibling)):t.remove(i),this.groupReorderHandler(e,r);var s=[].slice.call(this.parent.getContentTable().getElementsByClassName(Zr));this.groupReorderRowObject(o,s,r),this.parent.enableVirtualization?this.vGroupResetRowIndex():ke(this.parent,this.parent.getRowsObject().filter(function(e){return e.isDataRow}),s),this.parent.notify("refresh-Expand-and-Collapse",{rows:this.parent.getRowsObject()})}},e.prototype.vGroupResetRowIndex=function(){for(var e=this.parent,r=e.vRows,i=this.parent.getRows(),n=0,o=0,s=0;n<r.length;n++)if(r[parseInt(n.toString(),10)].isDataRow){r[parseInt(n.toString(),10)].index=o,r[parseInt(n.toString(),10)].isAltRow=!!e.enableAltRow&&o%2!=0;var a=e.getRowElementByUID(r[parseInt(n.toString(),10)].uid);if(!t.isNullOrUndefined(a)){i[parseInt(s.toString(),10)]=a,a.setAttribute(si,o.toString()),a.setAttribute(ai,(o+1).toString()),r[parseInt(n.toString(),10)].isAltRow?a.classList.add("e-altrow"):a.classList.remove("e-altrow");for(var l=0;l<a.cells.length;l++)a.cells[parseInt(l.toString(),10)].setAttribute("index",o.toString());s++}o++}},e.prototype.groupReorderHandler=function(e,r){for(var i=this.parent,n=e.data,o=r.data,s=i.groupModule.getGroupAggregateTemplates(!1),a=i.getRowObjectFromUID(r.parentUid),l=i.getRowObjectFromUID(e.parentUid),h=[a],p=[l],d=i.groupSettings.columns,c=0;c<d.length;c++)n[d[parseInt(c.toString(),10)]]=o[d[parseInt(c.toString(),10)]],c>0&&(h.push(i.getRowObjectFromUID(h[c-1].parentUid)),p.push(i.getRowObjectFromUID(p[c-1].parentUid)));e.parentUid=r.parentUid,e.visible=r.visible,e.parentGid=r.parentGid,e.changes!==n&&(e.changes=n);var u=this.iterateGroupAggregates([{dragRowObjects:p,dropRowObjects:h}]),g=u.filter(function(e){return e.key===p[p.length-1].data.key||e.key instanceof Date&&e.key.toString()===p[p.length-1].data.key.toString()}),f=u.filter(function(e){return e.key===h[h.length-1].data.key||e.key instanceof Date&&e.key.toString()===h[h.length-1].data.key.toString()});u=[],t.isNullOrUndefined(g[0])||u.push(g[0]),t.isNullOrUndefined(f[0])||u.push(f[0]);for(var m=i.currentViewData,y=0;y<m.length;y++)t.isNullOrUndefined(g[0])&&m[parseInt(y.toString(),10)].key===p[p.length-1].data.key?(m.splice(y,1),y--):t.isNullOrUndefined(f[0])&&m[parseInt(y.toString(),10)].key===h[h.length-1].data.key?(m.splice(y,1),y--):t.isNullOrUndefined(g[0])||m[parseInt(y.toString(),10)].key!==g[0].key?t.isNullOrUndefined(f[0])||m[parseInt(y.toString(),10)].key!==f[0].key||(m[parseInt(y.toString(),10)]=f[0]):m[parseInt(y.toString(),10)]=g[0];for(var v=this.groupGenerator.generateRows(u,{}),C=[],S=[],y=0;y<p.length;y++)C.push.apply(C,this.getGroupParentFooterAggregateRowObject(p[parseInt(y.toString(),10)].uid));for(y=0;y<h.length;y++)S.push.apply(S,this.getGroupParentFooterAggregateRowObject(h[parseInt(y.toString(),10)].uid));p.push.apply(p,C),h.push.apply(h,S),this.updatedRowObjChange(p,v,s),this.updatedRowObjChange(h,v,s),this.groupReorderRefreshHandler(e,l,a,s)},e.prototype.updatedRowObjChange=function(e,r,i){var n=this.parent,o=n.getRowsObject(),s={},a=[];n.enableVirtualization&&(s=n.contentModule.vgenerator.cache,a=n.vcRows);for(var l=0;l<e.length;l++){for(var h=!1,p=0;p<r.length;p++){if(!(t.isNullOrUndefined(r[parseInt(p.toString(),10)])||t.isNullOrUndefined(e[parseInt(l.toString(),10)].data.key)||t.isNullOrUndefined(r[parseInt(p.toString(),10)].data.key))&&(e[parseInt(l.toString(),10)].data.key===r[parseInt(p.toString(),10)].data.key||e[parseInt(l.toString(),10)].data.key instanceof Date&&e[parseInt(l.toString(),10)].data.key.toString()===r[parseInt(p.toString(),10)].data.key.toString())){-1!==(c=o.indexOf(e[parseInt(l.toString(),10)]))&&(o[parseInt(c.toString(),10)].data=r[parseInt(p.toString(),10)].data,o[parseInt(c.toString(),10)].gSummary=r[parseInt(p.toString(),10)].gSummary),n.enableVirtualization&&-1!==(u=a.indexOf(e[parseInt(l.toString(),10)]))&&(a[parseInt(u.toString(),10)].data=r[parseInt(p.toString(),10)].data,a[parseInt(u.toString(),10)].gSummary=r[parseInt(p.toString(),10)].gSummary),e[parseInt(l.toString(),10)].data=r[parseInt(p.toString(),10)].data,e[parseInt(l.toString(),10)].gSummary=r[parseInt(p.toString(),10)].gSummary,r.splice(p,1),p--,h=!0;break}if(e[parseInt(l.toString(),10)].isAggregateRow&&r[parseInt(p.toString(),10)].isAggregateRow){for(var d=0;d<i.length;d++)if(this.evaluateGroupAggregateValueChange(e[parseInt(l.toString(),10)],r[parseInt(p.toString(),10)],i[parseInt(d.toString(),10)])){var c=o.indexOf(e[parseInt(l.toString(),10)]);if(-1!==c&&(o[parseInt(c.toString(),10)].data=r[parseInt(p.toString(),10)].data,o[parseInt(c.toString(),10)].gSummary=r[parseInt(p.toString(),10)].gSummary),n.enableVirtualization){var u=a.indexOf(e[parseInt(l.toString(),10)]);-1!==u&&(a[parseInt(u.toString(),10)].data=r[parseInt(p.toString(),10)].data,a[parseInt(u.toString(),10)].gSummary=r[parseInt(p.toString(),10)].gSummary)}e[parseInt(l.toString(),10)].data=r[parseInt(p.toString(),10)].data,e[parseInt(l.toString(),10)].gSummary=r[parseInt(p.toString(),10)].gSummary,h=!0;break}if(h)break}}if(!h){var g=n.getRowElementByUID(e[parseInt(l.toString(),10)].uid);if(t.isNullOrUndefined(g)||t.remove(g),o.splice(o.indexOf(e[parseInt(l.toString(),10)]),1),n.enableVirtualization){a.splice(a.indexOf(e[parseInt(l.toString(),10)]),1);for(var f=1;f<=Object.keys(s).length;f++){var m=s[parseInt(f.toString(),10)].indexOf(e[parseInt(l.toString(),10)]);-1!==m&&s[parseInt(f.toString(),10)].splice([parseInt(m.toString(),10)],1)}}}}},e.prototype.groupReorderRefreshHandler=function(e,r,i,n){var o=this.parent,s=new fi(o.serviceLocator,null,o);t.isNullOrUndefined(e)||t.isNullOrUndefined(o.getRowElementByUID(e.uid))||s.refresh(e,o.getColumns(),!1);for(var a=0;a<o.groupSettings.columns.length;a++){if(t.isNullOrUndefined(r)||t.isNullOrUndefined(o.getRowElementByUID(r.uid))||s.refresh(r,o.getColumns(),!1),t.isNullOrUndefined(i)||t.isNullOrUndefined(o.getRowElementByUID(i.uid))||s.refresh(i,o.getColumns(),!1),n.length){for(var l=t.isNullOrUndefined(r)?[]:this.getGroupParentFooterAggregateRowObject(r.uid),h=t.isNullOrUndefined(i)?[]:this.getGroupParentFooterAggregateRowObject(i.uid),p=0;p<h.length;p++)t.isNullOrUndefined(h[parseInt(p.toString(),10)])||t.isNullOrUndefined(o.getRowElementByUID(h[parseInt(p.toString(),10)].uid))||s.refresh(h[parseInt(p.toString(),10)],o.getColumns(),!1);for(p=0;p<l.length;p++)t.isNullOrUndefined(l[parseInt(p.toString(),10)])||t.isNullOrUndefined(o.getRowElementByUID(l[parseInt(p.toString(),10)].uid))||s.refresh(l[parseInt(p.toString(),10)],o.getColumns(),!1)}t.isNullOrUndefined(r)||(r=o.getRowObjectFromUID(r.parentUid)),t.isNullOrUndefined(i)||(i=o.getRowObjectFromUID(i.parentUid))}},e.prototype.getGroupParentFooterAggregateRowObject=function(e){for(var t=this.parent.getRowsObject(),r=[],i=0;i<t.length;i++)t[parseInt(i.toString(),10)].parentUid===e&&t[parseInt(i.toString(),10)].isAggregateRow&&r.push(t[parseInt(i.toString(),10)]);return r},e.prototype.evaluateGroupAggregateValueChange=function(e,t,r){var i=!1;return e.data[r.field].field===t.data[r.field].field&&e.data[r.field].key===t.data[r.field].key&&e.data[r.field].hasOwnProperty(r.field+" - "+r.type)&&t.data[r.field].hasOwnProperty(r.field+" - "+r.type)&&(i=!0),i},e.prototype.groupReorderRowObject=function(e,r,i){for(var n,o=this.parent,s=o.enableVirtualization?o.vRows:o.getRowsObject(),a=[],l=i||o.getRowObjectFromUID(e.target.closest("tr").getAttribute("data-uid")),h=0;h<e.rows.length;h++){var p=o.getRowObjectFromUID(e.rows[parseInt(h.toString(),10)].getAttribute("data-uid"));l===p&&(n=s.indexOf(l)),a.push(s.splice(s.indexOf(p),1)[0])}if(t.isNullOrUndefined(n)?(n=s.indexOf(l),e.fromIndex>e.dropIndex?s.splice.apply(s,[n,0].concat(a)):s.splice.apply(s,[n+1,0].concat(a))):s.splice.apply(s,[n,0].concat(a)),!o.enableVirtualization){for(var d={},c=this.parent.getCurrentViewRecords(),h=0,u=r.length;h<u;h++){var g=parseInt(r[parseInt(h.toString(),10)].getAttribute(si),10);d[parseInt(h.toString(),10)]=c[parseInt(g.toString(),10)]}for(var f=this.parent.getRows(),h=0,u=r.length;h<u;h++)f[parseInt(h.toString(),10)]=r[parseInt(h.toString(),10)],c[parseInt(h.toString(),10)]=d[parseInt(h.toString(),10)]}},e.prototype.gettingVirtualData=function(e,r,i){for(var n=[],o=this,s=0;s<e.length;s++)!function(s){if(-1===r.indexOf(e[parseInt(s.toString(),10)].data)&&n.push(e[parseInt(s.toString(),10)].data),e[parseInt(s.toString(),10)].data.field===o.parent.groupSettings.columns[0]){var a=e[parseInt(s.toString(),10)].data.items;t.isNullOrUndefined(a.records)||(a=a.records);for(var l=0;l<a.length;l++)!function(e){i&&-1===r.findIndex(function(t){return t[i.toString()]===a[parseInt(e.toString(),10)][i.toString()]})&&n.push(a[parseInt(e.toString(),10)])}(l)}}(s);return n},e.prototype.iterateGroupAggregates=function(e){var i=e instanceof Array?e:[],n=this.parent.getRowsObject(),o=this.parent.getCurrentViewRecords(),s=this.parent.getPrimaryKeyFieldNames()[0];if(this.parent.enableVirtualization&&this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&(!t.isNullOrUndefined(e[0].dragRowObjects)||!t.isNullOrUndefined(e[0].dropRowObjects))){var a=e[0].dragRowObjects,l=e[0].dropRowObjects;a&&o.push.apply(o,this.gettingVirtualData(a,o,s)),l&&o.push.apply(o,this.gettingVirtualData(l,o,s))}var h=[],p=n.map(function(e){return"delete"===e.edit&&h.push(e.data),e.changes instanceof Object?e.changes:e.data});p=0===i.length?p:i;var d=o.map(function(e){var t,i=r.DataUtil.getObject(s,e);return p.some(function(e){return t=e,i===r.DataUtil.getObject(s,e)})?t:e}),c=e;if((!c.type||"cancel"!==c.type)&&h.length>0)for(var u=0;u<h.length;u++){var g=d.indexOf(h[parseInt(u.toString(),10)]);d.splice(g,1)}for(var f=[],m=this.parent.aggregates,y=0;y<m.length;y++)for(var v=m[parseInt(y.toString(),10)],C=0;C<v.columns.length;C++){var S={};S={type:v.columns[parseInt(C.toString(),10)].type.toString().toLowerCase(),field:v.columns[parseInt(C.toString(),10)].field},f.push(S)}for(var b,w,I=this.parent.groupSettings.columns,R=0;R<I.length;R++)w=b||d,b=r.DataUtil.group(w,I[parseInt(R.toString(),10)],f,null,null);return b},e.prototype.updateExpand=function(e){for(var r=e.uid,i=e.isExpand,n=this.parent.getRowsObject(),o=0;o<n.length;o++){var s=n[parseInt(o.toString(),10)];if(s.uid===r||t.isNullOrUndefined(r)){s.isExpand=i;for(var a=o+1;a<n.length&&"break"!==function(e){var i=n[parseInt(e.toString(),10)],o=void 0;if(i.parentUid!==s.uid&&(o=n.filter(function(e){return e.uid===i.parentUid})[0]),i.parentUid===s.uid?i.visible=s.isExpand:t.isNullOrUndefined(o)||i.parentUid!==o.uid||(o.isExpand&&!0===o.visible?i.visible=!0:o.isExpand&&!1===o.visible&&(i.visible=!1)),t.isNullOrUndefined(r))return"break"}(a);a++);}}this.parent.notify(Yt,{rows:n,args:{isFrozen:!1,rows:n}})},e}(),xo=function(){function r(e,t){this.aria=new Fi,this.childRefs=[],this.parent=e,this.parent.isDestroyed||(this.focus=t.getService("focus"),this.parent.on(ar,this.clickHandler,this),this.parent.on(lr,this.destroy,this),this.parent.on(sr,this.keyPressHandler,this),this.parent.on(xr,this.expand,this),this.parent.on(hr,this.refreshColSpan,this),this.parent.on(lr,this.destroyChildGrids,this),this.parent.on(kr,this.destroyChildGrids,this),this.serviceLocator=t)}return r.prototype.clickHandler=function(e){(e.target.classList.contains("e-icon-grightarrow")||e.target.classList.contains("e-icon-gdownarrow")&&!this.parent.allowGrouping)&&e.preventDefault(),this.toogleExpandcollapse(t.closest(e.target,"td"))},r.prototype.toogleExpandcollapse=function(r){this.l10n=this.serviceLocator.getService("localization");var i,n=this.parent,o=this.parent.getContentTable(),s=this.parent.getCurrentViewRecords().length-1,a=r&&r.classList.contains("e-detailrowcollapse");if(!(!r||!r.classList.contains("e-detailrowcollapse")&&!r.classList.contains("e-detailrowexpand")||r&&r.classList.contains("e-masked-cell"))){var l=r.parentElement,h=l.getAttribute("data-uid"),p=n.getRowObjectFromUID(h),d=!1,c=this.parent.getContentTable().querySelector(li).children[l.rowIndex+1];if(r.classList.contains("e-detailrowcollapse")){var u=p.data;if(this.isDetailRow(c))c.style.display="",n.notify("detail-state-change",{data:u,childGrid:n.childGrid,detailElement:r,isExpanded:a}),d=!0;else if(n.getDetailTemplate()||n.childGrid){var g=N("grid-row"),f=this.parent.createElement("tr",{className:"e-detailrow",attrs:{"data-uid":g}}),m=this.parent.createElement("th",{className:"e-detailcell",attrs:{scope:"col"}}),y=this.parent.getVisibleColumns().length;this.parent.allowRowDragAndDrop&&y++,m.setAttribute("colspan",y.toString());var v=new Nr({isDataRow:!0,isExpand:!0,uid:g,isDetailRow:!0,cells:[new qr({cellType:e.CellType.Indent}),new qr({isDataCell:!0,visible:!0})]});v.parentUid=p.uid;for(var C=0,S=n.groupSettings.columns.length;C<S;C++)f.appendChild(this.parent.createElement("td",{className:"e-indentcell"})),v.cells.unshift(new qr({cellType:e.CellType.Indent}));if(f.appendChild(this.parent.createElement("th",{className:"e-detailindentcell",attrs:{scope:"col"}})),f.appendChild(m),l.parentNode.insertBefore(f,l.nextSibling),n.detailTemplate){var b=this.parent.isReact&&"string"!=typeof n.detailTemplate,w=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,I=n.element.id+"detailTemplate";b||w?(n.getDetailTemplate()(u,n,"detailTemplate",I,null,null,m),this.parent.renderTemplates()):q(m,n.getDetailTemplate()(u,n,"detailTemplate",I,void 0,void 0,void 0,this.parent.root))}else{i=new Vn(this.getGridModel(n,p,n.printMode)),this.childRefs.push(i),i.query&&(i.query=i.query.clone()),i.parentDetails={parentID:n.element.id,parentPrimaryKeys:n.getPrimaryKeyFieldNames(),parentKeyField:n.childGrid.queryString,parentKeyFieldValue:n.childGrid.queryString&&_(n.childGrid.queryString)?ge(n.childGrid.queryString,u):u[n.childGrid.queryString],parentRowData:u},n.isReact?i.parentDetails.parentInstObj=n:n.parentDetails&&n.parentDetails.parentInstObj&&n.parentDetails.parentInstObj.isReact&&(i.parentDetails.parentInstObj=n.parentDetails.parentInstObj),i.isLegacyTemplate=n.isReact||n.isLegacyTemplate,n.isPrinting&&(i.isPrinting=!0,i.on(Yt,this.promiseResolve(i),this),i.on(Zt,this.promiseResolve(i),this)),p.childGrid=i;var R=i.getInjectedModules(),x=n.getInjectedModules();R&&R.length===x.length||i.setInjectedModules(x);var F=this.parent.createElement("div",{id:"child"+H(l,"e-grid").length+"_grid"+l.rowIndex+N(""),className:"e-childgrid"});m.appendChild(F),i.appendTo(F)}f.appendChild(m),l.nextSibling?l.parentNode.insertBefore(f,l.nextSibling):l.parentNode.appendChild(f);var T=n.getRows(),E=n.getRowsObject();T.splice(T.indexOf(l)+1,0,f),E.splice(E.indexOf(p)+1,0,v),n.trigger("detailDataBound",{detailElement:m,data:u,childGrid:i}),n.notify("detailDataBound",{rows:E})}if(t.classList(r,["e-detailrowexpand"],["e-detailrowcollapse"]),t.classList(r.firstElementChild,["e-dtdiagonaldown","e-icon-gdownarrow"],["e-dtdiagonalright","e-icon-grightarrow"]),p.isExpand=!0,r.classList.contains("e-lastrowcell")&&this.parent.getContent().clientHeight>o.scrollHeight){t.removeClass(r.parentElement.querySelectorAll("td"),"e-lastrowcell");var z=o.querySelector(li).getElementsByClassName("e-detailrow").length-1;t.addClass(o.querySelector(li).getElementsByClassName("e-detailrow")[parseInt(z.toString(),10)].childNodes,["e-lastrowcell"]),this.lastrowcell=!0}this.aria.setExpand(r,!0),r.firstElementChild.setAttribute("title",this.l10n.getConstant("Expanded"))}else this.isDetailRow(c)&&(c.style.display="none",n.notify("detail-state-change",{data:p.data,childGrid:n.childGrid,detailElement:r,isExpanded:a})),t.classList(r,["e-detailrowcollapse"],["e-detailrowexpand"]),t.classList(r.firstElementChild,["e-dtdiagonalright","e-icon-grightarrow"],["e-dtdiagonaldown","e-icon-gdownarrow"]),parseInt(l.getAttribute(si),10)===s&&this.lastrowcell&&(t.addClass(r.parentElement.querySelectorAll("td"),"e-lastrowcell"),this.lastrowcell=!1),p.isExpand=!1,d=!0,this.aria.setExpand(r,!1),r.firstElementChild.setAttribute("title",this.l10n.getConstant("Collapsed"));(!t.isNullOrUndefined(n.detailTemplate)||n.childGrid&&d)&&(n.updateVisibleExpandCollapseRows(),n.notify("refresh-Expand-and-Collapse",{rows:n.getRowsObject()})),this.parent.allowTextWrap&&"auto"===this.parent.height&&(this.parent.getContentTable().scrollHeight>this.parent.getContent().clientHeight?this.parent.scrollModule.setPadding():this.parent.scrollModule.removePadding())}},r.prototype.getGridModel=function(e,r,i){var n;return e.isPrinting&&r.isExpand&&e.expandedRows&&e.expandedRows[r.index]&&e.expandedRows[r.index].gridModel?(e.expandedRows[r.index].gridModel.hierarchyPrintMode=e.childGrid.hierarchyPrintMode,n=t.extend({},e.expandedRows[r.index].gridModel,e.childGrid,!0)):(e.isPrinting&&e.childGrid.allowPaging&&(e.childGrid.allowPaging="CurrentPage"===i),n=t.extend({},{},e.childGrid,!0)),n},r.prototype.promiseResolve=function(e){var t=this;return function(){e.off(Yt,t.promiseResolve),e.off(Zt,t.promiseResolve),e.notify(Rr,{})}},r.prototype.isDetailRow=function(e){return e&&e.classList.contains("e-detailrow")},r.prototype.destroy=function(){var e=this.parent.element;!this.parent.isDestroyed&&e&&(e.querySelector("."+jr)||e.querySelector("."+Vr))&&(this.parent.off(ar,this.clickHandler),this.parent.off(lr,this.destroy),this.parent.off(sr,this.keyPressHandler),this.parent.off(xr,this.expand),this.parent.off(hr,this.refreshColSpan),this.parent.off(lr,this.destroyChildGrids),this.parent.off(kr,this.destroyChildGrids))},r.prototype.getTDfromIndex=function(e,r){var i=t.isNullOrUndefined(e)?void 0:this.parent.getDataRows()[parseInt(e.toString(),10)];return i&&i.querySelector(r)?i.querySelector(r):null},r.prototype.expand=function(e){isNaN(e)||(e=this.getTDfromIndex(e,".e-detailrowcollapse")),e&&e.classList.contains("e-detailrowcollapse")&&this.toogleExpandcollapse(e)},r.prototype.collapse=function(e){isNaN(e)||(e=this.getTDfromIndex(e,".e-detailrowexpand")),e&&e.classList.contains("e-detailrowexpand")&&this.toogleExpandcollapse(e)},r.prototype.expandAll=function(){this.expandCollapse(!0),this.parent.trigger(Nt,{requestType:"expandAllComplete",type:Nt,moduleObj:this})},r.prototype.collapseAll=function(){this.expandCollapse(!1),this.parent.trigger(Nt,{requestType:"collapseAllComplete",type:Nt,moduleObj:this})},r.prototype.expandCollapse=function(e){for(var t,r=this.parent.getDataRows(),i=0,n=r.length;i<n;i++)t=r[parseInt(i.toString(),10)].querySelector(".e-detailrowcollapse, .e-detailrowexpand"),e?this.expand(t):this.collapse(t)},r.prototype.keyPressHandler=function(e){var t=this.parent;switch(e.action){case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"altUpArrow":case"altDownArrow":var r=t.allowSelection?t.getSelectedRowIndexes():[];if(r.length){var i=t.getDataRows()[r[r.length-1]].querySelector(".e-detailrowcollapse, .e-detailrowexpand");"altDownArrow"===e.action?this.expand(i):this.collapse(i)}break;case"enter":if(this.parent.isEdit)return;var n=this.focus.getFocusedElement();if(n&&(n.classList.contains("e-icon-grightarrow")||n.classList.contains("e-icon-gdownarrow"))&&(n=n.parentElement),n&&!n.classList.contains("e-detailrowcollapse")&&!n.classList.contains("e-detailrowexpand"))break;this.toogleExpandcollapse(n)}},r.prototype.refreshColSpan=function(){for(var e=this.parent.contentModule.getTable().querySelectorAll("tr.e-detailrow"),t=this.parent.getVisibleColumns().length,r=0;r<e.length;r++)e[parseInt(r.toString(),10)].querySelector(".e-detailcell").setAttribute("colspan",t+"")},r.prototype.destroyChildGrids=function(){for(var e=this.parent.getRowsObject(),t=0;t<e.length;t++)e[parseInt(t.toString(),10)].childGrid=null;for(t=0;t<this.childRefs.length;t++)this.childRefs[parseInt(t.toString(),10)].isDestroyed||this.childRefs[parseInt(t.toString(),10)].destroy();this.childRefs=[]},r.prototype.getModuleName=function(){return"detailRow"},r}(),Fo=function(){function r(e,t){this.predefinedItems={},this.isSearched=!1,this.items=["Add","Edit","Update","Delete","Cancel","Print","Search","ColumnChooser","PdfExport","ExcelExport","CsvExport","WordExport"],this.parent=e,this.gridID=e.element.id,this.serviceLocator=t,this.addEventListener()}return r.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization");for(var e=["Add","Edit","Update","Delete","Cancel","Print","PdfExport","ExcelExport","WordExport","CsvExport"],t=this.parent.enableAdaptiveUI,r=["Edit","Delete","Update","Cancel"],i=0,n=e;i<n.length;i++){var o=n[i],s=o.toLowerCase(),a=s[0].toUpperCase()+s.slice(1);this.predefinedItems[""+o]={id:this.gridID+"_"+s,prefixIcon:"e-"+s,text:this.l10n.getConstant(a),tooltipText:this.l10n.getConstant(a)},t&&(this.predefinedItems[""+o].text="",this.predefinedItems[""+o].visible=-1===r.indexOf(o))}this.predefinedItems.Search={id:this.gridID+"_search",tooltipText:this.l10n.getConstant("Search"),align:"Right",cssClass:"e-search-wrapper",type:"Input"},this.predefinedItems.ColumnChooser={id:this.gridID+"_columnchooser",cssClass:"e-cc e-ccdiv e-cc-toolbar",suffixIcon:"e-columnchooser-btn",text:t?"":this.l10n.getConstant("Columnchooser"),tooltipText:this.l10n.getConstant("Columnchooser"),align:"Right"},"Vertical"===this.parent.rowRenderingMode&&(this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&(this.predefinedItems.responsiveFilter={id:this.gridID+"_responsivefilter",cssClass:"e-gridresponsiveicons e-icons",suffixIcon:"e-resfilter-icon",tooltipText:this.l10n.getConstant("FilterButton")}),this.parent.allowSorting&&(this.predefinedItems.responsiveSort={id:this.gridID+"_responsivesort",cssClass:"e-gridresponsiveicons e-icons",suffixIcon:"e-ressort-icon",tooltipText:this.l10n.getConstant("Sort")})),this.parent.enableAdaptiveUI&&this.parent.toolbar&&this.parent.toolbar.indexOf("Search")>-1&&(this.predefinedItems.responsiveBack={id:this.gridID+"_responsiveback",cssClass:"e-gridresponsiveicons e-icons",suffixIcon:"e-resback-icon",visible:!1}),this.createToolbar()},r.prototype.getToolbar=function(){return this.toolbar.element},r.prototype.destroy=function(){this.toolbar&&!this.toolbar.isDestroyed&&(this.toolbar.element?(this.toolbar.off("render-react-toolbar-template",this.addReactToolbarPortals),this.toolbar.destroy()):(this.parent.destroyTemplate(["toolbarTemplate"]),this.parent.isReact&&this.parent.renderTemplates()),this.unWireEvent(),this.removeEventListener(),this.element.parentNode&&t.remove(this.element))},r.prototype.bindSearchEvents=function(){this.searchElement=t.select("#"+this.gridID+"_searchbar",this.element),this.wireEvent(),this.refreshToolbarItems(),this.parent.searchSettings&&this.updateSearchBox()},r.prototype.toolbarCreated=function(e){if(this.element.querySelector(".e-search-wrapper"))if(!this.parent.enableAdaptiveUI||e){var t=this.parent.cssClass?"e-input-group e-search "+this.parent.cssClass:"e-input-group e-search";this.element.querySelector(".e-search-wrapper").innerHTML='<div class="'+t+'" role="search">                    <input id="'+this.gridID+'_searchbar" class="e-input e-search" name="input" type="search"                     placeholder= "'+this.l10n.getConstant("Search")+'"/>                    <span id="'+this.gridID+'_clearbutton" class="e-input-group-icon e-icons e-sicon"                     tabindex="-1" aria-label= "clear" role= "clear" style="cursor: default"></span>                    <span id="'+this.gridID+'_searchbutton" class="e-input-group-icon e-search-icon e-icons"                     tabindex="-1" title="'+this.l10n.getConstant("Search")+'" aria-label= "search" role= "search"></span>                     </div>'}else this.element.querySelector(".e-search-wrapper").innerHTML='<span id="'+this.gridID+'_clearbutton" class="e-input-group-icon e-icons e-sicon"                     tabindex="-1" aria-label= "clear" style="cursor: default"></span>                    <span id="'+this.gridID+'_searchbutton" class="e-input-group-icon e-search-icon e-icons"                     tabindex="-1" title="'+this.l10n.getConstant("Search")+'" aria-label= "search"></span>                     </div>';this.bindSearchEvents()},r.prototype.createToolbar=function(){var e=this.getItems();this.toolbar=new l.Toolbar({items:e,clicked:this.toolbarClickHandler.bind(this),enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,created:this.toolbarCreated.bind(this),cssClass:this.parent.cssClass?this.parent.cssClass:""}),this.toolbar.isReact=this.parent.isReact,this.toolbar.on("render-react-toolbar-template",this.addReactToolbarPortals,this);this.toolbar.isStringTemplate=!0;var t="viewContainerRef";if(this.parent[""+t]&&(this.toolbar.registeredTemplate={},this.toolbar[""+t]=this.parent[""+t]),this.element=this.parent.createElement("div",{id:this.gridID+"_toolbarItems"}),this.parent.enableAdaptiveUI&&this.element.classList.add("e-res-toolbar"),this.parent.toolbarTemplate){if("string"==typeof this.parent.toolbarTemplate)this.toolbar.appendTo(this.parent.toolbarTemplate),this.element=this.toolbar.element;else{var r=this.parent.isReact&&"string"!=typeof this.parent.toolbarTemplate,i=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,n=this.parent.element.id+"toolbarTemplate";r||i?(R(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate",n,null,null,this.element),this.parent.renderTemplates()):q(this.element,R(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate"))}this.element.classList.add("e-temp-toolbar")}else this.toolbar.appendTo(this.element);this.parent.element.insertBefore(this.element,this.parent.getHeaderContent());var o=this.element.querySelector(".e-toolbar-left"),s=this.element.querySelector(".e-toolbar-center"),a=this.element.querySelector(".e-toolbar-right"),h=this.element.querySelector(".e-toolbar-items"),p=this.element,d=o?o.clientWidth:0,c=s?s.clientWidth:0,u=a?a.clientWidth:0,g=h?h.clientWidth:0,f=p?p.clientWidth:0;(d>f||c>f||u>f||g>f)&&this.toolbar.refreshOverflow()},r.prototype.addReactToolbarPortals=function(e){this.parent.isReact&&e&&(this.parent.portals=this.parent.portals.concat(e),this.parent.renderTemplates())},r.prototype.renderResponsiveSearch=function(r){r?(this.toolbarCreated(!0),this.refreshResponsiveToolbarItems(e.ResponsiveToolbarAction.isSearch),this.searchElement=t.select("#"+this.gridID+"_searchbar",this.element),O(this.searchElement,"e-toolbar-right").classList.add("e-responsive-right"),this.parent.searchSettings&&this.updateSearchBox(),this.searchBoxObj.searchFocus({target:this.searchElement}),this.searchElement.focus()):this.refreshResponsiveToolbarItems(e.ResponsiveToolbarAction.isInitial)},r.prototype.refreshResponsiveToolbarItems=function(t){if(t===e.ResponsiveToolbarAction.isInitial){for(var r=this.parent.element.id,i=[r+"_edit",r+"_delete"],n=this.parent.getSelectedRowIndexes(),o=[r+"_responsiveback",r+"_update",r+"_cancel"],s=0,a=this.toolbar.items;s<a.length;s++)(d=(p=a[s]).template.length?this.toolbar.element.querySelector(p.template):this.toolbar.element.querySelector("#"+p.id))&&(i.indexOf(p.id)>-1?n.length?d.parentElement.classList.remove("e-hidden"):d.parentElement.classList.add("e-hidden"):-1===o.indexOf(p.id)?d.parentElement.classList.remove("e-hidden"):d.parentElement.classList.add("e-hidden"));this.searchElement&&(O(this.searchElement,"e-toolbar-right").classList.remove("e-responsive-right"),this.toolbarCreated(!1),this.unWireEvent(),this.searchElement=void 0)}if(t===e.ResponsiveToolbarAction.isSearch)for(var i=[this.parent.element.id+"_responsiveback",this.parent.element.id+"_search"],l=0,h=this.toolbar.items;l<h.length;l++){var p=h[l],d=this.toolbar.element.querySelector("#"+p.id);d&&(i.indexOf(p.id)>-1?d.parentElement.classList.remove("e-hidden"):d.parentElement.classList.add("e-hidden"))}},r.prototype.refreshToolbarItems=function(e){var t=this.parent,r=[],i=[],n=t.editSettings,o=t.currentViewData&&t.currentViewData.length;n.allowAdding?r.push(this.gridID+"_add"):i.push(this.gridID+"_add"),n.allowEditing&&o?r.push(this.gridID+"_edit"):i.push(this.gridID+"_edit"),n.allowDeleting&&o?r.push(this.gridID+"_delete"):i.push(this.gridID+"_delete"),"Batch"===t.editSettings.mode?t.element.getElementsByClassName("e-updatedtd").length&&(n.allowAdding||n.allowEditing)?(r.push(this.gridID+"_update"),r.push(this.gridID+"_cancel")):(i.push(this.gridID+"_update"),i.push(this.gridID+"_cancel")):t.isEdit&&(n.allowAdding||n.allowEditing)?(r=[this.gridID+"_update",this.gridID+"_cancel"],i=[this.gridID+"_add",this.gridID+"_edit",this.gridID+"_delete"]):(i.push(this.gridID+"_update"),i.push(this.gridID+"_cancel")),this.enableItems(r,!0),this.enableItems(i,!1)},r.prototype.getItems=function(){var e=[],t=this.parent.toolbar||[];if("string"==typeof this.parent.toolbar)return[];"Vertical"===this.parent.rowRenderingMode&&(this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&e.push(this.getItemObject("responsiveFilter")),this.parent.allowSorting&&e.push(this.getItemObject("responsiveSort")));for(var r=0,i=t;r<i.length;r++){var n=i[r];switch(typeof n){case"number":e.push(this.getItemObject(this.items[n]));break;case"string":e.push(this.getItemObject(n));break;default:e.push(this.getItem(n))}}return this.parent.enableAdaptiveUI&&this.parent.toolbar&&this.parent.toolbar.indexOf("Search")>-1&&e.push(this.getItemObject("responsiveBack")),e},r.prototype.getItem=function(e){var r=this.predefinedItems[e.text];return r?t.extend(r,r,e):e},r.prototype.getItemObject=function(e){return this.predefinedItems[""+e]||{text:e,id:this.gridID+"_"+e}},r.prototype.enableItems=function(e,r){for(var i=0,n=e;i<n.length;i++){var o=n[i],s=t.select("#"+o,this.element);s&&this.toolbar.enableItems(s.parentElement,r)}},r.prototype.toolbarClickHandler=function(e){var r=this,i=this.parent,n=this.gridID;t.extend(e,{cancel:!1});var o=e,s=e.originalEvent;i.trigger("toolbarClick",o,function(e){if(e.originalEvent=e.originalEvent?e.originalEvent:s,!e.cancel)switch(!t.isNullOrUndefined(e.item)&&e.item.id){case n+"_print":i.print();break;case n+"_edit":i.startEdit();break;case n+"_update":i.endEdit();break;case n+"_cancel":i.closeEdit();break;case n+"_add":i.addRecord();break;case n+"_delete":i.deleteRecord();break;case n+"_search":e.originalEvent.target.id===n+"_searchbutton"&&r.searchElement?r.search():!i.enableAdaptiveUI||r.searchElement||!e.originalEvent.target.classList.contains("e-search-wrapper")&&e.originalEvent.target.id!==n+"_searchbutton"?e.originalEvent.target.classList.contains("e-clear-icon")&&e.originalEvent.target.id===n+"_clearbutton"&&r.searchElement&&(r.searchElement.value="",r.searchElement&&(r.sIcon=r.searchElement.parentElement.querySelector(".e-sicon"),r.sIcon.classList.remove("e-clear-icon"),r.sIcon.removeAttribute("title"),r.sIcon.style.cursor="default"),(r.isSearched||r.parent.searchSettings.key.length)&&(r.parent.search(r.searchElement.value),r.isSearched=!1)):r.renderResponsiveSearch(!0);break;case n+"_columnchooser":var o=r.parent.element.querySelector(".e-ccdiv"),a=o.getBoundingClientRect().top,l=o.getBoundingClientRect().left,h=e.originalEvent.target;a=o.getBoundingClientRect().top+o.offsetTop,i.createColumnchooser(l,a,h);break;case n+"_responsivefilter":i.showResponsiveCustomFilter();break;case n+"_responsivesort":i.showResponsiveCustomSort();break;case n+"_responsiveback":r.renderResponsiveSearch(!1)}})},r.prototype.modelChanged=function(e){"edit"===e.module&&this.refreshToolbarItems()},r.prototype.onPropertyChanged=function(e){e.module===this.getModuleName()&&this.parent.toolbar&&(this.element&&t.remove(this.element),this.render())},r.prototype.keyUpHandler=function(e){13===e.keyCode&&this.search(),this.searchElement&&(this.sIcon=this.searchElement.parentElement.querySelector(".e-sicon"),this.searchElement.value.length&&!t.isNullOrUndefined(this.sIcon)?(this.sIcon.classList.add("e-clear-icon"),this.sIcon.setAttribute("title","Clear"),this.sIcon.style.cursor="pointer"):(this.sIcon.classList.remove("e-clear-icon"),this.sIcon.removeAttribute("title"),this.sIcon.style.cursor="default"))},r.prototype.search=function(){this.isSearched=!0,this.parent.search(this.searchElement.value)},r.prototype.updateSearchBox=function(){this.searchElement&&(this.searchElement.value=this.parent.searchSettings.key)},r.prototype.wireEvent=function(){this.searchElement&&(this.searchBoxObj=new hn(this.searchElement),t.EventHandler.add(this.searchElement,"keyup",this.keyUpHandler,this),this.searchBoxObj.wireEvent()),t.EventHandler.add(this.element,"focusin",this.onFocusIn,this),t.EventHandler.add(this.element,"focusout",this.onFocusOut,this)},r.prototype.unWireEvent=function(){this.searchElement&&(t.EventHandler.remove(this.searchElement,"keyup",this.keyUpHandler),this.searchBoxObj.unWireEvent()),t.EventHandler.remove(this.element,"focusin",this.onFocusIn),t.EventHandler.remove(this.element,"focusout",this.onFocusOut)},r.prototype.onFocusIn=function(e){var r=this.parent.focusModule.currentInfo;r&&r.element&&(t.removeClass([r.element,r.elementToFocus],["e-focused","e-focus"]),r.element.tabIndex=-1),e.target.tabIndex=0},r.prototype.onFocusOut=function(e){e.target.tabIndex=-1},r.prototype.setFocusToolbarItem=function(e){var t=e.querySelector(".e-btn,.e-input,.e-toolbar-item-focus");!t&&this.parent.enableAdaptiveUI&&!this.searchElement&&e.classList.contains("e-search-wrapper")&&(t=e.querySelector("#"+this.gridID+"_searchbutton")),t.focus()},r.prototype.getFocusableToolbarItems=function(){for(var e=[].slice.call(this.element.querySelectorAll(".e-toolbar-item:not(.e-overlay):not(.e-hidden)")),r=[],i=0;i<e.length;i++)t.isNullOrUndefined(e[parseInt(i.toString(),10)].querySelector(".e-btn,.e-input,.e-toolbar-item-focus"))||r.push(e[parseInt(i.toString(),10)]);return r},r.prototype.keyPressedHandler=function(e){if(e.target&&O(e.target,"e-toolbar-item")){var t=O(e.target,"e-toolbar-item"),r=this.getFocusableToolbarItems();if("tab"===e.action||"shiftTab"===e.action){if("tab"===e.action&&t===r[r.length-1]||"shiftTab"===e.action&&t===r[0])return;for(var i=0;i<r.length;i++)if(t===r[parseInt(i.toString(),10)]){e.preventDefault();var n="tab"===e.action?i+1:i-1;return void this.setFocusToolbarItem(r[parseInt(n.toString(),10)])}}"enter"===e.action&&this.parent.enableAdaptiveUI&&!this.searchElement&&e.target.id===this.gridID+"_searchbutton"&&this.renderResponsiveSearch(!0)}},r.prototype.reRenderToolbar=function(){this.element&&t.remove(this.element),this.render()},r.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:"set-fullscreen-dialog",handler:this.reRenderToolbar},{event:Qt,handler:this.render},{event:Jt,handler:this.onPropertyChanged},{event:$t,handler:this.updateSearchBox.bind(this)},{event:er,handler:this.refreshToolbarItems},{event:"toolbar-refresh",handler:this.refreshToolbarItems},{event:$t,handler:this.modelChanged},{event:qt,handler:this.refreshToolbarItems},{event:ar,handler:this.removeResponsiveSearch},{event:"row-mode-change",handler:this.reRenderToolbar},{event:lr,handler:this.destroy},{event:sr,handler:this.keyPressedHandler}],Ze(this.parent,this.evtHandlers,!0,this),this.rowSelectedFunction=this.rowSelected.bind(this),this.rowDeSelectedFunction=this.rowSelected.bind(this),this.parent.addEventListener("rowSelected",this.rowSelectedFunction),this.parent.addEventListener("rowDeselected",this.rowDeSelectedFunction))},r.prototype.removeEventListener=function(){this.parent.isDestroyed||(Ze(this.parent,this.evtHandlers,!1),this.parent.removeEventListener("rowSelected",this.rowSelectedFunction),this.parent.removeEventListener("rowDeselected",this.rowDeSelectedFunction))},r.prototype.removeResponsiveSearch=function(e){var t=e.target,r=t.classList.contains("e-search-icon")||t.classList.contains("e-search-wrapper");this.parent.enableAdaptiveUI&&!r&&this.searchElement&&!O(e.target,"e-res-toolbar")&&this.renderResponsiveSearch(!1)},r.prototype.rowSelected=function(){this.parent.enableAdaptiveUI&&this.refreshResponsiveToolbarItems(e.ResponsiveToolbarAction.isInitial)},r.prototype.getModuleName=function(){return"toolbar"},r}(),To=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Eo=function(e){function i(t,r){var i=e.call(this,t,r)||this;return i.aggregates={},i.parent=t,i.locator=r,i.modelGenerator=new vi(i.parent),i.addEventListener(),i}return To(i,e),i.prototype.renderPanel=function(){var e=this.parent.createElement("div",{className:Gr}),r=this.parent.createElement("div",{className:"e-summarycontent"}),i=r;if(this.parent.isFrozenGrid()){var n=this.parent.createElement("div",{className:"e-frozenfootercontent e-frozen-left-footercontent"}),o=this.parent.createElement("div",{className:"e-movablefootercontent"}),s=this.parent.createElement("div",{className:"e-frozenfootercontent e-frozen-right-footercontent"});(this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount())&&(r.appendChild(n),this.frozenContent=n),r.appendChild(o),this.movableContent=o,i=o,this.parent.getFrozenRightColumnsCount()&&(r.appendChild(s),this.frozenRightContent=s)}t.Browser.isDevice&&(i.style.overflowX="scroll"),e.appendChild(r),this.setPanel(e),null!=this.parent.getPager()?this.parent.element.insertBefore(e,this.parent.getPager()):this.parent.element.appendChild(e)},i.prototype.renderTable=function(){var e=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),r=this.createContentTable("_footer_table").querySelector("."+Jr),i=this.parent.createElement("tfoot");if(r.appendChild(i),this.parent.isFrozenGrid()){var n=r.cloneNode(!0),o=r.cloneNode(!0);if(e&&(this.frozenContent.appendChild(n),this.freezeTable=n),this.parent.getFrozenRightColumnsCount()){t.remove(o.querySelector(hi));var s=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(hi).cloneNode(!0);o.insertBefore(s,o.querySelector(li)),this.frozenRightContent.appendChild(o),this.frTable=o}this.movableContent.appendChild(r),t.remove(r.querySelector(hi));var a=this.parent.getHeaderContent().querySelector("."+Kr).querySelector(hi).cloneNode(!0);r.insertBefore(a,r.querySelector(li)),this.setColGroup(a)}this.setTable(r)},i.prototype.renderSummaryContent=function(e,r,i,n){var o=this.parent.dataSource instanceof Array?!this.parent.getDataModule().isRemote()&&this.parent.parentDetails?this.getData():this.parent.dataSource:this.parent.currentViewData,s=this.modelGenerator.getData(),a=t.isNullOrUndefined(i)?this.modelGenerator.getColumns():this.modelGenerator.getColumns(i,n),l=t.isNullOrUndefined(i)?this.modelGenerator.generateRows(o,e||this.aggregates):this.modelGenerator.generateRows(o,e||this.aggregates,i,n),h=document.createDocumentFragment(),p=new fi(this.locator,null,this.parent);p.element=this.parent.createElement("TR",{className:"e-summaryrow"});for(var d=0,c=s.length;d<c;d++){var u=l[parseInt(d.toString(),10)];if(u){var g=p.render(u,a);h.appendChild(g)}}r.tFoot.appendChild(h),this.aggregates=t.isNullOrUndefined(e)?this.aggregates:e},i.prototype.refresh=function(e){var r=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),i=this.parent.getMovableColumnsCount(),n=this.parent.getFrozenRightColumnsCount();if(this.parent.isFrozenGrid()&&(t.remove(this.getPanel()),this.renderPanel(),this.renderTable(),r&&(this.freezeTable.tFoot.innerHTML="",this.renderSummaryContent(e,this.freezeTable,0,r))),this.getTable().tFoot.innerHTML="",this.renderSummaryContent(e,this.getTable(),r,n?r+i:void 0),this.parent.getFrozenRightColumnsCount()){this.frTable.tFoot.innerHTML="",this.renderSummaryContent(e,this.frTable,r+i,r+i+n);var o=[].slice.call(this.getTable().getElementsByClassName("e-lastsummarycell"));if(o.length)for(var s=0;s<o.length;s++)o[parseInt(s.toString(),10)].style.borderRight="0px"}if(this.parent.isFrozenGrid()){var a=[].slice.call(this.parent.element.querySelector(".e-movablefootercontent").getElementsByClassName("e-summaryrow")),l=void 0;if(r){l=[].slice.call(this.parent.element.querySelector(".e-frozen-left-footercontent").getElementsByClassName("e-summaryrow")),this.refreshHeight(l,a);var h=this.frozenContent;h.offsetHeight||(h.style.height=this.getTable().offsetHeight+"px")}if(n){var p=[].slice.call(this.parent.element.querySelector(".e-frozen-right-footercontent").getElementsByClassName("e-summaryrow"));this.refreshHeight(p,a),l&&this.refreshHeight(p,l);var d=this.frTable;d.offsetHeight||(d.style.height=this.getTable().offsetHeight+"px")}this.parent.allowResizing&&this.updateFooterTableWidth(this.getTable())}t.isNullOrUndefined(e)&&this.parent.isAutoFitColumns&&this.parent.autoFitColumns(),this.onScroll()},i.prototype.refreshHeight=function(e,t){for(var r=0;r<e.length;r++){var i=e[parseInt(r.toString(),10)].getBoundingClientRect().height,n=t[parseInt(r.toString(),10)].getBoundingClientRect().height;i<n?(e[parseInt(r.toString(),10)].classList.remove("e-hide"),e[parseInt(r.toString(),10)].style.height=n+"px"):i>n&&(t[parseInt(r.toString(),10)].classList.remove("e-hide"),t[parseInt(r.toString(),10)].style.height=i+"px")}},i.prototype.refreshCol=function(){var e,t=e=this.parent.element.querySelector("."+jr).querySelector(hi).cloneNode(!0);this.parent.getFrozenColumns()&&(this.parent.enableColumnVirtualization&&this.parent.contentModule.isXaxis()?e=this.parent.getMovableVirtualHeader().querySelector(hi).cloneNode(!0):(e=ce(t,this.parent.getFrozenColumns(),this.parent),this.freezeTable.replaceChild(t,this.freezeTable.querySelector(hi)))),this.getTable().replaceChild(e,this.getColGroup()),this.setColGroup(e)},i.prototype.onWidthChange=function(e){this.getColFromIndex(e.index).style.width=t.formatUnit(e.width),this.parent.allowResizing&&"resize"===e.module&&this.updateFooterTableWidth(this.getTable())},i.prototype.onScroll=function(e){void 0===e&&(e={left:this.parent.isFrozenGrid()?this.parent.getContent().querySelector("."+Wr).scrollLeft:this.parent.getContent().firstChild.scrollLeft}),this.getTable().parentElement.scrollLeft=e.left},i.prototype.getColFromIndex=function(e){var t=this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenColumns(),r=this.parent.getMovableColumnsCount(),i=this.parent.getFrozenRightColumnsCount(),n=this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()?1:0;return t&&e<t+n?this.freezeTable.querySelector(hi).children[parseInt(e.toString(),10)]:i&&e>=t+r+n?this.frTable.querySelector(hi).children[e-(t?t+r+n:t+r)]:this.getColGroup().children[e-(t?t+n:t)]},i.prototype.columnVisibilityChanged=function(){this.refresh()},i.prototype.addEventListener=function(){this.evtHandlers=[{event:tr,handler:this.refreshCol},{event:"column-width-changed",handler:this.onWidthChange},{event:"scroll",handler:this.onScroll},{event:hr,handler:this.columnVisibilityChanged},{event:"refresh-footer-rendered",handler:this.refreshFooterRenderer}],Ze(this.parent,this.evtHandlers,!0,this)},i.prototype.removeEventListener=function(){Ze(this.parent,this.evtHandlers,!1)},i.prototype.updateFooterTableWidth=function(e){var t=this.parent.getHeaderTable();t&&e&&(e.style.width=t.style.width)},i.prototype.refreshFooterRenderer=function(e){var t=this.onAggregates(e);this.refresh(t)},i.prototype.getIndexByKey=function(e,t){for(var r=this.parent.getPrimaryKeyFieldNames()[0],i=0;i<t.length;i++)if(t[parseInt(i.toString(),10)][""+r]===e[""+r])return i;return-1},i.prototype.getData=function(){return this.parent.getDataModule().dataManager.executeLocal(this.parent.getDataModule().generateQuery(!0))},i.prototype.onAggregates=function(e){e=e instanceof Array?e:[];var t=this.parent.getPrimaryKeyFieldNames()[0],i=[],n=!1,o={},s=!1;!this.parent.renderModule.data.isRemote()&&this.parent.allowFiltering&&this.parent.filterSettings.columns.length&&(s=!0);var a=this.parent.dataSource instanceof Array?s?this.parent.getFilteredRecords():this.parent.dataSource:this.parent.dataSource.dataSource.json.length?this.parent.dataSource.dataSource.json:this.parent.getCurrentViewRecords();if(this.parent.parentDetails&&!this.parent.getDataModule().isRemote()&&(a=this.getData()),this.parent.editModule&&(o=this.parent.editModule.getBatchChanges()),Object.keys(o).length){for(c=0;c<a.length;c++)n=!1,o.changedRecords.length&&this.getIndexByKey(a[parseInt(c.toString(),10)],o.changedRecords)>-1&&(n=!0,i.push(o.changedRecords[this.getIndexByKey(a[parseInt(c.toString(),10)],o.changedRecords)])),o.deletedRecords.length&&this.getIndexByKey(a[parseInt(c.toString(),10)],o.deletedRecords)>-1?n=!0:n||i.push(a[parseInt(c.toString(),10)]);if(o.addedRecords.length)for(c=0;c<o.addedRecords.length;c++)i.push(o.addedRecords[parseInt(c.toString(),10)])}else i=e.length?I(a).map(function(i){var n,o=r.DataUtil.getObject(t,i);return e.some(function(e){return n=e,o===r.DataUtil.getObject(t,e)})?n:i}):a;var l=e;l.type&&"cancel"===l.type&&(i=a);for(var h,p={},d=this.parent.aggregates,c=0;c<d.length;c++)for(var u=0;u<d[parseInt(c.toString(),10)].columns.length;u++){var g=d[parseInt(c.toString(),10)].columns[parseInt(u.toString(),10)].type.toString();h=U(g,i,d[parseInt(c.toString(),10)].columns[parseInt(u.toString(),10)],this.parent),p[d[parseInt(c.toString(),10)].columns[parseInt(u.toString(),10)].field+" - "+g.toLowerCase()]=h}return{result:i,count:i.length,aggregates:p}},i}(Ii),zo=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Mo=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-summarycell",attrs:{tabindex:"-1"}}),t}return zo(r,e),r.prototype.getValue=function(e,r,i){var n=t.isNullOrUndefined(i.type)?i.columnName:i.field+" - "+("string"==typeof i.type?i.type.toLowerCase():"");return r[i.columnName]?r[i.columnName][""+n]:""},r.prototype.evaluate=function(e,r,i,n){var o=r.column;if(this.parent.on("refresh-aggregate-cell",this.refreshWithAggregate(e,r),this),!(o.footerTemplate||o.groupFooterTemplate||o.groupCaptionTemplate))return"Vertical"===this.parent.rowRenderingMode&&(e.style.display="none"),!0;"Vertical"===this.parent.rowRenderingMode&&e.classList.add("e-lastsummarycell");var s=o.getTemplate(r.cellType),a=this.parent.getColumnByField(i[o.columnName].field);if(!t.isNullOrUndefined(a)&&(i[o.columnName].headerText=a.headerText,a.isForeignColumn())){var l=a.columnData.filter(function(e){return e[a.foreignKeyField]===i[o.columnName].key})[0];l&&(i[o.columnName].foreignKey=l[a.foreignKeyValue])}var h=this.parent.isReact&&(o.footerTemplate?"string"!=typeof o.footerTemplate:o.groupFooterTemplate?"string"!=typeof o.groupFooterTemplate:!!o.groupCaptionTemplate&&"string"!=typeof o.groupCaptionTemplate),p=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact;if(h||p){var d=i[o.columnName];if("groupCaptionTemplate"===s.property||"groupFooterTemplate"===s.property){d.groupKey=d.key}s.fn(d,this.parent,s.property,"",null,null,e),this.parent.renderTemplates()}else q(e,s.fn(i[o.columnName],this.parent,s.property,""));return!1},r.prototype.refreshWithAggregate=function(e,r){var i=this,n=r;return function(r){var o=n,s=o.column.columnName?o.column.columnName:null,a=t.isNullOrUndefined(s)?null:r.cells.filter(function(e){return e.column.columnName===s})[0];e.parentElement&&e.parentElement.getAttribute("data-uid")===r.dataUid&&s&&s===a.column.columnName&&i.refreshTD(e,a,r.data)}},r}(xi),Do=function(){function r(e,t){this.parent=e,this.locator=t,this.addEventListener()}return r.prototype.getModuleName=function(){return"aggregate"},r.prototype.initiateRender=function(){for(var r=this,i=this.locator.getService("cellRendererFactory"),n=new Mo(this.parent,this.locator),o=[e.CellType.Summary,e.CellType.CaptionSummary,e.CellType.GroupSummary],s=0;s<o.length;s++)i.addCellRenderer(o[parseInt(s.toString(),10)],n);this.footerRenderer=new Eo(this.parent,this.locator),this.footerRenderer.renderPanel(),this.footerRenderer.renderTable();var a=this.footerRenderer.getPanel();this.parent.element.scrollHeight>=this.parent.getHeight(this.parent.height)&&a&&t.addClass([a],["e-footerpadding"]),this.locator.register("footerRenderer",this.footerRenderer);var l=function(){r.prepareSummaryInfo(),r.parent.off(Xt,l)};this.parent.on(Xt,l,this),this.parent.on(Xt,this.footerRenderer.refresh,this.footerRenderer)},r.prototype.prepareSummaryInfo=function(){var e=this;dt(this.parent.aggregates,function(r){var i=t.getValue("customFormat",r);if(t.isNullOrUndefined(i)||r.setPropertiesSilent({format:i}),"object"==typeof r.format){var n=new Mt;r.setFormatter(n.getFormatFunction(t.extend({},r.format)))}else if("string"==typeof r.format){var o=e.locator.getService("valueFormatter");r.setFormatter(o.getFormatFunction({format:r.format}))}r.setPropertiesSilent({columnName:r.columnName||r.field})})},r.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName()){t.isNullOrUndefined(this.footerRenderer)&&this.initiateRender(),this.prepareSummaryInfo(),this.footerRenderer.refresh();var r=new Si(this.parent);0===new Ci(this.parent).getData().length&&r.isEmpty()||this.parent.notify(er,{})}},r.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(Qt,this.initiateRender,this),this.parent.on(Jt,this.onPropertyChanged,this),this.parent.on("refresh-aggregates",this.refresh,this),this.parent.on(lr,this.destroy,this))},r.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.footerRenderer.removeEventListener(),this.parent.off(Qt,this.initiateRender),this.parent.off(Xt,this.footerRenderer.refresh),this.parent.off(Jt,this.onPropertyChanged),this.parent.off("refresh-aggregates",this.refresh),this.parent.off(lr,this.destroy),this.parent.element.querySelector("."+Gr)&&t.remove(this.parent.element.querySelector("."+Gr)))},r.prototype.destroy=function(){this.removeEventListener()},r.prototype.refresh=function(e,t){var r=e instanceof Array?e:[e];this.parent.notify("refresh-footer-rendered",r),t&&(r.row=t),this.parent.groupSettings.columns.length>0&&this.parent.notify("group-aggregates",r)},r}(),Oo=function(){function e(e,t,r){var i=this;this.fromWheel=!1,this.touchMove=!1,this.options={},this.sentinelInfo={up:{check:function(e,t){var r=e.top-i.containerRect.top,n=i.containerRect.bottom>e.bottom?i.containerRect.bottom-e.bottom:0;return t.entered=r>=0,r+i.options.pageHeight/2>=0||n>0&&e.bottom>0},axis:"Y"},down:{check:function(e,t){var r=e.bottom;return t.entered=e.bottom<=i.containerRect.bottom,r-i.containerRect.top-i.options.pageHeight/2<=i.options.pageHeight/2},axis:"Y"},right:{check:function(e,t){var r=e.right;return i.movableEle?(t.entered=r<i.movableContainerRect.right,r-i.movableContainerRect.width<=i.movableContainerRect.right):(t.entered=r<i.containerRect.right,r-i.containerRect.width<=i.containerRect.right)},axis:"X"},left:{check:function(e,t){var r=e.left;return t.entered=r>0,i.movableEle?r+i.movableContainerRect.width>=i.movableContainerRect.left:r+i.containerRect.width>=i.containerRect.left},axis:"X"}},this.element=e,this.options=t,this.movableEle=r}return e.prototype.observe=function(e,r){var i=this;this.containerRect=this.options.container.getBoundingClientRect(),t.EventHandler.add(this.options.container,"wheel",function(){return i.fromWheel=!0},this),t.EventHandler.add(this.options.container,"scroll",this.virtualScrollHandler(e,r),this),this.options.movableContainer&&(this.movableContainerRect=this.options.movableContainer.getBoundingClientRect(),t.EventHandler.add(this.options.scrollbar,"wheel",function(){return i.fromWheel=!0},this),t.EventHandler.add(this.options.scrollbar,"scroll",this.virtualScrollHandler(e,r),this))},e.prototype.check=function(e){var t=this.sentinelInfo[""+e];return!this.movableContainerRect||"left"!==e&&"right"!==e?t.check(this.element.getBoundingClientRect(),t):t.check(this.movableEle.getBoundingClientRect(),t)},e.prototype.virtualScrollHandler=function(e,r){var i=this,n="chrome"===t.Browser.info.name?200:100,o=t.debounce(e,n),s=t.debounce(e,50);return this.options.prevTop=this.options.prevLeft=0,function(e){var t=i.options.movableContainer?i.options.container.scrollTop:e.target.scrollTop,n=i.options.movableContainer?i.options.scrollbar.scrollLeft:e.target.scrollLeft,a=i.options.prevTop<t?"down":"up";a=i.options.prevLeft===n?a:i.options.prevLeft<n?"right":"left",i.options.prevTop=t,i.options.prevLeft=n;var l=i.sentinelInfo[""+a];if(-1!==i.options.axes.indexOf(l.axis)){i.containerRect=i.options.container.getBoundingClientRect();var h=i.check(a);if(l.entered&&(!i.movableEle||"right"!==a&&"left"!==a?r(i.element,l,a,{top:t,left:n},i.fromWheel,h):r(i.movableEle,l,a,{top:t,left:n},i.fromWheel,h)),h){var p=o;"X"===l.axis&&(p=s),p({direction:a,sentinel:l,offset:{top:t,left:n},focusElement:document.activeElement})}i.fromWheel=!1}}},e.prototype.setPageHeight=function(e){this.options.pageHeight=e},e}(),ko=function(){function e(e){this.cOffsets={},this.cache={},this.movableCache={},this.frozenRightCache={},this.rowCache={},this.data={},this.groups={},this.currentInfo={},this.parent=e,this.model=this.parent.pageSettings,this.rowModelGenerator=this.parent.allowGrouping?new wi(this.parent):new mi(this.parent)}return e.prototype.generateRows=function(e,r){var i=this,n=this.parent.isFrozenGrid(),o=!1,s=r.virtualInfo=r.virtualInfo||this.getData(),a=s.sentinelInfo&&"X"===s.sentinelInfo.axis,l=a||!s.loadNext||s.loadSelf?s.page:s.nextInfo.page,h=[],p=this.getBlockIndexes(l),d=[];if(this.currentInfo.blockIndexes&&(p=s.blockIndexes=r.virtualInfo.blockIndexes=this.includePrevPage?this.currentInfo.blockIndexes.slice(1):this.currentInfo.blockIndexes.slice(0,this.currentInfo.blockIndexes.length-1),o=!0),(n&&this.parent.getFrozenMode()!==ri&&!r.renderMovableContent||this.parent.getFrozenMode()===ri&&!r.renderMovableContent&&!r.renderFrozenRightContent||!n)&&this.checkAndResetCache(r.requestType),ue(this.parent)&&this.parent.vcRows.length){var c=this.parent.vcRows.filter(function(e){return e.isDataRow});if(this.parent.isManualRefresh&&c.length===e.records.length||!this.parent.isManualRefresh)return h=this.parent.vcRows}if(this.parent.enableColumnVirtualization)for(g=0;g<s.blockIndexes.length;g++)this.isBlockAvailable(s.blockIndexes[parseInt(g.toString(),10)])&&(this.cache[s.blockIndexes[parseInt(g.toString(),10)]]=this.rowModelGenerator.refreshRows(this.cache[s.blockIndexes[parseInt(g.toString(),10)]])),(r.renderMovableContent&&this.isMovableBlockAvailable(s.blockIndexes[parseInt(g.toString(),10)])||r.renderFrozenRightContent&&this.isFrozenRightBlockAvailable(s.blockIndexes[parseInt(g.toString(),10)]))&&((y=r.renderMovableContent?this.movableCache:this.frozenRightCache)[s.blockIndexes[parseInt(g.toString(),10)]]=this.rowModelGenerator.refreshRows(y[s.blockIndexes[parseInt(g.toString(),10)]]));for(var u=s.blockIndexes,g=0;g<u.length;g++){if(!this.isBlockAvailable(u[parseInt(g.toString(),10)])){var f=t.isNullOrUndefined(this.startIndex)?this.getStartIndex(u[parseInt(g.toString(),10)],e):this.startIndex,m=this.rowModelGenerator.generateRows(e,{virtualInfo:s,startIndex:f});ue(this.parent)&&!this.parent.vcRows.length&&(this.parent.vRows=m,this.parent.vcRows=m,this.parent.notify("refresh-virtual-max-page",{}));v=void 0;ue(this.parent)?this.getGroupVirtualRecordsByIndex(m):o?this.setBlockForManualRefresh(this.cache,p,m):(v=~~Math.max(m.length,this.model.pageSize)/2,this.isBlockAvailable(p[0])||(this.cache[p[0]]=m.slice(0,v)),this.isBlockAvailable(p[1])||(this.cache[p[1]]=m.slice(v)))}if(this.parent.groupSettings.columns.length&&!a&&this.cache[u[parseInt(g.toString(),10)]]&&!this.parent.groupSettings.enableLazyLoading&&(this.cache[u[parseInt(g.toString(),10)]]=this.updateGroupRow(this.cache[u[parseInt(g.toString(),10)]],u[parseInt(g.toString(),10)])),r.renderMovableContent&&!this.isMovableBlockAvailable(u[parseInt(g.toString(),10)])||r.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(u[parseInt(g.toString(),10)])){var y=r.renderMovableContent?this.movableCache:this.frozenRightCache,f=t.isNullOrUndefined(this.startIndex)?this.getStartIndex(u[parseInt(g.toString(),10)],e):this.startIndex,m=this.rowModelGenerator.generateRows(e,{virtualInfo:s,startIndex:f});if(o)this.setBlockForManualRefresh(y,p,m);else{var v=~~Math.max(m.length,this.model.pageSize)/2;(r.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(p[0])||r.renderMovableContent&&!this.isMovableBlockAvailable(p[0]))&&(y[p[0]]=m.slice(0,v)),(r.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(p[1])||r.renderMovableContent&&!this.isMovableBlockAvailable(p[1]))&&(y[p[1]]=m.slice(v))}}r.renderMovableContent||r.renderFrozenRightContent||!this.cache[u[parseInt(g.toString(),10)]]?(y=r.renderMovableContent?this.movableCache:this.frozenRightCache)[u[parseInt(g.toString(),10)]]&&h.push.apply(h,y[u[parseInt(g.toString(),10)]]):h.push.apply(h,this.cache[u[parseInt(g.toString(),10)]]),this.isBlockAvailable(u[parseInt(g.toString(),10)])&&d.push(u[parseInt(g.toString(),10)])}s.blockIndexes=d;return this.parent.allowGrouping&&this.parent.groupSettings.columns.length?this.parent.currentViewData.records=h.map(function(e){return e.data}):n?(r.renderMovableContent&&("Left"===this.parent.getFrozenMode()||"Right"===this.parent.getFrozenMode()||this.parent.getFrozenColumns())||r.renderFrozenRightContent)&&(this.parent.currentViewData=h.map(function(e){return e.data})):this.parent.currentViewData=h.map(function(e){return e.data}),"grouping"===r.requestType&&(this.parent.currentViewData.records=this.parent.currentViewData.records.filter(function(e,t){return i.parent.currentViewData.records.indexOf(e)===t})),ue(this.parent)&&this.parent.vcRows.length&&["save","delete"].some(function(e){return r.requestType===e})?h=this.parent.vcRows:h},e.prototype.setBlockForManualRefresh=function(e,t,r){var i=this.model.pageSize/2;this.includePrevPage?(e[t[0]-1]=r.slice(0,i),e[t[0]]=r.slice(i,2*i),e[t[1]]=r.slice(2*i,3*i),e[t[2]]=r.slice(3*i,4*i)):(e[t[0]]=r.slice(0,i),e[t[1]]=r.slice(i,2*i),e[t[2]]=r.slice(2*i,3*i),e[t[2]+1]=r.slice(3*i,4*i))},e.prototype.getBlockIndexes=function(e){return[e+(e-1),2*e]},e.prototype.getPage=function(e){return e%2==0?e/2:(e+1)/2},e.prototype.isBlockAvailable=function(e){return e in this.cache},e.prototype.isMovableBlockAvailable=function(e){return e in this.movableCache},e.prototype.isFrozenRightBlockAvailable=function(e){return e in this.frozenRightCache},e.prototype.getData=function(){return{page:this.model.currentPage,blockIndexes:this.getBlockIndexes(this.model.currentPage),direction:"down",columnIndexes:this.parent.getColumnIndexesInView()}},e.prototype.getStartIndex=function(e,t,r){void 0===r&&(r=!0);var i=e%2==0,n=(this.getPage(e)-1)*this.model.pageSize;return r||!i?n:n+~~(this.model.pageSize/2)},e.prototype.getColumnIndexes=function(e){var r=this;void 0===e&&(e=this.parent.getHeaderContent().querySelector("."+_r)),this.parent.isFrozenGrid()&&(e=e.querySelector("."+Kr));var i=[],n=0|e.scrollLeft,o=Object.keys(this.cOffsets),s=e.getBoundingClientRect().width;n=Math.min(this.cOffsets[o.length-1]-s,n);var a=t.Browser.isDevice?2*s:s/2,l=n+s+(0===n?a:0);return o.some(function(e){var t=Number(e),o=r.cOffsets[""+e];return n-a<=o&&l+a>=o&&i.push(t),l+a<o}),this.addFrozenIndex(i),i},e.prototype.addFrozenIndex=function(e){if(this.parent.getFrozenColumns()&&this.parent.enableColumnVirtualization&&0===e[0])for(var t=0;t<this.parent.getFrozenColumns();t++)e.push(e[e.length-1]+1)},e.prototype.checkAndResetCache=function(e){var t=["paging","refresh","sorting","filtering","searching","grouping","ungrouping","reorder","save","delete"];this.parent.getFrozenColumns()&&this.parent.frozenRows&&this.parent.enableColumnVirtualization&&"reorder"===e&&t.splice(t.indexOf(e),1);var r=t.some(function(t){return e===t});return r&&(this.cache={},this.data={},this.groups={},this.movableCache={},this.frozenRightCache={}),r},e.prototype.refreshColOffsets=function(){var e=this,t=0;this.cOffsets={};for(var r=this.parent.groupSettings.columns.length,i=this.parent.columns,n=i.length,o=this.parent.groupSettings.columns,s=0;s<o.length;s++)this.cOffsets[parseInt(s.toString(),10)]=30+(0|this.cOffsets[s-1]);for(var a=Array.apply(null,Array(n)).map(function(){return t++}),l=0;l<a.length;l++)a[parseInt(l.toString(),10)]=a[parseInt(l.toString(),10)]+r,this.cOffsets[a[parseInt(l.toString(),10)]]=(0|this.cOffsets[a[parseInt(l.toString(),10)]-1])+(function(t){return t.visible&&(e.parent.groupSettings.showGroupedColumn?t.visible:e.parent.groupSettings.columns.indexOf(t.field)<0)}(i[parseInt(l.toString(),10)])?parseInt(i[parseInt(l.toString(),10)].width,10):0)},e.prototype.updateGroupRow=function(e,t){for(var r=e[0],i=[],n=Object.keys(this.cache),o=0;o<n.length;o++)Number(n[parseInt(o.toString(),10)])<t&&(i=i.concat(this.cache[n[parseInt(o.toString(),10)]]));return r&&r.isDataRow||t%2==0?e:this.iterateGroup(e,i)},e.prototype.iterateGroup=function(e,t){var r=e[0],i=0;return r&&r.isDataRow?e:(e.some(function(e){return t.some(function(t,r){var n=t&&void 0!==t.data.field&&t.data.field===e.data.field&&t.data.key===e.data.key;return n&&(i=r),n})})&&(e.shift(),e=this.iterateGroup(e,t.slice(i))),e)},e.prototype.getRows=function(){for(var e=[],t=Object.keys(this.cache),r=0;r<t.length;r++)e=e.concat(this.cache[t[parseInt(r.toString(),10)]]);return e},e.prototype.generateCells=function(e){for(var t=[],r=this.parent.columnModel,i=0;i<r.length;i++)t.push(this.rowModelGenerator.generateCell(r[parseInt(i.toString(),10)],null,null,null,null,e));return t},e.prototype.getGroupVirtualRecordsByIndex=function(e){for(var t=this.parent.contentModule.getGroupedTotalBlocks(),r=this.parent.contentModule.getBlockSize(),i=1;i<=t;i++){var n=0;this.cache[parseInt(i.toString(),10)]=[];for(var o=(i-1)*r;o<e.length&&n!==r;o++)this.cache[parseInt(i.toString(),10)].push(e[parseInt(o.toString(),10)]),e[parseInt(o.toString(),10)].isDataRow&&n++}},e}(),Ao=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Lo=function(i){function n(e,t){var r=i.call(this,e,t)||this;return r.prevHeight=0,r.startIndex=0,r.preStartIndex=0,r.preventEvent=!1,r.actions=["filtering","searching","grouping","ungrouping"],r.offsets={},r.tmpOffsets={},r.virtualEle=new Bo,r.offsetKeys=[],r.isFocused=!1,r.isSelection=!1,r.isBottom=!1,r.isTop=!1,r.rndrCount=0,r.empty=void 0,r.isCancel=!1,r.requestTypes=["beginEdit","cancel","delete","add","save"],r.isNormaledit="Normal"===r.parent.editSettings.mode,r.virtualData={},r.emptyRowData={},r.vfColIndex=[],r.frzIdx=1,r.isContextMenuOpen=!1,r.isSelectionScroll=!1,r.validationCheck=!1,r.locator=t,r.eventListener("on"),r.parent.on(hr,r.setVisible,r),r.vgenerator=r.generator,r}return Ao(n,i),n.prototype.renderTable=function(){this.header=this.locator.getService("rendererFactory").getRenderer(e.RenderType.Header),i.prototype.renderTable.call(this),this.virtualEle.table=this.getTable(),this.virtualEle.content=this.content=this.getPanel().querySelector("."+Yr),this.virtualEle.renderWrapper(this.parent.height),this.virtualEle.renderPlaceHolder(),this.virtualEle.wrapper.style.position="absolute";var t=this.parent.dataSource instanceof r.DataManager&&!this.parent.dataSource.dataSource.offline,n={container:this.content,pageHeight:2*this.getBlockHeight(),debounceEvent:t,axes:this.parent.enableColumnVirtualization?["X","Y"]:["Y"]};this.observer=new Oo(this.virtualEle.wrapper,n)},n.prototype.renderEmpty=function(e){this.getTable().appendChild(e),this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector(li).innerHTML=""),this.virtualEle.adjustTable(0,0)},n.prototype.getReorderedFrozenRows=function(e){var t=e.virtualInfo.blockIndexes,r=e.virtualInfo.columnIndexes,i=e.virtualInfo.page;e.virtualInfo.blockIndexes=[1,2],e.virtualInfo.page=1,e.renderMovableContent||(e.virtualInfo.columnIndexes=[]);var n=this.parent.getCurrentViewRecords().length,o=this.parent.renderModule.data.dataManager.dataSource.json.slice(0,n),s=this.vgenerator.generateRows(o,e);return e.virtualInfo.blockIndexes=t,e.virtualInfo.columnIndexes=r,e.virtualInfo.page=i,s.splice(0,this.parent.frozenRows)},n.prototype.scrollListener=function(e){if(this.scrollAfterEdit(),this.parent.enablePersistence&&(this.parent.scrollPosition=e.offset),this.preventEvent||this.parent.isDestroyed)return void(this.preventEvent=!1);if(this.parent.islazyloadRequest&&"down"===e.direction)return this.parent.removeMaskRow(),void(this.parent.islazyloadRequest=!1);t.isNullOrUndefined(document.activeElement)?this.isFocused=!1:this.isFocused=this.content===t.closest(document.activeElement,"."+Yr)||this.content===document.activeElement;var r=e.sentinel,i=this.currentInfo=this.getInfoFromView(e.direction,r,e.offset);return ue(this.parent)?i.blockIndexes&&this.prevInfo.blockIndexes.toString()===i.blockIndexes.toString()?void this.parent.removeMaskRow():(i.event="refresh-virtual-block",t.isNullOrUndefined(i.offsets)||(i.offsets.top=this.content.scrollTop),this.parent.pageSettings.currentPage=i.page,this.parent.enableVirtualMaskRow&&(this.parent.showMaskRow(r.axis),this.parent.addShimmerEffect()),void this.parent.notify(i.event,{requestType:"virtualscroll",virtualInfo:i,focusElement:e.focusElement})):this.prevInfo&&("Y"===r.axis&&this.prevInfo.blockIndexes.toString()===i.blockIndexes.toString()||"X"===r.axis&&this.prevInfo.columnIndexes.toString()===i.columnIndexes.toString())?(this.parent.removeMaskRow(),t.Browser.isIE&&this.parent.hideSpinner(),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType,"Y"===r.axis&&this.restoreEdit(),void(this.parent.groupSettings.enableLazyLoading&&1===this.prevInfo.blockIndexes[0]&&1===i.blockIndexes[0]&&"up"===e.direction&&this.virtualEle.adjustTable(0,i.offsets.top<this.offsets[1]?0:this.getBlockHeight()))):(this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization?i.columnIndexes:[]),this.parent.pageSettings.currentPage=i.loadNext&&!i.loadSelf?i.nextInfo.page:i.page,this.requestType="virtualscroll",this.parent.enableVirtualMaskRow&&(this.parent.showMaskRow(r.axis),this.parent.addShimmerEffect()),this.parent.islazyloadRequest=!1,this.parent.notify(i.event,{requestType:"virtualscroll",virtualInfo:i,focusElement:e.focusElement}),void(this.parent.enableColumnVirtualization&&!this.parent.getContentTable().querySelector("tr.e-row")&&(this.parent.removeMaskRow(),this.appendContent(void 0,void 0,{requestType:"virtualscroll",virtualInfo:i,focusElement:e.focusElement}),this.prevInfo=i)))},n.prototype.block=function(e){return this.vgenerator.isBlockAvailable(e)},n.prototype.getInfoFromView=function(e,t,r){var i=!1,n=[],o={direction:e,sentinelInfo:t,offsets:r,startIndex:this.preStartIndex,endIndex:this.preEndIndex};o.page=this.getPageFromTop(r.top,o),o.blockIndexes=n=this.vgenerator.getBlockIndexes(o.page),o.loadSelf=!this.vgenerator.isBlockAvailable(n[o.block]);var s=this.ensureBlocks(o);if("upArrow"===this.activeKey&&o.blockIndexes.toString()!==s.toString()){var a=s[s.length-1];-1===o.blockIndexes.indexOf(a)&&(i=!0)}if(o.blockIndexes=s,o.loadNext=!s.filter(function(e){return-1===n.indexOf(e)}).every(this.block.bind(this)),o.event=o.loadNext||o.loadSelf?er:mr,o.nextInfo=o.loadNext?{page:Math.max(1,o.page+("down"===e?1:-1))}:{},i&&(o.blockIndexes=[o.blockIndexes[0]-1,o.blockIndexes[0],o.blockIndexes[0]+1]),"downArrow"===this.activeKey&&!isNaN(this.rowIndex)){var l=Math.ceil(this.rowIndex/this.getBlockSize());1!==l&&(o.blockIndexes[1]!==l||o.blockIndexes.length<3)&&(o.blockIndexes=[l-1,l,l+1])}return o.columnIndexes="X"===t.axis?this.vgenerator.getColumnIndexes():this.parent.getColumnIndexesInView(),this.parent.enableColumnVirtualization&&"X"===t.axis&&(o.event=mr),o},n.prototype.setKeyboardNavIndex=function(){this.blazorDataLoad=!0,"downArrow"!==this.activeKey&&"upArrow"!==this.activeKey||(this.blzRowIndex="downArrow"===this.activeKey?this.rowIndex+1:this.rowIndex-1,document.activeElement.blur())},n.prototype.ensureBlocks=function(e){var t,r=this,i=e.blockIndexes[e.block],n=i,o=Math.max,s="down"===e.direction?[o(i,1),++i,++i]:[o(i-1,1),i,i+1];return this.prevInfo=this.prevInfo||this.vgenerator.getData(),this.parent.enableColumnVirtualization&&this.parent.isFrozenGrid()&&("X"===e.sentinelInfo.axis||"Y"===e.sentinelInfo.axis&&e.page===this.prevInfo.page)&&(s=this.prevInfo.blockIndexes),s=s.filter(function(e,t){return s.indexOf(e)===t}),this.prevInfo.blockIndexes.toString()===s.toString()?s:((e.loadSelf||"down"===e.direction&&this.isEndBlock(n))&&(s=this.vgenerator.getBlockIndexes(e.page)),s.some(function(e,i){var n=e===(ue(r.parent)?r.getGroupedTotalBlocks():r.getTotalBlocks());return n&&(t=i),n}),void 0!==t&&(s=s.slice(0,t+1),0===e.block&&1===s.length&&this.vgenerator.isBlockAvailable(s[0]-1)&&(s=[s[0]-1,s[0]])),s)},n.prototype.appendContent=function(e,r,i){var n=this,o=this.parent.isFrozenGrid(),s=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),a=this.parent.enableColumnVirtualization&&o;this.checkFirstBlockColIndexes(i);var l=i.virtualInfo.sentinelInfo&&"Y"===i.virtualInfo.sentinelInfo.axis&&this.currentInfo.page&&this.currentInfo.page!==i.virtualInfo.page?this.currentInfo:i.virtualInfo;this.prevInfo=this.prevInfo||i.virtualInfo;var h=l.columnIndexes[0]-1;a&&l.columnIndexes[0]===s&&(h=l.columnIndexes[0]-s-1);var p,d=this.getColumnOffset(h),c=l.blockIndexes;this.parent.groupSettings.columns.length&&this.refreshOffsets(),"100%"===this.parent.height&&(this.parent.element.style.height="100%");var u=this.parent.height.toString().indexOf("%")<0?this.content.getBoundingClientRect().height:this.parent.element.getBoundingClientRect().height;if(!this.requestTypes.some(function(e){return e===n.requestType})){var g=this.getTranslateY(this.content.scrollTop,u,l);this.parent.groupSettings.enableLazyLoading&&l&&this.prevInfo&&1===this.prevInfo.blockIndexes[0]&&1===l.blockIndexes[0]&&"up"===l.direction?this.virtualEle.adjustTable(0,this.content.scrollTop<this.offsets[1]?0:this.getBlockHeight()):this.virtualEle.adjustTable(a?0:d,g),a&&this.virtualEle.adjustMovableTable(d,0)}if(this.parent.enableColumnVirtualization&&(this.header.virtualEle.adjustTable(a?0:d,0),a&&this.header.virtualEle.adjustMovableTable(d,0)),this.parent.enableColumnVirtualization){var f=l.columnIndexes;p=this.getColumnOffset(f[f.length-1])-this.getColumnOffset(f[0]-1)+"",a?this.header.virtualEle.setMovableWrapperWidth(p):this.header.virtualEle.setWrapperWidth(p)}if(a?this.virtualEle.setMovableWrapperWidth(p,t.Browser.isIE||"edge"===t.Browser.info.name):this.virtualEle.setWrapperWidth(p,t.Browser.isIE||"edge"===t.Browser.info.name),!(this.parent.enableColumnVirtualization&&t.isNullOrUndefined(e)&&t.isNullOrUndefined(r))){t.isNullOrUndefined(e)||t.isNullOrUndefined(e.parentNode)||t.remove(e);var m;if(o?i.renderFrozenRightContent?m=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(li):i.renderMovableContent?i.renderMovableContent&&(m=this.parent.getMovableVirtualContent().querySelector(li)):m=this.parent.getFrozenVirtualContent().querySelector(li):m=this.parent.element.querySelector("."+Yr).querySelector(li),m&&(t.remove(m),e=null),this.parent.isReact&&!t.isNullOrUndefined(this.parent.rowTemplate)?e=r:(e=this.parent.createElement(li,{attrs:{role:"rowgroup"}})).appendChild(r),this.parent.frozenRows&&"virtualscroll"===i.requestType&&1===this.parent.pageSettings.currentPage)for(var y=0;y<this.parent.frozenRows;y++)e.children[0].remove();if(o?(i.renderFrozenRightContent?(this.parent.getContent().querySelector(".e-frozen-right-content").querySelector("."+Jr).appendChild(e),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType,this.parent.notify(wr,{case:"refreshHeight"})):i.renderMovableContent?i.renderMovableContent&&(this.parent.getMovableVirtualContent().querySelector("."+Jr).appendChild(e),this.parent.getFrozenMode()!==ri&&(this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType,this.parent.notify(wr,{case:"refreshHeight"}))):this.parent.getFrozenVirtualContent().querySelector("."+Jr).appendChild(e),this.vfColIndex.length&&(i.virtualInfo.columnIndexes=l.columnIndexes=t.extend([],this.vfColIndex),this.vfColIndex=i.renderMovableContent?[]:this.vfColIndex)):(this.getTable().appendChild(e),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType),this.parent.groupSettings.columns.length){if(!ue(this.parent)&&"up"===l.direction){var v=this.offsets[this.getTotalBlocks()]-this.prevHeight;this.parent.groupSettings.enableLazyLoading||(this.preventEvent=!0);var C=this.content.scrollTop;this.content.scrollTop=C+v}this.setVirtualHeight(),this.parent.groupSettings.enableLazyLoading||this.observer.setPageHeight(this.getOffset(c[c.length-1])-this.getOffset(c[0]-1))}this.prevInfo=l,this.isFocused&&"downArrow"!==this.activeKey&&"upArrow"!==this.activeKey&&this.content.focus();var S=Math.ceil(this.getTotalBlocks()/2);if(this.isBottom&&(this.isBottom=!1,this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-1]),this.parent.pageSettings.currentPage===S&&1===c.length&&(this.isBottom=!0,this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-2]),this.parent.isFrozenGrid()&&this.parent.pageSettings.currentPage===S-1&&"up"===l.direction&&(this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-3]),this.isTop&&(this.parent.getContent().firstElementChild.scrollTop=0,this.isTop=!1),"virtualscroll"===i.requestType&&"X"===i.virtualInfo.sentinelInfo.axis&&this.parent.notify(yr,{}),this.focusCell(i),this.restoreEdit(i),this.restoreAdd(i),this.ensureSelectedRowPosition(),this.validationScrollLeft(i,o),!this.initialRowTop){var b=this.parent.element.getBoundingClientRect().top;this.parent.getRowByIndex(0)&&(this.initialRowTop=this.parent.getRowByIndex(0).getBoundingClientRect().top-b)}var w=i.tableName,I="Left-Right"===this.parent.getFrozenMode()?"frozen-right"===w:"movable"===w;o&&!I||(this.vgenerator.startIndex=null,this.vgenerator.currentInfo={},this.vgenerator.includePrevPage=null)}},n.prototype.validationScrollLeft=function(e,t){var r=this.parent.getFrozenColumns(),i=this.parent.getFrozenMode(),n=!t||e&&(r||"Left"===i||"Right"===i?e.renderMovableContent:e.renderFrozenRightContent);if(this.validationCheck&&n)if(this.validationCol){var o=this.vgenerator.cOffsets[this.validationCol.index-this.parent.getVisibleFrozenColumns()-1];this.validationCol=null,this.parent.isFrozenGrid()?this.movableContent.scrollLeft=o:this.content.scrollLeft=o}else this.validationCheck=!1,this.parent.editModule.editFormValidate()},n.prototype.ensureSelectedRowPosition=function(){if(!this.isSelection&&this.isSelectionScroll&&!t.isNullOrUndefined(this.selectRowIndex)){this.isSelectionScroll=!1;var e=this.parent.getRowByIndex(this.selectRowIndex);e&&!this.isRowInView(e)&&this.rowSelected({rowIndex:this.selectRowIndex,row:e},!0)}},n.prototype.checkFirstBlockColIndexes=function(e){if(this.parent.enableColumnVirtualization&&this.parent.isFrozenGrid()&&0===e.virtualInfo.columnIndexes[0]){var r=[],i=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount();if(!e.renderMovableContent&&e.virtualInfo.columnIndexes.length>i){this.vfColIndex=e.virtualInfo.columnIndexes;for(var n=0;n<i;n++)r.push(n);e.virtualInfo.columnIndexes=r}else e.renderMovableContent&&(this.vfColIndex.length||(this.vfColIndex=t.extend([],e.virtualInfo.columnIndexes)),e.virtualInfo.columnIndexes=t.extend([],this.vfColIndex),e.virtualInfo.columnIndexes.splice(0,i))}},n.prototype.focusCell=function(e){if("upArrow"===this.activeKey||"downArrow"===this.activeKey){var t=this.parent.getRowByIndex(this.rowIndex);t.cells[this.cellIndex].focus({preventScroll:!0}),this.parent.selectionSettings.checkboxOnly||this.parent.selectRow(parseInt(t.getAttribute(si),10)),this.activeKey=this.empty}},n.prototype.restoreEdit=function(e){if(this.isNormaledit){var r=this.parent.getFrozenColumns(),i=e&&this.parent.isFrozenGrid(),n=this.parent.getFrozenMode(),o=e&&(r||"Left"===n||"Right"===n?e.renderMovableContent:e.renderFrozenRightContent);if((!i||i&&o)&&this.parent.editSettings.allowEditing&&this.parent.editModule&&!t.isNullOrUndefined(this.editedRowIndex)){var s=this.getRowByIndex(this.editedRowIndex),a=this.content,l=Object.keys(this.virtualData),h=e&&e.virtualInfo&&"X"===e.virtualInfo.sentinelInfo.axis;if(i&&h&&(s=this.parent.getMovableRowByIndex(this.editedRowIndex),a=this.movableContent),l.length&&s&&!a.querySelector("."+ei)){var p=s.getBoundingClientRect().top;(h||p<this.content.offsetHeight&&p>this.parent.getRowHeight())&&(this.parent.isEdit=!1,this.parent.editModule.startEdit(s))}if(s&&this.content.querySelector("."+ei)&&!l.length){var d=t.extend({},this.getRowObjectByIndex(this.editedRowIndex));this.virtualData=this.getVirtualEditedData(d)}}this.restoreAdd(e)}},n.prototype.getVirtualEditedData=function(e){var t=[].slice.call(this.parent.element.getElementsByClassName("e-gridform"));if(!(this.parent.editModule&&this.parent.editModule.formObj&&this.parent.editModule.formObj.isDestroyed))for(var r=0;r<t.length;r++)e=this.parent.editModule.getCurrentEditedData(t[parseInt(r.toString(),10)],e);return e},n.prototype.restoreAdd=function(e){var t=this.parent.getFrozenColumns(),r=e&&this.parent.isFrozenGrid(),i=this.parent.getFrozenMode(),n=e&&e.virtualInfo&&e.virtualInfo.sentinelInfo&&"X"===e.virtualInfo.sentinelInfo.axis&&r?!(this.parent.getMovableVirtualHeader().querySelector("."+ti)||this.parent.getMovableVirtualContent().querySelector("."+ti)):!this.parent.element.querySelector("."+ti),o=e&&(t||"Left"===i||"Right"===i?e.renderMovableContent:e.renderFrozenRightContent);if((!r||r&&o)&&this.isNormaledit&&this.isAdd&&n){var s="Top"===this.parent.editSettings.newRowPosition&&this.content.scrollTop<this.parent.getRowHeight(),a="Bottom"===this.parent.editSettings.newRowPosition&&this.parent.pageSettings.currentPage===this.maxPage;(s||a)&&(this.parent.isEdit=!1,this.parent.addRecord())}},n.prototype.onDataReady=function(e){t.isNullOrUndefined(e.count)||(this.count=e.count,this.maxPage=Math.ceil(e.count/this.parent.pageSettings.pageSize)),this.vgenerator.checkAndResetCache(e.requestType),["refresh","filtering","searching","grouping","ungrouping","reorder",void 0].some(function(t){return e.requestType===t})&&this.refreshOffsets(),this.setVirtualHeight(),this.resetScrollPosition(e.requestType)},n.prototype.setVirtualHeight=function(e){var r=this.parent.enableColumnVirtualization?this.getColumnOffset(this.parent.columns.length+this.parent.groupSettings.columns.length-1)+"px":"100%";if(this.parent.isFrozenGrid()){var i=1===this.parent.pageSettings.currentPage&&Object.keys(this.offsets).length<=2?this.offsets[1]:this.offsets[this.getTotalBlocks()-2];i=i>this.content.clientHeight?i:0,this.virtualEle.setVirtualHeight(i,r)}else{var n=this.offsets[ue(this.parent)&&0!==this.count?this.getGroupedTotalBlocks():this.getTotalBlocks()];this.virtualEle.setVirtualHeight(n,r),this.virtualEle&&this.virtualEle.wrapper&&(this.virtualEle.wrapper.style.minHeight=t.isNullOrUndefined(n)?"0px":t.formatUnit(this.parent.height))}this.parent.enableColumnVirtualization&&(this.header.virtualEle.setVirtualHeight(1,r),this.parent.isFrozenGrid()&&(this.virtualEle.setMovableVirtualHeight(1,r),this.header.virtualEle.setMovableVirtualHeight(1,r)))},n.prototype.getPageFromTop=function(e,t){var r=this,i=ue(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks(),n=0;return this.offsetKeys.some(function(o){var s=Number(o),a=e<=r.offsets[""+o]||s===i&&e>r.offsets[""+o];return a&&(r.offsetKeys.length%2!=0&&s.toString()===r.offsetKeys[r.offsetKeys.length-2]&&e<=r.offsets[r.offsetKeys.length-1]&&(s+=1),t.block=s%2==0?1:0,n=Math.max(1,Math.min(r.vgenerator.getPage(s),r.maxPage))),a}),n},n.prototype.getTranslateY=function(e,t,r,i){void 0===r&&((r={page:this.getPageFromTop(e,{})}).blockIndexes=this.vgenerator.getBlockIndexes(r.page));var n=(r.blockIndexes[0]||1)-1,o=this.getOffset(n),s=this.getOffset(r.blockIndexes[r.blockIndexes.length-1]);i&&(r=this.prevInfo);var a=o>e?this.getOffset(n-1):s<e+t?this.getOffset(n+1):o,l=this.offsets[r.blockIndexes[r.blockIndexes.length-1]]-this.tmpOffsets[r.blockIndexes[0]],h=ue(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks();return a+l>this.offsets[parseInt(h.toString(),10)]&&(a-=a+l-this.offsets[parseInt(h.toString(),10)]),a},n.prototype.getOffset=function(e){return Math.min(0|this.offsets[parseInt(e.toString(),10)],0|this.offsets[this.maxBlock])},n.prototype.onEntered=function(){var e=this;return function(r,i,n,o,s,a){if(!t.Browser.isIE||s||!a||e.preventEvent||e.parent.enableVirtualMaskRow||e.parent.showSpinner(),e.parent.enableVirtualMaskRow&&!e.preventEvent){var l=parseInt(e.offsetKeys[0],10),h=parseInt(e.offsetKeys[e.offsetKeys.length-1],10),p=e.currentInfo.blockIndexes;p&&p[0]===l&&"up"===n||p&&p[p.length-1]===h&&"down"===n||setTimeout(function(){e.parent.showMaskRow(i.axis)},0)}var d=e.parent.enableColumnVirtualization&&e.parent.isFrozenGrid();e.prevInfo=e.prevInfo||e.vgenerator.getData();var c="X"===i.axis,u=e.prevInfo.offsets?e.prevInfo.offsets.top:null,g=e.content.getBoundingClientRect().height,f=e.getColumnOffset(c?e.vgenerator.getColumnIndexes()[0]-1:e.prevInfo.columnIndexes[0]-1);if(c&&!d){var m=Object.keys(e.vgenerator.cOffsets).length-e.prevInfo.columnIndexes.length,y=e.vgenerator.cOffsets[m-1];f=f>y?y:f}var v=e.getTranslateY(o.top,g,c&&u===o.top?e.prevInfo:void 0,!0);e.virtualEle.adjustTable(d?0:f,Math.min(v,e.offsets[e.maxBlock])),d&&e.virtualEle.adjustMovableTable(f,0),e.parent.enableColumnVirtualization&&(e.header.virtualEle.adjustTable(d?0:f,0),d&&e.header.virtualEle.adjustMovableTable(f,0))}},n.prototype.dataBound=function(){this.parent.notify("refresh-virtual-frozen-height",{}),this.isSelection&&"upArrow"!==this.activeKey&&"downArrow"!==this.activeKey?this.parent.selectRow(this.selectedRowIndex):this.activeKey=this.empty},n.prototype.rowSelected=function(e,t){if((this.isSelection||t)&&!this.isLastBlockRow(e.rowIndex)){var r=Ie(this.content.firstElementChild),i=this.parent.element.getBoundingClientRect().top,n=e.row.getBoundingClientRect().top-i,o=this.content.getBoundingClientRect().height,s=o<n,a=s?n-o:this.initialRowTop-n,l=s?r.height-a:r.height+a;this.virtualEle.adjustTable(r.width,l),this.content.querySelector("tbody").lastElementChild.getBoundingClientRect().top-i<o&&(l+=o-(e.row.getBoundingClientRect().top-i),this.virtualEle.adjustTable(r.width,l-this.parent.getRowHeight()/2))}this.isSelection=!1},n.prototype.isLastBlockRow=function(e){var t=this.parent.getContent().firstElementChild,r=Math.floor(t.offsetHeight/this.parent.getRowHeight())-1;return e>=this.maxPage*this.parent.pageSettings.pageSize-r},n.prototype.refreshMaxPage=function(){this.parent.groupSettings.columns.length&&this.parent.vcRows.length&&(this.maxPage=Math.ceil(this.parent.vcRows.length/this.parent.pageSettings.pageSize))},n.prototype.setVirtualPageQuery=function(e){var r=this.parent.getContent().querySelector(".e-row");if(r&&this.parent.isManualRefresh&&this.currentInfo.blockIndexes&&3===this.currentInfo.blockIndexes.length){this.vgenerator.startIndex=parseInt(r.getAttribute("data-rowindex"),10),this.vgenerator.currentInfo=t.extend({},this.currentInfo),this.vgenerator.currentInfo.blockIndexes=this.currentInfo.blockIndexes.slice(),(this.vgenerator.includePrevPage=this.currentInfo.blockIndexes[0]%2==0)?(this.vgenerator.startIndex=this.vgenerator.startIndex-this.getBlockSize(),this.vgenerator.currentInfo.blockIndexes.unshift(this.currentInfo.blockIndexes[0]-1)):this.vgenerator.currentInfo.blockIndexes.push(this.currentInfo.blockIndexes[this.currentInfo.blockIndexes.length-1]+1);var i=(this.vgenerator.currentInfo.blockIndexes[0]-1)*this.getBlockSize(),n=this.vgenerator.currentInfo.blockIndexes.length*this.getBlockSize();e.query.skip(i),e.query.take(n),e.skipPage=!0}},n.prototype.eventListener=function(e){var t=this;this.parent[""+e](Xt,this.onDataReady,this),this.parent.addEventListener(qt,this.dataBound.bind(this)),this.parent.addEventListener(Bt,this.actionBegin.bind(this)),this.parent.addEventListener(Nt,this.actionComplete.bind(this)),this.parent.addEventListener("rowSelected",this.rowSelected.bind(this)),this.parent[""+e](mr,this.refreshContentRows,this),this.parent[""+e]("refresh-Virtual-LazyLoad-Cache",this.refreshVirtualLazyLoadCache,this),this.parent[""+e]("select-virtual-Row",this.selectVirtualRow,this),this.parent[""+e]("virtaul-cell-focus",this.virtualCellFocus,this),this.parent[""+e]("virtual-scroll-edit-action-begin",this.editActionBegin,this),this.parent[""+e]("virtual-scroll-add-action-begin",this.addActionBegin,this),this.parent[""+e]("virtual-scroll-edit",this.restoreEdit,this),this.parent[""+e]("virtual-scroll-edit-success",this.editSuccess,this),this.parent[""+e]("refresh-virtual-cache",this.refreshCache,this),this.parent[""+e]("edit-reset",this.resetIsedit,this),this.parent[""+e](Mr,this.getVirtualData,this),this.parent[""+e]("virtual-scroll-edit-cancel",this.editCancel,this),this.parent[""+e]("refresh-virtual-max-page",this.refreshMaxPage,this),this.parent[""+e]("set-virtual-page-query",this.setVirtualPageQuery,this),this.parent[""+e]("select-row-on-context-open",this.selectRowOnContextOpen,this),this.parent[""+e]("reset-virtual-focus",this.resetVirtualFocus,this),this.parent[""+e]("refresh-virtual-editform-cells",this.refreshCells,this),this.parent[""+e]("scroll-to-edit",this.scrollToEdit,this);for(var r=this.actions,i=0;i<r.length;i++)this.parent[""+e](r[parseInt(i.toString(),10)]+"-begin",this.onActionBegin,this);var n=function(){t.observer.observe(function(e){return t.scrollListener(e)},t.onEntered());var e=t.parent;if(e.enablePersistence&&e.scrollPosition){t.content.scrollTop=e.scrollPosition.top;var r={direction:"down",sentinel:t.observer.sentinelInfo.down,offset:e.scrollPosition,focusElement:e.element};t.scrollListener(r),e.enableColumnVirtualization&&(t.content.scrollLeft=e.scrollPosition.left)}t.parent.off(Yt,n)};this.parent.on(Yt,n,this)},n.prototype.refreshVirtualLazyLoadCache=function(e){var r=this.currentInfo.blockIndexes;t.isNullOrUndefined(this.currentInfo.blockIndexes)&&(r=[1,2]);for(var i,n,o,s=0;s<r.length;s++)for(var a=this.vgenerator.cache[r[parseInt(s.toString(),10)]],l=0;l<a.length;l++)if(a[parseInt(l.toString(),10)].uid===e.uid){i=r[parseInt(s.toString(),10)],n=l,o=a;break}e.count?this.vgenerator.cache[parseInt(i.toString(),10)].splice(n+1,e.count):e.rows&&e.rows.length&&(this.vgenerator.cache[parseInt(i.toString(),10)]=[].slice.call(o.slice(0,n+1)).concat([].slice.call(e.rows)).concat([].slice.call(o.slice(n+1,o.length)))),this.refreshOffsets()},n.prototype.scrollToEdit=function(e){var r=this.parent.isFrozenGrid(),i=!0;if(this.validationCheck=!0,this.isAdd&&this.content.scrollTop>0){i=!1;var n=Object.keys(this.offsets);this.content.scrollTop="Top"===this.parent.editSettings.newRowPosition?0:this.offsets[n.length-1]}var o=this.parent.getRowByIndex(this.editedRowIndex);if(!(o||t.isNullOrUndefined(this.editedRowIndex)||o&&this.isRowInView(o))){var s=this.parent.getRowHeight(),a=this.editedRowIndex*s;t.isNullOrUndefined(a)||(i=!1,this.content.scrollTop=a)}if(e&&i){var l=this.vgenerator.cOffsets[e.index-this.parent.getVisibleFrozenColumns()-1];if(!this.parent.enableColumnVirtualization){var h=this.parent.getHeaderContent().querySelector('.e-headercelldiv[e-mappinguid="'+e.uid+'"]');l=r?h.parentElement.offsetLeft-this.parent.getFrozenVirtualHeader().offsetWidth:h.parentElement.offsetLeft}r?this.parent.getMovableVirtualContent().scrollLeft=this.parent.enableRtl?-Math.abs(l):l:this.content.scrollLeft=this.parent.enableRtl?-Math.abs(l):l}e&&!i&&(this.validationCol=e)},n.prototype.refreshCells=function(e){e.cells=this.vgenerator.generateCells(e.foreignKeyData)},n.prototype.resetVirtualFocus=function(e){this.isCancel=e.isCancel},n.prototype.getVirtualData=function(e){if(this.isNormaledit){var t=this.parent.element.querySelector('.e-griderror:not([style*="display: none"])'),r=Object.keys(this.virtualData);if(e.isScroll=0!==r.length&&this.currentInfo.sentinelInfo&&"X"===this.currentInfo.sentinelInfo.axis,t)return;this.virtualData=r.length?this.virtualData:e.virtualData,this.getVirtualEditedData(this.virtualData),e.virtualData=this.virtualData,e.isAdd=this.isAdd,e.isCancel=this.isCancel}},n.prototype.selectRowOnContextOpen=function(e){this.isContextMenuOpen=e.isOpen},n.prototype.editCancel=function(e){var r=ze(this.parent,e.data);t.isNullOrUndefined(r)||(e.data=this.parent.getCurrentViewRecords()[parseInt(r.toString(),10)])},n.prototype.editSuccess=function(e){this.isNormaledit&&(!this.isAdd&&e.data&&this.updateCurrentViewData(e.data),this.isAdd=!1)},n.prototype.updateCurrentViewData=function(e){var r=ze(this.parent,e);t.isNullOrUndefined(r)||(this.parent.getCurrentViewRecords()[parseInt(r.toString(),10)]=e)},n.prototype.actionBegin=function(e){"virtualscroll"!==e.requestType&&(this.requestType=e.requestType),e.cancel||this.parent.notify("refresh-virtual-frozenrows",e)},n.prototype.virtualCellFocus=function(e){var r=document.activeElement;if(!r.classList.contains(Ur)&&r instanceof HTMLInputElement&&(r=r.closest(".e-rowcell")),r&&r.classList.contains(Ur)&&e&&("upArrow"===e.action||"downArrow"===e.action)){var i=parseInt(r.parentElement.getAttribute(si),10);if(e&&("downArrow"===e.action||"upArrow"===e.action)){var n=this.parent.getContent().firstElementChild;"downArrow"===e.action?i+=1:i-=1,this.rowIndex=i,this.cellIndex=parseInt(r.getAttribute(oi),10);var o=this.parent.getRowByIndex(i),s=this.parent.pageSettings.currentPage,a=Math.floor(n.offsetHeight/this.parent.getRowHeight())-1,l=!1;t.isNullOrUndefined(o)&&(l=!0,("downArrow"===e.action&&s===this.maxPage-1||"upArrow"===e.action&&1===s)&&(l=!1)),l||Fe(o,this.parent)&&"downArrow"===e.action||Te(o,2*this.parent.getRowHeight())&&"upArrow"===e.action?(this.activeKey=e.action,n.scrollTop="downArrow"===e.action?(i-a)*this.parent.getRowHeight():i*this.parent.getRowHeight()):this.activeKey=this.empty,this.parent.selectionSettings.checkboxOnly||this.parent.selectRow(i)}}},n.prototype.editActionBegin=function(e){this.editedRowIndex=e.index;var r=t.extend({},this.getRowObjectByIndex(e.index)),i=Object.keys(this.virtualData);e.data=i.length?this.virtualData:r,e.isScroll=0!==i.length&&this.currentInfo.sentinelInfo&&"X"===this.currentInfo.sentinelInfo.axis},n.prototype.getEditedRowObject=function(){for(var e,t=this.parent.vcRows,r=0;r<t.length;r++)t[parseInt(r.toString(),10)].index===this.editedRowIndex&&(e=t[parseInt(r.toString(),10)]);return e},n.prototype.refreshCache=function(e){var t=Math.ceil((this.editedRowIndex+1)/this.getBlockSize()),r=this.editedRowIndex-(t-1)*this.getBlockSize();this.parent.groupSettings.columns.length?this.getEditedRowObject().data=e.data:(this.vgenerator.cache[parseInt(t.toString(),10)][parseInt(r.toString(),10)].data=e.data,this.vgenerator.movableCache[parseInt(t.toString(),10)]&&(this.vgenerator.movableCache[parseInt(t.toString(),10)][parseInt(r.toString(),10)].data=e.data),this.vgenerator.frozenRightCache[parseInt(t.toString(),10)]&&(this.vgenerator.frozenRightCache[parseInt(t.toString(),10)][parseInt(r.toString(),10)].data=e.data))},n.prototype.actionComplete=function(e){if(this.parent.enableVirtualization){var t=["delete","save","cancel"],r=["sorting","filtering","grouping","refresh","searching","ungrouping","reorder"];t.some(function(t){return t===e.requestType})&&(this.refreshOffsets(),this.parent.isFrozenGrid()?(this.vgenerator.refreshColOffsets(),this.parent.contentModule.virtualRenderer.virtualEle.setVirtualHeight()):this.refreshVirtualElement()),this.isNormaledit&&(r.some(function(t){return t===e.requestType})||t.some(function(t){return t===e.requestType}))&&(this.isCancel=!0,this.isAdd=!1,this.editedRowIndex=this.empty,this.virtualData={},this.parent.editModule&&(this.parent.editModule.editModule.previousData=void 0)),this.parent.enableColumnVirtualization&&"filterafteropen"===e.requestType&&this.currentInfo.columnIndexes&&this.currentInfo.columnIndexes[0]>0&&this.parent.resetFilterDlgPosition(e.columnName)}},n.prototype.resetIsedit=function(){this.parent.enableVirtualization&&this.isNormaledit&&(this.parent.editSettings.allowEditing&&Object.keys(this.virtualData).length||this.parent.editSettings.allowAdding&&this.isAdd)&&(this.parent.isEdit=!0)},n.prototype.scrollAfterEdit=function(){if(this.parent.editModule&&this.parent.editSettings.allowEditing&&this.isNormaledit&&this.parent.element.querySelector(".e-gridform")){var e=this.parent.element.querySelector("."+ei),r=this.parent.element.querySelector("."+ti);if(e||r){var i=e?t.extend({},this.getRowObjectByIndex(this.editedRowIndex)):t.extend({},this.emptyRowData),n=Object.keys(this.virtualData);this.virtualData=n.length?this.getVirtualEditedData(this.virtualData):this.getVirtualEditedData(i)}}},n.prototype.createEmptyRowdata=function(){var e=this;this.parent.columnModel.filter(function(t){e.emptyRowData[t.field]=e.empty})},n.prototype.addActionBegin=function(e){if(this.isNormaledit){Object.keys(this.emptyRowData).length||this.createEmptyRowdata(),this.isAdd=!0;var t=this.parent.pageSettings.currentPage;!this.parent.frozenRows&&this.content.scrollTop>0&&"Top"===this.parent.editSettings.newRowPosition&&(this.isAdd=!0,this.onActionBegin(),e.startEdit=!1,this.content.scrollTop=0),t<this.maxPage-1&&"Bottom"===this.parent.editSettings.newRowPosition&&(this.isAdd=!0,this.parent.setProperties({pageSettings:{currentPage:this.maxPage-1}},!0),e.startEdit=!1,this.content.scrollTop=this.offsets[this.offsetKeys.length])}},n.prototype.getRowObjectByIndex=function(e){return this.getRowCollection(e,!1,!0)},n.prototype.getBlockSize=function(){return this.parent.pageSettings.pageSize>>1},n.prototype.getBlockHeight=function(){return this.getBlockSize()*this.parent.getRowHeight()},n.prototype.isEndBlock=function(e){var t=ue(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks();return e>=t||e===t-1},n.prototype.getGroupedTotalBlocks=function(){var e=this.parent.vcRows;return Math.floor(e.length/this.getBlockSize()<1?1:e.length/this.getBlockSize())},n.prototype.getTotalBlocks=function(){return Math.ceil(this.count/this.getBlockSize())},n.prototype.getColumnOffset=function(e){return 0|this.vgenerator.cOffsets[parseInt(e.toString(),10)]},n.prototype.getModelGenerator=function(){return new ko(this.parent)},n.prototype.resetScrollPosition=function(e){this.actions.some(function(t){return t===e})&&(this.preventEvent=0!==this.content.scrollTop,this.content.scrollTop=0),"virtualscroll"!==e&&(this.isAdd=!1)},n.prototype.onActionBegin=function(e){this.parent.setProperties({pageSettings:{currentPage:1}},!0)},n.prototype.getRows=function(){return this.vgenerator.getRows()},n.prototype.getRowByIndex=function(e){var r;return ue(this.parent)?r=t.isNullOrUndefined(e)?void 0:this.parent.getDataRows()[parseInt(e.toString(),10)]:this.prevInfo&&(r=this.getRowCollection(e,!1)),r},n.prototype.getMovableVirtualRowByIndex=function(e){return this.getRowCollection(e,!0)},n.prototype.getFrozenRightVirtualRowByIndex=function(e){return this.getRowCollection(e,!1,!1,!0)},n.prototype.getRowCollection=function(e,r,i,n){var o=(this.prevInfo.blockIndexes[0]-1)*this.getBlockSize();this.parent.pageSettings.pageSize%2!=0&&(o+=Math.floor(o/this.getBlockSize()/2));var s=r?this.parent.getMovableDataRows():this.parent.getDataRows();s=n?this.parent.getFrozenRightDataRows():s;var a=i?this.parent.getCurrentViewRecords():s;i&&this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&(o=parseInt(this.parent.getRows()[0].getAttribute(si),10),a=a.filter(function(e){return t.isNullOrUndefined(e.items)}));var l=a[e-o];return this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(l=i?e<=this.parent.frozenRows?this.parent.getRowsObject()[parseInt(e.toString(),10)].data:l:e<=this.parent.frozenRows?s[parseInt(e.toString(),10)]:s[e-o+this.parent.frozenRows]),l},n.prototype.getVirtualRowIndex=function(e){return(this.prevInfo.blockIndexes[0]-1)*this.getBlockSize()+e},n.prototype.refreshOffsets=function(){var e=this.parent,t=0,r=this.getBlockSize(),i=ue(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks();this.prevHeight=this.offsets[parseInt(i.toString(),10)],this.maxBlock=i%2==0?i-2:i-1,this.offsets={};for(var n=Array.apply(null,Array(i)).map(function(){return++t}),o=0;o<n.length;o++){var s=(this.vgenerator.cache[n[parseInt(o.toString(),10)]]||[]).length,a=ue(this.parent)?e.vcRows.length%r:this.count%r,l=!ue(this.parent)&&n[parseInt(o.toString(),10)]in this.vgenerator.cache?s*this.parent.getRowHeight():a&&n[parseInt(o.toString(),10)]===i?a*this.parent.getRowHeight():this.getBlockHeight();this.offsets[n[parseInt(o.toString(),10)]]=(0|this.offsets[n[parseInt(o.toString(),10)]-1])+l,this.tmpOffsets[n[parseInt(o.toString(),10)]]=0|this.offsets[n[parseInt(o.toString(),10)]-1]}this.offsetKeys=Object.keys(this.offsets),ue(this.parent)&&(this.parent.vGroupOffsets=this.offsets),this.parent.enableColumnVirtualization&&this.vgenerator.refreshColOffsets()},n.prototype.refreshVirtualElement=function(){this.vgenerator.refreshColOffsets(),this.setVirtualHeight()},n.prototype.setVisible=function(e){var r,i,n=this.parent,o=this.parent.getFrozenColumns();o&&(r=[].slice.call(this.parent.getFrozenVirtualContent().querySelectorAll("col")),i=[].slice.call(this.parent.getMovableVirtualContent().querySelectorAll("col")));var s,a=[];(a=this.getRows()).some(function(e){return e.isDataRow&&(s=e),e.isDataRow});var l=!0;!n.groupSettings.columns.length&&s&&(l=!1);for(var h=n.getDataRows(),p=0,d=e.length;p<d;p++){var c=e[parseInt(p.toString(),10)],u=n.getNormalizedColumnIndex(c.uid),g=!0===c.visible?"":"none",f=void 0;if(r&&i?u>=o?(f=i,h=this.parent.getMovableRows(),u-=o):f=r:f=this.getColGroup().children,-1!==u&&s&&u<s.cells.length&&t.setStyleAttribute(f[parseInt(u.toString(),10)],{display:g}),!l){var m=void 0;c.width&&(m=c.visible?this.virtualEle.wrapper.offsetWidth+parseInt(c.width.toString(),10):this.virtualEle.wrapper.offsetWidth-parseInt(c.width.toString(),10)),m>n.width?(this.setDisplayNone(h,u,g,a),this.parent.enableColumnVirtualization&&this.virtualEle.setWrapperWidth(m+""),this.refreshVirtualElement()):l=!0}!this.parent.invokedFromMedia&&c.hideAtMedia&&this.parent.updateMediaColumns(c),this.parent.invokedFromMedia=!1}l||o?this.refreshContentRows({requestType:"refresh"}):this.parent.notify("partial-refresh",{rows:a,args:{isFrozen:!1,rows:a}})},n.prototype.selectVirtualRow=function(e){var r=this;if(e.isAvailable=e.selectedIndex<this.count,e.isAvailable&&!this.isContextMenuOpen&&"upArrow"!==this.activeKey&&"downArrow"!==this.activeKey&&!this.isSelection&&!this.requestTypes.some(function(e){return e===r.requestType})&&!this.parent.selectionModule.isInteracted){var i=this.parent.getRowByIndex(e.selectedIndex),n=this.parent.getRowHeight();if(!i||!this.isRowInView(i)){this.isSelection=!0,this.selectedRowIndex=e.selectedIndex;var o=(e.selectedIndex+1)*n;if(!t.isNullOrUndefined(o)){var s=this.content.scrollTop<o?"down":"up";this.selectRowIndex=e.selectedIndex,this.content.scrollTop=o,this.isSelectionScroll=this.observer.check(s)}}}this.parent.isFrozenGrid()&&this.requestType?this.parent.getTablesCount()===this.frzIdx?(this.requestType=this.empty,this.frzIdx=1):this.frzIdx++:this.requestType=this.empty},n.prototype.isRowInView=function(e){var t=e.getBoundingClientRect().top,r=e.getBoundingClientRect().bottom;return t>=this.content.getBoundingClientRect().top&&r<=this.content.getBoundingClientRect().bottom},n}(Ii),Po=function(e){function r(t,r){var i=e.call(this,t,r)||this;return i.virtualEle=new Bo,i.isMovable=!1,i.gen=new ko(i.parent),i.parent.on(hr,i.setVisible,i),i.parent.on(mr,function(e){return"X"===e.virtualInfo.sentinelInfo.axis?i.refreshUI():null},i),i}return Ao(r,e),r.prototype.renderTable=function(){this.gen.refreshColOffsets(),this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector("."+_r))),e.prototype.renderTable.call(this),this.virtualEle.table=this.getTable(),this.virtualEle.content=this.getPanel().querySelector("."+_r),this.virtualEle.content.style.position="relative",this.virtualEle.renderWrapper(),this.virtualEle.renderPlaceHolder("absolute")},r.prototype.appendContent=function(e){this.isMovable?(this.virtualEle.movableWrapper.appendChild(e),this.isMovable=!1):this.virtualEle.wrapper.appendChild(e)},r.prototype.refreshUI=function(){this.isMovable=this.parent.isFrozenGrid(),this.setFrozenTable(this.parent.getMovableVirtualContent()),this.gen.refreshColOffsets(),this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector("."+_r))),e.prototype.refreshUI.call(this),this.setFrozenTable(this.parent.getFrozenVirtualContent())},r.prototype.setVisible=function(e){var r,i,n,o,s,a=this.parent,l=this.parent.getFrozenColumns();l&&(o=[].slice.call(this.parent.getFrozenVirtualHeader().querySelectorAll("col")),s=[].slice.call(this.parent.getMovableVirtualHeader().querySelectorAll("col")));for(var h=0,p=e.length;h<p;h++){var d=e[parseInt(h.toString(),10)];i=a.getNormalizedColumnIndex(d.uid),r=d.visible?"":"none";var c=void 0;if(o&&s?i>=l?(c=s,i-=l):c=o:c=this.getColGroup().children,t.setStyleAttribute(c[parseInt(i.toString(),10)],{display:r}),a.enableColumnVirtualization&&!a.groupSettings.columns.length){var u=void 0;(u=d.visible?this.virtualEle.wrapper.offsetWidth+parseInt(d.width.toString(),10):this.virtualEle.wrapper.offsetWidth-parseInt(d.width.toString(),10))>a.width?(this.setDisplayNone(d,r),this.virtualEle.setWrapperWidth(u+""),this.gen.refreshColOffsets()):n=!0}else n=!0;n&&!l&&this.refreshUI()}l&&this.parent.notify(pr,{})},r.prototype.setFrozenTable=function(e){this.parent.isFrozenGrid()&&this.parent.enableColumnVirtualization&&this.parent.contentModule.isXaxis()&&this.parent.contentModule.setTable(e.querySelector("."+Jr+":not(.e-masked-table)"))},r.prototype.setDisplayNone=function(e,r){var i=this.parent.isFrozenGrid(),n=this.getTable();i&&"movable"===e.getFreezeTableName()&&(n=this.parent.getMovableVirtualHeader().querySelector("."+Jr));for(var o=0,s=[].slice.apply(n.querySelectorAll("th.e-headercell"));o<s.length;o++){var a=s[o];if(a.querySelector("[e-mappinguid]")&&a.querySelector("[e-mappinguid]").getAttribute("e-mappinguid")===e.uid){t.setStyleAttribute(a,{display:r}),""===r&&t.removeClass([a],"e-hide");break}}},r}(Ri),Bo=function(){function e(){}return e.prototype.renderWrapper=function(e){this.wrapper=t.createElement("div",{className:"e-virtualtable",styles:"min-height:"+t.formatUnit(e)}),this.wrapper.appendChild(this.table),this.content.appendChild(this.wrapper)},e.prototype.renderPlaceHolder=function(e){void 0===e&&(e="relative"),this.placeholder=t.createElement("div",{className:"e-virtualtrack",styles:"position:"+e}),this.content.appendChild(this.placeholder)},e.prototype.renderFrozenWrapper=function(e){this.wrapper=t.createElement("div",{className:"e-virtualtable",styles:"min-height:"+t.formatUnit(e)+"; display: flex"}),this.content.appendChild(this.wrapper)},e.prototype.renderFrozenPlaceHolder=function(){this.placeholder=t.createElement("div",{className:"e-virtualtrack"}),this.content.appendChild(this.placeholder)},e.prototype.renderMovableWrapper=function(e){this.movableWrapper=t.createElement("div",{className:"e-virtualtable",styles:"min-height:"+t.formatUnit(e)}),this.movableContent.appendChild(this.movableWrapper)},e.prototype.renderMovablePlaceHolder=function(){this.movablePlaceholder=t.createElement("div",{className:"e-virtualtrack"}),this.movableContent.appendChild(this.movablePlaceholder)},e.prototype.adjustTable=function(e,t){this.wrapper.style.transform="translate("+e+"px, "+t+"px)"},e.prototype.adjustMovableTable=function(e,t){this.movableWrapper.style.transform="translate("+e+"px, "+t+"px)"},e.prototype.setMovableWrapperWidth=function(e,t){this.movableWrapper.style.width=e?e+"px":t?"100%":""},e.prototype.setMovableVirtualHeight=function(e,t){this.movablePlaceholder.style.height=e+"px",this.movablePlaceholder.style.width=t},e.prototype.setWrapperWidth=function(e,t){this.wrapper.style.width=e?e+"px":t?"100%":""},e.prototype.setVirtualHeight=function(e,r){this.placeholder.style.height=t.isNullOrUndefined(e)?"0px":e+"px",this.placeholder.style.width=r},e.prototype.setFreezeWrapperWidth=function(e,t,r){e.style.width=t?t+"px":r?"100%":""},e}(),No=function(){function r(e,t){this.parent=e,this.locator=t,this.addEventListener()}return r.prototype.getModuleName=function(){return"virtualscroll"},r.prototype.instantiateRenderer=function(){this.parent.log(["limitation","virtual_height"],"virtualization");var t=this.locator.getService("rendererFactory");this.parent.isFrozenGrid()||(this.parent.enableColumnVirtualization&&t.addRenderer(e.RenderType.Header,new Po(this.parent,this.locator)),t.addRenderer(e.RenderType.Content,new Lo(this.parent,this.locator))),this.ensurePageSize()},r.prototype.ensurePageSize=function(){var e=this.parent.getRowHeight(),t=this.parent.height.toString().indexOf("%")<0?this.parent.height:this.parent.element.getBoundingClientRect().height;this.blockSize=~~(t/e);var r=2*this.blockSize,i=this.parent.pageSettings.pageSize;this.parent.setProperties({pageSettings:{pageSize:i<r?r:i}},!0)},r.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(Kt,this.instantiateRenderer,this),this.parent.on("column-width-changed",this.refreshVirtualElement,this),this.parent.on("create-virtual-validation-form",this.createVirtualValidationForm,this),this.parent.on("validate-virtual-form",this.virtualEditFormValidation,this),this.parent.on(lr,this.destroy,this))},r.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Kt,this.instantiateRenderer),this.parent.off("column-width-changed",this.refreshVirtualElement),this.parent.off("create-virtual-validation-form",this.createVirtualValidationForm),this.parent.off("validate-virtual-form",this.virtualEditFormValidation),this.parent.off(lr,this.destroy))},r.prototype.getCurrentEditedData=function(e){var r={virtualData:t.extend({},{},e,!0),isAdd:!1,isScroll:!1,endEdit:!0};return this.parent.notify(Mr,r),r.virtualData},r.prototype.createVirtualValidationForm=function(e){var r=this.parent;if(r.enableVirtualization&&"Normal"===r.editSettings.mode){var i=r.columns,n=new fi(this.locator,null,this.parent),o=t.extend({},{},r.getRowObjectFromUID(e.uid),!0);r.notify("refresh-virtual-editform-cells",o);var s=e.argsCreator(this.getCurrentEditedData(e.prevData),{},!1);s.isCustomFormValidation=!0,s.row=n.render(o,i),e.renderer.update(s);for(var a={},l=0;l<i.length;l++)i[parseInt(l.toString(),10)].visible&&i[parseInt(l.toString(),10)].validationRules&&Ge(i[parseInt(l.toString(),10)],0,a,{},{},i.length,!0);s.form.classList.add("e-virtual-validation"),r.editModule.virtualFormObj=r.editModule.createFormObj(s.form,a)}},r.prototype.virtualEditFormValidation=function(e){var r=this.parent,i=r.element.querySelector('.e-griderror:not([style*="display: none"])');if(r.editModule.virtualFormObj)if(i&&"none"!==i.style.display){var n=i.getBoundingClientRect(),o=r.element.querySelectorAll(".e-gridform"),s=o[0],a=r.getContent().getBoundingClientRect().left;if(o.length>1&&(s="Right"!==r.getFrozenMode()?o[1]:o[0],a=r.getMovableVirtualContent().getBoundingClientRect().left),n.left<a||n.right>r.element.offsetWidth){p=s.querySelector('.e-tooltip-wrap:not([style*="display: none"])');this.scrollToEdit(p,{editIdx:e.editIdx,addIdx:e.addIdx},!0)}}else if(r.editModule.virtualFormObj&&(!i||"none"===i.style.display)){for(var l=r.editModule.virtualFormObj.element.querySelectorAll('.e-tooltip-wrap:not([style*="display: none"])'),h=0;h<l.length;h++)t.remove(l[parseInt(h.toString(),10)]);if(this.setEditedDataToValidationForm(r.editModule.virtualFormObj.element,this.getCurrentEditedData(e.prevData)),e.isValid=r.editModule.virtualFormObj.validate(),!e.isValid){var p=r.editModule.virtualFormObj.element.querySelector('.e-tooltip-wrap:not([style*="display: none"])');this.scrollToEdit(p,{editIdx:e.editIdx,addIdx:e.addIdx})}}},r.prototype.scrollToEdit=function(e,r,i){var n=this.parent;if(e){var o=n.columnModel,s=Q(e.id).split("_")[0],a=n.getColumnByField(s),l=this.parent.getContent().firstElementChild.scrollTop,h=n.getRowByIndex(r.editIdx);if(i||!a||!t.isNullOrUndefined(r.addIdx)&&l>0||!t.isNullOrUndefined(r.editIdx)&&!h){for(var p=void 0,d=0;d<o.length&&!a;d++)if(o[parseInt(d.toString(),10)].field===s){p=o[parseInt(d.toString(),10)];break}i&&(p=a),this.parent.notify("scroll-to-edit",p)}}},r.prototype.setEditedDataToValidationForm=function(e,r){for(var i=[].slice.call(e.getElementsByClassName("e-field")),n=0,o=i.length;n<o;n++){var s=et(this.parent,i[parseInt(n.toString(),10)].getAttribute("e-mappinguid")),a=t.getValue(s.field,r);a=t.isNullOrUndefined(a)?"":a,i[parseInt(n.toString(),10)].value=a}},r.prototype.refreshVirtualElement=function(t){this.parent.enableColumnVirtualization&&"resize"===t.module&&this.locator.getService("rendererFactory").getRenderer(e.RenderType.Content).refreshVirtualElement()},r.prototype.destroy=function(){this.removeEventListener()},r}(),qo=function(){function e(e){this.parent=e}return e.prototype.addNew=function(e,t){this.isEdit=!1;var r,i=_e(this.parent),n=We(this.parent),o=this.parent.isFrozenGrid(),s=o&&this.parent.enableColumnVirtualization&&t.isScroll;if(r=this.parent.frozenRows&&"Top"===this.parent.editSettings.newRowPosition?s?this.parent.getMovableHeaderTbody():this.parent.getHeaderTable().querySelector(li):s?this.parent.getMovableContentTbody():this.parent.getContentTable().querySelector(li),t.row=this.parent.createElement("tr",{className:"e-row e-addedrow"}),r.querySelector(".e-emptyrow")){var a=r.querySelector(".e-emptyrow");if(a.parentNode.removeChild(a),o&&!s){var l=this.parent.getContent().querySelector("."+Wr).querySelector(li);if(l.firstElementChild.parentNode.removeChild(l.firstElementChild),this.parent.getFrozenMode()===ri){var h=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(li);h.firstElementChild.parentNode.removeChild(h.firstElementChild)}}}if("Top"===this.parent.editSettings.newRowPosition?r.insertBefore(t.row,r.firstChild):r.appendChild(t.row),t.row.appendChild(this.getEditElement(e,!1,void 0,t,!0)),this.parent.editModule.checkLastRow(t.row,t),o&&!s){var p=this.renderMovableform(t.row,t);if("Top"===this.parent.editSettings.newRowPosition?i.insertBefore(p,i.firstChild):i.appendChild(p),t.row.querySelector(".e-normaledit").setAttribute("colspan",this.parent.getVisibleFrozenColumns()+""),p.querySelector(".e-normaledit").setAttribute("colspan",""+(this.parent.getVisibleColumns().length-this.parent.getVisibleFrozenColumns())),n){var d=this.renderFrozenRightForm(t.row,t);"Top"===this.parent.editSettings.newRowPosition?n.insertBefore(d,n.firstChild):n.appendChild(d);var c=this.parent.getVisibleFrozenColumns()-this.parent.getFrozenRightColumnsCount();t.row.querySelector(".e-normaledit").setAttribute("colspan",c+""),d.querySelector(".e-normaledit").setAttribute("colspan",""+this.parent.getFrozenRightColumnsCount())}"auto"===this.parent.height&&this.parent.notify("frozenHeight",{})}},e.prototype.renderFrozenRightForm=function(e,t){var r=e.cloneNode(!0),i=t.frozenRightForm=r.querySelector("form");return this.parent.editSettings.template?(i.innerHTML="",this.appendChildren(i,t.rowData,!1),r):(this.renderRightFrozen(e,r),r.querySelector(hi).innerHTML=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(hi).innerHTML,r)},e.prototype.renderMovableform=function(e,t){var r=e.cloneNode(!0),i=t.movableForm=r.querySelector("form");return this.parent.editSettings.template?(i.innerHTML="",this.appendChildren(i,t.rowData,!1),r):(this.renderMovable(e,r),r.querySelector(hi).innerHTML=this.parent.getHeaderContent().querySelector("."+Kr).querySelector(hi).innerHTML,r)},e.prototype.updateFreezeEdit=function(e,t){return t=t.concat([].slice.call(this.getFreezeRow(e).querySelectorAll("td.e-rowcell"))),this.parent.getFrozenMode()===ri&&(t=t.concat([].slice.call(this.getFreezeRightRow(e).querySelectorAll("td.e-rowcell")))),t},e.prototype.getFreezeRightRow=function(e){var t=parseInt(e.getAttribute(si),10),r=this.parent.getFrozenLeftContentTbody(),i=this.parent.getFrozenHeaderTbody(),n=this.parent.getFrozenRightHeaderTbody(),o=this.parent.getFrozenRightContentTbody();return r.contains(e)||i.contains(e)?this.parent.getFrozenRightRowByIndex(t):o.contains(e)||n.contains(e)?this.parent.getRowByIndex(t):e},e.prototype.getFreezeRow=function(e){if(this.parent.isFrozenGrid()){var t=parseInt(e.getAttribute(si),10),r=this.parent.getFrozenLeftContentTbody(),i=this.parent.getMovableContentTbody(),n=this.parent.getFrozenHeaderTbody(),o=this.parent.getMovableHeaderTbody();if(r.contains(e)||n.contains(e))return this.parent.getMovableRowByIndex(t);if(i.contains(e)||o.contains(e))return this.parent.getRowByIndex(t)}return e},e.prototype.update=function(e,r){this.isEdit=!0;var i=r.isCustomFormValidation,n=r.isScroll;n||!t.closest(r.row,"."+Wr)&&!t.closest(r.row,"."+Kr)||(r.row=this.getFreezeRow(r.row)),(t.closest(r.row,".e-frozen-right-content")||t.closest(r.row,".e-frozen-right-header"))&&(r.row=this.getFreezeRightRow(r.row));var o=this.parent.isFrozenGrid()&&this.parent.enableColumnVirtualization&&n,s=[].slice.call(r.row.querySelectorAll("td.e-rowcell"));r.row.innerHTML="",o||i||(s=this.updateFreezeEdit(r.row,s)),r.row.appendChild(this.getEditElement(e,!0,s,r,!0)),r.row.classList.add(ei),this.parent.editModule.checkLastRow(r.row,r),o||i||this.refreshFreezeEdit(r.row,r)},e.prototype.refreshFreezeEdit=function(e,t){var r=e.firstChild;this.parent.getVisibleFrozenColumns()&&this.parent.editSettings.template&&(r.querySelector(hi).innerHTML=this.parent.getHeaderContent().querySelector("."+Xr).querySelector(hi).innerHTML);var i,n,o=parseInt(e.getAttribute(si),10);if(this.parent.isFrozenGrid()){o<this.parent.frozenRows?(n=this.parent.getHeaderContent(),i="."+Xr):(n=this.parent.getContent(),i="."+Qr);var s=r.cloneNode(!0),a=r.cloneNode(!0),l=t.movableForm=s.querySelector("form");this.parent.editSettings.template&&this.refreshEditForm(l,t.rowData);var h=void 0,p=void 0;n.querySelector(i).contains(e)?(h=this.parent.getMovableRowByIndex(o),this.updateFrozenCont(h,r,s),this.parent.getFrozenMode()===ri&&(t.frozenRightForm=a.querySelector("form"),this.refreshEditForm(t.frozenRightForm,t.rowData),p=this.parent.getFrozenRightRowByIndex(o),this.updateFrozenRightCont(p,r,a))):(h=this.parent.getRowByIndex(o),this.updateFrozenCont(h,s,r),this.parent.getFrozenMode()===ri&&(t.frozenRightForm=a.querySelector("form"),this.refreshEditForm(t.frozenRightForm,t.rowData),p=this.parent.getFrozenRightRowByIndex(o),this.updateFrozenRightCont(p,a,r))),h.appendChild(s),h.classList.add(ei),this.parent.getFrozenMode()===ri&&(p.appendChild(a),p.classList.add(ei),xe(t.frozenRightForm.querySelector("td:not(.e-hide)"),t.form.querySelector("td:not(.e-hide)"))),xe(t.movableForm.querySelector("td:not(.e-hide)"),t.form.querySelector("td:not(.e-hide)"))}},e.prototype.refreshEditForm=function(e,t){this.parent.editSettings.template&&(e.innerHTML="",this.appendChildren(e,t,!1))},e.prototype.updateFrozenRightCont=function(e,t,r){e.innerHTML="",this.renderRightFrozen(t,r),r.querySelector(hi).innerHTML=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(hi).innerHTML,t.setAttribute("colspan",this.parent.getVisibleFrozenColumns()-this.parent.getFrozenRightColumnsCount()+""),r.setAttribute("colspan",this.parent.getFrozenRightColumnsCount()+"")},e.prototype.updateFrozenCont=function(e,t,r){e.innerHTML="",this.renderMovable(t,r),r.querySelector(hi).innerHTML=this.parent.getHeaderContent().querySelector("."+Kr).querySelector(hi).innerHTML,t.setAttribute("colspan",this.parent.getVisibleFrozenColumns()+""),r.setAttribute("colspan",this.parent.getCurrentVisibleColumns(this.parent.enableColumnVirtualization).length-this.parent.getVisibleFrozenColumns()+"")},e.prototype.renderRightFrozen=function(e,t){t.querySelector("tr").innerHTML="";for(var r=this.parent.getColumns(),i=0,n=0;n<r.length;n++,i++)if(r[parseInt(n.toString(),10)].getFreezeTableName()===ii){var o=i-this.parent.getMovableColumnsCount();t.querySelector("tr").appendChild(e.querySelector("tr").removeChild(e.querySelector("tr").children[parseInt(o.toString(),10)])),i--}},e.prototype.renderMovable=function(e,t){t.querySelector("tr").innerHTML="";for(var r=this.parent.getColumns(),i=this.parent.isRowDragable()?1:0,n=0;n<r.length;n++,i++)"movable"===r[parseInt(n.toString(),10)].getFreezeTableName()&&(t.querySelector("tr").appendChild(e.querySelector("tr").removeChild(e.querySelector("tr").children[parseInt(i.toString(),10)])),i--)},e.prototype.getEditElement=function(e,r,i,n,o){var s=this.parent,a=0,l=t.isNullOrUndefined(s.detailTemplate)&&t.isNullOrUndefined(s.childGrid)?0:1;s.allowGrouping&&(a=s.groupSettings.columns.length);var h=this.parent.createElement("td",{className:"e-editcell e-normaledit",attrs:{colspan:(s.getCurrentVisibleColumns(this.parent.enableColumnVirtualization).length-s.getVisibleFrozenColumns()+this.parent.getIndentCount()).toString()}}),p=n.form=this.parent.createElement("form",{id:s.element.id+"EditForm",className:"e-gridform"});if(this.parent.editSettings.template)return this.appendChildren(p,n.rowData,o),h.appendChild(p),h;var d=this.parent.createElement("table",{className:"e-table e-inline-edit",attrs:{cellspacing:"0.25",role:"grid"}});d.appendChild(s.getContentTable().querySelector(hi).cloneNode(!0));var c=this.parent.createElement(li,{attrs:{role:"rowgroup"}}),u=this.parent.createElement("tr"),g=0;for(l&&u.insertBefore(this.parent.createElement("td",{className:"e-detailrowcollapse"}),u.firstChild),s.isRowDragable()&&u.appendChild(this.parent.createElement("td",{className:"e-dragindentcell"}));g<a;)u.appendChild(this.parent.createElement("td",{className:"e-indentcell"})),g++;var f=0;g=0;for(var m=s.isFrozenGrid()&&s.enableColumnVirtualization&&n.isScroll,y=n.isCustomFormValidation?this.parent.columnModel:s.getColumns();r&&f<i.length&&g<y.length||g<y.length;){var v=r?i[parseInt(f.toString(),10)].getAttribute("colspan"):null,C=y[parseInt(g.toString(),10)];if(m&&"movable"!==C.getFreezeTableName()||n.isCustomFormValidation&&(C.commands||C.commandsTemplate||!C.field))g++;else{var S=this.parent.createElement("td",{className:Ur,attrs:{style:"text-align:"+(C.textAlign?C.textAlign:""),colspan:v||""}});C.visible?(S.appendChild(e[C.uid]),"Vertical"===this.parent.rowRenderingMode&&(x(S,{"data-cell":C.headerText}),0===g&&S.classList.add("e-responsive-editcell")),"booleanedit"===C.editType?S.classList.add("e-boolcell"):(C.commands||C.commandsTemplate)&&t.addClass([S],"e-unboundcell")):S.classList.add("e-hide"),u.appendChild(S),g=v?g+parseInt(v,10):g+1,f++}}return c.appendChild(u),d.appendChild(c),p.appendChild(d),h.appendChild(p),h},e.prototype.removeEventListener=function(){},e.prototype.appendChildren=function(e,r,i){var n=t.extend({},r,{isAdd:!this.isEdit,isFrozen:i},!0),o=this.parent.element.id+"editSettingsTemplate";this.parent.isReact&&"string"!=typeof this.parent.editSettings.template?(this.parent.getEditTemplate()(n,this.parent,"editSettingsTemplate",o,null,null,e),this.parent.renderTemplates()):q(e,this.parent.getEditTemplate()(n,this.parent,"editSettingsTemplate",o))},e}(),Ho=function(){function e(e){this.parent=e}return e.prototype.update=function(e,r){if(this.parent.isReact&&r.columnObject&&r.columnObject.template){var i=r.cell.parentElement,n=r.cell.cloneNode(!0);i.insertBefore(n,r.cell),n.focus(),r.cell.remove(),r.cell=n}r.cell.innerHTML="",r.cell.appendChild(this.getEditElement(e,r)),r.cell.classList.add("e-editedbatchcell"),t.classList(r.row,[ei,"e-batchrow"],[])},e.prototype.getEditElement=function(e,t){var r=this.parent,i=this.parent.createElement("form",{id:r.element.id+"EditForm",className:"e-gridform"});return i.appendChild(e[t.columnObject.uid]),"booleanedit"===t.columnObject.editType&&t.cell.classList.add("e-boolcell"),t.columnObject.editType||t.cell.classList.add("e-inputbox"),i},e.prototype.removeEventListener=function(){},e}(),Uo=function(){function r(e,t){this.parent=e,this.serviceLocator=t,this.parent.isDestroyed||(this.parent.on(Sr,this.destroy,this),this.parent.on(lr,this.destroy,this))}return r.prototype.setLocaleObj=function(){this.l10n=this.serviceLocator.getService("localization")},r.prototype.addNew=function(e,t){this.isEdit=!1,this.createDialog(e,t)},r.prototype.update=function(e,t){this.isEdit=!0,this.createDialog(e,t)},r.prototype.createDialogHeader=function(r){var i=this,n=this.parent;if(this.parent.enableAdaptiveUI){var o=new Ji(this.parent,this.serviceLocator);return o.action=this.isEdit?e.ResponsiveDialogAction.isEdit:e.ResponsiveDialogAction.isAdd,o.renderResponsiveHeader(void 0,r)}return n.editSettings.headerTemplate?t.initializeCSPTemplate(function(){return i.getDialogEditTemplateElement("HeaderTemplate",r).outerHTML}):this.isEdit?this.l10n.getConstant("EditFormTitle")+r.primaryKeyValue[0]:this.l10n.getConstant("AddFormTitle")},r.prototype.createDialog=function(e,r){var n=this,o=this.parent;this.dialog=this.parent.createElement("div",{id:o.element.id+"_dialogEdit_wrapper",styles:"width: auto"}),o.enableAdaptiveUI&&this.dialog.classList.add("e-responsive-dialog"),o.element.appendChild(this.dialog),this.setLocaleObj(),this.dialog.setAttribute("aria-label",this.l10n.getConstant("DialogEdit")),this.dialogObj=new i.Dialog(t.extend({header:this.createDialogHeader(r),isModal:!0,visible:!0,cssClass:this.parent.cssClass?"e-edit-dialog "+this.parent.cssClass:"e-edit-dialog",content:this.getEditElement(e,r),showCloseIcon:!0,allowDragging:!0,close:this.dialogClose.bind(this),created:this.dialogCreated.bind(this),closeOnEscape:!0,width:o.editSettings.template?"auto":"330px",target:r.target?r.target:document.body,animationSettings:{effect:"None"},footerTemplate:o.editSettings.footerTemplate?t.initializeCSPTemplate(function(){return n.getDialogEditTemplateElement("FooterTemplate",r).outerHTML}):null,buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.l10n.getConstant("SaveButton"),cssClass:this.parent.cssClass?"e-primary "+this.parent.cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:this.parent.cssClass?"e-flat "+this.parent.cssClass:"e-flat",content:this.l10n.getConstant("CancelButton")}}]},o.editSettings.dialog?o.editSettings.dialog.params||{}:{})),r.dialog=this.dialogObj;this.dialogObj.isStringTemplate=!0,this.renderResponsiveDialog(),this.dialogObj.appendTo(this.dialog),Re(this.parent.element,this.dialogObj.element.parentElement),o.enableAdaptiveUI&&this.dialogObj.show(!0)},r.prototype.dialogCreated=function(){Xe(this.parent)},r.prototype.renderResponsiveDialog=function(){var e=this;this.parent.enableAdaptiveUI&&(this.parent.adaptiveDlgTarget&&(this.dialogObj.target=this.parent.adaptiveDlgTarget),this.dialogObj.buttons=[{}],this.dialogObj.showCloseIcon=!0,this.dialogObj.visible=!1,this.dialogObj.width="100%",this.dialogObj.open=function(){e.dialogObj.element.style.maxHeight="100%"})},r.prototype.btnClick=function(e){this.l10n.getConstant("CancelButton").toLowerCase()===e.target.innerText.trim().toLowerCase()?this.dialogClose():this.parent.endEdit()},r.prototype.dialogClose=function(){this.parent.closeEdit()},r.prototype.destroy=function(e){for(var r=["template","headerTemplate","footerTemplate"],i=0;i<r.length;i++)if(this.parent.editSettings[r[parseInt(i.toString(),10)]]){var n=r[parseInt(i.toString(),10)].charAt(0).toUpperCase()+r[parseInt(i.toString(),10)].slice(1),o=this.parent.element.id+"editSettings"+n;t.updateBlazorTemplate(o,n,this.parent.editSettings)}this.parent.notify("destroy-form",{}),this.parent.isEdit=!1,this.parent.notify("toolbar-refresh",{}),this.dialog&&!this.dialogObj.isDestroyed&&(this.dialogObj.destroy(),t.remove(this.dialog))},r.prototype.getDialogEditTemplateElement=function(e,r){var i=this.parent.createElement("div",{className:"e-dialog"+e}),n=t.extend({},r.rowData,{isAdd:!this.isEdit},!0),o=this.parent.element.id+"editSettings"+e;return q(i,("HeaderTemplate"===e?this.parent.getEditHeaderTemplate():this.parent.getEditFooterTemplate())(n,this.parent,"editSettings"+e,o)),t.updateBlazorTemplate(o,e,this.parent.editSettings),i},r.prototype.getEditElement=function(e,r){var i=this,n=this.parent,o=this.parent.createElement("div",{className:this.isEdit?ei:"e-insertedrow"}),s=r.form=this.parent.createElement("form",{id:n.element.id+"EditForm",className:"e-gridform"});if(this.parent.editSettings.template){var a=this.parent.element.id+"editSettingsTemplate",l=t.extend({},r.rowData,{isAdd:!this.isEdit},!0),h=this.parent.isReact&&"string"!=typeof this.parent.editSettings.template,p=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact;h||p?(this.parent.getEditTemplate()(l,this.parent,"editSettingsTemplate",a,null,null,s),this.parent.renderTemplates()):q(s,this.parent.getEditTemplate()(l,this.parent,"editSettingsTemplate",a));var d=function(){for(var e=i.parent.getColumns(),t=0;t<e.length;t++)e[parseInt(t.toString(),10)].validationRules&&(i.parent.editModule.formObj.rules[e[parseInt(t.toString(),10)].field]=e[parseInt(t.toString(),10)].validationRules)};return t.updateBlazorTemplate(a,"Template",this.parent.editSettings,!0,d),o.appendChild(s),o}for(var c=this.parent.createElement("table",{className:Jr,attrs:{cellspacing:"6px",role:"grid"}}),u=this.parent.createElement(li,{attrs:{role:"rowgroup"}}),g=n.getColumns(),f=0;f<g.length;f++)if(!(this.parent.editModule.checkColumnIsGrouped(g[parseInt(f.toString(),10)])||g[parseInt(f.toString(),10)].commands||g[parseInt(f.toString(),10)].commandsTemplate||"checkbox"===g[parseInt(f.toString(),10)].type)){var m=this.parent.createElement("tr"),y=this.parent.createElement("td",{className:Ur,attrs:{style:"text-align:"+(this.parent.enableRtl?"right":"left")+";width:190px"}});e[g[parseInt(f.toString(),10)].uid].classList.remove("e-input"),y.appendChild(e[g[parseInt(f.toString(),10)].uid]),m.appendChild(y),u.appendChild(m)}return c.appendChild(u),s.appendChild(c),o.appendChild(s),o},r.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Sr,this.destroy),this.parent.off(lr,this.destroy))},r}(),jo=function(){function r(e,t){this.editType={Inline:qo,Normal:qo,Batch:Ho,Dialog:Uo},this.parent=e,this.serviceLocator=t,this.renderer=new this.editType[this.parent.editSettings.mode](e,t),this.focus=t.getService("focus")}return r.prototype.addNew=function(e){this.renderer.addNew(this.getEditElements(e),e),this.convertWidget(e)},r.prototype.update=function(e){this.renderer.update(this.getEditElements(e),e),e.isCustomFormValidation||(this.parent.notify("edit-form",e),this.convertWidget(e))},r.prototype.convertWidget=function(e){var r,i,n,o,s=this.parent,a=s.isFrozenGrid(),l="Right"===s.getFrozenMode()&&"Normal"===s.editSettings.mode?1:0,h="Dialog"===s.editSettings.mode?t.select("#"+s.element.id+"_dialogEdit_wrapper .e-gridform",document):s.element.getElementsByClassName("e-gridform")[parseInt(l.toString(),10)],p=a&&this.parent.enableColumnVirtualization&&e.isScroll;if(a&&"Normal"===s.editSettings.mode){var d=parseInt(e.row.getAttribute(si),10);s.frozenRows&&("add"===e.requestType&&"Top"===s.editSettings.newRowPosition||d<s.frozenRows)?(n=s.element.querySelector("."+Kr).querySelector(".e-gridform"),this.parent.getFrozenMode()===ri&&(o=e.frozenRightForm)):(n=s.element.querySelector("."+Wr).querySelector(".e-gridform"),this.parent.getFrozenMode()===ri&&(o=e.frozenRightForm))}for(var c=0,u="Batch"!==s.editSettings.mode?s.getColumns():[s.getColumnByField(e.columnName)];c<u.length;c++){var g=u[c];if(!p||"movable"===g.getFreezeTableName())if(!this.parent.editSettings.template||t.isNullOrUndefined(g.field)){if(!this.parent.editModule.checkColumnIsGrouped(g)&&!g.commands){g.valueAccessor(g.field,e.rowData,g),i=n&&"movable"===g.getFreezeTableName()&&"Normal"===s.editSettings.mode?n.querySelector("[e-mappinguid="+g.uid+"]"):o&&g.getFreezeTableName()===ii&&"Normal"===s.editSettings.mode?o.querySelector("[e-mappinguid="+g.uid+"]"):h.querySelector("[e-mappinguid="+g.uid+"]");var f=g.edit.write;t.isNullOrUndefined(i)||("string"==typeof f?(f=ge(f,window))({rowData:e.rowData,element:i,column:g,requestType:e.requestType,row:e.row,foreignKeyData:g.isForeignColumn()&&ge(g.field,e.foreignKeyData)}):g.edit.write({rowData:e.rowData,element:i,column:g,requestType:e.requestType,row:e.row,foreignKeyData:g.isForeignColumn()&&ge(g.field,e.foreignKeyData)}),r||i.getAttribute("disabled")||O(i,"e-checkbox-disabled")||(this.focusElement(i,e.type),r=!0))}}else{var m=t.extend({},e);m.element=h.querySelector("[name="+W(g.field)+"]"),t.isNullOrUndefined(m.element)&&a&&(m.element=n.querySelector("[name="+W(g.field)+"]")),"string"==typeof g.edit.write?ge(g.edit.write,window)(m):g.edit.write(m)}}if(a&&!this.parent.allowTextWrap&&("add"===e.requestType||"beginEdit"===e.requestType)&&"Dialog"!==this.parent.editSettings.mode&&!t.isNullOrUndefined(h)&&!t.isNullOrUndefined(n)){var y=n.querySelector("tr").children[0],v=h.querySelector("tr").children[0];if(v.offsetHeight>y.offsetHeight)y.style.height=v.offsetHeight+"px",o&&((C=n.querySelector("tr").children[0]).style.height=v.offsetHeight+"px");else if(v.style.height=y.offsetHeight+"px",o){var C=n.querySelector("tr").children[0];C.style.height=y.offsetHeight+"px"}}},r.prototype.focusElement=function(e,r){var i=this.parent.element.querySelector(".e-edit-checkselect");!t.isNullOrUndefined(i)&&i.nextElementSibling&&i.nextElementSibling.classList.add("e-focus"),"Batch"===this.parent.editSettings.mode?this.focus.onClick({target:t.closest(e,"td")},!0):!this.parent.enableVirtualization||"Normal"!==this.parent.editSettings.mode||this.parent.enableVirtualization&&"Bottom"===this.parent.editSettings.newRowPosition&&O(e,ti)?e.focus():e.focus({preventScroll:!0}),e.classList.contains("e-defaultcell")&&e.setSelectionRange(e.value.length,e.value.length)},r.prototype.getEditElements=function(r){var i=this.parent,n={},o="Batch"!==i.editSettings.mode?i.getColumns():[i.getColumnByField(r.columnName)];if(r.isCustomFormValidation&&(o=this.parent.columnModel),this.parent.editSettings.template)return{};for(var s=i.isFrozenGrid()&&i.enableColumnVirtualization&&r.isScroll,a=0,l=o.length;a<l;a++){var h=o[parseInt(a.toString(),10)];if(!(this.parent.editModule.checkColumnIsGrouped(h)||s&&"movable"!==o[parseInt(a.toString(),10)].getFreezeTableName()||r.isCustomFormValidation&&(h.commands||h.commandsTemplate||!h.field)))if(h.commands||h.commandsTemplate){var p=this.serviceLocator.getService("cellRendererFactory"),d=new mi(this.parent),c=p.getCellRenderer(e.CellType.CommandColumn),u=d.generateRows(r.rowData)[0].cells.filter(function(e){return e.rowID}),g=c.render(u[parseInt(a.toString(),10)],r.rowData,{index:r.row?r.row.getAttribute(si):0},this.parent.enableVirtualization);(I=g.firstElementChild).setAttribute("textAlign",g.getAttribute("textAlign")),n[h.uid]=I}else{if("dateonly"===h.type&&r.rowData[h.field]instanceof Date){var f=r.rowData[h.field];r.rowData[h.field]=f.getFullYear()+"-"+pe(f.getMonth()+1)+"-"+pe(f.getDate())}var m={column:h,value:h.valueAccessor(h.field,r.rowData,h),type:r.requestType,data:r.rowData},y=h.edit.create,v=void 0;if(h.editTemplate){v=this.parent.createElement("span",{attrs:{"e-mappinguid":h.uid}});var C=this.parent.element.id+h.uid+"editTemplate",S=ve({},r.rowData,{column:h}),b=this.parent.isReact&&"string"!=typeof h.editTemplate,w=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact;b||w?(h.getEditTemplate()(t.extend({index:r.rowIndex},S),this.parent,"editTemplate",C,null,null,v),this.parent.renderTemplates()):q(v,h.getEditTemplate()(t.extend({index:r.rowIndex},S),this.parent,"editTemplate",C))}else{if("string"==typeof(v="string"==typeof y?(y=ge(y,window))(m):h.edit.create(m))){var I=this.parent.createElement("div");I.innerHTML=v,v=I.firstChild}var R="input"!==v.tagName&&v.querySelectorAll("input").length,x=W(h.field);t.attributes(R?v.querySelector("input"):v,{name:x,"e-mappinguid":h.uid,id:i.element.id+x}),t.classList(v,["e-input","e-field"],[]),"Right"===h.textAlign&&v.classList.add("e-ralign"),((h.isPrimaryKey||h.isIdentity)&&"beginEdit"===r.requestType||h.isIdentity&&"add"===r.requestType)&&v.setAttribute("disabled","")}n[h.uid]=v}}return n},r.prototype.destroy=function(){this.renderer.removeEventListener()},r}(),Vo=function(){function e(e){this.parent=e}return e.prototype.create=function(e){return $e(this.parent,e.column,"e-field",{type:"text"})},e.prototype.read=function(e){return e.ej2_instances[0].value},e.prototype.destroy=function(){this.obj&&!this.obj.isDestroyed&&(this.removeEventHandler&&this.removeEventHandler(),this.obj.destroy())},e}(),Go=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),_o=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.activeClasses=["e-selectionbackground","e-active"],t}return Go(r,e),r.prototype.create=function(e){var t="e-field e-boolcell";return"checkbox"===e.column.type&&(t="e-field e-boolcell e-edit-checkselect"),this.removeEventHandler=this.removeEventListener,$e(this.parent,e.column,t,{type:"checkbox",value:e.value})},r.prototype.read=function(e){return e.checked},r.prototype.write=function(e){var r,i;if(t.isNullOrUndefined(e.row)||(r=e.row.querySelector(".e-edit-checkselect")),ge(e.column.field,e.rowData)&&(i=JSON.parse(ge(e.column.field,e.rowData).toString().toLowerCase())),!t.isNullOrUndefined(r)&&"checkbox"===e.column.type){if(this.editType=this.parent.editSettings.mode,this.editRow=e.row,"add"!==e.requestType){var o=this.parent.getRowObjectFromUID(e.row.getAttribute("data-uid"));i=!!o&&o.isSelected}$.apply(void 0,[[].slice.call(e.row.getElementsByClassName(Ur)),i].concat(this.activeClasses))}this.obj=new n.CheckBox(t.extend({label:"Dialog"!==this.parent.editSettings.mode?" ":e.column.headerText,checked:i,disabled:!X(e.column,e.requestType,e.element),enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:""},e.column.edit.params)),this.addEventListener(),this.obj.appendTo(e.element)},r.prototype.addEventListener=function(){this.cbChange=this.checkBoxChange.bind(this),this.obj.addEventListener("change",this.cbChange)},r.prototype.removeEventListener=function(){this.obj.isDestroyed||this.obj.removeEventListener("change",this.cbChange)},r.prototype.checkBoxChange=function(e){if(this.editRow&&"Dialog"!==this.editType){var t=!1;e.checked?(t=!0,this.editRow.setAttribute("aria-selected",t.toString())):this.editRow.removeAttribute("aria-selected"),$.apply(void 0,[[].slice.call(this.editRow.getElementsByClassName(Ur)),t].concat(this.activeClasses))}},r}(Vo),Wo=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ko=function(e){function i(t){var r=e.call(this)||this;return r.parent=t,r.flag=!1,r.removeEventHandler=r.removeEventListener,r}return Wo(i,e),i.prototype.write=function(e){var i="Dialog"!==this.parent.editSettings.mode;this.column=e.column;var n=new r.Predicate(e.column.field,"notequal",null,!0,!1),o={};if(e.column.edit.params)for(var a=Object.keys(e.column.edit.params),l=0;l<a.length;l++)o[a[parseInt(l.toString(),10)]]="query"===a[parseInt(l.toString(),10)]?e.column.edit.params[a[parseInt(l.toString(),10)]].clone():e.column.edit.params[a[parseInt(l.toString(),10)]];this.obj=new s.DropDownList(t.extend({dataSource:this.parent.dataSource instanceof r.DataManager?this.parent.dataSource:new r.DataManager(this.parent.dataSource),query:(new r.Query).where(n).select(e.column.field),enabled:X(e.column,e.requestType,e.element),fields:{value:e.column.field},value:ge(e.column.field,e.rowData),enableRtl:this.parent.enableRtl,placeholder:i?"":e.column.headerText,popupHeight:"200px",floatLabelType:i?"Never":"Always",sortOrder:"Ascending",cssClass:this.parent.cssClass?this.parent.cssClass:null,close:this.dropDownClose.bind(this)},o)),this.parent.enableVirtualization&&(this.obj.dataSource=e.column.isForeignColumn()?[e.foreignKeyData[0]]:[e.rowData]),this.addEventListener(),this.obj.query.params=this.parent.query.params,this.obj.appendTo(e.element),e.element.setAttribute("name",W(e.column.field))},i.prototype.dropDownClose=function(e){e.event&&"escape"===e.event.action&&(this.parent.editModule.editCellDialogClose=!0)},i.prototype.addEventListener=function(){this.ddCreated=this.dropdownCreated.bind(this),this.ddOpen=this.dropDownOpen.bind(this),this.ddBeforeOpen=this.dropdownBeforeOpen.bind(this),this.ddComplete=this.ddActionComplete.bind(this),this.obj.addEventListener("created",this.ddCreated),this.obj.addEventListener(pi,this.ddOpen),this.obj.addEventListener("beforeOpen",this.ddBeforeOpen),this.obj.addEventListener(Nt,this.ddComplete)},i.prototype.removeEventListener=function(){this.obj.isDestroyed||(this.obj.removeEventListener("created",this.ddCreated),this.obj.removeEventListener(pi,this.ddOpen),this.obj.removeEventListener("beforeOpen",this.ddBeforeOpen),this.obj.removeEventListener(Nt,this.ddComplete))},i.prototype.dropdownCreated=function(e){this.flag=!0},i.prototype.dropdownBeforeOpen=function(){this.parent.enableVirtualization&&(this.obj.dataSource=this.column.isForeignColumn()?this.column.dataSource instanceof r.DataManager?this.column.dataSource:new r.DataManager(this.column.dataSource):this.parent.dataSource instanceof r.DataManager?this.parent.dataSource:new r.DataManager(this.parent.dataSource))},i.prototype.ddActionComplete=function(e){e.result=r.DataUtil.distinct(e.result,this.obj.fields.value,!0),!this.flag||!this.column.dataSource||this.column.edit.params&&this.column.edit.params.ddEditedData||("result"in this.column.dataSource?this.column.dataSource.result=e.result:this.column.dataSource instanceof r.DataManager&&(this.column.dataSource.dataSource.json=e.result)),this.flag=!1},i.prototype.dropDownOpen=function(e){var r=O(this.obj.element,"e-dialog");if("Dialog"===this.parent.editSettings.mode&&!t.isNullOrUndefined(r)){var i=t.select("#"+r.id,document).ej2_instances[0];e.popup.element.style.zIndex=(i.zIndex+1).toString()}},i}(Vo),Qo=function(){function e(e){this.parent=e}return e.prototype.keyEventHandler=function(e){if(13===e.keyCode||9===e.keyCode){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),this.dispatchEvent(t)}},e.prototype.create=function(e){return this.instances=new t.Internationalization(this.parent.locale),$e(this.parent,e.column,"e-field",{})},e.prototype.read=function(e){return this.obj.value},e.prototype.write=function(e){var r=e.column,i="Dialog"!==this.parent.editSettings.mode;this.obj=new o.NumericTextBox(t.extend({value:parseFloat(ge(e.column.field,e.rowData)),enableRtl:this.parent.enableRtl,placeholder:i?"":e.column.headerText,enabled:X(e.column,e.requestType,e.element),floatLabelType:"Dialog"!==this.parent.editSettings.mode?"Never":"Always",locale:this.parent.locale,cssClass:this.parent.cssClass?this.parent.cssClass:null},r.edit.params)),e.element.setAttribute("name",W(e.column.field)),this.obj.appendTo(e.element),this.obj.element.addEventListener("keydown",this.keyEventHandler)},e.prototype.destroy=function(){this.obj&&!this.obj.isDestroyed&&(this.obj.element.removeEventListener("keydown",this.keyEventHandler),this.obj.destroy())},e}(),Xo=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Yo=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Xo(r,e),r.prototype.create=function(e){var r={type:"text",value:t.isNullOrUndefined(e.value)?"":e.value,style:"text-align:"+e.column.textAlign};return $e(this.parent,e.column,"e-field e-input e-defaultcell",r)},r.prototype.read=function(e){return e.value},r.prototype.write=function(e){var r=e.column,i="Dialog"!==this.parent.editSettings.mode;this.obj=new o.TextBox(t.extend({element:e.element,floatLabelType:"Dialog"!==this.parent.editSettings.mode?"Never":"Always",enableRtl:this.parent.enableRtl,enabled:X(e.column,e.requestType,e.element),placeholder:i?"":e.column.headerText,cssClass:this.parent.cssClass?this.parent.cssClass:""},r.edit.params)),this.obj.appendTo(e.element),"Batch"===this.parent.editSettings.mode&&this.obj.element.addEventListener("keydown",this.keyEventHandler)},r.prototype.keyEventHandler=function(e){if("Enter"===e.key||"Tab"===e.key){var t=new Event("change",{bubbles:!1,cancelable:!0});this.dispatchEvent(t)}},r.prototype.destroy=function(){this.obj&&!this.obj.isDestroyed&&(this.obj.element.removeEventListener("keydown",this.keyEventHandler),this.obj.destroy())},r}(Vo),Jo=function(){function e(e,t,r){this.args={},this.currentVirtualData={},this.parent=e,this.renderer=r,this.serviceLocator=t,this.addEventListener()}return e.prototype.clickHandler=function(e){var t=e.target,r=this.parent;(O(t,Vr)&&O(O(t,Vr),"e-grid").id===r.element.id||r.frozenRows&&O(t,_r))&&!O(t,"e-unboundcelldiv")&&(this.rowIndex=O(t,Ur)?parseInt(t.parentElement.getAttribute(si),10):-1,r.isEdit&&r.editModule.endEdit())},e.prototype.dblClickHandler=function(e){O(e.target,Ur)&&this.parent.editSettings.allowEditOnDblClick&&this.parent.editModule.startEdit(O(e.target,Zr))},e.prototype.editComplete=function(e){this.parent.isEdit=!1;switch(e.requestType){case"save":(this.parent.isCheckBoxSelection||"Multiple"===this.parent.selectionSettings.type)&&this.parent.isPersistSelection||"edit"!==e.action&&this.parent.selectRow(0),this.parent.trigger(Nt,t.extend(e,{requestType:"save",type:Nt}));break;case"delete":this.parent.trigger(Nt,t.extend(e,{requestType:"delete",type:Nt})),this.parent.isCheckBoxSelection||this.parent.selectRow(this.editRowIndex)}},e.prototype.getEditArgs=function(e,t,r){for(var i=this.parent.getPrimaryKeyFieldNames(),n=[],o=0;o<i.length;o++)n.push(ge(i[parseInt(o.toString(),10)],e));return{primaryKey:i,primaryKeyValue:n,requestType:"beginEdit",rowData:e,rowIndex:this.rowIndex,type:"edit",cancel:!1,foreignKeyData:t&&t.foreignKeyData,target:void 0,isScroll:r}},e.prototype.startEdit=function(e){var r=this,i=this.parent;if(this.rowIndex=this.editRowIndex=parseInt(e.getAttribute(si),10),i.enableVirtualization||i.enableInfiniteScrolling){var n='.e-row[data-rowindex="'+this.rowIndex+'"]';if(!this.parent.element.querySelector(n))return}var o={data:void 0,index:this.rowIndex,isScroll:!1};if(this.parent.notify("virtual-scroll-edit-action-begin",o),ue(i)){var s=i.getRowObjectFromUID(e.getAttribute("data-uid"));this.previousData=s.data}else this.previousData||!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling?this.parent.enableVirtualization||(this.previousData=t.extend({},{},i.getCurrentViewRecords()[this.rowIndex],!0)):this.previousData=o.data;var a=t.extend({},{},o.data||this.previousData,!0);this.uid=e.getAttribute("data-uid");var l=i.getRowObjectFromUID(this.uid),h=this.getEditArgs(a,l,o.isScroll);h.row=e,h.isScroll?this.inlineEditHandler(h,e):(this.parent.notify("create-virtual-validation-form",{uid:this.uid,prevData:this.previousData,argsCreator:this.getEditArgs.bind(this),renderer:this.renderer}),i.trigger("beginEdit",h,function(t){t.type="actionBegin",i.trigger(Bt,t,function(t){t.cancel||r.inlineEditHandler(t,e)})}))},e.prototype.inlineEditHandler=function(e,t){var r=this.parent;r.isEdit=!0,e.row=e.row?e.row:t,"Dialog"!==r.editSettings.mode&&r.clearSelection(),"Dialog"===r.editSettings.mode&&r.selectionModule&&(r.selectionModule.preventFocus=!0,e.row.classList.add("e-dlgeditrow")),this.renderer.update(e),this.uid=t.getAttribute("data-uid"),r.editModule.applyFormValidation(),e.type="actionComplete",r.trigger(Nt,e),r.editSettings.template&&r.editModule.applyFormValidation(void 0,e.form.ej2_instances[0].rules),this.args=e,this.parent.allowTextWrap&&this.parent.notify(wr,{case:"textwrap"})},e.prototype.updateRow=function(e,t){var r=this,i=this.parent;this.editRowIndex=e;var n={requestType:"save",action:"edit",type:Bt,data:t,cancel:!1,previousData:i.getCurrentViewRecords()[parseInt(e.toString(),10)],row:i.getRowByIndex(e)};if(i.showSpinner(),i.enableInfiniteScrolling){this.uid=n.row.getAttribute("data-uid");var o=parseInt(n.row.getAttribute("data-rowindex"),10);this.parent.notify("refresh-infinite-editrowindex",{index:o})}i.notify(vr,n),n.promise?n.promise.then(function(){return i.refresh()}).catch(function(e){return r.edFail(e)}):i.enableInfiniteScrolling||i.refresh()},e.prototype.editFormValidate=function(){var e=this.parent,t=e.editModule.editFormValidate(),r={prevData:this.previousData,isValid:!0,editIdx:this.editRowIndex,addIdx:this.addedRowIndex};return e.notify("validate-virtual-form",r),t&&r.isValid},e.prototype.endEdit=function(){var e=this,r=this.parent;if(this.parent.isEdit&&this.editFormValidate()){var i=t.extend({},{},this.previousData,!0),n=t.extend(this.args,{requestType:"save",type:Bt,data:i,cancel:!1,previousData:this.previousData,selectedRow:r.selectedRowIndex,foreignKeyData:{}}),o="Right"===r.getFrozenMode()?1:0,s="Dialog"===r.editSettings.mode,a=t.select("#"+r.element.id+"_dialogEdit_wrapper",document),l=s?a.querySelector(".e-gridform"):r.element.getElementsByClassName("e-gridform")[parseInt(o.toString(),10)],h={virtualData:t.extend({},{},this.previousData,!0),isAdd:!1,isScroll:!1,endEdit:!0};if(this.parent.notify(Mr,h),(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&"Normal"===this.parent.editSettings.mode&&Object.keys(h.virtualData).length?this.parent.isEdit&&(this.currentVirtualData=i=n.data=h.virtualData):i=r.editModule.getCurrentEditedData(l,i),r.isFrozenGrid()&&"Normal"===r.editSettings.mode){var p=r.getMovableVirtualHeader().querySelector(".e-gridform"),d=r.getMovableVirtualContent().querySelector(".e-gridform"),c=[p||d],u=void 0,g=void 0,f=[];r.getFrozenMode()===ri&&(u=r.getFrozenRightHeader().querySelector(".e-gridform"),g=r.getFrozenRightContent().querySelector(".e-gridform"),f=[u||g]),Ne(this.parent,function(e,t){for(var n=0,o=t;n<o.length;n++){var s=o[n];s&&(i=r.editModule.getCurrentEditedData(s,i))}},[[],c,f])}var m=[].slice.call(r.element.getElementsByClassName(ei)).length;if(h.isAdd||!Object.keys(this.currentVirtualData).length||m||(m=1),s?a.getElementsByClassName(ei).length:m)n.action="edit",r.trigger(Bt,n,function(t){t.cancel||("Spinner"===e.parent.loadingIndicator.indicatorType&&r.showSpinner(),"Shimmer"===e.parent.loadingIndicator.indicatorType&&e.parent.showMaskRow(),r.notify(vr,t))});else if(n.action="add",n.selectedRow=0,n.index=this.addedRowIndex,r.notify("virtual-scroll-edit-success",{}),r.notify(er,n),this.addedRowIndex=null,n.cancel)return;r.editModule.resetMovableContentValidation()}},e.prototype.destroyElements=function(){var e=this.parent;e.editModule.destroyWidgets(),e.editModule.destroyForm(),this.parent.notify(Sr,{})},e.prototype.editHandler=function(e){var t=this;e.promise?e.promise.then(function(r){return t.edSucc(r,e)}).catch(function(e){return t.edFail(e)}):this.editSuccess(e.data,e)},e.prototype.edSucc=function(e,t){this.editSuccess(e,t)},e.prototype.edFail=function(e){this.editFailure(e)},e.prototype.updateCurrentViewData=function(e){this.parent.enableVirtualization||this.parent.enableInfiniteScrolling||(this.parent.getCurrentViewRecords()[this.editRowIndex]=e)},e.prototype.requestSuccess=function(e){this.parent.editModule.formObj&&!this.parent.editModule.formObj.isDestroyed&&(this.destroyElements(),this.stopEditStatus(),"Dialog"===this.parent.editSettings.mode&&"add"!==e.action&&this.parent.selectionModule&&this.parent.element.querySelector(".e-dlgeditrow").classList.remove("e-dlgeditrow"))},e.prototype.editSuccess=function(e,r){var i=this;if(!(t.isNullOrUndefined(e)||e instanceof Array)){r.data=t.extend({},t.extend({},r.rowData,r.data),e)}if(this.requestSuccess(r),this.parent.trigger("beforeDataBound",r),r.type=Nt,this.parent.isEdit=!1,this.refreshRow(r.data),this.parent.notify("virtual-scroll-edit-success",r),this.parent.editModule.checkLastRow(r.row),this.parent.editModule.isLastRow=!1,this.updateCurrentViewData(r.data),this.blazorTemplate(),this.editRowIndex=null,this.parent.allowGrouping&&this.parent.groupSettings.columns.length){for(var n=r.row,o=this.parent.getRowsObject(),s=n.getAttribute("data-uid"),a=this.parent.getRowObjectFromUID(s),l=0;l<this.parent.groupSettings.columns.length;l++)!function(e){o=o.filter(function(t){return t.isDataRow&&t.data[i.parent.groupSettings.columns[parseInt(e.toString(),10)]]===r.data[i.parent.groupSettings.columns[parseInt(e.toString(),10)]]&&t!==a})}(l);var h=o[0];t.isNullOrUndefined(a)||t.isNullOrUndefined(h)||a.parentUid===h.parentUid?this.parent.aggregates.length&&this.parent.aggregateModule.refresh(r.data,this.parent.groupSettings.enableLazyLoading?r.row:void 0):this.parent.groupModule.groupedRowReorder(a,h)}else this.parent.aggregates.length&&this.parent.aggregateModule.refresh(r.data,this.parent.groupSettings.enableLazyLoading?r.row:void 0);this.parent.trigger(Nt,r),(!this.parent.isCheckBoxSelection&&"Multiple"!==this.parent.selectionSettings.type||!this.parent.isPersistSelection&&!this.parent.selectionSettings.checkboxOnly)&&"Dialog"!==this.parent.editSettings.mode&&this.parent.selectRow(this.rowIndex>-1?this.rowIndex:this.editRowIndex),this.parent.aggregates.length&&this.parent.groupSettings.enableLazyLoading&&this.parent.groupSettings.columns.length&&(this.parent.groupModule.getGroupAggregateTemplates(!0).length||this.parent.groupModule.getGroupAggregateTemplates(!1).length)||(this.parent.removeMaskRow(),this.parent.hideSpinner())},e.prototype.closeForm=function(){!this.cloneRow&&this.parent.isEdit&&this.stopEditStatus(),this.cloneRow&&(this.cloneRow.remove(),this.cloneRow=null,this.originalRow.classList.remove("e-hiddenrow")),this.parent.isFrozenGrid()&&this.cloneFrozen&&(this.cloneFrozen.remove(),this.frozen.classList.remove("e-hiddenrow"))},e.prototype.blazorTemplate=function(){var e=this.parent.getColumns();this.parent.editSettings.template&&"Normal"===this.parent.editSettings.mode&&t.updateBlazorTemplate(this.parent.element.id+"editSettingsTemplate","Template",this.parent.editSettings);for(var r=0;r<e.length;r++){var i=e[parseInt(r.toString(),10)];i.template&&t.updateBlazorTemplate(this.parent.element.id+i.uid,"Template",i,!1),i.editTemplate&&t.updateBlazorTemplate(this.parent.element.id+i.uid+"editTemplate","EditTemplate",i)}},e.prototype.editFailure=function(e){this.parent.removeMaskRow(),this.parent.trigger("actionFailure",{error:e}),this.parent.hideSpinner(),this.parent.log("actionfailure",{error:e})},e.prototype.needRefresh=function(){var e=!0,t=this.parent.element.querySelector(".e-gridform");return!this.parent.enableVirtualization&&!this.parent.infiniteScrollSettings.enableCache||"Normal"!==this.parent.editSettings.mode||t||(e=!1),e},e.prototype.refreshRow=function(e){var t=this.parent.isFrozenGrid(),r=new fi(this.serviceLocator,null,this.parent),i=this.parent.getRowObjectFromUID(this.uid);if(i){i.changes=e,this.parent.notify("refresh-virtual-cache",{data:e}),ae(i,this.parent.getForeignKeyColumns(),i.changes),this.needRefresh()&&r.refresh(i,this.parent.getColumns(),!0);var n=[].slice.call(this.parent.element.querySelectorAll('[data-rowindex="'+i.index+'"]'));if(t&&n.length)for(var o=0;o<n.length;o++){var s=n[parseInt(o.toString(),10)].getAttribute("data-uid");s!==this.uid&&((i=this.parent.getRowObjectFromUID(s)).changes=e,ae(i,this.parent.getForeignKeyColumns(),i.changes),r.refresh(i,this.parent.getColumns(),!0),this.parent.editModule.checkLastRow(n[parseInt(o.toString(),10)]))}}},e.prototype.closeEdit=function(){var e=this;if(this.parent.isEdit){var r=this.parent,i=t.extend(this.args,{requestType:"cancel",type:Bt,cancel:!1,data:this.previousData,selectedRow:r.selectedRowIndex});r.notify("virtual-scroll-edit-cancel",i),this.blazorTemplate(),r.trigger(Bt,i,function(t){if(!t.cancel){"Dialog"===e.parent.editSettings.mode&&e.parent.notify(Sr,{}),r.isEdit=!1,e.stopEditStatus(),t.type=Nt,"Dialog"!==r.editSettings.mode&&e.refreshRow(t.data);var i=r.groupSettings.enableLazyLoading&&r.groupSettings.columns.length&&!r.getContentTable().querySelector("tr.e-emptyrow");r.getContentTable().querySelector("tr.e-emptyrow")||r.getContentTable().querySelector("tr.e-row")||i||r.renderModule.emptyRow(),"Dialog"!==r.editSettings.mode&&r.selectRow(e.rowIndex),r.editModule.resetMovableContentValidation(),r.trigger(Nt,t)}})}},e.prototype.addRecord=function(e,i){var n=this,o=this.parent;if(this.addedRowIndex=i=t.isNullOrUndefined(i)?0:i,e)return void o.notify(er,{requestType:"save",type:Bt,data:e,selectedRow:0,action:"add",index:i});if(!o.isEdit){this.previousData={},this.uid="";var s=o.getColumns(),a={virtualData:{},isScroll:!1};this.parent.notify(Mr,a);for(var l=0;l<s.length;l++)a.isScroll&&"movable"!==s[parseInt(l.toString(),10)].getFreezeTableName()||s[parseInt(l.toString(),10)].field&&("string"===s[parseInt(l.toString(),10)].type&&(s[parseInt(l.toString(),10)].defaultValue=this.parent.sanitize(s[parseInt(l.toString(),10)].defaultValue)),r.DataUtil.setValue(s[parseInt(l.toString(),10)].field,s[parseInt(l.toString(),10)].defaultValue,this.previousData));var h={cancel:!1,foreignKeyData:{},requestType:"add",data:this.previousData,type:Bt,index:i,rowData:this.previousData,target:void 0,isScroll:a.isScroll};(this.parent.enableVirtualization||this.parent.infiniteScrollSettings.enableCache)&&Object.keys(a.virtualData).length&&(h.data=h.rowData=a.virtualData),h.isScroll?this.inlineAddHandler(h):(this.parent.notify("create-virtual-validation-form",{uid:this.uid,prevData:this.previousData,argsCreator:this.getEditArgs.bind(this),renderer:this.renderer}),o.trigger(Bt,h,function(e){e.cancel||n.inlineAddHandler(e)}))}},e.prototype.inlineAddHandler=function(e){var t=this.parent;t.isEdit=!0,"Dialog"!==t.editSettings.mode&&t.clearSelection(),this.renderer.addNew(e),t.editModule.applyFormValidation(),e.type=Nt,e.row=t.element.querySelector("."+ti),t.trigger(Nt,e),t.editSettings.template&&t.editModule.applyFormValidation(void 0,e.form.ej2_instances[0].rules),this.args=e},e.prototype.deleteRecord=function(e,r){if(this.editRowIndex=this.parent.selectedRowIndex,r){r=r instanceof Array?r:[r];var i=this.parent,n=Object.keys(r).length;e=e||this.parent.getPrimaryKeyFieldNames()[0];for(var o=0;o<n;o++)!function(t){var n,o,s=i.currentViewData.some(function(i){return o=i,r[parseInt(t.toString(),10)]===ge(e,i)||r[parseInt(t.toString(),10)]===i});r[parseInt(t.toString(),10)]=s?o:r[parseInt(t.toString(),10)][""+e]?r[parseInt(t.toString(),10)]:(n={},n[e]=r[parseInt(t.toString(),10)],n)}(o)}var s={requestType:"delete",type:Bt,foreignKeyData:{},data:r||this.parent.getSelectedRecords(),tr:this.parent.getSelectedRows(),cancel:!1};if(t.isNullOrUndefined(this.parent.commandDelIndex)||(s.data[0]=this.parent.getRowObjectFromUID(this.parent.getRowByIndex(this.parent.commandDelIndex).getAttribute("data-uid")).data),this.parent.enableVirtualization&&s.data.length>1){var a=this.parent.getSelectedRows()[0].getAttribute("data-uid");s.data=[this.parent.getRowObjectFromUID(a).data]}this.parent.notify(er,s)},e.prototype.stopEditStatus=function(){for(var e=this.parent,r=[].slice.call(e.element.getElementsByClassName(ti)),i=[].slice.call(e.element.getElementsByClassName(ei)),n=0;n<r.length;n++)t.remove(r[parseInt(n.toString(),10)]);for(n=0;n<i.length;n++)i[parseInt(n.toString(),10)].classList.remove(ei)},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:"crud-Action",handler:this.editHandler},{event:"double-tap",handler:this.dblClickHandler},{event:ar,handler:this.clickHandler},{event:"recordAdded",handler:this.requestSuccess},{event:"dblclick",handler:this.dblClickHandler},{event:"delete-complete",handler:this.editComplete},{event:"save-complete",handler:this.editComplete},{event:"row-mode-change",handler:this.closeEdit},{event:"closeinline",handler:this.closeForm}],Ze(this.parent,this.evtHandlers,!0,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||Ze(this.parent,this.evtHandlers,!1)},e.prototype.destroy=function(){this.removeEventListener(),this.renderer.destroy()},e}(),Zo=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),$o=function(e){function t(t,r,i){var n=e.call(this,t,r)||this;return n.parent=t,n.serviceLocator=r,n.renderer=i,n}return Zo(t,e),t.prototype.closeEdit=function(){e.prototype.closeEdit.call(this)},t.prototype.addRecord=function(t,r){e.prototype.addRecord.call(this,t,r)},t.prototype.endEdit=function(){e.prototype.endEdit.call(this)},t.prototype.updateRow=function(t,r){e.prototype.updateRow.call(this,t,r)},t.prototype.deleteRecord=function(t,r){e.prototype.deleteRecord.call(this,t,r)},t.prototype.startEdit=function(t){e.prototype.startEdit.call(this,t)},t}(Jo),es=function(){function i(e,t,r){this.cellDetails={},this.originalCell={},this.cloneCell={},this.editNext=!1,this.preventSaveCell=!1,this.initialRender=!0,this.validationColObj=[],this.addBatchRow=!1,this.prevEditedBatchCell=!1,this.parent=e,this.serviceLocator=t,this.renderer=r,this.focus=t.getService("focus"),this.addEventListener()}return i.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:ar,handler:this.clickHandler},{event:"dblclick",handler:this.dblClickHandler},{event:or,handler:this.onBeforeCellFocused},{event:"cellfocused",handler:this.onCellFocused},{event:"double-tap",handler:this.dblClickHandler},{event:sr,handler:this.keyDownHandler},{event:"editNextValCell",handler:this.editNextValCell},{event:"closebatch",handler:this.closeForm},{event:lr,handler:this.destroy}],Ze(this.parent,this.evtHandlers,!0,this),this.dataBoundFunction=this.dataBound.bind(this),this.batchCancelFunction=this.batchCancel.bind(this),this.parent.addEventListener(qt,this.dataBoundFunction),this.parent.addEventListener("batchCancel",this.batchCancelFunction))},i.prototype.removeEventListener=function(){this.parent.isDestroyed||(Ze(this.parent,this.evtHandlers,!1),this.parent.removeEventListener(qt,this.dataBoundFunction),this.parent.removeEventListener("batchCancel",this.batchCancelFunction))},i.prototype.batchCancel=function(){this.parent.focusModule.restoreFocus()},i.prototype.dataBound=function(){this.parent.notify("toolbar-refresh",{})},i.prototype.destroy=function(){this.removeEventListener()},i.prototype.clickHandler=function(e){O(e.target,this.parent.element.id+"_add",!0)||(this.parent.isEdit&&t.closest(this.form,"td")!==t.closest(e.target,"td")&&(this.saveCell(),this.editNextValCell()),O(e.target,Ur)&&!this.parent.isEdit&&this.setCellIdx(e.target))},i.prototype.dblClickHandler=function(e){var r=O(e.target,Ur),i=O(e.target,Zr),n=i&&parseInt(i.getAttribute(si),10),o=r&&parseInt(r.getAttribute(oi),10);t.isNullOrUndefined(r)||t.isNullOrUndefined(n)||isNaN(o)||r.parentElement.classList.contains(ei)||this.editCell(n,this.parent.getColumns()[parseInt(o.toString(),10)].field,this.isAddRow(n))},i.prototype.onBeforeCellFocused=function(e){this.parent.isEdit&&this.validateFormObj()&&(e.byClick||["tab","shiftTab","enter","shiftEnter"].indexOf(e.keyArgs.action)>-1)&&(e.cancel=!0,e.byClick?e.clickArgs.preventDefault():e.keyArgs.preventDefault())},i.prototype.onCellFocused=function(e){var r=this.parent.getFrozenLeftCount(),i=this.parent.getFrozenRightColumnsCount(),n=this.parent.getContent().querySelector("."+Wr),o=this.parent.getHeaderContent().querySelector("."+Kr),s=!(e.container.isContent&&e.container.isDataCell||this.parent.frozenRows&&e.container.isHeader);if(this.parent.focusModule.active&&(this.prevEditedBatchCell=this.parent.focusModule.active.matrix.current.toString()===this.prevEditedBatchCellMatrix().toString(),this.crtRowIndex=[].slice.call(this.parent.focusModule.active.getTable().rows).indexOf(t.closest(e.element,"tr"))),!e.byKey||s||this.parent.isFrozenGrid()&&e.element&&t.closest(e.element,".e-gridheader")&&t.closest(e.element,"thead"))return void((this.parent.isEdit&&s||this.parent.isFrozenGrid()&&this.parent.isEdit&&e.byKey)&&this.saveCell());var a=e.container.indexes,l=a[0],h=a[1];if(r&&(n.contains(e.element)||this.parent.frozenRows&&o.contains(e.element))&&(h+=r),i){var p=this.parent.getHeaderContent().querySelector(".e-frozen-right-header");(this.parent.getContent().querySelector(".e-frozen-right-content").contains(e.element)||this.parent.frozenRows&&p.contains(e.element))&&(h+=r+this.parent.getMovableColumnsCount())}this.parent.frozenRows&&e.container.isContent&&(l+=this.parent.frozenRows);var d=this.parent.isEdit;if(!this.parent.element.getElementsByClassName("e-popup-open").length)switch(d=d&&!this.validateFormObj(),e.keyArgs.action){case"tab":case"shiftTab":var c=this.parent.isRowDragable()&&this.parent.isDetail()?2:this.parent.isRowDragable()||this.parent.isDetail()?1:0,u=this.parent.getColumns()[h-c];u&&!this.parent.isEdit&&this.editCell(l,u.field),(d||this.parent.isLastCellPrimaryKey)&&this.editCellFromIndex(l,h);break;case"enter":case"shiftEnter":e.keyArgs.preventDefault();var g={cancel:!1,keyArgs:e.keyArgs};this.parent.notify("beforeFocusCellEdit",g),!g.cancel&&d&&this.editCell(l,this.cellDetails.column.field);break;case"f2":this.editCellFromIndex(l,h),this.focus.focus()}},i.prototype.isAddRow=function(e){return this.parent.getDataRows()[parseInt(e.toString(),10)].classList.contains("e-insertedrow")},i.prototype.editCellFromIndex=function(e,t){this.cellDetails.rowIndex=e,this.cellDetails.cellIndex=t,this.editCell(e,this.parent.getColumns()[parseInt(t.toString(),10)].field,this.isAddRow(e))},i.prototype.closeEdit=function(){var e=this,t=this.parent,r=this.parent.getRowsObject(),i={cancel:!1,batchChanges:this.getBatchChanges()};if(t.notify("before-batch-cancel",i),!i.cancel){t.isEdit&&this.saveCell(!0),this.isAdded=!1,t.clearSelection();for(var n,o=qe(this.parent),s=this,a=0;a<r.length;a++)!function(t){var i=!1,a=r[parseInt(t.toString(),10)].isDirty;Ne(s.parent,function(r,n){(i=e.removeBatchElementChanges(n[parseInt(t.toString(),10)],a))&&n.splice(t,1)},o),i&&t--,n=t}(a),a=n;t.getContentTable().querySelector("tr.e-row")||t.renderModule.renderEmptyRow();var l={requestType:"batchCancel",rows:this.parent.getRowsObject()};this.parent.isFrozenGrid()?(this.parent.getRowsObject().length&&t.notify("batchCancel",{rows:this.parent.getRowsObject(),args:{isFrozen:!0}}),this.parent.getMovableRowsObject().length&&t.notify("batchCancel",{rows:this.parent.getMovableRowsObject()}),this.parent.getFrozenRightRowsObject().length&&t.notify("batchCancel",{rows:this.parent.getFrozenRightRowsObject(),args:{renderFrozenRightContent:!0}})):t.notify("batchCancel",{rows:this.parent.getRowsObject().length?this.parent.getRowsObject():[new Nr({isDataRow:!0,cells:[new qr({isDataCell:!0,visible:!0})]})]}),t.selectRow(this.cellDetails.rowIndex),this.refreshRowIdx(),t.editModule.resetMovableContentValidation(),t.notify("toolbar-refresh",{}),this.parent.notify("tooltip-destroy",{}),l={requestType:"batchCancel",rows:this.parent.getRowsObject()},t.trigger("batchCancel",l)}},i.prototype.removeBatchElementChanges=function(e,r){var i=this.parent,n=new fi(this.serviceLocator,null,this.parent),o=!1;if(r){e.isDirty=r;var s=i.getRowElementByUID(e.uid);if(s&&(s.classList.contains("e-insertedrow")?(t.remove(s),o=!0):(ae(e,this.parent.getForeignKeyColumns(),e.data),delete e.changes,delete e.edit,e.isDirty=!1,t.classList(s,[],["e-hiddenrow","e-updatedtd"]),n.refresh(e,i.getColumns(),!1)),this.parent.aggregates.length>0)){var a=[];a.type="cancel",this.parent.notify("refresh-footer-rendered",a),this.parent.groupSettings.columns.length>0&&this.parent.notify("group-aggregates",a)}}return o},i.prototype.removeHideAndSelection=function(e){if(e.classList.contains("e-hiddenrow")){e.removeAttribute("aria-selected");for(var r=[].slice.call(e.getElementsByClassName("e-selectionbackground")),i=0;i<r.length;i++)t.removeClass([r[parseInt(i.toString(),10)]],["e-selectionbackground","e-active"])}t.classList(e,[],["e-hiddenrow","e-updatedtd"])},i.prototype.deleteRecord=function(e,t){this.saveCell(),this.validateFormObj()&&this.saveCell(!0),this.isAdded=!1,this.bulkDelete(e,t),this.parent.aggregates.length>0&&(this.parent.notify("refresh-footer-rendered",{}),this.parent.groupSettings.columns.length>0&&this.parent.notify("group-aggregates",{}))},i.prototype.addRecord=function(e){this.bulkAddRow(e)},i.prototype.endEdit=function(){this.parent.isEdit&&this.validateFormObj()||this.batchSave()},i.prototype.closeForm=function(){for(var e=0;e<Object.keys(this.originalCell).length;e++)for(var t=0;t<Object.keys(this.cloneCell).length;t++)Object.keys(this.originalCell)[parseInt(e.toString(),10)]===Object.keys(this.cloneCell)[parseInt(t.toString(),10)]&&(this.cloneCell[Object.keys(this.cloneCell)[parseInt(t.toString(),10)]].replaceWith(this.originalCell[Object.keys(this.originalCell)[parseInt(e.toString(),10)]]),this.originalCell[Object.keys(this.originalCell)[parseInt(e.toString(),10)]].classList.contains("e-selectionbackground")&&this.originalCell[Object.keys(this.originalCell)[parseInt(e.toString(),10)]].classList.remove("e-selectionbackground","e-cellselectionbackground","e-active"));this.cloneCell={},this.originalCell={}},i.prototype.validateFormObj=function(){return this.parent.editModule.formObj&&!this.parent.editModule.formObj.validate()},i.prototype.batchSave=function(){var e=this.parent;if(e.isCheckBoxSelection){var r=e.element.querySelector(".e-checkselectall").parentElement;r.classList.contains("e-checkbox-disabled")&&e.pageSettings.totalRecordsCount>e.currentViewData.length&&t.removeClass([r],["e-checkbox-disabled"])}if(this.saveCell(),!(e.isEdit||this.editNextValCell()||e.isEdit)){var i=this.getBatchChanges();"Multiple"===this.parent.selectionSettings.type&&i.deletedRecords.length&&this.parent.selectionSettings.persistSelection&&(i.deletedRecords=this.removeSelectedData,this.removeSelectedData=[]);var n={changedRecords:this.parent.getRowsObject().filter(function(e){return e.isDirty&&-1===["add","delete"].indexOf(e.edit)}).map(function(e){return e.data})},o={batchChanges:i,cancel:!1};e.trigger("beforeBatchSave",o,function(t){t.cancel||(e.showSpinner(),e.notify("bulk-save",{changes:i,original:n}))}),e.editModule.resetMovableContentValidation()}},i.prototype.getBatchChanges=function(){for(var e={addedRecords:[],deletedRecords:[],changedRecords:[]},t=0,r=this.parent.getRowsObject();t<r.length;t++){var i=r[t];if(i.isDirty)switch(i.edit){case"add":e.addedRecords.push(i.changes);break;case"delete":e.deletedRecords.push(i.data);break;default:e.changedRecords.push(i.changes)}}return e},i.prototype.removeRowObjectFromUID=function(e){for(var t=this.parent.getRowsObject(),r=0,i=t.length;r<i&&t[parseInt(r.toString(),10)].uid!==e;r++);Ne(this.parent,function(e,t){t.splice(r,1)},qe(this.parent))},i.prototype.addRowObject=function(e,t){var r=this.parent,i="Top"===r.editSettings.newRowPosition;Ne(this.parent,function(n,o){var s=e.clone();r.isFrozenGrid()?t===n&&(i?o.unshift(s):o.push(s)):i?o.unshift(s):o.push(s)},qe(this.parent),!0)},i.prototype.bulkDelete=function(e,r){var i=this;this.removeSelectedData=[];var n=this.parent,o=n.selectedRowIndex,s=n.getSelectedRows(),a={primaryKey:this.parent.getPrimaryKeyFieldNames(),rowIndex:o,rowData:r||n.getSelectedRecords()[0],cancel:!1};a.row=r?n.editModule.deleteRowUid?n.getRowElementByUID(n.editModule.deleteRowUid):n.getRows()[n.getCurrentViewRecords().indexOf(r)]:r?n.getRows()[parseInt(o.toString(),10)]:s[0],a.row&&n.trigger("beforeBatchDelete",a,function(e){if(!e.cancel){if(i.removeSelectedData=n.getSelectedRecords(),n.clearSelection(),e.row=e.row?e.row:r?n.getRows()[parseInt(o.toString(),10)]:s[0],i.parent.isFrozenGrid()){r&&(o=parseInt(e.row.getAttribute(si),10),(s=[]).push(n.getRowByIndex(o)),s.push(n.getMovableRowByIndex(o)),n.getFrozenMode()===ri&&s.push(n.getFrozenRightRowByIndex(o)));for(a=0;a<s.length;a++){p=s[parseInt(a.toString(),10)].getAttribute("data-uid");s[parseInt(a.toString(),10)].classList.contains("e-insertedrow")?(i.removeRowObjectFromUID(p),t.remove(s[parseInt(a.toString(),10)])):((d=n.getRowObjectFromUID(p)).isDirty=!0,d.edit="delete",t.classList(s[parseInt(a.toString(),10)],["e-hiddenrow","e-updatedtd"],[]),n.frozenRows&&o<n.frozenRows&&n.getMovableDataRows().length>=n.frozenRows&&(n.getMovableHeaderTbody().appendChild(n.getMovableRowByIndex(n.frozenRows-1)),n.getFrozenHeaderTbody().appendChild(n.getRowByIndex(n.frozenRows-1)),n.getFrozenMode()===ri&&n.getFrozenRightHeaderTbody().appendChild(n.getFrozenRightRowByIndex(n.frozenRows-1))),n.frozenRows&&o<n.frozenRows&&n.getDataRows().length>=n.frozenRows&&n.getHeaderTable().querySelector(li).appendChild(n.getRowByIndex(n.frozenRows-1))),delete s[parseInt(a.toString(),10)]}}else if(i.parent.isFrozenGrid()||1!==s.length&&!r)for(var a=0;a<s.length;a++){var l=s[parseInt(a.toString(),10)].getAttribute("data-uid");if(s[parseInt(a.toString(),10)].classList.contains("e-insertedrow"))i.removeRowObjectFromUID(l),t.remove(s[parseInt(a.toString(),10)]);else{t.classList(s[parseInt(a.toString(),10)],["e-hiddenrow","e-updatedtd"],[]);var h=n.getRowObjectFromUID(l);h.isDirty=!0,h.edit="delete",delete s[parseInt(a.toString(),10)]}}else{var p=e.row.getAttribute("data-uid");if(p=r&&i.parent.editModule.deleteRowUid?p=i.parent.editModule.deleteRowUid:p,e.row.classList.contains("e-insertedrow"))i.removeRowObjectFromUID(p),t.remove(e.row);else{var d=n.getRowObjectFromUID(p);d.isDirty=!0,d.edit="delete",t.classList(e.row,["e-hiddenrow","e-updatedtd"],[])}delete e.row}i.refreshRowIdx(),r&&(n.editModule.deleteRowUid=void 0,n.getSelectedRows().length&&(o=parseInt(n.getSelectedRows()[0].getAttribute(si),10))),n.isCheckBoxSelection||n.selectRow(o),n.trigger("batchDelete",e),n.notify("batchDelete",{rows:i.parent.getRowsObject()}),n.notify("toolbar-refresh",{})}})},i.prototype.refreshRowIdx=function(){for(var e,t=this.parent.getAllDataRows(!0),r=He(this.parent),i=qe(this.parent),n=this,o=0,s=0,a=t.length;o<a;o++)!function(o,s,a){t[parseInt(o.toString(),10)].classList.contains(Zr)&&!t[parseInt(o.toString(),10)].classList.contains("e-hiddenrow")?(Ne(n.parent,function(e,t,r){t[parseInt(o.toString(),10)].setAttribute(si,s.toString()),t[parseInt(o.toString(),10)].setAttribute(ai,(s+1).toString()),r[parseInt(o.toString(),10)].index=s},r,null,i),s++):Ne(n.parent,function(e,t,r){t[parseInt(o.toString(),10)].removeAttribute(si),t[parseInt(o.toString(),10)].removeAttribute(ai),r[parseInt(o.toString(),10)].index=-1},r,null,i),e=s}(o,s),s=e},i.prototype.getIndexFromData=function(e){return A(e,this.parent.getCurrentViewRecords())},i.prototype.bulkAddRow=function(r){var i=this,n=this.parent;if(!n.editSettings.allowAdding)return void(n.isEdit&&this.saveCell());if(n.isEdit&&(this.saveCell(),this.parent.notify("editNextValCell",{})),!n.isEdit){if(this.initialRender){for(var o=n.getVisibleColumns(),s=0;s<o.length;s++)if(o[parseInt(s.toString(),10)].validationRules&&o[parseInt(s.toString(),10)].validationRules.required){var a={field:o[parseInt(s.toString(),10)].field.slice(),cellIdx:s};this.validationColObj.push(a)}this.initialRender=!1}this.parent.element.classList.add("e-editing");var l={defaultData:r||this.getDefaultData(),primaryKey:n.getPrimaryKeyFieldNames(),cancel:!1};n.trigger("beforeBatchAdd",l,function(o){if(!o.cancel)if(i.isAdded=!0,n.clearSelection(),n.isFrozenGrid()){for(var s=i.parent.getMovableColumnsCount(),a=i.parent.getFrozenLeftCount(),l=i.parent.getFrozenRightColumnsCount(),h=n.getContentTable().querySelector(li),p=s+a+l,d=void 0,c=[],u=[],g=void 0,f=void 0,m=void 0,y=void 0,v=void 0,C=0;C<p;){var S=new fi(i.serviceLocator,null,i.parent),b=(F=new mi(i.parent)).generateRows([o.defaultData]);a>0?(d="frozen-left",p=(a=0)+l+s):s>0?(d="movable",p=a+l+(s=0)):(d="frozen-right",p=a+(l=0)+s);for(var w=0;w<b.length;w++)b[parseInt(w.toString(),10)].cells=Pe(i.parent,b[parseInt(w.toString(),10)].cells,d);"frozen-left"===d?(m=S.render(b[0],n.getColumns())).classList.add("e-insertedrow"):"movable"===d?(y=S.render(b[0],n.getColumns())).classList.add("e-insertedrow"):(v=S.render(b[0],n.getColumns())).classList.add("e-insertedrow");for(var I=0;I<i.parent.groupSettings.columns.length;I++)m.insertBefore(i.parent.createElement("td",{className:"e-indentcell"}),m.firstChild),b[0].cells.unshift(new qr({cellType:e.CellType.Indent}));h.querySelector(".e-emptyrow")&&((T=h.querySelector(".e-emptyrow")).parentNode.removeChild(T),i.removeFrozenTbody()),"frozen-left"===d&&(h=n.frozenRows&&"Top"===n.editSettings.newRowPosition?n.getHeaderTable().querySelector(li):n.getContentTable().querySelector(li),"Top"===i.parent.editSettings.newRowPosition?(h.insertBefore(m,h.firstChild),t.addClass([].slice.call(m.getElementsByClassName(Ur)),["e-updatedtd"])):(h.appendChild(m),t.addClass([].slice.call(m.getElementsByClassName(Ur)),["e-updatedtd"]))),"movable"!==d&&"frozen-right"!==d||i.renderFrozenAddRow(y,v,d),b[0].isDirty=!0,b[0].changes=t.extend({},{},b[0].data,!0),b[0].edit="add",i.addRowObject(b[0],d)}i.refreshRowIdx(),i.focus.forgetPrevious(),n.notify("batchAdd",{rows:i.parent.getRowsObject(),args:{isFrozen:i.parent.isFrozenGrid()}});var R=i.getBatchChanges(),x=i.getBottomIndex();"Top"===i.parent.editSettings.newRowPosition?n.selectRow(0):n.selectRow(x),r||(f=i.findNextEditableCell(0,!0),g=n.getColumns()[parseInt(f.toString(),10)],"Top"===i.parent.editSettings.newRowPosition?i.editCell(0,g.field,!0):i.editCell(x,g.field,!0)),i.parent.aggregates.length>0&&(r||R.addedRecords.length)&&i.parent.notify("refresh-footer-rendered",{}),m&&(xe(y.querySelector("td:not(.e-hide)"),m.querySelector("td:not(.e-hide)")),c.push(m),u.push(m.cells)),c.push(y),u.push(y.cells),v&&(c.push(v),u.push(v.cells));E={defaultData:o.defaultData,row:c,columnObject:g,columnIndex:f,primaryKey:o.primaryKey,cell:u};n.trigger("batchAdd",E)}else{for(var S=new fi(i.serviceLocator,null,i.parent),F=new mi(i.parent),b=F.generateRows([o.defaultData]),m=S.render(b[0],n.getColumns()),g=void 0,f=void 0,C=0;C<i.parent.groupSettings.columns.length;C++)m.insertBefore(i.parent.createElement("td",{className:"e-indentcell"}),m.firstChild),b[0].cells.unshift(new qr({cellType:e.CellType.Indent}));h=n.getContentTable().querySelector(li);if(m.classList.add("e-insertedrow"),h.querySelector(".e-emptyrow")){var T=h.querySelector(".e-emptyrow");T.parentNode.removeChild(T),i.removeFrozenTbody()}h=n.frozenRows&&"Top"===n.editSettings.newRowPosition?n.getHeaderTable().querySelector(li):n.getContentTable().querySelector(li),"Top"===i.parent.editSettings.newRowPosition?h.insertBefore(m,h.firstChild):h.appendChild(m),t.addClass([].slice.call(m.getElementsByClassName(Ur)),["e-updatedtd"]),b[0].isDirty=!0,b[0].changes=t.extend({},{},b[0].data,!0),b[0].edit="add",i.addRowObject(b[0]),i.refreshRowIdx(),i.focus.forgetPrevious(),n.notify("batchAdd",{rows:i.parent.getRowsObject(),args:{isFrozen:i.parent.isFrozenGrid()}});var R=i.getBatchChanges(),x=i.getBottomIndex();"Top"===i.parent.editSettings.newRowPosition?n.selectRow(0):n.selectRow(x),r||(f=i.findNextEditableCell(0,!0),g=n.getColumns()[parseInt(f.toString(),10)],"Top"===i.parent.editSettings.newRowPosition?i.editCell(0,g.field,!0):i.editCell(x,g.field,!0)),i.parent.aggregates.length>0&&(r||R.addedRecords.length)&&i.parent.notify("refresh-footer-rendered",{});var E={defaultData:o.defaultData,row:m,columnObject:g,columnIndex:f,primaryKey:o.primaryKey,cell:t.isNullOrUndefined(f)?void 0:m.cells[parseInt(f.toString(),10)]};n.trigger("batchAdd",E)}})}},i.prototype.renderFrozenAddRow=function(e,r,i){var n,o,s=this.parent;"movable"===i&&(n=s.frozenRows&&"Top"===s.editSettings.newRowPosition?this.parent.getMovableHeaderTbody():this.parent.getContent().querySelector(".e-movablecontent").querySelector(li),"Top"===s.editSettings.newRowPosition?n.insertBefore(e,n.firstChild):n.appendChild(e),t.addClass([].slice.call(e.getElementsByClassName(Ur)),["e-updatedtd"])),"frozen-right"===i&&(o=s.frozenRows&&"Top"===s.editSettings.newRowPosition?this.parent.getFrozenRightHeaderTbody():this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(li),"Top"===s.editSettings.newRowPosition?o.insertBefore(r,o.firstChild):o.appendChild(r),t.addClass([].slice.call(r.getElementsByClassName(Ur)),["e-updatedtd"]),xe(r.querySelector("td:not(.e-hide)"),e.querySelector("td:not(.e-hide)"))),"auto"===s.height&&s.notify("frozenHeight",{})},i.prototype.removeFrozenTbody=function(){var e=this.parent;if(e.isFrozenGrid()){var t=e.getContent().querySelector("."+Wr).querySelector(li);if(t.firstElementChild.parentNode.removeChild(t.firstElementChild),e.getFrozenMode()===ri){var r=e.getContent().querySelector(".e-frozen-right-content").querySelector(li);r.firstElementChild.parentNode.removeChild(r.firstElementChild)}}},i.prototype.renderMovable=function(e,t){var r=e.cloneNode(!0),i=this.parent.getMovableColumnsCount(),n=this.parent.getFrozenLeftCount(),o=this.parent.getFrozenRightColumnsCount();return Ue(e,0,n),Ue(r,n,o?r.children.length-o:r.children.length),Ue(t,n+i,t.children.length),r},i.prototype.findNextEditableCell=function(e,r,i){for(var n,o=this.parent.getColumns(),s=o.length,a=e;a<s;a++){if(n=!!i&&t.isNullOrUndefined(o[parseInt(a.toString(),10)].validationRules),!r&&this.checkNPCell(o[parseInt(a.toString(),10)]))return a;if(r&&(!o[parseInt(a.toString(),10)].template||o[parseInt(a.toString(),10)].field)&&o[parseInt(a.toString(),10)].visible&&(!o[parseInt(a.toString(),10)].isIdentity||!o[parseInt(a.toString(),10)].isPrimaryKey)&&!n)return a}return-1},i.prototype.checkNPCell=function(e){return!e.template&&e.visible&&!e.isPrimaryKey&&!e.isIdentity&&e.allowEditing},i.prototype.getDefaultData=function(){for(var e={},r={number:0,string:null,boolean:!1,date:null,datetime:null},i=0,n=this.parent.columnModel;i<n.length;i++){var o=n[i];o.field&&t.setValue(o.field,Object.keys(o).indexOf("defaultValue")>=0?o.defaultValue:r[o.type],e)}return e},i.prototype.setCellIdx=function(e){var t=0;this.parent.allowGrouping&&(t=this.parent.groupSettings.columns.length),this.cellDetails.cellIndex=e.cellIndex-t,this.cellDetails.rowIndex=parseInt(e.getAttribute("index"),10)},i.prototype.editCell=function(e,t,r){var i=this.parent,n=i.getColumnByField(t);this.index=e,this.field=t,this.isAdd=r;var o=i.isEdit&&!(this.cellDetails.column.field===t&&this.cellDetails.rowIndex===e&&this.parent.getDataRows().length-1!==e&&this.prevEditedBatchCell);i.editSettings.allowEditing&&(!o&&(n.allowEditing||!n.allowEditing&&i.focusModule.active&&i.focusModule.active.getTable().rows[this.crtRowIndex]&&i.focusModule.active.getTable().rows[this.crtRowIndex].classList.contains("e-insertedrow"))?this.editCellExtend(e,t,r):o&&(this.editNext=!0,this.saveCell()))},i.prototype.editCellExtend=function(e,r,i){var n=this,o=this.parent,s=o.getColumnByField(r),a=o.getPrimaryKeyFieldNames();if(!o.isEdit){var l,h,p=t.extend({},{},this.getDataByIndex(e),!0);if("movable"===s.getFreezeTableName()||s.getFreezeTableName()===ii?(l="movable"===s.getFreezeTableName()?o.getMovableDataRows()[parseInt(e.toString(),10)]:o.getFrozenRightDataRows()[parseInt(e.toString(),10)],h=this.parent.getRowObjectFromUID(l.getAttribute("data-uid")),p=h.changes?t.extend({},{},h.changes,!0):p):(l=o.getDataRows()[parseInt(e.toString(),10)],p=t.extend({},{},this.getDataByIndex(e),!0)),a[0]===s.field&&!l.classList.contains("e-insertedrow")||s.columns||s.isPrimaryKey&&s.isIdentity||s.commands)return void(this.parent.isLastCellPrimaryKey=!0);this.parent.isLastCellPrimaryKey=!1,this.parent.element.classList.add("e-editing");var d=o.getRowObjectFromUID(l.getAttribute("data-uid")),c=[].slice.apply(l.cells),u={columnName:s.field,isForeignKey:!t.isNullOrUndefined(s.foreignKeyValue),primaryKey:a,rowData:p,validationRules:t.extend({},s.validationRules?s.validationRules:{}),value:ge(s.field,p),type:i?"add":"edit",cancel:!1,foreignKeyData:d&&d.foreignKeyData};u.cell=c[this.getColIndex(c,this.getCellIdx(s.uid))],u.row=l,u.columnObject=s,u.cell&&o.trigger("cellEdit",u,function(r){r.cancel||(r.cell=r.cell?r.cell:c[n.getColIndex(c,n.getCellIdx(s.uid))],r.row=r.row?r.row:l,r.columnObject=r.columnObject?r.columnObject:s,r.columnObject.index=t.isNullOrUndefined(r.columnObject.index)?0:r.columnObject.index,n.cellDetails={rowData:p,column:s,value:r.value,isForeignKey:r.isForeignKey,rowIndex:e,cellIndex:parseInt(r.cell.getAttribute(oi),10),foreignKeyData:r.foreignKeyData},r.cell.classList.contains("e-updatedtd")&&(n.isColored=!0,r.cell.classList.remove("e-updatedtd")),o.isEdit=!0,o.clearSelection(),o.isCheckBoxSelection&&o.isPersistSelection||o.selectRow(n.cellDetails.rowIndex,!0),n.renderer.update(r),n.parent.notify("batcheditform-rendered",r),n.form=t.select("#"+o.element.id+"EditForm",o.element),o.editModule.applyFormValidation([s]),n.parent.element.querySelector(".e-gridpopup").style.display="none")})}},i.prototype.updateCell=function(e,t,r){var i=this.parent,n=i.getColumnByField(t),o=i.getColumnIndexByField(t);if(n&&!n.isPrimaryKey&&n.allowEditing){var s=Ve(this.parent,n,e,o),a="movable"===n.getFreezeTableName()?this.parent.getMovableRowsObject()[parseInt(e.toString(),10)]:n.getFreezeTableName()===ii?i.getFrozenRightRowsObject()[parseInt(e.toString(),10)]:i.getRowObjectFromUID(s.parentElement.getAttribute("data-uid"));this.refreshTD(s,n,a,r),this.parent.trigger("queryCellInfo",{cell:this.newReactTd||s,column:n,data:a.changes})}},i.prototype.setChanges=function(e,i,n){var o;if(this.parent.isFrozenGrid()){var s=this.parent.getRowElementByUID(e.uid),a=parseInt(s.getAttribute(si),10);(o=this.parent.getRowsObject()[parseInt(a.toString(),10)]).changes||(o.changes=t.extend({},{},e.data,!0)),t.isNullOrUndefined(i)||t.setValue(i,n,o.changes);var l=this.parent.getMovableRowsObject()[parseInt(a.toString(),10)];if(l.changes=t.extend({},{},o.changes,!0),e.data[""+i]!==n&&(l.isDirty=!0,o.isDirty=!0),this.parent.getFrozenMode()===ri){var h=this.parent.getFrozenRightRowsObject()[parseInt(a.toString(),10)];h.changes=t.extend({},{},o.changes,!0),e.data[""+i]!==n&&(h.isDirty=!0)}}else if(e.changes||(e.changes=t.extend({},{},e.data,!0)),t.isNullOrUndefined(i)||("string"==typeof n&&(n=this.parent.sanitize(n)),r.DataUtil.setValue(i,n,e.changes)),e.data[""+i]!==n){var p=this.parent.getColumnByField(i).type;"date"===p||"datetime"===p?new Date(e.data[""+i]).toString()!==new Date(n).toString()&&(e.isDirty=!0):e.isDirty=!0}},i.prototype.updateRow=function(e,t){for(var r=0,i=Object.keys(t);r<i.length;r++){var n=i[r];this.updateCell(e,n,t[""+n])}},i.prototype.getCellIdx=function(e){var r=this.parent.getColumnIndexByUid(e)+this.parent.groupSettings.columns.length;return t.isNullOrUndefined(this.parent.detailTemplate)&&t.isNullOrUndefined(this.parent.childGrid)||r++,this.parent.isRowDragable()&&r++,r},i.prototype.refreshTD=function(e,r,i,n){var o,s=new xi(this.parent,this.serviceLocator);n="number"!==r.type||t.isNullOrUndefined(n)?n:parseFloat(n),this.setChanges(i,r.field,n);var a=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount();a=a&&this.parent.isRowDragable()?a+1:a,ae(i,this.parent.getForeignKeyColumns(),i.changes),o=a&&"movable"===r.getFreezeTableName()&&this.parent.getColumns().length===i.cells.length?i.cells.slice(a,i.cells.length):i.cells;var l,h;this.parent.isReact&&(l=e.parentElement,h=e.cellIndex);var p=0;a&&(p="movable"===r.getFreezeTableName()&&"Right"!==this.parent.getFrozenMode()?a:r.getFreezeTableName()===ii?this.parent.getFrozenLeftColumnsCount()+this.parent.getMovableColumnsCount():p),s.refreshTD(e,o[this.getCellIdx(r.uid)-p],i.changes,{index:this.getCellIdx(r.uid)}),this.parent.isReact?(this.newReactTd=l.cells[parseInt(h.toString(),10)],l.cells[parseInt(h.toString(),10)].classList.add("e-updatedtd")):e.classList.add("e-updatedtd"),e.classList.add("e-updatedtd"),this.parent.notify("toolbar-refresh",{})},i.prototype.getColIndex=function(e,r){var i=0;this.parent.allowGrouping&&this.parent.groupSettings.columns&&(i=this.parent.groupSettings.columns.length),t.isNullOrUndefined(this.parent.detailTemplate)&&t.isNullOrUndefined(this.parent.childGrid)||i++,this.parent.isRowDragable()&&i++;for(var n=0;n<e.length;n++)if(parseInt(e[parseInt(n.toString(),10)].getAttribute(oi),10)===r-i)return n;return-1},i.prototype.editNextValCell=function(){var e=this.parent,t=e.element.querySelectorAll(".e-insertedrow"),r=1===t.length||(e.getFrozenColumns()>0||e.getFrozenRightColumnsCount()>0||e.getFrozenLeftColumnsCount()>0)&&(2===t.length||3===t.length);if(r&&this.isAdded&&!e.isEdit){for(var i=this.getBottomIndex(),n=this.cellDetails.cellIndex;n<e.getColumns().length;n++){if(e.isEdit)return;var o=this.findNextEditableCell(this.cellDetails.cellIndex+1,!0,!0),s=e.getColumns()[parseInt(o.toString(),10)];if(s){if("Bottom"===this.parent.editSettings.newRowPosition)this.editCell(i,s.field,!0);else{var a={index:0,column:s};this.parent.notify("next-cell-index",a),this.editCell(a.index,s.field,!0)}this.saveCell()}}e.isEdit||(this.isAdded=!1)}else if(r||!this.isAdded||e.isEdit||e.isFrozenGrid()){if(!r&&this.isAdded&&!e.isEdit&&e.isFrozenGrid()){var l=e.getFrozenLeftContentTbody()?e.getFrozenLeftContentTbody().querySelectorAll(".e-insertedrow"):void 0,h=e.getFrozenRightContentTbody()?e.getFrozenRightContentTbody().querySelectorAll(".e-insertedrow"):void 0,p=e.getMovableContentTbody().querySelectorAll(".e-insertedrow"),d=0,c=e.getVisibleFrozenLeftCount()?e.getVisibleFrozenLeftCount():e.getFrozenColumns(),u=e.getVisibleFrozenRightCount(),g=e.getVisibleMovableCount();if("Bottom"===e.editSettings.newRowPosition){f=this.getBatchChanges();d=e.getCurrentViewRecords().length-f.deletedRecords.length}else"Top"===e.editSettings.newRowPosition&&e.frozenRows&&(l=e.getFrozenHeaderTbody()?e.getFrozenHeaderTbody().querySelectorAll(".e-insertedrow"):void 0,h=e.getFrozenRightHeader()?e.getFrozenRightHeader().querySelectorAll(".e-insertedrow"):void 0,p=e.getMovableHeaderTbody().querySelectorAll(".e-insertedrow"));for(n=0;n<p.length&&!e.isEdit;n++,d++)for(m=0;m<this.validationColObj.length&&!e.isEdit;m++)c&&this.validationColObj[parseInt(m.toString(),10)].cellIdx<c?""===l[parseInt(n.toString(),10)].querySelectorAll("td")[this.validationColObj[parseInt(m.toString(),10)].cellIdx].innerText&&(this.editCell(d,this.validationColObj[parseInt(m.toString(),10)].field),e.editModule.formObj.validate()&&this.saveCell()):u&&g<=this.validationColObj[parseInt(m.toString(),10)].cellIdx?""===h[parseInt(n.toString(),10)].querySelectorAll("td")[this.validationColObj[parseInt(m.toString(),10)].cellIdx-(g+c)].innerText&&(this.editCell(d,this.validationColObj[parseInt(m.toString(),10)].field),e.editModule.formObj.validate()&&this.saveCell()):""===p[parseInt(n.toString(),10)].querySelectorAll("td")[this.validationColObj[parseInt(m.toString(),10)].cellIdx-c].innerText&&(this.editCell(d,this.validationColObj[parseInt(m.toString(),10)].field),e.editModule.formObj.validate()&&this.saveCell());e.isEdit||(this.isAdded=!1)}}else{d=0;if("Bottom"===e.editSettings.newRowPosition){var f=this.getBatchChanges();d=e.getCurrentViewRecords().length-f.deletedRecords.length}for(n=0;n<t.length&&!e.isEdit;n++,d++)for(var m=0;m<this.validationColObj.length&&!e.isEdit;m++)""===t[parseInt(n.toString(),10)].querySelectorAll("td")[this.validationColObj[parseInt(m.toString(),10)].cellIdx].innerText&&(this.editCell(d,this.validationColObj[parseInt(m.toString(),10)].field),this.validateFormObj()&&this.saveCell());e.isEdit||(this.isAdded=!1)}},i.prototype.escapeCellEdit=function(){var e=this.generateCellArgs();e.value=e.previousValue,!e.value&&this.cellDetails.column.validationRules||this.successCallBack(e,e.cell.parentElement,e.column,!0)(e)},i.prototype.generateCellArgs=function(){var e=this.parent;this.parent.element.classList.remove("e-editing");var r=this.cellDetails.column,i={};i[r.field]=ge(r.field,this.cellDetails.rowData);var n=e.editModule.getCurrentEditedData(this.form,i),o=t.extend({},n);n=t.extend({},n,this.cellDetails.rowData);var s=ge(r.field,o);t.isNullOrUndefined(r.field)||t.isUndefined(s)||t.setValue(r.field,s,n);var a={columnName:r.field,value:ge(r.field,n),rowData:this.cellDetails.rowData,column:r,previousValue:this.cellDetails.value,isForeignKey:this.cellDetails.isForeignKey,cancel:!1};return a.cell=this.form.parentElement,a.columnObject=r,a},i.prototype.saveCell=function(e){if(!this.preventSaveCell&&this.form){var t=this.parent;if(e||t.isEdit&&!this.validateFormObj()){this.preventSaveCell=!0;var r=this.generateCellArgs(),i=r.cell.parentElement,n=r.column;e?this.successCallBack(r,i,n)(r):(t.trigger("cellSave",r,this.successCallBack(r,i,n)),t.notify("batchedit-form",{formObj:this.form}))}}},i.prototype.successCallBack=function(e,r,i,n){var o=this;return function(e){var s=o.parent;if(e.cell=e.cell?e.cell:o.form.parentElement,e.columnObject=e.columnObject?e.columnObject:i,e.columnObject.index=t.isNullOrUndefined(e.columnObject.index)?0:e.columnObject.index,e.cancel){if(o.preventSaveCell=!1,o.editNext){if(o.editNext=!1,o.cellDetails.rowIndex===o.index&&o.cellDetails.column.field===o.field)return;o.editCellExtend(o.index,o.field,o.isAdd)}}else{s.editModule.destroyWidgets([i]),s.isEdit=!1,s.editModule.destroyForm(),o.parent.notify("tooltip-destroy",{});var a=O(e.cell,Wr)||O(e.cell,Kr)?s.getRowObjectFromUID(r.getAttribute("data-uid"),!0):s.getRowObjectFromUID(r.getAttribute("data-uid"));if(s.getFrozenMode()===ri&&(O(e.cell,"e-frozen-right-header")||O(e.cell,"e-frozen-right-content"))&&(a=s.getRowObjectFromUID(r.getAttribute("data-uid"),!1,!0)),o.refreshTD(e.cell,i,a,e.value),o.parent.isReact&&(e.cell=o.newReactTd),t.removeClass([r],[ei,"e-batchrow"]),t.removeClass([e.cell],["e-editedbatchcell","e-boolcell"]),(!t.isNullOrUndefined(e.value)&&e.value.toString()===(t.isNullOrUndefined(o.cellDetails.value)?"":o.cellDetails.value).toString()&&!o.isColored||t.isNullOrUndefined(e.value)&&t.isNullOrUndefined(a.data[i.field])&&t.isNullOrUndefined(o.cellDetails.value)&&!e.cell.parentElement.classList.contains("e-insertedrow"))&&e.cell.classList.remove("e-updatedtd"),t.isNullOrUndefined(n)){var l=s.isReact&&i.template&&"string"!=typeof i.template,h=s.parentDetails&&s.parentDetails.parentInstObj&&s.parentDetails.parentInstObj.isReact;l||h?s.requireTemplateRef?s.renderTemplates(function(){s.trigger("cellSaved",e)}):(s.renderTemplates(),s.trigger("cellSaved",e)):s.trigger("cellSaved",e)}if(s.notify("toolbar-refresh",{}),o.isColored=!1,o.parent.aggregates.length>0&&(o.parent.notify("refresh-footer-rendered",{}),o.parent.groupSettings.columns.length>0&&!o.isAddRow(o.cellDetails.rowIndex)&&o.parent.notify("group-aggregates",{})),o.preventSaveCell=!1,o.editNext){if(o.editNext=!1,o.cellDetails.rowIndex===o.index&&o.cellDetails.column.field===o.field&&o.prevEditedBatchCell)return;var p=s.getColumnByField(o.field);p&&(p.allowEditing||!p.allowEditing&&s.focusModule.active&&s.focusModule.active.getTable().rows[o.crtRowIndex]&&s.focusModule.active.getTable().rows[o.crtRowIndex].classList.contains("e-insertedrow"))&&o.editCellExtend(o.index,o.field,o.isAdd)}n&&s.notify("restore-Focus",{})}}},i.prototype.prevEditedBatchCellMatrix=function(){var e=[],t=this.parent,r=t.focusModule.active?t.focusModule.active.getTable().querySelector(".e-editedbatchcell"):void 0;if(r){var i=r.parentElement;e=[[].slice.call(this.parent.focusModule.active.getTable().rows).indexOf(i),[].slice.call(i.cells).indexOf(r)]}return e},i.prototype.getDataByIndex=function(e){var t=this.parent.getRowObjectFromUID(this.parent.getDataRows()[parseInt(e.toString(),10)].getAttribute("data-uid"));return t.changes?t.changes:t.data},i.prototype.keyDownHandler=function(e){if(this.addBatchRow||("tab"===e.action||"shiftTab"===e.action)&&this.parent.isEdit){var t=this.parent,r=this.getBottomIndex(),i=O(e.target,Ur);if(this.addBatchRow||i){var n=i?i.querySelector(".e-field"):void 0;if(this.addBatchRow||n){var o=this.parent.getVisibleColumns(),s="tab"===e.action?o.length-1:0;(this.addBatchRow||o[parseInt(s.toString(),10)].field===n.getAttribute("id").slice(this.parent.element.id.length))&&(this.cellDetails.rowIndex===r&&"tab"===e.action?("Top"===t.editSettings.newRowPosition?(t.editSettings.newRowPosition="Bottom",this.addRecord(),t.editSettings.newRowPosition="Top"):this.addRecord(),this.addBatchRow=!1):this.saveCell())}}}},i.prototype.addCancelWhilePaging=function(){this.validateFormObj()&&(this.parent.notify("destroy-form",{}),this.parent.isEdit=!1,this.isColored=!1)},i.prototype.getBottomIndex=function(){var e=this.getBatchChanges();return this.parent.getCurrentViewRecords().length+e.addedRecords.length-e.deletedRecords.length-1},i}(),ts=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),rs=function(e){function t(t,r,i){var n=e.call(this,t,r)||this;return n.parent=t,n.serviceLocator=r,n.renderer=i,n}return ts(t,e),t.prototype.closeEdit=function(){e.prototype.closeEdit.call(this)},t.prototype.addRecord=function(t,r){e.prototype.addRecord.call(this,t,r)},t.prototype.endEdit=function(){e.prototype.endEdit.call(this)},t.prototype.updateRow=function(t,r){e.prototype.updateRow.call(this,t,r)},t.prototype.deleteRecord=function(t,r){e.prototype.deleteRecord.call(this,t,r)},t.prototype.startEdit=function(t){e.prototype.startEdit.call(this,t)},t}(Jo),is=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ns=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return is(r,e),r.prototype.write=function(e){this.edit=this.parent.editModule,"datepickeredit"===e.column.editType?this.obj=new a.DatePicker(t.extend(ct(e,this.parent.editSettings.mode,this.parent.enableRtl,this.parent.cssClass,this),e.column.edit.params)):"datetimepickeredit"===e.column.editType&&(this.obj=new a.DateTimePicker(t.extend(ct(e,this.parent.editSettings.mode,this.parent.enableRtl,this.parent.cssClass,this),e.column.edit.params))),this.obj.appendTo(e.element)},r}(Vo),os=function(){function e(e){this.parent=e}return e.prototype.read=function(e,t){return t},e.prototype.write=function(){},e.prototype.destroy=function(){},e}(),ss=function(){function e(e,t){this.editType={Inline:$o,Normal:$o,Batch:es,Dialog:rs},this.isValidationApplied=!1,this.editCellDialogClose=!1,this.parent=e,this.serviceLocator=t,this.l10n=this.serviceLocator.getService("localization"),this.addEventListener(),this.updateEditObj(),this.createAlertDlg(),this.createConfirmDlg()}return e.prototype.updateColTypeObj=function(){for(var r=this.parent.columnModel,i=0;i<r.length;i++)if(this.parent.editSettings.template||r[parseInt(i.toString(),10)].editTemplate){r[parseInt(i.toString(),10)].edit=t.extend(new e.editCellType.templateedit(this.parent),r[parseInt(i.toString(),10)].edit||{})}else r[parseInt(i.toString(),10)].edit=t.extend(new(e.editCellType[r[parseInt(i.toString(),10)].editType&&e.editCellType[r[parseInt(i.toString(),10)].editType]?r[parseInt(i.toString(),10)].editType:"defaultedit"])(this.parent,this.serviceLocator),r[parseInt(i.toString(),10)].edit||{});this.parent.log("primary_column_missing")},e.prototype.getModuleName=function(){return"edit"},e.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName())for(var t=this.parent,r=0,i=Object.keys(e.properties);r<i.length;r++)switch(i[r]){case"allowAdding":case"allowDeleting":case"allowEditing":(t.editSettings.allowAdding||t.editSettings.allowEditing||t.editSettings.allowDeleting)&&this.initialEnd();break;case"mode":this.updateEditObj(),t.isEdit=!1,t.refresh()}},e.prototype.updateEditObj=function(){this.editModule&&this.editModule.destroy(),this.renderer=new jo(this.parent,this.serviceLocator),this.editModule=new this.editType[this.parent.editSettings.mode](this.parent,this.serviceLocator,this.renderer)},e.prototype.initialEnd=function(){this.updateColTypeObj()},e.prototype.startEdit=function(e){var t=this.parent;if(t.editSettings.allowEditing&&!t.isEdit&&"Batch"!==t.editSettings.mode){if(this.parent.element.classList.add("e-editing"),t.getSelectedRows().length)e||(e=t.getSelectedRows()[0]);else if(!e)return void this.showDialog("EditOperationAlert",this.alertDObj);if(this.parent.enableVirtualization&&"Normal"===this.parent.editSettings.mode){var r=parseInt(e.getAttribute("data-rowindex"),10);e=this.parent.getRowByIndex(r)}this.isLastRow=e.rowIndex===this.parent.getContent().querySelector("tr:last-child").rowIndex,"none"!==e.style.display&&(this.editModule.startEdit(e),this.refreshToolbar(),t.element.querySelector(".e-gridpopup").style.display="none",this.parent.notify("start-edit",{}))}},e.prototype.checkLastRow=function(e,r){var i=this.isLastRow;"auto"!==this.parent.height&&"Bottom"===this.parent.editSettings.newRowPosition&&r&&"add"===r.requestType&&this.parent.getContent().firstElementChild.offsetHeight>this.parent.getContentTable().scrollHeight?t.addClass([].slice.call(e.getElementsByClassName(Ur)),"e-lastrowadded"):i&&e&&e.classList&&t.addClass([].slice.call(e.getElementsByClassName(Ur)),"e-lastrowcell")},e.prototype.closeEdit=function(){if("Batch"===this.parent.editSettings.mode&&this.parent.editSettings.showConfirmDialog&&this.parent.element.getElementsByClassName("e-updatedtd").length)return void this.showDialog("CancelEdit",this.dialogObj);this.parent.element.classList.remove("e-editing"),this.editModule.closeEdit(),this.refreshToolbar(),this.parent.notify("close-edit",{})},e.prototype.refreshToolbar=function(){this.parent.notify("toolbar-refresh",{})},e.prototype.addRecord=function(e,t){if(this.parent.editSettings.allowAdding){var r={startEdit:!0};e||this.parent.notify("virtual-scroll-add-action-begin",r),r.startEdit&&(this.parent.element.classList.add("e-editing"),this.editModule.addRecord(e,t),this.refreshToolbar(),this.parent.notify("start-add",{}))}},e.prototype.deleteRecord=function(e,r){var i=this.parent;if(i.editSettings.allowDeleting)return r||i.getSelectedRecords().length||!t.isNullOrUndefined(i.commandDelIndex)?i.editSettings.showDeleteConfirmDialog?void this.showDialog("ConfirmDelete",this.dialogObj):void this.editModule.deleteRecord(e,r):void this.showDialog("DeleteOperationAlert",this.alertDObj)},e.prototype.deleteRow=function(e){this.deleteRowUid=e.getAttribute("data-uid");var r=this.parent.getRowObjectFromUID(this.deleteRowUid);t.isNullOrUndefined(r)||this.deleteRecord(null,r.data)},e.prototype.endEdit=function(){if("Batch"===this.parent.editSettings.mode&&this.parent.editSettings.showConfirmDialog&&(t.isNullOrUndefined(this.formObj)||this.formObj.validate())&&(this.parent.editModule.saveCell(),this.parent.notify("editNextValCell",{}),t.isNullOrUndefined(this.formObj)||this.formObj.validate()))return void this.showDialog("BatchSaveConfirm",this.dialogObj);this.endEditing()},e.prototype.updateCell=function(e,t,r){this.editModule.updateCell(e,t,r)},e.prototype.updateRow=function(e,t){this.editModule.updateRow(e,t)},e.prototype.batchCancel=function(){this.closeEdit()},e.prototype.batchSave=function(){this.endEdit()},e.prototype.editCell=function(e,t){this.editModule.editCell(e,t)},e.prototype.editFormValidate=function(){var e=!this.formObj||this.formObj.validate(),t=!this.mFormObj||this.mFormObj.validate(),r=!this.frFormObj||this.frFormObj.validate();return e&&t&&r},e.prototype.getBatchChanges=function(){return this.editModule.getBatchChanges?this.editModule.getBatchChanges():{}},e.prototype.getCurrentEditCellData=function(){var e=this.getCurrentEditedData(this.formObj.element,{});return e[Object.keys(e)[0]]},e.prototype.saveCell=function(){this.editModule.saveCell()},e.prototype.endEditing=function(){this.parent.element.classList.remove("e-editing"),this.editModule.endEdit(),this.refreshToolbar()},e.prototype.showDialog=function(e,t){t.content="<div>"+this.l10n.getConstant(e)+"</div>",t.dataBind(),t.show()},e.prototype.getValueFromType=function(e,t){var r=t;switch(e.type){case"number":r=isNaN(parseFloat(t))?null:parseFloat(t);break;case"boolean":"booleanedit"!==e.editType&&(r=t===this.l10n.getConstant("True")||!0===t);break;case"date":case"datetime":"datepickeredit"!==e.editType&&"datetimepickeredit"!==e.editType&&t&&t.length?r=new Date(t):""===t&&(r=null);break;case"dateonly":r=t&&(t=new Date(t))?t.getFullYear()+"-"+pe(t.getMonth()+1)+"-"+pe(t.getDate()):null}return r},e.prototype.destroyToolTip=function(){for(var e=0,r=[].slice.call(this.parent.element.getElementsByClassName("e-griderror"));e<r.length;e++){var i=r[e];t.remove(i)}this.parent.getContent().firstElementChild.style.position="relative"},e.prototype.createConfirmDlg=function(){this.dialogObj=this.dlgWidget([{click:this.dlgOk.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),cssClass:this.parent.cssClass?"e-primary "+this.parent.cssClass:"e-primary",isPrimary:!0}},{click:this.dlgCancel.bind(this),buttonModel:{cssClass:this.parent.cssClass?"e-flat "+this.parent.cssClass:"e-flat",content:this.l10n.getConstant("CancelButton")}}],"EditConfirm")},e.prototype.createAlertDlg=function(){this.alertDObj=this.dlgWidget([{click:this.alertClick.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),cssClass:this.parent.cssClass?"e-flat "+this.parent.cssClass:"e-flat",isPrimary:!0}}],"EditAlert")},e.prototype.alertClick=function(){this.alertDObj.hide()},e.prototype.dlgWidget=function(e,t){var r=this.parent.createElement("div",{id:this.parent.element.id+t});this.parent.element.appendChild(r);var n={showCloseIcon:!1,isModal:!0,visible:!1,closeOnEscape:!0,target:this.parent.element,width:"320px",animationSettings:{effect:"None"},cssClass:this.parent.cssClass?this.parent.cssClass:""};n.buttons=e;var o=new i.Dialog(n);return o.isStringTemplate=!0,o.appendTo(r),o},e.prototype.dlgCancel=function(){this.parent.focusModule.clearIndicator(),this.parent.focusModule.restoreFocus(),this.dialogObj.hide(),this.parent.notify("cancelcnfrmDlg",{})},e.prototype.dlgOk=function(){switch(this.dialogObj.element.querySelector(".e-dlg-content").firstElementChild.innerText){case this.l10n.getConstant("ConfirmDelete"):this.editModule.deleteRecord();break;case this.l10n.getConstant("CancelEdit"):this.editModule.closeEdit();break;case this.l10n.getConstant("BatchSaveConfirm"):this.endEditing();break;case this.l10n.getConstant("BatchSaveLostChanges"):"Batch"===this.parent.editSettings.mode&&this.editModule.addCancelWhilePaging(),this.executeAction()}this.dlgCancel()},e.prototype.destroyEditComponents=function(){this.parent.isEdit&&(this.destroyWidgets(),this.destroyForm()),this.destroy()},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.eventDetails=[{event:$t,handler:this.onPropertyChanged},{event:Qt,handler:this.initialEnd},{event:sr,handler:this.keyPressHandler},{event:yr,handler:this.updateColTypeObj},{event:"tooltip-destroy",handler:this.destroyToolTip},{event:Cr,handler:this.preventBatch},{event:"destroy-form",handler:this.destroyForm},{event:lr,handler:this.destroyEditComponents}],Ze(this.parent,this.eventDetails,!0,this),this.actionBeginFunction=this.onActionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.onDataBoundFunction=this.onDataBound.bind(this),this.parent.addEventListener(Bt,this.actionBeginFunction),this.parent.addEventListener(Nt,this.actionCompleteFunction),this.parent.addEventListener(qt,this.onDataBoundFunction))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(Ze(this.parent,this.eventDetails,!1),this.parent.removeEventListener(Nt,this.actionCompleteFunction),this.parent.removeEventListener(Bt,this.actionBeginFunction),this.parent.removeEventListener(qt,this.onDataBoundFunction))},e.prototype.onDataBound=function(){this.resetMovableContentValidation()},e.prototype.actionComplete=function(e){["add","beginEdit","save","delete","cancel","filterafteropen","filterchoicerequest"].indexOf(e.requestType)<0&&(this.parent.isEdit=!1),"batchsave"===e.requestType&&this.parent.focusModule.restoreFocus(),this.refreshToolbar()},e.prototype.getCurrentEditedData=function(e,i){var n=this.parent;if(n.editSettings.template){for(var o=[].slice.call(e.elements),s=0;s<o.length;s++)if((o[parseInt(s.toString(),10)].hasAttribute("name")&&"e-multi-hidden"!==o[parseInt(s.toString(),10)].className||o[parseInt(s.toString(),10)].classList.contains("e-multiselect"))&&("hidden"!==o[parseInt(s.toString(),10)].type||!O(o[parseInt(s.toString(),10)],"e-switch-wrapper")&&!O(o[parseInt(s.toString(),10)],"e-checkbox-wrapper"))){var a=Q(o[parseInt(s.toString(),10)].hasAttribute("name")?o[parseInt(s.toString(),10)].getAttribute("name"):o[parseInt(s.toString(),10)].getAttribute("id")),l=n.getColumnByField(a)||{field:a,type:o[parseInt(s.toString(),10)].getAttribute("type")},h=void 0;"checkbox"===l.type||"boolean"===l.type?h=o[parseInt(s.toString(),10)].checked:o[parseInt(s.toString(),10)].value?(h=o[parseInt(s.toString(),10)].value,o[parseInt(s.toString(),10)].ej2_instances&&o[parseInt(s.toString(),10)].ej2_instances.length&&!t.isNullOrUndefined(o[parseInt(s.toString(),10)].ej2_instances[0].value)&&(o[parseInt(s.toString(),10)].blur(),h=o[parseInt(s.toString(),10)].ej2_instances[0].value)):o[parseInt(s.toString(),10)].ej2_instances&&(h=o[parseInt(s.toString(),10)].ej2_instances[0].value),l.edit&&"string"==typeof l.edit.read?h=t.getValue(l.edit.read,window)(o[parseInt(s.toString(),10)],h):l.edit&&l.edit.read&&(h=l.edit.read(o[parseInt(s.toString(),10)],h)),h=n.editModule.getValueFromType(l,h),"radio"===o[parseInt(s.toString(),10)].type?o[parseInt(s.toString(),10)].checked&&r.DataUtil.setValue(l.field,h,i):("string"==typeof h&&this.parent.sanitize(h),r.DataUtil.setValue(l.field,h,i))}return i}for(var p=n.columnModel.filter(function(e){return e.editTemplate}),d=0;d<p.length;d++)if(e[W(p[parseInt(d.toString(),10)].field)]){var c=[].slice.call(e[W(p[parseInt(d.toString(),10)].field)]),u=(c=c.length?c:[e[W(p[parseInt(d.toString(),10)].field)]]).filter(function(e){return!t.isNullOrUndefined(e.ej2_instances)});0===u.length&&(u=c.filter(function(e){return e.hasAttribute("name")}));for(s=0;s<u.length;s++){h=this.getValue(p[parseInt(d.toString(),10)],u[parseInt(s.toString(),10)],i);"string"===p[parseInt(d.toString(),10)].type&&(h=this.parent.sanitize(h)),r.DataUtil.setValue(p[parseInt(d.toString(),10)].field,h,i)}}for(var g=[].slice.call(e.getElementsByClassName("e-field")),f=0,m=g.length;f<m;f++){var y=n.getColumnByUid(g[parseInt(f.toString(),10)].getAttribute("e-mappinguid"));if(y&&y.field){h=this.getValue(y,g[parseInt(f.toString(),10)],i);"string"===y.type&&(h=this.parent.sanitize(h)),r.DataUtil.setValue(y.field,h,i)}}return i},e.prototype.getValue=function(e,r,i){var n=r.ej2_instances?r.ej2_instances[0].value:r.value,o=this.parent,s=e.edit.read;return"checkbox"!==e.type&&"boolean"!==e.type||(n=r.checked),"string"==typeof s?(s=t.getValue(s,window),n=o.editModule.getValueFromType(e,s(r,n))):n=o.editModule.getValueFromType(e,e.edit.read(r,n)),t.isNullOrUndefined(i[e.field])&&""===n&&(n=i[e.field]),n},e.prototype.onActionBegin=function(e){if("columnstate"===e.requestType&&this.parent.isEdit&&"Batch"!==this.parent.editSettings.mode)this.closeEdit();else{var t=this.parent.element.querySelector("."+ei),r=this.parent.element.querySelector("."+ti);if(t&&this.parent.frozenRows&&"virtualscroll"===e.requestType&&parseInt(O(t,Zr).getAttribute(si),10)<this.parent.frozenRows)return;var i=-1===["filterafteropen","filterbeforeopen","filterchoicerequest","filtersearchbegin","save","infiniteScroll","virtualscroll"].indexOf(e.requestType),n=this.parent.enableVirtualization&&this.formObj&&!this.formObj.isDestroyed&&(t||r||"cancel"===e.requestType)&&i;(!this.parent.enableVirtualization&&"Batch"!==this.parent.editSettings.mode&&this.formObj&&!this.formObj.isDestroyed&&i&&!e.cancel||n)&&(this.destroyWidgets(),this.destroyForm())}},e.prototype.destroyWidgets=function(e){this.parent.editSettings.template&&(this.parent.destroyTemplate(["editSettingsTemplate"]),this.parent.isReact&&this.parent.renderTemplates()),(e=e||this.parent.getCurrentVisibleColumns(this.parent.enableColumnVirtualization)).some(function(e){return!t.isNullOrUndefined(e.editTemplate)})&&(this.parent.destroyTemplate(["editTemplate"]),this.parent.isReact&&this.parent.renderTemplates());for(var r=0,i=e;r<i.length;r++){var n=i[r],o=n.edit.destroy;n.edit.destroy&&("string"==typeof o?(o=t.getValue(o,window))():n.edit.destroy())}for(var s=[].slice.call(this.formObj.element.elements),a=0;a<s.length;a++)s[parseInt(a.toString(),10)].hasAttribute("name")&&s[parseInt(a.toString(),10)].ej2_instances&&s[parseInt(a.toString(),10)].ej2_instances.length&&!s[parseInt(a.toString(),10)].ej2_instances[0].isDestroyed&&s[parseInt(a.toString(),10)].ej2_instances[0].destroy()},e.prototype.destroyForm=function(){this.destroyToolTip();for(var e=[this.formObj,this.mFormObj,this.frFormObj,this.virtualFormObj],t=0;t<e.length;t++)e[parseInt(t.toString(),10)]&&e[parseInt(t.toString(),10)].element&&!e[parseInt(t.toString(),10)].isDestroyed&&e[parseInt(t.toString(),10)].destroy();this.destroyToolTip()},e.prototype.destroy=function(){var e=this.parent.element;if(e){var r=!(!e.querySelector("."+jr)||!e.querySelector("."+Vr));r&&this.destroyForm(),this.removeEventListener();var i=this.dialogObj.element;i.childElementCount>0&&(this.dialogObj.destroy(),t.remove(i)),(i=this.alertDObj.element).childElementCount>0&&(this.alertDObj.destroy(),t.remove(i)),r&&this.editModule&&this.editModule.destroy()}},e.prototype.keyPressHandler=function(e){switch(e.action){case"insert":this.addRecord();break;case"delete":"INPUT"===e.target.tagName&&!e.target.classList.contains("e-checkselect")||document.querySelector(".e-popup-open.e-edit-dialog")||this.deleteRecord();break;case"f2":this.startEdit();break;case"enter":O(e.target,"e-unboundcelldiv")||"Batch"===this.parent.editSettings.mode||!(O(e.target,Vr)||this.parent.frozenRows&&O(e.target,_r))||document.getElementsByClassName("e-popup-open").length||(e.preventDefault(),this.endEdit());break;case"escape":this.parent.isEdit&&!this.editCellDialogClose&&("Batch"===this.parent.editSettings.mode?this.editModule.escapeCellEdit():this.curretRowFocus(e)),this.editCellDialogClose&&(this.editCellDialogClose=!1);break;case"tab":case"shiftTab":this.curretRowFocus(e)}},e.prototype.curretRowFocus=function(e){if(this.parent.isEdit&&"Batch"!==this.parent.editSettings.mode){var r=O(e.target,"e-editedrow")||O(e.target,"e-addedrow");if(r){var i=r.classList.contains("e-addedrow")?"e-addedrow":"e-editedrow",n=[].slice.call(r.querySelectorAll(".e-input:not(.e-disabled)")),o=[].slice.call(r.querySelectorAll(".e-unboundcell"));if(o)for(var s=0;s<o.length;s++)n=n.concat([].slice.call(o[parseInt(s.toString(),10)].querySelectorAll(".e-btn:not(.e-hide)")));if(this.parent.isFrozenGrid())if(t.isNullOrUndefined(this.parent.frozenRows)||t.isNullOrUndefined(O(e.target,"e-frozenheader"))&&t.isNullOrUndefined(O(e.target,"e-movableheader"))){var a=this.parent.getContent().querySelector(".e-movablecontent ."+i);if(n.push.apply(n,[].slice.call(a.querySelectorAll(".e-input:not(.e-disabled)"))),"Left-Right"===this.parent.getFrozenMode()||"Right"===this.parent.getFrozenMode()){var l=this.parent.getContent().querySelector(".e-frozen-right-content ."+i);n.push.apply(n,[].slice.call(l.querySelectorAll(".e-input:not(.e-disabled)")))}}else{var h=this.parent.getHeaderContent().querySelector(".e-movableheader ."+i);if(n.push.apply(n,[].slice.call(h.querySelectorAll(".e-input:not(.e-disabled)"))),"Left-Right"===this.parent.getFrozenMode()||"Right"===this.parent.getFrozenMode()){var p=this.parent.getHeaderContent().querySelector(".e-frozen-right-header ."+i);n.push.apply(n,[].slice.call(p.querySelectorAll(".e-input:not(.e-disabled)")))}}var d=O(e.target,"e-rowcell");if(d===O(n[n.length-1],"e-rowcell")&&"tab"===e.action&&!d.classList.contains("e-unboundcell")||d===O(n[0],"e-rowcell")&&"shiftTab"===e.action||"escape"===e.action){var c=r.getAttribute("data-uid"),u=this.parent.getRows();"Left-Right"!==this.parent.getFrozenMode()&&"Right"!==this.parent.getFrozenMode()||(u=this.parent.getFrozenRightRows()),(this.parent.getFrozenColumns()||"Left"===this.parent.getFrozenMode())&&(u=this.parent.getMovableRows());var g=u.map(function(e){return e.getAttribute("data-uid")}).indexOf(c);this.parent.frozenRows&&O(r,"e-content")&&(g-=this.parent.frozenRows),r.classList.contains("e-addedrow")&&(g=0),"escape"===e.action?this.closeEdit():this.endEdit(),this.parent.focusModule.active&&(this.parent.focusModule.active.matrix.current=[g,0])}}}},e.prototype.preventBatch=function(e){this.preventObj=e,this.showDialog("BatchSaveLostChanges",this.dialogObj)},e.prototype.executeAction=function(){this.preventObj.handler.call(this.preventObj.instance,this.preventObj.arg1,this.preventObj.arg2,this.preventObj.arg3,this.preventObj.arg4,this.preventObj.arg5,this.preventObj.arg6,this.preventObj.arg7,this.preventObj.arg8)},e.prototype.applyFormValidation=function(e,r){var i=this.parent,n=i.isFrozenGrid(),o="Normal"===this.parent.editSettings.mode,s="Right"===this.parent.getFrozenMode()&&o?1:0,a="Dialog"!==this.parent.editSettings.mode?i.element.getElementsByClassName("e-gridform")[parseInt(s.toString(),10)]:t.select("#"+i.element.id+"_dialogEdit_wrapper .e-gridform",document),l="Right"===this.parent.getFrozenMode()&&o?0:1,h=i.element.getElementsByClassName("e-gridform")[parseInt(l.toString(),10)],p={},d={},c={};e=e||i.getColumns();for(var u=0;u<e.length;u++)(e[parseInt(u.toString(),10)].visible||"Dialog"===i.editSettings.mode&&(-1!==i.groupSettings.columns.indexOf(e[parseInt(u.toString(),10)].field)||"Dialog"!==i.editSettings.mode))&&e[parseInt(u.toString(),10)].validationRules&&t.isNullOrUndefined(r)&&Ge(e[parseInt(u.toString(),10)],l,p,d,c,e.length);if(n&&"Dialog"!==this.parent.editSettings.mode){if(this.parent.editModule.mFormObj=this.createFormObj(h,d),this.parent.getFrozenMode()===ri){var g=i.element.getElementsByClassName("e-gridform")[2];this.parent.editModule.frFormObj=this.createFormObj(g,c)}}else p=t.extend(p,d,c);this.parent.editModule.formObj=this.createFormObj(a,r||p)},e.prototype.createFormObj=function(e,t){var r=this;return new o.FormValidator(e,{rules:t,locale:this.parent.locale,validationComplete:function(e){r.validationComplete(e)},customPlacement:function(e,t){var i=e.getAttribute("e-mappinguid"),n={column:r.parent.getColumnByUid(i),error:t,inputElement:e,value:e.value};r.valErrorPlacement(e,t),r.parent.notify("validation-custom-placement",n)}})},e.prototype.valErrorPlacement=function(e,t){if(this.parent.isEdit){var r=t.getAttribute("for"),i=this.getElemTable(e).querySelector("#"+K(r)+"_Error");i?i.querySelector(".e-tip-content").innerHTML=t.outerHTML:this.createTooltip(e,t,r,"")}},e.prototype.getElemTable=function(e){var r,i,n=this.parent;if("Dialog"!==n.editSettings.mode){r=n.frozenRows&&n.frozenRows>(parseInt(t.closest(e,"."+Zr).getAttribute(si),10)||0);var o=e.name,s=void 0;o&&(s=tt(this.parent,Q(o))),s&&n.isFrozenGrid()?"frozen-left"===s.getFreezeTableName()?i=r?n.getFrozenVirtualHeader().querySelector("table"):n.getFrozenVirtualContent().querySelector("table"):"frozen-right"===s.getFreezeTableName()?i=r?n.getFrozenRightHeader().querySelector("table"):n.getFrozenRightContent().querySelector("table"):"movable"===s.getFreezeTableName()&&(i=r?n.getMovableVirtualHeader().querySelector("table"):n.getMovableVirtualContent().querySelector("table")):i=r?n.getHeaderTable():n.getContentTable()}else i=t.select("#"+n.element.id+"_dialogEdit_wrapper",document);return i},e.prototype.resetElemPosition=function(e,t){var r=O(t.element,Ur);if(r){var i=r.getBoundingClientRect().right,n=e.getBoundingClientRect().right;if(n>i){var o=n-i;e.style.left=e.offsetLeft-o+"px"}}},e.prototype.validationComplete=function(e){if(this.parent.isEdit){var t=this.getElemTable(e.element).querySelector("#"+K(e.inputName)+"_Error");t&&("failure"===e.status?(t.style.display="",this.resetElemPosition(t,e)):t.style.display="none")}},e.prototype.resetMovableContentValidation=function(){if(this.isValidationApplied&&this.parent.getMovableVirtualContent()&&!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling){var e=this.parent.getContent().querySelector("."+Wr);e.style.overflowX="auto",e.style.overflowY="hidden",this.isValidationApplied=!1}},e.prototype.createTooltip=function(e,r,n,o){var s=this.parent.getColumnByField(n),a=this.parent.getFrozenMode()===ri&&"Normal"===this.parent.editSettings.mode&&s.getFreezeTableName()===ii?this.frFormObj.element:this.formObj.element,l=O(e,"e-virtual-validation");l&&(a=this.virtualFormObj.element);var h=this.parent.getContent().firstElementChild,p=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount();p&&(h=this.parent.getMovableVirtualContent());var d,c,u=h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth,g="Dialog"!==this.parent.editSettings.mode,f=t.closest(e,"."+Ur),m=t.closest(e,"."+Zr),y=this.parent.getContent().querySelector("."+Qr),v=!1,C=!1,S="Bottom"===this.parent.editSettings.newRowPosition&&this.parent.getContent().firstElementChild.offsetHeight>this.parent.getContentTable().scrollHeight,b=Math.round(this.parent.getContent().clientHeight/this.parent.getRowHeight())-1,w=y?[].slice.call(this.parent.getFrozenVirtualContent().getElementsByClassName(Zr)):[].slice.call(this.parent.getContent().getElementsByClassName(Zr));if("Batch"===this.parent.editSettings.mode&&b>1&&w.length>=b&&!S&&w[w.length-1].getAttribute(si)===m.getAttribute(si)&&(C=!0),g){if(this.parent.frozenRows){var I=p?this.parent.getFrozenVirtualHeader().querySelector(li).children:this.parent.getHeaderTable().querySelector(li).children;v=(d=I.length>(parseInt(m.getAttribute(si),10)||0))&&parseInt(m.getAttribute(si),10)===I.length-1}(v||b>1&&w.length>=b&&("Bottom"===this.parent.editSettings.newRowPosition&&this.editModule.args&&"add"===this.editModule.args.requestType||f.classList.contains("e-lastrowcell")&&!m.classList.contains(ti))||C)&&(c=!0)}var R=g?d?this.parent.getHeaderTable():this.parent.getContentTable():t.select("#"+this.parent.element.id+"_dialogEdit_wrapper .e-dlg-content",document),x=R.getBoundingClientRect(),F=g?this.parent.element.getBoundingClientRect().left:x.left,T=t.closest(e,"td"),E=T?T.getBoundingClientRect():e.parentElement.getBoundingClientRect(),z=this.parent.createElement("div",{className:"e-tooltip-wrap e-lib e-control e-popup e-griderror",id:n+"_Error",styles:"display:"+o+";top:"+((d?E.top+E.height:E.bottom-x.top-(p?y.scrollTop:0))+R.scrollTop+9)+"px;left:"+(E.left-F+R.scrollLeft+E.width/2)+"px;max-width:"+E.width+"px;text-align:center;"});this.parent.cssClass&&z.classList.add(this.parent.cssClass),g&&x.left<F&&(z.style.left=parseInt(z.style.left,10)-x.left+F+"px");var M=this.parent.createElement("div",{className:"e-tip-content"});M.appendChild(r);var D;if(c?((D=this.parent.createElement("div",{className:"e-arrow-tip e-tip-bottom"})).appendChild(this.parent.createElement("div",{className:"e-arrow-tip-outer e-tip-bottom"})),D.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-inner e-tip-bottom"}))):((D=this.parent.createElement("div",{className:"e-arrow-tip e-tip-top"})).appendChild(this.parent.createElement("div",{className:"e-arrow-tip-outer e-tip-top"})),D.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-inner e-tip-top"}))),z.appendChild(M),z.appendChild(D),l||!p&&!this.parent.frozenRows||"Dialog"===this.parent.editSettings.mode?l?this.virtualFormObj.element.appendChild(z):this.formObj.element.appendChild(z):(("Normal"===this.parent.editSettings.mode?t.closest(e,".e-editcell"):t.closest(e,"."+Jr)).style.position="relative",z.style.position="absolute","Batch"===this.parent.editSettings.mode||t.closest(e,"."+Qr)||t.closest(e,"."+Xr)||this.parent.frozenRows&&!p?a.appendChild(z):this.mFormObj.element.appendChild(z)),!c&&g&&h.getBoundingClientRect().bottom<E.bottom+E.height){var k=this.parent.getContent().querySelector(".e-content");p&&0===this.parent.currentViewData.length&&0===k.scrollTop?k.scrollTop=z.offsetHeight+D.scrollHeight:h.scrollTop=h.scrollTop+z.offsetHeight+D.scrollHeight}var A=parseInt(document.defaultView.getComputedStyle(z,null).getPropertyValue("font-size"),10);if(z.getBoundingClientRect().width<E.width&&z.querySelector("label").getBoundingClientRect().height/(1.2*A)>=2&&(z.style.width=z.style.maxWidth),(p||this.parent.frozenRows)&&"Dialog"!==this.parent.editSettings.mode?z.style.left=T.offsetLeft+(T.offsetWidth/2-z.offsetWidth/2)+"px":z.style.left=parseInt(z.style.left,10)-z.offsetWidth/2+"px",g&&!u&&!this.parent.allowPaging||p||this.parent.frozenRows){h.style.position="static";var L=i.calculateRelativeBasedPosition(T,z);z.style.top=L.top+E.height+9+"px"}if(t.closest(e,"."+Wr)&&!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling){var P=this.parent.getContent().querySelector("."+Wr);P.style.overflowX="visible",P.style.overflowY="visible",this.isValidationApplied=!0}if(c){if(!u||p||"auto"===this.parent.height||this.parent.frozenRows||this.parent.enableVirtualization)z.style.bottom=E.height+9+"px";else{var B=h.scrollWidth>h.offsetWidth?j():0,N=-1===this.parent.height.toString().indexOf("%")?parseInt(this.parent.height,10):h.offsetHeight;z.style.bottom=N-h.querySelector("table").offsetHeight-B+E.height+9+"px"}if(w.length<b&&"Bottom"===this.parent.editSettings.newRowPosition&&this.editModule.args&&"add"===this.editModule.args.requestType){var q=(this.parent.frozenRows?this.parent.frozenRows+(w.length-1):w.length-1)*this.parent.getRowHeight(),H=this.parent.getContent().clientHeight-q;z.style.bottom=H+9+"px"}z.style.top=null}},e.prototype.checkColumnIsGrouped=function(e){return!(e.visible||this.parent.groupSettings.columns.indexOf(e.field)>-1)},e.AddEditors=function(r){e.editCellType=t.extend(e.editCellType,r)},e.editCellType={dropdownedit:Ko,numericedit:Qo,datepickeredit:ns,datetimepickeredit:ns,booleanedit:_o,defaultedit:Yo,templateedit:os},e}(),as=function(){function e(e,r){this.showColumn=[],this.hideColumn=[],this.changedColumns=[],this.unchangedColumns=[],this.isDlgOpen=!1,this.initialOpenDlg=!0,this.stateChangeColumns=[],this.changedStateColumns=[],this.isInitialOpen=!1,this.isCustomizeOpenCC=!1,this.searchOperator="startswith",this.prevShowedCols=[],this.hideDialogFunction=this.hideDialog.bind(this),this.parent=e,this.serviceLocator=r,this.addEventListener(),this.cBoxTrue=n.createCheckBox(this.parent.createElement,!1,{checked:!0,label:" "}),this.cBoxFalse=n.createCheckBox(this.parent.createElement,!1,{checked:!1,label:" "}),this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden e-cc e-cc-chbox",attrs:{type:"checkbox","aria-checked":"true"}}),this.cBoxTrue.firstChild),this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden e-cc e-cc-chbox",attrs:{type:"checkbox","aria-checked":"false"}}),this.cBoxFalse.firstChild),this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck"),this.parent.enableRtl&&t.addClass([this.cBoxTrue,this.cBoxFalse],["e-rtl"]),this.parent.cssClass&&t.addClass([this.cBoxTrue,this.cBoxFalse],[this.parent.cssClass])}return e.prototype.destroy=function(){var e=this.parent.element;e&&(e.querySelector("."+jr)||e.querySelector("."+Vr))&&(this.removeEventListener(),this.unWireEvents(),t.isNullOrUndefined(this.dlgObj)||!this.dlgObj.element||this.dlgObj.isDestroyed||this.dlgObj.destroy())},e.prototype.rtlUpdate=function(){this.parent.enableRtl?t.addClass([].slice.call(this.innerDiv.getElementsByClassName("e-checkbox-wrapper")),["e-rtl"]):t.removeClass([].slice.call(this.innerDiv.getElementsByClassName("e-checkbox-wrapper")),["e-rtl"])},e.prototype.addEventListener=function(){this.parent.isDestroyed||(t.EventHandler.add(document,"click",this.clickHandler,this),this.parent.on(Jt,this.enableAfterRenderEle,this),this.parent.on(Qt,this.render,this),this.parent.addEventListener(qt,this.hideDialogFunction),this.parent.on(lr,this.destroy,this),this.parent.on("rtl-updated",this.rtlUpdate,this),this.parent.on("reset-columns",this.onResetColumns,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(t.EventHandler.remove(document,"click",this.clickHandler),this.parent.off(Qt,this.render),this.parent.off(lr,this.destroy),this.parent.off(Jt,this.enableAfterRenderEle),this.parent.off("rtl-updated",this.rtlUpdate),this.parent.off("reset-columns",this.onResetColumns),this.parent.removeEventListener(qt,this.hideDialogFunction))},e.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization"),this.renderDlgContent(),this.getShowHideService=this.serviceLocator.getService("showHideService")},e.prototype.clickHandler=function(e){var r=e.target;if(!this.isCustomizeOpenCC){if(t.isNullOrUndefined(t.closest(r,".e-cc"))&&t.isNullOrUndefined(t.closest(r,".e-cc-toolbar")))t.isNullOrUndefined(this.dlgObj)||!this.dlgObj.visible||r.classList.contains("e-toolbar-items")||(this.dlgObj.hide(),this.clearActions(),this.refreshCheckboxState(),this.isDlgOpen=!1);else if(r.classList.contains("e-columnchooser-btn")||r.classList.contains("e-cc-toolbar")){if(this.initialOpenDlg&&this.dlgObj.visible||!this.isDlgOpen)return void(this.isDlgOpen=!0)}else r.classList.contains("e-cc-cancel")&&(r.parentElement.querySelector(".e-ccsearch").value="",this.columnChooserSearch(""),this.removeCancelIcon(),this.refreshCheckboxButton());(this.parent.detailTemplate||this.parent.childGrid)&&(this.targetdlg=e.target)}this.isCustomizeOpenCC&&e.target.classList.contains("e-cc-cancel")&&this.refreshCheckboxState(),this.rtlUpdate()},e.prototype.hideDialog=function(){!t.isNullOrUndefined(this.dlgObj)&&this.dlgObj.visible&&(this.dlgObj.hide(),this.isDlgOpen=!1)},e.prototype.renderColumnChooser=function(e,r,n){if(this.dlgObj.visible||!this.parent.detailTemplate&&!this.parent.childGrid||this.hideOpenedDialog(),this.dlgObj.visible)this.hideDialog(),this.addcancelIcon(),this.clearActions(),this.refreshCheckboxState();else{if(this.beforeOpenColumnChooserEvent().cancel)return;n&&(this.targetdlg=n),this.refreshCheckboxState(),this.dlgObj.dataBind(),this.dlgObj.element.style.maxHeight="430px";var o=this.dlgObj.element.style.display;this.dlgObj.element.style.display="block";var s=this.parent.getHeaderContent().classList.contains("e-sticky"),a=t.closest(n,".e-toolbar-item"),l=void 0;s?(l=a.getBoundingClientRect(),this.dlgObj.element.classList.add("e-sticky")):(this.dlgObj.element.classList.remove("e-sticky"),l=i.calculateRelativeBasedPosition(a,this.dlgObj.element)),this.dlgObj.element.style.display=o,this.dlgObj.element.style.top=l.top+t.closest(n,".e-cc-toolbar").getBoundingClientRect().height+"px";t.isNullOrUndefined(t.closest(n,".e-bigger"))||(this.dlgObj.width=258),t.Browser.isDevice?(this.dlgObj.target=document.body,this.dlgObj.position={X:"center",Y:"center"},this.dlgObj.refreshPosition(),this.dlgObj.open=this.mOpenDlg.bind(this)):this.parent.enableRtl?this.dlgObj.element.style.left=n.offsetLeft+"px":this.dlgObj.element.style.left=l.left-250+t.closest(n,".e-cc-toolbar").clientWidth+2+"px",this.removeCancelIcon(),this.dlgObj.show(),this.parent.notify("columnChooserOpened",{dialog:this.dlgObj})}this.rtlUpdate()},e.prototype.openColumnChooser=function(e,r){if(this.isCustomizeOpenCC=!0,this.dlgObj.visible)return void this.hideDialog();this.beforeOpenColumnChooserEvent().cancel||(this.isInitialOpen?this.refreshCheckboxState():(this.dlgObj.content=this.renderChooserList(),this.updateIntermediateBtn()),this.dlgObj.dataBind(),this.dlgObj.position={X:"center",Y:"center"},t.isNullOrUndefined(e)?(this.dlgObj.position={X:"center",Y:"center"},this.dlgObj.refreshPosition()):(this.dlgObj.element.style.top="",this.dlgObj.element.style.left="",this.dlgObj.element.style.top=r+"px",this.dlgObj.element.style.left=e+"px"),this.dlgObj.beforeOpen=this.customDialogOpen.bind(this),this.dlgObj.show(),this.isInitialOpen=!0,this.dlgObj.beforeClose=this.customDialogClose.bind(this))},e.prototype.enableAfterRenderEle=function(e){e.module===this.getModuleName()&&e.enable&&this.render()},e.prototype.keyUpHandler=function(e){"Escape"===e.key&&this.hideDialog(),this.setFocus(O(e.target,"e-cclist"))},e.prototype.setFocus=function(e){var t=this.dlgDiv.querySelector(".e-colfocus");t&&t.classList.remove("e-colfocus"),e&&e.classList.add("e-colfocus")},e.prototype.customDialogOpen=function(){var e=this.dlgObj.content.querySelector("input.e-ccsearch");t.EventHandler.add(e,"keyup",this.columnChooserManualSearch,this)},e.prototype.customDialogClose=function(){var e=this.dlgObj.content.querySelector("input.e-ccsearch");t.EventHandler.remove(e,"keyup",this.columnChooserManualSearch)},e.prototype.getColumns=function(){return this.parent.getColumns().filter(function(e){return"checkbox"!==e.type&&!0===e.showInColumnChooser||"checkbox"===e.type&&void 0!==e.field})},e.prototype.renderDlgContent=function(){this.dlgDiv=this.parent.createElement("div",{className:"e-ccdlg e-cc",id:this.parent.element.id+"_ccdlg"}),this.dlgDiv.setAttribute("aria-label",this.l10n.getConstant("ColumnChooserDialogARIA")),this.parent.element.appendChild(this.dlgDiv),this.dlgObj=new i.Dialog({header:this.l10n.getConstant("ChooseColumns"),showCloseIcon:!1,closeOnEscape:!1,locale:this.parent.locale,visible:!1,enableRtl:this.parent.enableRtl,target:document.getElementById(this.parent.element.id),buttons:[{click:this.confirmDlgBtnClick.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),isPrimary:!0,cssClass:this.parent.cssClass?"e-cc e-cc_okbtn "+this.parent.cssClass:"e-cc e-cc_okbtn"}},{click:this.clearBtnClick.bind(this),buttonModel:{cssClass:this.parent.cssClass?"e-flat e-cc e-cc-cnbtn "+this.parent.cssClass:"e-flat e-cc e-cc-cnbtn",content:this.l10n.getConstant("CancelButton")}}],content:this.renderChooserList(),width:250,cssClass:this.parent.cssClass?"e-cc "+this.parent.cssClass:"e-cc",animationSettings:{effect:"None"}});this.dlgObj.isStringTemplate=!0,this.dlgObj.appendTo(this.dlgDiv),this.wireEvents()},e.prototype.renderChooserList=function(){this.mainDiv=this.parent.createElement("div",{className:"e-main-div e-cc"});var e=this.parent.createElement("div",{className:"e-cc-searchdiv e-cc e-input-group"}),t=this.parent.createElement("input",{className:"e-ccsearch e-cc e-input",attrs:{placeholder:this.l10n.getConstant("Search"),cssClass:this.parent.cssClass}}),r=this.parent.createElement("span",{className:"e-ccsearch-icon e-icons e-cc e-input-group-icon",attrs:{title:this.l10n.getConstant("Search")}}),i=this.parent.createElement("div",{className:"e-cc-contentdiv"});this.innerDiv=this.parent.createElement("div",{className:"e-innerdiv e-cc"}),e.appendChild(t),e.appendChild(r),this.searchBoxObj=new hn(t);var n=this.refreshCheckboxList(this.parent.getColumns());return this.innerDiv.appendChild(n),i.appendChild(this.innerDiv),this.mainDiv.appendChild(e),this.mainDiv.appendChild(i),this.mainDiv},e.prototype.confirmDlgBtnClick=function(e){this.stateChangeColumns=[],this.changedStateColumns=[],this.changedColumns=this.changedColumns.length>0?this.changedColumns:this.unchangedColumns,this.changedColumnState(this.changedColumns);var r=this.ulElement.querySelector(".e-uncheck")&&this.ulElement.querySelectorAll(".e-uncheck:not(.e-selectall)").length;t.isNullOrUndefined(e)||r<this.parent.getColumns().length&&(this.hideColumn.length&&this.columnStateChange(this.hideColumn,!1),this.showColumn.length&&this.columnStateChange(this.showColumn,!0),this.getShowHideService.setVisible(this.stateChangeColumns,this.changedStateColumns),this.clearActions(),this.parent.notify("tooltip-destroy",{module:"edit"}),0===this.parent.getCurrentViewRecords().length&&this.parent.element.querySelector(".e-emptyrow").querySelector("td").setAttribute("colSpan",this.parent.getVisibleColumns().length.toString()))},e.prototype.onResetColumns=function(e){if("columnstate"===e.requestType)return void this.resetColumnState()},e.prototype.resetColumnState=function(){this.showColumn=[],this.hideColumn=[],this.hideDialog()},e.prototype.changedColumnState=function(e){for(var t=0;t<e.length;t++){var r=e[parseInt(t.toString(),10)],i=this.parent.getColumnByUid(r);this.changedStateColumns.push(i)}},e.prototype.columnStateChange=function(e,t){for(var r=0;r<e.length;r++){var i=e[parseInt(r.toString(),10)],n=this.parent.getColumnByUid(i);"checkbox"!==n.type&&(n.visible=t),this.stateChangeColumns.push(n)}},e.prototype.clearActions=function(){this.resetColumnState(),this.addcancelIcon()},e.prototype.clearBtnClick=function(){this.clearActions(),this.parent.notify("columnChooserCancelBtnClick",{dialog:this.dlgObj})},e.prototype.checkstatecolumn=function(e,t,r){void 0===r&&(r=!1);var i=this.parent.getColumnByUid(t);e?(-1!==this.hideColumn.indexOf(t)&&this.hideColumn.splice(this.hideColumn.indexOf(t),1),-1!==this.showColumn.indexOf(t)||i&&i.visible||this.showColumn.push(t)):(-1!==this.showColumn.indexOf(t)&&this.showColumn.splice(this.showColumn.indexOf(t),1),-1===this.hideColumn.indexOf(t)&&i&&i.visible&&this.hideColumn.push(t)),r?e?this.unchangedColumns.push(t):this.changedColumns.push(t):-1!==this.changedColumns.indexOf(t)?this.changedColumns.splice(this.changedColumns.indexOf(t),1):this.changedColumns.push(t)},e.prototype.columnChooserSearch=function(e){var t,i,n=!1,o=this.dlgDiv.querySelector(".e-footer-content"),s=this.ulElement.querySelector(".e-check")&&this.ulElement.querySelectorAll(".e-check:not(.e-selectall)").length;if(this.isInitialOpen=!0,o&&(i=o.querySelector(".e-btn").ej2_instances[0]),""===e?(this.removeCancelIcon(),t=this.getColumns(),n=!0):t=new r.DataManager(this.getColumns()).executeLocal((new r.Query).where("headerText",this.searchOperator,e,!0,this.parent.columnChooserSettings.ignoreAccent)),t.length)this.innerDiv.innerHTML=" ",this.innerDiv.classList.remove("e-ccnmdiv"),this.innerDiv.appendChild(this.refreshCheckboxList(t)),n?i&&s&&(i.disabled=!1):(this.addcancelIcon(),this.refreshCheckboxButton());else{var a=this.parent.createElement("span",{className:"e-cc e-nmatch"});a.innerHTML=this.l10n.getConstant("Matchs"),this.innerDiv.innerHTML=" ",this.innerDiv.appendChild(a),this.innerDiv.classList.add("e-ccnmdiv"),i&&(i.disabled=!0)}this.flag=!0,this.stopTimer()},e.prototype.wireEvents=function(){t.EventHandler.add(this.dlgObj.element,"click",this.checkBoxClickHandler,this),t.EventHandler.add(this.searchBoxObj.searchBox,"keyup",this.columnChooserManualSearch,this),t.EventHandler.add(this.dlgObj.element,"keyup",this.keyUpHandler,this),this.searchBoxObj.wireEvent()},e.prototype.unWireEvents=function(){this.parent.isDestroyed||(this.dlgObj.element&&(t.EventHandler.remove(this.dlgObj.element,"click",this.checkBoxClickHandler),t.EventHandler.remove(this.dlgObj.element,"keyup",this.keyUpHandler)),t.EventHandler.remove(this.searchBoxObj.searchBox,"keyup",this.columnChooserManualSearch),this.searchBoxObj.unWireEvent())},e.prototype.checkBoxClickHandler=function(e){var t,r=O(e.target,"e-checkbox-wrapper");if(r){if(r.querySelector(".e-selectall")?this.updateSelectAll(!r.querySelector(".e-check")):ie(r.parentElement),r.querySelector(".e-chk-hidden").focus(),r.querySelector(".e-check"))t=!0,r.firstChild.setAttribute("aria-checked","true");else{if(!r.querySelector(".e-uncheck"))return;t=!1,r.firstChild.setAttribute("aria-checked","false")}this.updateIntermediateBtn();var i=O(r,"e-ccheck").getAttribute("uid"),n=this.parent.getColumns();if("grid-selectAll"===i){this.changedColumns=[],this.unchangedColumns=[];for(var o=0;o<n.length;o++)n[parseInt(o.toString(),10)].showInColumnChooser&&this.checkstatecolumn(t,n[parseInt(o.toString(),10)].uid,!0)}else this.checkstatecolumn(t,i);this.refreshCheckboxButton(),this.setFocus(O(e.target,"e-cclist"))}},e.prototype.updateIntermediateBtn=function(){var e=this.ulElement.children.length-1,r=[],i=this.ulElement.children[0].querySelector(".e-frame"),n=this.ulElement.querySelectorAll(".e-check:not(.e-selectall)").length,o=this.dlgObj.btnObj[0],s=i.parentElement.querySelector("input");o.disabled=!1,e===n?(r=["e-check"],s.setAttribute("aria-checked","true")):n?(r=["e-stop"],s.setAttribute("aria-checked","mixed")):(r=["e-uncheck"],s.setAttribute("aria-checked","false"),o.disabled=!0),o.dataBind(),t.removeClass([i],["e-check","e-stop","e-uncheck"]),t.addClass([i],r)},e.prototype.updateSelectAll=function(e){for(var t=0,r=[].slice.call(this.ulElement.getElementsByClassName("e-frame"));t<r.length;t++){var i=r[t];se(i,e);var n=i.parentElement.querySelector("input");i.classList.contains("e-check")?n.setAttribute("aria-checked","true"):i.classList.contains("e-uncheck")&&n.setAttribute("aria-checked","false")}},e.prototype.refreshCheckboxButton=function(){for(var e=this.parent.getVisibleColumns(),t=0;t<e.length;t++){l=e[parseInt(t.toString(),10)].uid;-1===this.prevShowedCols.indexOf(l)&&this.prevShowedCols.push(l)}for(t=0;t<this.hideColumn.length;t++){var r=this.prevShowedCols.indexOf(this.hideColumn[parseInt(t.toString(),10)]);-1!==r&&this.prevShowedCols.splice(r,1)}var i=0!==this.showColumn.length?1:this.prevShowedCols.length,n=this.dlgDiv.querySelector(".e-footer-content").querySelector(".e-btn").ej2_instances[0];n.disabled=!1;for(var o=[],s=[].slice.call(this.parent.element.getElementsByClassName("e-cc-chbox")),t=0,a=s.length;t<a;t++){var l=O(s[parseInt(t.toString(),10)],"e-ccheck").getAttribute("uid");o.push(l)}var h=this.showColumn.filter(function(e){return-1!==o.indexOf(e)});0===i&&0===h.length&&(n.disabled=!0),n.dataBind()},e.prototype.refreshCheckboxList=function(e){this.ulElement=this.parent.createElement("ul",{className:"e-ccul-ele e-cc"});var r=this.l10n.getConstant("SelectAll"),i=this.parent.createElement("li",{className:"e-cclist e-cc e-cc-selectall"}),n=this.createCheckBox(r,!1,"grid-selectAll");e.length&&(n.querySelector(".e-checkbox-wrapper").firstElementChild.classList.add("e-selectall"),n.querySelector(".e-frame").classList.add("e-selectall"),this.checkState(n.querySelector(".e-icons"),!0),i.appendChild(n),this.ulElement.appendChild(i)),this.parent.cssClass&&t.addClass([n],[this.parent.cssClass]);for(var o=0;o<e.length;o++){var s=e[parseInt(o.toString(),10)];this.renderCheckbox(s)}return this.ulElement},e.prototype.refreshCheckboxState=function(){this.dlgObj.element.querySelector(".e-cc.e-input").value="",this.columnChooserSearch("");for(var e=this.parent,t=this.dlgObj.element.querySelectorAll(".e-cc-chbox:not(.e-selectall)"),r=0,i=t.length;r<i;r++){var n=t[parseInt(r.toString(),10)],o=void 0;o=this.parent.childGrid||this.parent.detailTemplate?O(this.dlgObj.element.querySelectorAll(".e-cc-chbox:not(.e-selectall)")[parseInt(r.toString(),10)],"e-ccheck").getAttribute("uid"):O(n,"e-ccheck").getAttribute("uid");var s=e.getColumnByUid(o),a=[].slice.call(n.parentElement.getElementsByClassName("e-uncheck"));s.visible&&!a.length?(n.checked=!0,this.checkState(n.parentElement.querySelector(".e-icons"),!0)):(n.checked=!1,this.checkState(n.parentElement.querySelector(".e-icons"),!1))}},e.prototype.checkState=function(e,r){r?t.classList(e,["e-check"],["e-uncheck"]):t.classList(e,["e-uncheck"],["e-check"])},e.prototype.createCheckBox=function(e,t,r){var i=t?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0);return i.querySelector(".e-label").innerHTML=e,oe(r,i,"e-ccheck")},e.prototype.renderCheckbox=function(e){var r,i,n;if(e.showInColumnChooser){r=this.parent.createElement("li",{className:"e-cclist e-cc",styles:"list-style:None",id:"e-ccli_"+e.uid}),i=-1!==this.hideColumn.indexOf(e.uid),n=-1!==this.showColumn.indexOf(e.uid);var o=this.createCheckBox(e.headerText,e.visible&&!i||n,e.uid);r.appendChild(o),this.parent.cssClass&&t.addClass([o],[this.parent.cssClass]),this.ulElement.appendChild(r)}this.isInitialOpen&&this.updateIntermediateBtn()},e.prototype.columnChooserManualSearch=function(e){this.addcancelIcon(),this.searchValue=e.target.value,this.stopTimer(),this.startTimer(e)},e.prototype.startTimer=function(e){var t=this,r=t.flag||13===e.keyCode?0:500;this.timer=window.setInterval(function(){t.columnChooserSearch(t.searchValue)},r)},e.prototype.stopTimer=function(){window.clearInterval(this.timer)},e.prototype.addcancelIcon=function(){this.dlgDiv.querySelector(".e-cc.e-ccsearch-icon").classList.add("e-cc-cancel"),this.dlgDiv.querySelector(".e-cc-cancel").setAttribute("title",this.l10n.getConstant("Clear"))},e.prototype.removeCancelIcon=function(){this.dlgDiv.querySelector(".e-cc.e-ccsearch-icon").classList.remove("e-cc-cancel"),this.dlgDiv.querySelector(".e-cc.e-ccsearch-icon").setAttribute("title",this.l10n.getConstant("Search"))},e.prototype.mOpenDlg=function(){t.Browser.isDevice&&(this.dlgObj.element.querySelector(".e-cc-searchdiv").classList.remove("e-input-focus"),this.dlgObj.element.querySelectorAll(".e-cc-chbox")[0].focus())},e.prototype.getModuleName=function(){return"columnChooser"},e.prototype.hideOpenedDialog=function(){for(var e=[].slice.call(document.getElementsByClassName("e-ccdlg")).filter(function(e){return e.classList.contains("e-popup-open")}),t=0,r=e.length;t<r;t++)(e[parseInt(t.toString(),10)].classList.contains("e-dialog")||this.parent.element.id+"_ccdlg"!==e[parseInt(t.toString(),10)].id)&&e[parseInt(t.toString(),10)].ej2_instances[0].hide()},e.prototype.beforeOpenColumnChooserEvent=function(){var e={requestType:"beforeOpenColumnChooser",element:this.parent.element,columns:this.getColumns(),cancel:!1,searchOperator:this.parent.columnChooserSettings.operator};return this.parent.trigger("beforeOpenColumnChooser",e),this.searchOperator=e.searchOperator,e},e}(),ls=function(){function i(e,t){this.hideColumnInclude=!1,this.foreignKeyData={},this.parent=e,!e.parentDetails&&t&&(this.foreignKeyData=t)}return i.getQuery=function(e,t){var r=t.generateQuery(!0).requiresCount();return t.isRemote()&&(e.groupSettings.enableLazyLoading&&e.groupSettings.columns.length?r.lazyLoad=[]:r.take(e.pageSettings.totalRecordsCount)),r},i.prototype.getFData=function(e,t){return le(t,{},e,this.foreignKeyData[t.field])[0]},i.prototype.getGridRowModel=function(e,t,r,i){void 0===i&&(i=0);var n=[],o=t.length;if(o){for(var s=0;s<o;s++,i++){var a={isExpand:!1};a.data=t[parseInt(s.toString(),10)],a.index=i,r.childGrid&&("All"===r.hierarchyPrintMode?a.isExpand=!0:"Expanded"===r.hierarchyPrintMode&&this.parent.expandedRows&&this.parent.expandedRows[parseInt(i.toString(),10)]&&(a.isExpand=r.expandedRows[parseInt(i.toString(),10)].isExpand));var l=new Nr(a);l.cells=this.generateCells(e,r),n.push(l)}this.processColumns(n)}return n},i.prototype.generateCells=function(t,r){var i=[];if(r.childGridLevel)for(var n=r.childGridLevel,o=0;n>o;o++)i.push(this.generateCell({},e.CellType.Indent));for(var s=0,a=t;s<a.length;s++){var l=a[s];i.push(this.generateCell(l,e.CellType.Data))}return i},i.prototype.getColumnData=function(e){var t,i=this,n=[],o=e.getForeignKeyColumns();if(o.length){for(var s=0;s<o.length;s++){var a="result"in o[parseInt(s.toString(),10)].dataSource?new r.DataManager(o[parseInt(s.toString(),10)].dataSource.result):o[parseInt(s.toString(),10)].dataSource;n.push(a.executeQuery(new r.Query))}t=Promise.all(n).then(function(e){for(var t=0;t<o.length;t++)i.foreignKeyData[o[parseInt(t.toString(),10)].field]=e[parseInt(t.toString(),10)].result})}return t},i.prototype.getHeaders=function(e,t){this.hideColumnInclude=!!t,this.colDepth=Se(e);for(var r=[],i=0;i<this.colDepth;i++)r[parseInt(i.toString(),10)]=new Nr({}),r[parseInt(i.toString(),10)].cells=[];return r=this.processColumns(r),r=this.processHeaderCells(r,e),{rows:r,columns:this.generateActualColumns(e)}},i.prototype.getConvertedWidth=function(e){var t=parseFloat(e);return-1!==e.indexOf("%")?this.parent.element.getBoundingClientRect().width*t/100:t},i.prototype.generateActualColumns=function(e,t){void 0===t&&(t=[]);for(var r=0,i=e;r<i.length;r++){var n=i[r];n.commands||(n.columns?(n.visible||this.hideColumnInclude)&&0!==this.getCellCount(n,0)&&this.generateActualColumns(n.columns,t):(n.visible||this.hideColumnInclude)&&t.push(n))}return t},i.prototype.processHeaderCells=function(e,t){for(var r=t,i=0;i<r.length;i++)r[parseInt(i.toString(),10)].commands||(e=this.appendGridCells(r[parseInt(i.toString(),10)],e,0));return e},i.prototype.appendGridCells=function(t,r,i){if(t.columns||!1===t.visible&&!this.hideColumnInclude||t.commands){if(t.columns){var n=this.getCellCount(t,0);n&&r[parseInt(i.toString(),10)].cells.push(new qr({cellType:e.CellType.StackedHeader,column:t,colSpan:n}));for(var o=void 0,s=0,a=t.columns.length;s<a;s++)t.columns[parseInt(s.toString(),10)].visible&&!o&&(o=!0),r=this.appendGridCells(t.columns[parseInt(s.toString(),10)],r,i+1)}}else r[parseInt(i.toString(),10)].cells.push(this.generateCell(t,e.CellType.Header,this.colDepth-i,i));return r},i.prototype.generateCell=function(t,r,i,n){var o={visible:t.visible,isDataCell:r===e.CellType.Data,column:t,cellType:r,rowSpan:i,index:n};return(!o.rowSpan||o.rowSpan<2)&&delete o.rowSpan,new qr(o)},i.prototype.processColumns=function(t){var r=this.parent,i=[];r.enableColumnVirtualization&&(i=r.getColumnIndexesInView());for(var n=0,o=t.length;n<o;n++)if(r.allowGrouping)for(var s=0,a=r.groupSettings.columns.length-1;s<a;s++)r.enableColumnVirtualization&&-1===i.indexOf(s)||t[parseInt(n.toString(),10)].cells.splice(0,0,this.generateCell({},e.CellType.HeaderIndent));return t},i.prototype.getCellCount=function(e,t){if(e.columns)for(var r=0;r<e.columns.length;r++)t=this.getCellCount(e.columns[parseInt(r.toString(),10)],t);else(e.visible||this.hideColumnInclude)&&t++;return t},i.prototype.checkAndExport=function(e,t){Object.keys(e).some(function(t){return!e[""+t]})||t()},i.prototype.failureHandler=function(e,t,r){var i=this;return function(){e[t.id]=!0,i.checkAndExport(e,r)}},i.prototype.createChildGrid=function(e,r,i,n){var o=new Vn(this.parent.detailRowModule.getGridModel(e,r,i));e.isPrinting=!1;o.parentDetails={parentID:e.element.id,parentPrimaryKeys:e.getPrimaryKeyFieldNames(),parentKeyField:e.childGrid.queryString,parentKeyFieldValue:t.getValue(o.queryString,r.data),parentRowData:r.data};var s=N("child-grid"),a=t.createElement("div",{id:s,styles:"display: none"});return document.body.appendChild(a),o.id=s,n[""+s]=!1,o.isExportGrid=!0,{childGrid:o,element:a}},i.prototype.getGridExportColumns=function(e){for(var t=[],r=0,i=e;r<i.length;r++)"checkbox"!==i[parseInt(r.toString(),10)].type&&t.push(i[parseInt(r.toString(),10)]);return t},i.prototype.getForeignKeyData=function(){return this.foreignKeyData},i}(),hs=function(){function e(e){this.valueFormatter=new Mt(e),this.internationalization=new t.Internationalization(e)}return e.prototype.returnFormattedValue=function(e,r){return!t.isNullOrUndefined(e.value)&&e.value?this.valueFormatter.getFormatFunction(r)(e.value):""},e.prototype.formatCellValue=function(e){if(e.isForeignKey&&(e.value=t.getValue(e.column.foreignKeyValue,le(e.column,{},e.value)[0])),"number"===e.column.type&&void 0!==e.column.format&&""!==e.column.format)return"string"==typeof e.column.format&&(e.column.format={format:e.column.format}),e.value||0===e.value?this.internationalization.getNumberFormat(e.column.format)(e.value):"";if("boolean"===e.column.type&&""!==e.value)return e.value?"true":"false";if("date"!==e.column.type&&"dateonly"!==e.column.type&&"datetime"!==e.column.type&&"time"!==e.column.type||void 0===e.column.format)return(t.isNullOrUndefined(e.column.type)||t.isNullOrUndefined(e.value))&&t.isNullOrUndefined(e.value)?"":e.value.toString();if("string"==typeof e.value&&(e.value=new Date(e.value)),"string"==typeof e.column.format){var r=void 0,i=e.column.format;return r="date"===e.column.type||"dateonly"===e.column.type?{type:"date",skeleton:i}:"time"===e.column.type?{type:"time",skeleton:i}:{type:"dateTime",skeleton:i},this.returnFormattedValue(e,r)}if(e.column.format instanceof Object&&void 0===e.column.format.type)return e.value.toString();var n=void 0;return n="date"===e.column.type||"dateonly"===e.column.type?{type:e.column.format.type,format:e.column.format.format,skeleton:e.column.format.skeleton}:"time"===e.column.type?{type:"time",format:e.column.format.format,skeleton:e.column.format.skeleton}:{type:"dateTime",format:e.column.format.format,skeleton:e.column.format.skeleton},this.returnFormattedValue(e,n)},e}(),ps=function(){function i(e,t){this.book={},this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.rowLength=1,this.expType="AppendToSheet",this.includeHiddenColumn=!1,this.isCsvExport=!1,this.isChild=!1,this.isElementIdChanged=!1,this.gridPool={},this.sheet={},this.grpFooterTemplates=[],this.footerTemplates=[],this.aggIndex=0,this.totalAggregates=0,this.parent=e,this.helper=new ls(e),this.locator=t,this.l10n=this.locator.getService("localization")}return i.prototype.getModuleName=function(){return"ExcelExport"},i.prototype.init=function(e){null!==e.element&&""===e.element.id&&(e.element.id=(new Date).toISOString(),this.isElementIdChanged=!0),this.parent=e,this.parent.isDestroyed||(this.isExporting=void 0,this.book={},this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.rowLength=1,this.footer=void 0,this.expType="AppendToSheet",this.includeHiddenColumn=!1,this.exportValueFormatter=new hs(e.locale),e.id=N("main-grid"),this.gridPool[e.id]=!1)},i.prototype.Map=function(e,r,i,n,o,s){var a=e;this.gridPool={},e.childGrid&&(t.isNullOrUndefined(r)||"None"!==r.hierarchyExportMode)&&(e.expandedRows=ye(e).expandedRows);var l={requestType:"beforeExcelExport",gridObject:a,cancel:!1,isMultipleExport:i,workbook:n,isCsv:o,isBlob:s,isChild:this.isChild,grpFooterTemplates:this.grpFooterTemplates};return a.trigger("beforeExcelExport",l),l.cancel?new Promise(function(e){return e()}):(this.parent.log("exporting_begin",this.getModuleName()),this.data=new Br(a),this.isExporting=!0,this.isBlob=l.isBlob,this.isChild=l.isChild,this.grpFooterTemplates=l.grpFooterTemplates,this.isCsvExport=!!l.isCsv&&l.isCsv,y(r)&&v(r,a),this.processRecords(a,r,l.isMultipleExport,l.workbook))},i.prototype.exportingSuccess=function(e){this.isExporting=!1,this.parent.trigger("excelExportComplete",this.isBlob?{promise:this.blobPromise}:{}),this.parent.log("exporting_complete",this.getModuleName()),e(this.book)},i.prototype.processRecords=function(e,i,n,o){var s=this;if(e.allowGrouping&&e.groupSettings.enableLazyLoading&&e.groupSettings.columns.length&&(t.isNullOrUndefined(i)?i={hierarchyExportMode:"All"}:i.hierarchyExportMode=i.hierarchyExportMode||"All"),t.isNullOrUndefined(i)||t.isNullOrUndefined(i.dataSource)){if(t.isNullOrUndefined(i)||"CurrentPage"!==i.exportType){var a=[];return a.push(this.data.getData({},ls.getQuery(e,this.data))),a.push(this.helper.getColumnData(e)),new Promise(function(t,r){Promise.all(a).then(function(r){s.init(e),s.processInnerRecords(e,i,n,o,r[0]).then(function(){s.exportingSuccess(t)})}).catch(function(e){r(s.book),s.parent.trigger("actionFailure",e)})})}return new Promise(function(t){s.init(e),s.processInnerRecords(e,i,n,o,s.parent.getCurrentViewRecords()),s.exportingSuccess(t)})}i.dataSource=i.dataSource instanceof r.DataManager?i.dataSource:new r.DataManager(i.dataSource);var l=i.query?i.query:new r.Query;return(t.isNullOrUndefined(l.isCountRequired)||e.aggregates)&&(l.isCountRequired=!0),new Promise(function(t){i.dataSource.executeQuery(l).then(function(r){s.init(e),s.processInnerRecords(e,i,n,o,r).then(function(){s.exportingSuccess(t)})})})},i.prototype.processInnerRecords=function(e,r,i,n,o){var s=this;this.groupedColLength=e.groupSettings.columns.length;var a,l=5,p=[],d=Se(e.columns),c=!t.isNullOrUndefined(r);return c&&!t.isNullOrUndefined(r.multipleExport)&&(this.expType=t.isNullOrUndefined(r.multipleExport.type)?"AppendToSheet":r.multipleExport.type,t.isNullOrUndefined(r.multipleExport.blankRows)||(l=r.multipleExport.blankRows)),t.isNullOrUndefined(n)?(this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.sheet.images=[]):"NewSheet"===this.expType?(this.workSheet=n.worksheets,this.rows=[],this.columns=[],this.sheet.images=[],this.styles=n.styles):(this.workSheet=[],this.rows=n.worksheets[0].rows,this.columns=n.worksheets[0].columns,this.styles=n.styles,this.sheet.images=n.worksheets[0].images,this.rowLength=this.rows[this.rows.length-1].index+l,this.rowLength++),c&&(t.isNullOrUndefined(i)?(t.isNullOrUndefined(r.header)||this.processExcelHeader(JSON.parse(JSON.stringify(r.header))),t.isNullOrUndefined(r.footer)||(this.footer=JSON.parse(JSON.stringify(r.footer)))):(t.isNullOrUndefined(r.header)||!i&&"NewSheet"!==this.expType||this.processExcelHeader(JSON.parse(JSON.stringify(r.header))),t.isNullOrUndefined(r.footer)||("AppendToSheet"===this.expType?i||(this.footer=JSON.parse(JSON.stringify(r.footer))):this.footer=JSON.parse(JSON.stringify(r.footer))))),this.includeHiddenColumn=!!c&&r.includeHiddenColumn,new Promise(function(t,i){e.childGridLevel=0,p=s.processGridExport(e,r,o),s.globalResolve=t,s.gridPool[e.id]=!0,s.helper.checkAndExport(s.gridPool,s.globalResolve)}).then(function(){var o=[];if(s.organiseRows(p,p[0].index,o),s.rows=s.rows.concat(o),t.isNullOrUndefined(s.footer)||("AppendToSheet"===s.expType&&!i||"NewSheet"===s.expType)&&s.processExcelFooter(s.footer),s.columns.length>0&&(s.sheet.columns=s.columns),s.sheet.rows=s.rows,s.sheet.enableRtl=s.parent.enableRtl,s.parent.allowFiltering&&e.getVisibleColumns().length&&c&&r.enableFilter){var l=r.header?r.header.headerRows||r.header.rows.length:0,u={row:d+l,column:s.groupedColLength?s.groupedColLength+1:s.sheet.columns[0].index,lastRow:s.sheet.rows.length,lastColumn:s.sheet.columns.length};s.sheet.autoFilters=u}if(s.workSheet.push(s.sheet),s.book.worksheets=s.workSheet,s.book.styles=s.styles,e.notify("finalPageSetup",s.book),!i){if(s.isCsvExport){c&&!t.isNullOrUndefined(r.separator)&&","!==r.separator&&(a=r.separator);g=new h.Workbook(s.book,"csv",e.locale,t.defaultCurrencyCode,a);s.isBlob?s.blobPromise=g.saveAsBlob("text/csv"):c&&r.fileName?g.save(r.fileName):g.save("Export.csv")}else{var g=new h.Workbook(s.book,"xlsx",e.locale,t.defaultCurrencyCode);s.isBlob?s.blobPromise=g.saveAsBlob("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"):c&&r.fileName?g.save(r.fileName):g.save("Export.xlsx")}s.isElementIdChanged&&(e.element.id=""),delete e.expandedRows}return n})},i.prototype.organiseRows=function(e,t,r){if(!e.length)return t;for(var i=0;i<e.length;i++){var n=e[parseInt(i.toString(),10)],o=n.childRows;o?(n.index=t++,delete n.childRows,r.push(n),t=this.organiseRows(o,t,r)):(n.index=t++,r.push(n))}return t},i.prototype.processGridExport=function(e,r,i){var n=[],o=this.parent.isFrozenGrid()&&!this.parent.getFrozenColumns();t.isNullOrUndefined(r)||t.isNullOrUndefined(r.theme)||(this.theme=r.theme),e.childGrid&&!t.isNullOrUndefined(r)&&(e.hierarchyPrintMode=r.hierarchyExportMode||"Expanded");var s=new ls(e,this.helper.getForeignKeyData()),a=y(r)?E(r.columns,e.enableColumnVirtualization):s.getGridExportColumns(o?e.getColumns():e.columns),l=s.getHeaders(a,this.includeHiddenColumn),h=e.groupSettings.columns.length?e.groupSettings.columns.length-1:0;if(n=this.processHeaderContent(e,l,h,n),!t.isNullOrUndefined(r)&&Object.keys(r).length&&t.isNullOrUndefined(r.dataSource))if("CurrentPage"!==r.exportType||e.groupSettings.enableLazyLoading&&!e.getDataModule().isRemote())if(e.groupSettings.enableLazyLoading&&!e.getDataModule().isRemote()){var p=void 0;if(!t.isNullOrUndefined(r)&&Object.keys(r).length){var d="CurrentPage"!==r.exportType,c=e.getDataModule().generateQuery(d),u=e.getDataModule().dataManager.executeLocal(c);c.lazyLoad=[];if(!d)for(f=0;f<c.queries.length;f++)"onPage"===c.queries[parseInt(f.toString(),10)].fn&&(c.queries[parseInt(f.toString(),10)].e.pageSize=u.reduce(function(e,t){return e+t.count},0));if("All"===r.hierarchyExportMode)p=e.getDataModule().dataManager.executeLocal(c);else if("Expanded"===r.hierarchyExportMode||"None"===r.hierarchyExportMode||t.isNullOrUndefined(r.hierarchyExportMode)){p=e.getDataModule().dataManager.executeLocal(c);for(var g=this.parent.contentModule.lazyLoadQuery,f=0;f<g.length;f++)for(var m=g[parseInt(f.toString(),10)][0],v=0;v<p.length;v++)p[parseInt(v.toString(),10)].key===m.value&&(u[parseInt(f.toString(),10)]=p[parseInt(v.toString(),10)]);p=u}}else p=e.currentViewData;n=this.processRecordContent(e,i,l,r,p,n,s)}else n=this.processRecordContent(e,i,l,r,void 0,n,s);else n=this.processRecordContent(e,i,l,r,e.currentViewData,n,s);else n=this.processRecordContent(e,i,l,r,void 0,n,s);return e.notify("export-DataBound",{excelRows:n,type:"excel"}),this.capTemplate=void 0,this.footerTemplates=[],this.grpFooterTemplates=[],this.aggIndex=0,this.totalAggregates=0,n},i.prototype.processRecordContent=function(e,r,i,n,o,s,a){var l;if(l=!t.isNullOrUndefined(o)&&o.length?o:r.result,t.isNullOrUndefined(l.level)?this.processRecordRows(e,l,i,0,0,n,s,a):this.processGroupedRows(e,l,i,l.level,0,n,s,a),!t.isNullOrUndefined(r.aggregates)&&Object.keys(r.aggregates).length>0)if(t.isNullOrUndefined(o)||this.parent.groupSettings.enableLazyLoading){var h=r.result.GroupGuid?r.result.records:r.result;this.processAggregates(e,h,s)}else this.processAggregates(e,r.result,s,o);return s},i.prototype.processGroupedRows=function(e,r,i,n,o,s,a,l){for(var h=0,p=r;h<p.length;h++){var d=p[h],c=[],u={};u.index=1+n-1;var g=e.getColumnByField(d.field),f={value:d.key,column:g,style:void 0,isForeignKey:g.isForeignColumn()},m=e.getColumnByField(d.field).headerText+": "+(g.enableGroupByFormat?d.key:this.exportValueFormatter.formatCellValue(f))+" - ";d.count>1?m+=d.count+" items":m+=d.count+" item";var y={captionText:m,type:this.isCsvExport?"CSV":"Excel",data:d};this.parent.trigger("exportGroupCaption",y),u.value=y.captionText,u.style=this.getCaptionThemeStyle(this.theme),t.isNullOrUndefined(y.style)||(u.style=this.mergeOptions(u.style,y.style));var v=new Si(e).generateRows(d);if(this.fillAggregates(e,v,r.level+r.childLevels-1,a,this.rowLength),c.push(u),a[a.length-1].cells.length>0){for(var C=r.level+r.childLevels+v[0].cells.length,S=0,b=0,w=a[a.length-1].cells;b<w.length;b++){var I=w[b];I.index<C&&(C=I.index),I.index>S&&(S=I.index),c[c.length-1].index!==I.index&&c.push(I)}for(C-u.index>1&&(u.colSpan=C-u.index);S<i.columns.length+n+r.childLevels;){var R={};R.index=S+1,R.style=this.getCaptionThemeStyle(this.theme),c.push(R),S++}}else{for(var x=0,F=0,T=i.columns;F<T.length;F++)T[F].visible&&x++;u.colSpan=r.childLevels+x}if(a[a.length-1].cells=c,this.rowLength++,this.groupedColLength<8&&n>1){var E={outlineLevel:n-1,isCollapsed:!0};a[a.length-1].grouping=E}!t.isNullOrUndefined(r.childLevels)&&r.childLevels>0?(this.processGroupedRows(e,d.items,i,d.items.level,o,s,a,l),this.processAggregates(e,d,a,void 0,n-1+r.childLevels,!0)):(o=this.processRecordRows(e,d.items,i,n-1,o,s,a,l),this.processAggregates(e,d,a,void 0,n-1,!0))}},i.prototype.processRecordRows=function(r,i,n,o,s,a,l,h){for(var p=1,d=[],c=n.columns,u=0,g=h.getGridRowModel(c,i,r,s);u<g.length;u++){var f=g[u];d=[],s++,p=1;for(var m=void 0,y=0,v=f.cells.length;y<v;y++){var C=f.cells[parseInt(y.toString(),10)];if(C.cellType===e.CellType.Data){var S=C.column,b=S.field,w=t.isNullOrUndefined(b)?"":S.valueAccessor(b,f.data,S),I=t.isNullOrUndefined(w)?"":w,R=void 0;if(S.isForeignColumn&&S.isForeignColumn()&&(R=h.getFData(I,S),I=t.getValue(S.foreignKeyValue,R)),!t.isNullOrUndefined(I)){var x={},F=p+o+r.childGridLevel,T={data:f.data,column:S,foreignKeyData:R,value:I,style:void 0,colSpan:1,cell:x};if(r.trigger("excelQueryCellInfo",T),t.isNullOrUndefined(T.image)||t.isNullOrUndefined(T.image.base64)||(m=this.setImage(T,F),T.image.height&&""!==T.value&&(m+=30)),t.isNullOrUndefined(T.hyperLink)||(T.cell.hyperlink={target:T.hyperLink.target},T.value=T.hyperLink.displayText||T.value),x=T.cell,x.index=F,x.value=T.value,""===T.data&&r.childGridLevel&&1===p){var E={};E.hAlign="left",T={style:E},x.colSpan=r.getVisibleColumns().length,x.value=this.l10n.getConstant("EmptyRecord")}if(T.colSpan>1&&(x.colSpan=T.colSpan),t.isNullOrUndefined(T.style))x.style={name:r.element.id+"column"+(p+o)};else{var z=this.getColumnStyle(r,p+o);x.style=this.mergeOptions(this.styles[parseInt(z.toString(),10)],T.style)}d.push(x)}p++}}var M={index:this.rowLength++,cells:d};if(t.isNullOrUndefined(m)||(M.height=m),this.groupedColLength&&this.groupedColLength<8&&o+1>0?(M.grouping={outlineLevel:o+1,isCollapsed:!0},l.push(M)):l.push(M),(f.isExpand||this.isChild)&&!t.isNullOrUndefined(r.childGrid)){r.isPrinting=!0;var D=!t.isNullOrUndefined(a)&&a.exportType?a.exportType:"AllPages",O=this.helper.createChildGrid(r,f,D,this.gridPool),k=O.childGrid,A=O.element;k.actionFailure=h.failureHandler(this.gridPool,k,this.globalResolve),k.childGridLevel=r.childGridLevel+1;var L={childGrid:k,row:f,exportProperties:a};this.parent.trigger("exportDetailDataBound",L),k.beforeDataBound=this.childGridCell(M,k,a,f),k.appendTo(A)}r.notify("export-RowDataBound",{rowObj:f,type:"excel",excelRows:l})}return s},i.prototype.setImage=function(e,r){t.isNullOrUndefined(this.sheet.images)&&(this.sheet.images=[]);var i={image:e.image.base64,row:this.rowLength,column:r,lastRow:this.rowLength,lastColumn:r};return e.image.width&&e.image.height&&(i.width=e.image.width,i.height=e.image.height),this.sheet.images.push(i),this.columns[r-1].width=e.image.width||this.columns[r-1].width,e.image.height||50},i.prototype.childGridCell=function(e,r,i,n){var o=this;return function(s){r.beforeDataBound=null,s.cancel=!0,0===s.result.length&&(s.result=[""]),e.childRows=o.processGridExport(r,i,s);for(var a=o.parent.groupSettings.columns.length,l=e.childRows,h=0;h<l.length;h++)l[parseInt(h.toString(),10)].grouping={outlineLevel:a+r.childGridLevel,isCollapsed:!n.isExpand,isHidden:!n.isExpand};return r.destroy(),t.detach(r.element),o.gridPool[r.id]=!0,o.helper.checkAndExport(o.gridPool,o.globalResolve),e}},i.prototype.processAggregates=function(e,r,i,n,o,s){var a=new vi(e),l=a.getColumns();l=l.filter(function(e){return t.isNullOrUndefined(e.commands)&&"checkbox"!==e.type}),e.aggregates.length&&this.parent!==e&&e.aggregateModule.prepareSummaryInfo();var h=void 0;if(h=t.isNullOrUndefined(n)?r:n,void 0===o&&(o=0),e.groupSettings.columns.length>0&&s){var p=new Ci(e).generateRows(h,{level:h.level});p.length>0&&(i=this.fillAggregates(e,p,o,i))}else{o=e.groupSettings.columns.length>0&&!s?e.groupSettings.columns.length:o;var d=a.generateRows(h,r.aggregates,null,null,l);d.length>0&&!s&&(o=e.groupSettings.columns.length?o-1:o,i=this.fillAggregates(e,d,o,i))}return i},i.prototype.fillAggregates=function(r,i,n,o,s){for(var a=0,l=i;a<l.length;a++){for(var h=l[a],p=[],d=!0,c=0,u=0,g=h.cells;u<g.length;u++){var f=g[u],m={};if(f.cellType!==e.CellType.DetailFooterIntent&&(f.visible||this.includeHiddenColumn))if(c++,f.isDataCell){d=!1;var y=!t.isNullOrUndefined(f.column.footerTemplate),v=!t.isNullOrUndefined(f.column.groupFooterTemplate),C=!t.isNullOrUndefined(f.column.groupCaptionTemplate);if(m.index=c+n+r.childGridLevel,y)m.value=this.getAggreateValue(r,e.CellType.Summary,f.column.footerTemplate,f,h);else if(v)m.value=this.getAggreateValue(r,e.CellType.GroupSummary,f.column.groupFooterTemplate,f,h);else if(C)m.value=this.getAggreateValue(r,e.CellType.CaptionSummary,f.column.groupCaptionTemplate,f,h);else for(var S=0,b=Object.keys(h.data[f.column.field]);S<b.length;S++)b[S]===f.column.type&&(t.isNullOrUndefined(h.data[f.column.field].Sum)?t.isNullOrUndefined(h.data[f.column.field].Average)?t.isNullOrUndefined(h.data[f.column.field].Max)?t.isNullOrUndefined(h.data[f.column.field].Min)?t.isNullOrUndefined(h.data[f.column.field].Count)?t.isNullOrUndefined(h.data[f.column.field].TrueCount)?t.isNullOrUndefined(h.data[f.column.field].FalseCount)?t.isNullOrUndefined(h.data[f.column.field].Custom)||(m.value=h.data[f.column.field].Custom):m.value=h.data[f.column.field][f.column.field+" - falsecount"]:m.value=h.data[f.column.field][f.column.field+" - truecount"]:m.value=h.data[f.column.field][f.column.field+" - count"]:m.value=h.data[f.column.field][f.column.field+" - min"]:m.value=h.data[f.column.field][f.column.field+" - max"]:m.value=h.data[f.column.field][f.column.field+" - average"]:m.value=h.data[f.column.field][f.column.field+" - sum"]);m.style=this.getCaptionThemeStyle(this.theme),this.aggregateStyle(f.column,m.style,f.column.field);var w=f.attributes.style;w.textAlign&&(m.style.hAlign=w.textAlign.toLowerCase());var I={row:h,type:y?"Footer":v?"GroupFooter":"GroupCaption",style:m};this.parent.trigger("excelAggregateQueryCellInfo",I),p.push(m)}else void 0===s&&(m.index=c+n+r.childGridLevel,m.style=this.getCaptionThemeStyle(this.theme),p.push(m))}if(t.isNullOrUndefined(s)){var R={};if(!(this.groupedColLength<8&&this.groupedColLength>0)||r.groupSettings.enableLazyLoading&&t.isNullOrUndefined(o[o.length-1].grouping))R={index:this.rowLength++,cells:p};else{var x={outlineLevel:o[o.length-1].grouping.outlineLevel,isCollapsed:!0};R={index:this.rowLength++,cells:p,grouping:x}}d||o.push(R)}else o.push({index:s,cells:p})}return o},i.prototype.aggregateStyle=function(e,r,i){var n=this.parent.getColumnByField(i);if("object"==typeof e.format){var o=e.format;r.numberFormat=t.isNullOrUndefined(o.format)?o.skeleton:o.format,t.isNullOrUndefined(o.type)||(r.type=o.type.toLowerCase())}else r.numberFormat=e.format;!t.isNullOrUndefined(n)&&t.isNullOrUndefined(r.type)&&(r.type=n.type.toLowerCase())},i.prototype.getAggreateValue=function(r,i,n,o,s){var a={};a[t.getEnumValue(e.CellType,o.cellType)]=t.compile(n);var l,h=s.data[o.column.field?o.column.field:o.column.columnName];if(this.parent.isReact||this.parent.isVue||this.parent.isAngular){if(t.isNullOrUndefined(o.column.customAggregate))return t.isNullOrUndefined(o.column.footerTemplate)?o.column.groupFooterTemplate?l=this.getAggregateTemplate(this.grpFooterTemplates,r.getContentTable(),h,o):(this.capTemplate=t.isNullOrUndefined(this.capTemplate)?r.getContentTable().querySelector(".e-groupcaptionrow").querySelector(".e-summarycell.e-templatecell").innerText.split(h[o.column.type])[0]:this.capTemplate,l=this.capTemplate+h[o.column.type]):l=this.getAggregateTemplate(this.footerTemplates,r.getFooterContentTable(),h,o),t.isNullOrUndefined(l)?"":l;l=a[t.getEnumValue(e.CellType,o.cellType)](h,this.parent)}else l=a[t.getEnumValue(e.CellType,o.cellType)](h);return t.isNullOrUndefined(l[0])?"":l[0].textContent},i.prototype.getAggregateTemplate=function(e,t,r,i){var n=i.column.groupFooterTemplate?"e-groupfooterrow":"e-summaryrow";if(!e.length){this.totalAggregates=0,this.aggIndex=0;for(var o=0;o<t.querySelectorAll("tr").length&&!(t.querySelectorAll("tr")[parseInt(o.toString(),10)].classList.contains(n)&&(this.totalAggregates++,t.querySelectorAll("tr")[parseInt(o.toString(),10)+1]&&t.querySelectorAll("tr")[parseInt(o.toString(),10)+1].classList.contains("e-groupcaptionrow")));o++);}e.length<this.totalAggregates&&e.push(t.querySelectorAll("."+n)[e.length].querySelector(".e-summarycell.e-templatecell").innerText.split(r[i.column.type])[0]),this.parent.groupSettings.enableLazyLoading&&i.column.groupFooterTemplate&&0===this.totalAggregates&&(this.totalAggregates=e.length);var s=e[++this.aggIndex-1]+r[i.column.type];return this.aggIndex===this.totalAggregates&&(this.aggIndex=0),s},i.prototype.mergeOptions=function(e,t){for(var r={},i=Object.keys(e),n=0;n<i.length;n++)"name"!==i[parseInt(n.toString(),10)]&&(r[i[parseInt(n.toString(),10)]]=e[i[parseInt(n.toString(),10)]]);i=Object.keys(t);for(n=0;n<i.length;n++)"name"!==i[parseInt(n.toString(),10)]&&(r[i[parseInt(n.toString(),10)]]=t[i[parseInt(n.toString(),10)]]);return r},i.prototype.getColumnStyle=function(e,t){for(var r=0,i=0,n=this.styles;i<n.length;i++){if(n[i].name===e.element.id+"column"+t)return r;r++}},i.prototype.headerRotation=function(e){var t=e.style.rotation;t<=90&&t>=0?e.style.hAlign="Left":t>90&&t<=180?e.style.hAlign="Right":(t=180,e.style.hAlign="Right"),e.style.rotation=t},i.prototype.processHeaderContent=function(r,i,n,o){var s=i.rows,a=i.columns,l=[];if(n>0)for(var h=0;h!==n;)this.columns.push({index:h+1,width:30}),h++;for(var p=0;p<a.length;p++)this.parseStyles(r,a[parseInt(p.toString(),10)],this.getRecordThemeStyle(this.theme),n+p+1);for(var d,c=0;c<s.length;c++){for(var u=1+n,g=[],f=0;f<s[parseInt(c.toString(),10)].cells.length;f++){var m={},y={},v=s[parseInt(c.toString(),10)].cells[parseInt(f.toString(),10)];if(v.cellType!==e.CellType.HeaderIndent&&v.cellType!==e.CellType.DetailHeader){for(var C={contains:!0,index:1};C.contains;)if(C=this.getIndex(l,1,u),u=C.index,!C.contains){y.index=C.index+r.childGridLevel;break}if(!t.isNullOrUndefined(v.rowSpan)&&1!==v.rowSpan){y.rowSpan=v.rowSpan;for(var S=1;S<v.rowSpan+1;S++){var b={rowIndex:0,columnIndex:0};b.rowIndex=S,b.columnIndex=u,l.push(b)}}t.isNullOrUndefined(v.colSpan)||1===v.colSpan||(y.colSpan=v.colSpan,u=u+y.colSpan-1),y.value=v.column.headerText,m=this.getHeaderThemeStyle(this.theme),t.isNullOrUndefined(v.column.textAlign)||(m.hAlign=v.column.textAlign.toLowerCase()),t.isNullOrUndefined(v.column.headerTextAlign)||(m.hAlign=v.column.headerTextAlign.toLowerCase());var w={cell:y,gridCell:v,style:m};r.trigger("excelHeaderQueryCellInfo",w),w.style.rotation&&this.headerRotation(w),t.isNullOrUndefined(w.image)||t.isNullOrUndefined(w.image.base64)||(d=this.setImage(w,u)),t.isNullOrUndefined(w.hyperLink)||(w.cell.hyperlink={target:w.hyperLink.target},y.value=w.hyperLink.displayText||y.value),y.style=w.style,g.push(y),u++}}var I={index:this.rowLength++,cells:g};t.isNullOrUndefined(d)||(I.height=d),o.push(I)}return o},i.prototype.getHeaderThemeStyle=function(e){var r={};return r.fontSize=12,r.borders={color:"#E0E0E0"},r.bold=!0,t.isNullOrUndefined(e)||t.isNullOrUndefined(e.header)||(r=this.updateThemeStyle(e.header,r)),r},i.prototype.updateThemeStyle=function(e,r){return t.extend(r,e)},i.prototype.getCaptionThemeStyle=function(e){var r={};return r.fontSize=13,r.backColor="#F6F6F6",t.isNullOrUndefined(e)||t.isNullOrUndefined(e.caption)||(r=this.updateThemeStyle(e.caption,r)),r},i.prototype.getRecordThemeStyle=function(e){var r={};return r.fontSize=13,r.borders={color:"#E0E0E0"},t.isNullOrUndefined(e)||t.isNullOrUndefined(e.record)||(r=this.updateThemeStyle(e.record,r)),r},i.prototype.processExcelHeader=function(e){if(!t.isNullOrUndefined(e.rows)&&("NewSheet"===this.expType||1===this.rowLength)){var r=void 0;void 0===e.headerRows?this.rowLength=e.rows.length:this.rowLength=e.headerRows,r=this.rowLength<e.rows.length?this.rowLength:e.rows.length,this.rowLength++;for(var i=0;i<r;i++){var n=e.rows[parseInt(i.toString(),10)];(null===n.index||t.isNullOrUndefined(n.index))&&(n.index=i+1),this.updatedCellIndex(n)}}},i.prototype.updatedCellIndex=function(e){for(var r=e.cells.length,i=0;i<r;i++){var n=e.cells[parseInt(i.toString(),10)];(null===n.index||t.isNullOrUndefined(n.index))&&(n.index=i+1)}this.rows.push(e)},i.prototype.processExcelFooter=function(e){if(!t.isNullOrUndefined(e.rows)){var r=void 0;void 0===e.footerRows?this.rowLength+=e.rows.length:e.footerRows>e.rows.length?(this.rowLength+=e.footerRows-e.rows.length,r=e.rows.length):r=e.footerRows;for(var i=0;i<r;i++){var n=e.rows[parseInt(i.toString(),10)];null===n.index||void 0===n.index?n.index=this.rowLength++:n.index+=this.rowLength,this.updatedCellIndex(n)}}},i.prototype.getIndex=function(e,t,r){for(var i=0,n=e;i<n.length;i++){var o=n[i];if(o.rowIndex===t&&o.columnIndex===r)return r+=1,{contains:!0,index:r}}return{contains:!1,index:r}},i.prototype.parseStyles=function(e,r,i,n){if(!t.isNullOrUndefined(r.format))if("object"==typeof r.format){var o=r.format;i.numberFormat=t.isNullOrUndefined(o.format)?o.skeleton:o.format,t.isNullOrUndefined(o.type)||(i.type=o.type.toLowerCase())}else i.numberFormat=r.format,i.type=r.type;t.isNullOrUndefined(r.textAlign)||(i.hAlign=r.textAlign.toLowerCase()),Object.keys(i).length>0&&(i.name=e.element.id+"column"+n,this.styles.push(i)),t.isNullOrUndefined(r.width)||"auto"===r.width||this.columns.push({index:n+e.childGridLevel,width:"number"==typeof r.width?r.width:this.helper.getConvertedWidth(r.width)})},i.prototype.destroy=function(){},i}(),ds=function(){function i(e){this.hideColumnInclude=!1,this.currentViewData=!1,this.customDataSource=!1,this.isGrouping=!1,this.headerOnPages=[],this.drawPosition={xPosition:0,yPosition:0},this.parent=e,this.helper=new ls(e),this.gridPool={}}return i.prototype.getModuleName=function(){return"PdfExport"},i.prototype.init=function(e){this.exportValueFormatter=new hs(e.locale),this.pdfDocument=void 0,this.hideColumnInclude=!1,this.currentViewData=!1,this.parent=e,this.isGrouping=!1,this.isExporting=!0,e.id=N("main-grid"),this.gridPool[e.id]=!1,this.pdfPageSettings=new p.PdfPageSettings},i.prototype.exportWithData=function(e,r,i,n,o,s,a){var l=this;this.init(e),t.isNullOrUndefined(r)?this.pdfDocument=new p.PdfDocument:this.pdfDocument=r,this.processExport(e,n,o,s).then(function(){l.isExporting=!1,e.trigger("pdfExportComplete",l.isBlob?{promise:l.blobPromise}:{}),l.parent.log("exporting_complete",l.getModuleName()),i(l.pdfDocument)}).catch(function(e){a(l.pdfDocument),l.parent.trigger("actionFailure",e)})},i.prototype.Map=function(e,i,n,o,s){var a=this;this.data=new Br(this.parent),this.isBlob=s,this.gridPool={};var l=i&&i.query?i.query:new r.Query;e.childGrid&&(t.isNullOrUndefined(i)||"None"!==i.hierarchyExportMode)&&(e.expandedRows=ye(e).expandedRows);var h={requestType:"beforePdfExport",cancel:!1,headerPageNumbers:[],gridDrawPosition:{xPosition:0,yPosition:0},generateQuery:!1};h.gridObject=e;if(e.trigger("beforePdfExport",h),!0===h.cancel)return new Promise(function(e,t){return e()});if(y(i)&&v(i,e),h.generateQuery&&(l=ls.getQuery(e,this.data)),this.headerOnPages=h.headerPageNumbers,this.drawPosition=h.gridDrawPosition,this.parent.log("exporting_begin",this.getModuleName()),t.isNullOrUndefined(i)||t.isNullOrUndefined(i.dataSource)){if(t.isNullOrUndefined(i)||"CurrentPage"!==i.exportType){var d=[];return d.push(this.data.getData({},ls.getQuery(e,this.data))),d.push(this.helper.getColumnData(e)),new Promise(function(r,s){Promise.all(d).then(function(l){a.init(e),t.isNullOrUndefined(o)?a.pdfDocument=new p.PdfDocument:a.pdfDocument=o,a.processExport(e,l[0],i,n).then(function(){a.isExporting=!1,e.trigger("pdfExportComplete",a.isBlob?{promise:a.blobPromise}:{}),a.parent.log("exporting_complete",a.getModuleName()),r(a.pdfDocument)}).catch(function(e){s(a.pdfDocument),a.parent.trigger("actionFailure",e)})})})}return new Promise(function(t,r){a.exportWithData(e,o,t,a.parent.getCurrentViewRecords(),i,n,r)})}return i.dataSource=i.dataSource instanceof r.DataManager?i.dataSource:new r.DataManager(i.dataSource),new Promise(function(t,r){i.dataSource.executeQuery(l).then(function(s){a.exportWithData(e,o,t,s,i,n,r)})})},i.prototype.processExport=function(e,r,i,n){var o,s=this,a=this.pdfDocument.sections.add();this.processSectionExportProperties(a,i);var l=a.pages.add();return new Promise(function(t,n){o=s.processGridExport(e,r,i),s.globalResolve=t,s.gridPool[e.id]=!0,s.helper.checkAndExport(s.gridPool,s.globalResolve)}).then(function(){return o.draw(l,s.drawPosition.xPosition,s.drawPosition.yPosition),s.drawHeader(i),n||(s.isBlob?s.blobPromise=s.pdfDocument.save():!t.isNullOrUndefined(i)&&i.fileName?s.pdfDocument.save(i.fileName):s.pdfDocument.save("Export.pdf"),s.pdfDocument.destroy(),delete e.expandedRows),s.pdfDocument})},i.prototype.processSectionExportProperties=function(e,r){return t.isNullOrUndefined(r)||t.isNullOrUndefined(r.pageOrientation)&&t.isNullOrUndefined(r.pageSize)||(this.pdfPageSettings.orientation="Landscape"===r.pageOrientation?p.PdfPageOrientation.Landscape:p.PdfPageOrientation.Portrait,this.pdfPageSettings.size=this.getPageSize(r.pageSize),e.setPageSettings(this.pdfPageSettings)),e},i.prototype.processGridExport=function(e,r,i){var n=!0,o=this.parent.isFrozenGrid()&&!this.parent.getFrozenColumns();t.isNullOrUndefined(i)||(this.gridTheme=i.theme,n=!!t.isNullOrUndefined(i.allowHorizontalOverflow)||i.allowHorizontalOverflow);var s=new ls(e,this.helper.getForeignKeyData()),a=this.processExportProperties(i,r.result),l=y(i)?E(i.columns,e.enableColumnVirtualization):s.getGridExportColumns(o?e.getColumns():e.columns);l=l.filter(function(e){return t.isNullOrUndefined(e.commands)});var h=!1;e.groupSettings.columns.length&&(h=!0),e.childGrid&&!t.isNullOrUndefined(i)&&(e.hierarchyPrintMode=i.hierarchyExportMode||"Expanded");var d=new p.PdfGrid,c=this.getHeaderThemeStyle(),u=c.border,g=c.font,f=c.brush,m=s.getHeaders(l,this.hideColumnInclude),v=m.columns;d=this.processGridHeaders(e.groupSettings.columns.length,d,m.rows,v,u,g,f,e,n,l),this.setColumnProperties(v,d,s,e,n);var C=this.getSummaryCaptionThemeStyle();if(!t.isNullOrUndefined(a)&&a.length){if(h?(t.isNullOrUndefined(C.border)||(u=C.border),this.processGroupedRecords(d,a,v,e,u,0,C.font,C.brush,C.backgroundBrush,r,i,s,0)):this.processRecord(u,v,e,a,d,0,i,s,0),!t.isNullOrUndefined(r.aggregates)){var S=new vi(e),b=void 0,w=S.getColumns();w=w.filter(function(e){return t.isNullOrUndefined(e.commands)&&"checkbox"!==e.type}),e.aggregates.length&&this.parent!==e&&e.aggregateModule.prepareSummaryInfo(),b=this.customDataSource?S.generateRows(a,r.aggregates):this.currentViewData?S.generateRows(this.parent.getCurrentViewRecords(),r.aggregates):h?S.generateRows(a.records,r.aggregates):S.generateRows(r.result,r.aggregates,null,null,w),this.processAggregates(b,d,u,C.font,C.brush,C.backgroundBrush,!1,null,null,null,!h)}}else d.rows.addRow().style.setBorder(u);return d},i.prototype.getSummaryCaptionThemeStyle=function(){if(t.isNullOrUndefined(this.gridTheme)||t.isNullOrUndefined(this.gridTheme.caption))return{font:new p.PdfStandardFont(p.PdfFontFamily.Helvetica,9.75),brush:new p.PdfSolidBrush(new p.PdfColor(0,0,0)),backgroundBrush:new p.PdfSolidBrush(new p.PdfColor(246,246,246))};var e=t.isNullOrUndefined(this.gridTheme.caption.fontSize)?9.75:this.gridTheme.caption.fontSize,r=t.isNullOrUndefined(this.gridTheme.caption.fontName)?p.PdfFontFamily.Helvetica:this.getFontFamily(this.gridTheme.caption.fontName),i=this.getFontStyle(this.gridTheme.caption),n=new p.PdfColor(0,0,0);if(!t.isNullOrUndefined(this.gridTheme.caption.fontColor)){var o=this.hexToRgb(this.gridTheme.caption.fontColor);n=new p.PdfColor(o.r,o.g,o.b)}var s=this.gridTheme.caption.border?this.getBorderStyle(this.gridTheme.caption.border):null,a=new p.PdfStandardFont(r,e,i);return t.isNullOrUndefined(this.gridTheme.caption.font)||(a=this.gridTheme.caption.font),{font:a,brush:new p.PdfSolidBrush(n),backgroundBrush:new p.PdfSolidBrush(new p.PdfColor(246,246,246)),border:s}},i.prototype.getGridPdfFont=function(e){var r=0;if(e.header&&e.header.font){var i=e.header.font.fontFamily,n=e.header.font.fontSize,o=e.header.font.fontStyle;if(r=t.isNullOrUndefined(p.PdfFontStyle[""+o])?0:p.PdfFontStyle[""+o],e.header.font.isTrueType)e.header.font=new p.PdfTrueTypeFont(i,n,r);else{var s=t.isNullOrUndefined(i)?p.PdfFontFamily.Helvetica:this.getFontFamily(i);e.header.font=new p.PdfStandardFont(s,n,r)}}if(e.caption&&e.caption.font){var a=e.caption.font.fontFamily,l=e.caption.font.fontSize,h=e.caption.font.fontStyle;if(r=t.isNullOrUndefined(p.PdfFontStyle[""+h])?0:p.PdfFontStyle[""+h],e.caption.font.isTrueType)e.caption.font=new p.PdfTrueTypeFont(a,l,r);else{var d=t.isNullOrUndefined(a)?p.PdfFontFamily.Helvetica:this.getFontFamily(a);e.caption.font=new p.PdfStandardFont(d,l,r)}}if(e.record&&e.record.font){var c=e.record.font.fontFamily,u=e.record.font.fontSize,g=e.record.font.fontStyle;if(r=t.isNullOrUndefined(p.PdfFontStyle[""+g])?0:p.PdfFontStyle[""+g],e.record.font.isTrueType)e.record.font=new p.PdfTrueTypeFont(c,u,r);else{var f=t.isNullOrUndefined(c)?p.PdfFontFamily.Helvetica:this.getFontFamily(c);e.record.font=new p.PdfStandardFont(f,u,r)}}},i.prototype.getHeaderThemeStyle=function(){var e=new p.PdfBorders;if(t.isNullOrUndefined(this.gridTheme)||t.isNullOrUndefined(this.gridTheme.header))return e.all=new p.PdfPen(new p.PdfColor(234,234,234)),{border:e,font:new p.PdfStandardFont(p.PdfFontFamily.Helvetica,10.5),brush:new p.PdfSolidBrush(new p.PdfColor(102,102,102))};var r=t.isNullOrUndefined(this.gridTheme.header.fontName)?p.PdfFontFamily.Helvetica:this.getFontFamily(this.gridTheme.header.fontName),i=this.getFontStyle(this.gridTheme.header),n=t.isNullOrUndefined(this.gridTheme.header.fontSize)?10.5:this.gridTheme.header.fontSize,o=new p.PdfColor;if(!t.isNullOrUndefined(this.gridTheme.header.fontColor)){var s=this.hexToRgb(this.gridTheme.header.fontColor);o=new p.PdfColor(s.r,s.g,s.b)}var a=new p.PdfStandardFont(r,n,i);return t.isNullOrUndefined(this.gridTheme.header.font)||(a=this.gridTheme.header.font),{border:this.getBorderStyle(this.gridTheme.header.border),font:a,brush:new p.PdfSolidBrush(o)}},i.prototype.processGroupedRecords=function(e,r,i,n,o,s,a,l,h,d,c,u,g){for(var f=this,m=s,y=this,v=0,C=r;v<C.length;v++)!function(s){var v=e.rows.addRow(),C=n.getColumnByField(s.field),S={value:s.key,column:C,style:void 0,isForeignKey:C.isForeignColumn()},b={captionText:n.getColumnByField(s.field).headerText+": "+(C.enableGroupByFormat?s.key:y.exportValueFormatter.formatCellValue(S))+" - "+s.count+(r.count>1?" items":" item"),type:"PDF",data:s,style:void 0};y.parent.trigger("exportGroupCaption",b,function(y){v.cells.getCell(m).value=y.captionText,v.cells.getCell(m).style.stringFormat=new p.PdfStringFormat(p.PdfTextAlignment.Left),v.style.setBorder(o),v.style.setFont(a),v.style.setTextBrush(l),v.style.setBackgroundBrush(h),t.isNullOrUndefined(y.style)||f.processCellStyle(v.cells.getCell(m),y);var C,S=new Si(n);if(C=t.isNullOrUndefined(s.items.records)?S.generateRows(s.items,s):S.generateRows(s.items.records,s),t.isNullOrUndefined(C)||0!==C.length||(v.cells.getCell(m+1).columnSpan=e.columns.count-(m+1)),!t.isNullOrUndefined(r.childLevels)&&r.childLevels>0)f.processAggregates(C,e,o,a,l,h,!0,v,m,null,null,n),f.processGroupedRecords(e,s.items,i,n,o,m+1,a,l,h,d,c,u,g),g=f.rowIndex,C=(b=new Ci(n)).generateRows(s.items.records,s),f.processAggregates(C,e,o,a,l,h,!1);else{f.processAggregates(C,e,o,a,l,h,!0,v,m,null,null,n),g=f.processRecord(o,i,n,s.items,e,m+1,c,u,g);var b=new Ci(n);C=b.generateRows(s.items,s);f.processAggregates(C,e,o,a,l,h,!1,null,null,!0,null,n)}})}(C[v])},i.prototype.processGridHeaders=function(r,i,n,o,s,a,l,h,d,c){for(var u=this,g=o.length+r,f=Se(c),m=c,y=0,v=[],C=0;C<n.length;C++)v[parseInt(C.toString(),10)]=0;h.groupSettings.columns.length&&(y=h.groupSettings.columns.length-1,g-=1),i.columns.add(g),i.headers.add(n.length);var S=function(r,o,d,c,g){var f=i.headers.getHeader(r),m=f.cells.getCell(o),y=n[parseInt(r.toString(),10)].cells[h.groupSettings.columns.length?o:v[parseInt(r.toString(),10)]];v[parseInt(r.toString(),10)]=v[parseInt(r.toString(),10)]+1,t.isNullOrUndefined(d.headerTextAlign)||(m.style.stringFormat=u.getHorizontalAlignment(d.headerTextAlign)),c>0&&(m.rowSpan=c,m.style.stringFormat=u.getVerticalAlignment("Bottom",m.style.stringFormat,d.textAlign)),g>0&&(m.columnSpan=g),f.style.setBorder(s),f.style.setFont(a),f.style.setTextBrush(l),m.value=d.headerText,t.isNullOrUndefined(y)||y.cellType!==e.CellType.HeaderIndent&&y.cellType!==e.CellType.DetailHeader||(m.value="",m.width=20);var C={cell:m,gridCell:y,style:m.style};u.parent.trigger("pdfHeaderQueryCellInfo",C);var S=C,b=C.style.borders,w=C.style.font,I=C.style.textBrush;t.isNullOrUndefined(b)||f.style.setBorder(b),t.isNullOrUndefined(w)||f.style.setFont(w),t.isNullOrUndefined(I)||f.style.setTextBrush(I),t.isNullOrUndefined(S.style.verticalAlignment)||(m.style.stringFormat=u.getVerticalAlignment(S.style.verticalAlignment,m.style.stringFormat)),t.isNullOrUndefined(S.image)||(m.value=new p.PdfBitmap(S.image.base64)),t.isNullOrUndefined(S.hyperLink)||(m.value=u.setHyperLink(S))},b=function(e,t,r,i,n,o){for(var s=0,a=0;a<e.length;a++)if(o&&(i=s=s+r+(0===a?0:-1),r=0),o||e[parseInt(a.toString(),10)].visible||(i-=1),e[parseInt(a.toString(),10)].columns&&e[parseInt(a.toString(),10)].columns.length){var l=b(e[parseInt(a.toString(),10)].columns,t-1,0,a+i,n+1,!1);S(n,a+i+y,e[parseInt(a.toString(),10)],0,l),r+=l,i=i+l-1}else(e[parseInt(a.toString(),10)].visible||u.hideColumnInclude)&&(r++,S(n,a+i+y,e[parseInt(a.toString(),10)],t,0));return r};return b(m,f,0,0,0,!0),i.columns.count>=6&&d&&(i.style.allowHorizontalOverflow=!0),i},i.prototype.processExportProperties=function(e,r){if(t.isNullOrUndefined(e))this.currentViewData=!1,this.customDataSource=!1;else{t.isNullOrUndefined(e.theme)||(this.gridTheme=e.theme);var i=this.pdfPageSettings.size;if(this.drawHeader(e),!t.isNullOrUndefined(e.footer)){var n=e.footer,o=new p.PointF(0,i.width-80-.75*n.fromBottom),s=new p.SizeF(i.width-80,.75*n.height),a=new p.RectangleF(o,s);this.pdfDocument.template.bottom=this.drawPageTemplate(new p.PdfPageTemplateElement(a),n)}t.isNullOrUndefined(e.includeHiddenColumn)||this.isGrouping||(this.hideColumnInclude=e.includeHiddenColumn),t.isNullOrUndefined(e.dataSource)?t.isNullOrUndefined(e.exportType)?(this.currentViewData=!1,this.customDataSource=!1):"CurrentPage"===e.exportType?(r=this.parent.currentViewData,this.currentViewData=!0,this.customDataSource=!1):(this.currentViewData=!1,this.customDataSource=!1):(this.customDataSource=!0,this.currentViewData=!1)}return r},i.prototype.drawHeader=function(e){var r=this,i=this.pdfPageSettings.size;if(!t.isNullOrUndefined(e)&&!t.isNullOrUndefined(e.header)){var n=e.header,o=new p.PointF(0,n.fromTop),s=new p.SizeF(i.width-80,.75*n.height),a=new p.RectangleF(o,s);if(this.headerOnPages.length){var l=this.drawPageTemplate(new p.PdfPageTemplateElement(a),n);this.headerOnPages.filter(function(e){e-1>=0&&e-1<=r.pdfDocument.pages.count-1&&r.pdfDocument.pages.getPageByIndex(e-1).graphics.drawPdfTemplate(l.template,new p.PointF(0,0))})}else this.pdfDocument.template.top=this.drawPageTemplate(new p.PdfPageTemplateElement(a),n)}},i.prototype.drawPageTemplate=function(e,t){for(var r=0,i=t.contents;r<i.length;r++){var n=i[r];switch(this.processContentValidation(n),n.type){case"Text":if(""===n.value||void 0===n.value||null===n.value||"string"!=typeof n.value)throw new Error("please enter the valid input value in text content...");this.drawText(e,n);break;case"PageNumber":this.drawPageNumber(e,n);break;case"Image":if(void 0===n.src||null===n.src||""===n.src)throw new Error("please enter the valid base64 string in image content...");this.drawImage(e,n);break;case"Line":this.drawLine(e,n);break;default:throw new Error("Please set valid content type...")}}return e},i.prototype.processContentValidation=function(e){if(void 0===e.type||null===e.type)throw new Error("please set valid content type...");if("Line"===e.type){if(void 0===e.points||null===e.points)throw new Error("please enter valid points in "+e.type+" content...");if(void 0===e.points.x1||null===e.points.x1||"number"!=typeof e.points.x1)throw new Error("please enter valid x1 co-ordinate in "+e.type+" points...");if(void 0===e.points.y1||null===e.points.y1||"number"!=typeof e.points.y1)throw new Error("please enter valid y1 co-ordinate in "+e.type+" points...");if(void 0===e.points.x2||null===e.points.x2||"number"!=typeof e.points.x2)throw new Error("please enter valid x2 co-ordinate in "+e.type+" points...");if(void 0===e.points.y2||null===e.points.y2||"number"!=typeof e.points.y2)throw new Error("please enter valid y2 co-ordinate in "+e.type+" points...")}else{if(void 0===e.position||null===e.position)throw new Error("please enter valid position in "+e.type+" content...");if(void 0===e.position.x||null===e.position.x||"number"!=typeof e.position.x)throw new Error("please enter valid x co-ordinate in "+e.type+" position...");if(void 0===e.position.y||null===e.position.y||"number"!=typeof e.position.y)throw new Error("please enter valid y co-ordinate in "+e.type+" position...")}},i.prototype.drawText=function(e,r){var i=this.getFont(r),n=this.getBrushFromContent(r),o=null;if(!t.isNullOrUndefined(r.style.textPenColor)){var s=this.hexToRgb(r.style.textPenColor);o=new p.PdfPen(new p.PdfColor(s.r,s.g,s.b))}null==n&&null==o&&(n=new p.PdfSolidBrush(new p.PdfColor(0,0,0)));var a=r.value.toString(),l=.75*r.position.x,h=.75*r.position.y,d=new p.PdfStringFormat;t.isNullOrUndefined(r.style.stringFormat)||(d.alignment=r.style.stringFormat.alignment);var c=this.setContentFormat(r,d);null===c||t.isNullOrUndefined(c.format)||t.isNullOrUndefined(c.size)?e.graphics.drawString(a,i,o,n,l,h,d):e.graphics.drawString(a,i,o,n,l,h,c.size.width,c.size.height,c.format)},i.prototype.drawPageNumber=function(e,r){var i=this.getFont(r),n=null;if(t.isNullOrUndefined(r.style.textBrushColor))n=new p.PdfSolidBrush(new p.PdfColor(0,0,0));else{var o=this.hexToRgb(r.style.textBrushColor);n=new p.PdfSolidBrush(new p.PdfColor(o.r,o.g,o.b))}var s=new p.PdfPageNumberField(i,n);s.numberStyle=this.getPageNumberStyle(r.pageNumberType);var a,l;if(t.isNullOrUndefined(r.format))l="{0}",a=new p.PdfCompositeField(i,n,l,s);else{var h="$total";if(-1!==r.format.indexOf(h)&&-1!==r.format.indexOf("$current"))(d=new p.PdfPageCountField(i)).numberStyle=this.getPageNumberStyle(r.pageNumberType),l=r.format.indexOf(h)>r.format.indexOf("$current")?(l=r.format.replace("$current","0")).replace(h,"1"):(l=r.format.replace("$current","1")).replace(h,"0"),a=new p.PdfCompositeField(i,n,l,s,d);else if(-1!==r.format.indexOf("$current")&&-1===r.format.indexOf(h))l=r.format.replace("$current","0"),a=new p.PdfCompositeField(i,n,l,s);else{var d=new p.PdfPageCountField(i);l=r.format.replace(h,"0"),a=new p.PdfCompositeField(i,n,l,d)}}var c=.75*r.position.x,u=.75*r.position.y,g=this.setContentFormat(r,a.stringFormat);null===g||t.isNullOrUndefined(g.format)||t.isNullOrUndefined(g.size)||(a.stringFormat=g.format,a.bounds=new p.RectangleF(c,u,g.size.width,g.size.height)),a.draw(e.graphics,c,u)},i.prototype.drawImage=function(e,r){var i=.75*r.position.x,n=.75*r.position.y,o=t.isNullOrUndefined(r.size)?void 0:.75*r.size.width,s=t.isNullOrUndefined(r.size)?void 0:.75*r.size.height,a=new p.PdfBitmap(r.src);t.isNullOrUndefined(o)?e.graphics.drawImage(a,i,n):e.graphics.drawImage(a,i,n,o,s)},i.prototype.drawLine=function(e,r){var i=.75*r.points.x1,n=.75*r.points.y1,o=.75*r.points.x2,s=.75*r.points.y2,a=this.getPenFromContent(r);t.isNullOrUndefined(r.style)||null===r.style||(t.isNullOrUndefined(r.style.penSize)||null===r.style.penSize||"number"!=typeof r.style.penSize||(a.width=.75*r.style.penSize),a.dashStyle=this.getDashStyle(r.style.dashStyle)),e.graphics.drawLine(a,i,n,o,s)},i.prototype.processAggregates=function(r,i,n,o,s,a,l,h,p,d,c,u){for(var g=0,f=r;g<f.length;g++){for(var m=f[g],y=-1,v=0,C=!0,S=[],b=c?0:1,w=0;w<i.columns.count+b;w++){var I=m.cells[parseInt(v.toString(),10)];if(I.cellType!==e.CellType.DetailFooterIntent){if(!this.hideColumnInclude){for(;void 0===I.visible;)if(I.cellType!==e.CellType.DetailFooterIntent){if(t.isNullOrUndefined(h))S.push("");else if(t.isNullOrUndefined(h.cells.getCell(w).value))S.push("");else{z={row:m,type:"GroupCaption",style:h.cells};this.parent.trigger("pdfAggregateQueryCellInfo",z),S.push(h.cells.getCell(w).value),C=!1,l||(w+=1)}w+=1,v+=1,I=m.cells[parseInt(v.toString(),10)]}for(;!t.isNullOrUndefined(I.visible)&&!I.visible;)v+=1,I=m.cells[parseInt(v.toString(),10)]}if(I.isDataCell){var R={};if(t.isNullOrUndefined(I.column.footerTemplate)&&t.isNullOrUndefined(I.column.groupCaptionTemplate)&&t.isNullOrUndefined(I.column.groupFooterTemplate)){var x=this.getSummaryWithoutTemplate(m.data[I.column.field]);t.isNullOrUndefined(x)||S.push(x)}else{R=(x=this.getTemplateFunction(R,w,y,I)).templateFunction,y=x.leastCaptionSummaryIndex;var F=void 0,T=m.data[I.column.field?I.column.field:I.column.columnName];this.parent.isReact||this.parent.isVue?(F=R[t.getEnumValue(e.CellType,I.cellType)](T,this.parent),this.parent.isReact&&this.parent.renderTemplates()):F=R[t.getEnumValue(e.CellType,I.cellType)](T),S.push(t.isNullOrUndefined(F[0])?"":F[0].textContent),C=!1}}else S.push("");C&&""!==S[parseInt(w.toString(),10)]&&!t.isNullOrUndefined(S[parseInt(w.toString(),10)])&&null!==S[parseInt(w.toString(),10)]&&(C=!1),v+=1}else w--,v++}if(!c)if(l)for(w=u.groupSettings.columns.length;w<S.length-1;w++)S[parseInt(w.toString(),10)]=S[w+1],S[w+1]=S[w+2]?S[w+2]:"";else S.splice(0,1);if(!C)if(l)for(w=0;w<i.columns.count;w++)h.cells.getCell(w).value=S[parseInt(w.toString(),10)].toString(),w===p&&-1!==y&&1!==y?h.cells.getCell(w).columnSpan=y-1-p:w===p&&-1===y&&(h.cells.getCell(w).columnSpan=i.columns.count-p);else{var E=i.rows.addRow();E.style.setBorder(n),E.style.setFont(o),E.style.setTextBrush(s),E.style.setBackgroundBrush(a);var z={row:m,type:d?"GroupFooter":"Footer",style:E.cells};this.parent.trigger("pdfAggregateQueryCellInfo",z);for(w=0;w<i.columns.count;w++)E.cells.getCell(w).value=S[parseInt(w.toString(),10)].toString()}}},i.prototype.getTemplateFunction=function(r,i,n,o){return t.isNullOrUndefined(o.column.footerTemplate)||o.cellType!==e.CellType.Summary?t.isNullOrUndefined(o.column.groupCaptionTemplate)?r[t.getEnumValue(e.CellType,e.CellType.GroupSummary)]=t.compile(o.column.groupFooterTemplate):(-1===n&&(n=i),r[t.getEnumValue(e.CellType,e.CellType.CaptionSummary)]=t.compile(o.column.groupCaptionTemplate)):r[t.getEnumValue(e.CellType,e.CellType.Summary)]=t.compile(o.column.footerTemplate),{templateFunction:r,leastCaptionSummaryIndex:n}},i.prototype.getSummaryWithoutTemplate=function(e){return t.isNullOrUndefined(e.Sum)?t.isNullOrUndefined(e.Average)?t.isNullOrUndefined(e.Max)?t.isNullOrUndefined(e.Min)?t.isNullOrUndefined(e.Count)?t.isNullOrUndefined(e.TrueCount)?t.isNullOrUndefined(e.FalseCount)?t.isNullOrUndefined(e.Custom)?void 0:e.Custom:e.FalseCount:e.TrueCount:e.Count:e.Min:e.Max:e.Average:e.Sum},i.prototype.setColumnProperties=function(e,r,i,n,o){for(var s=n.groupSettings.columns.length?n.groupSettings.columns.length-1:0,a=0;a<s;a++)r.columns.getColumn(a).width=20;for(a=0;a<e.length;a++)t.isNullOrUndefined(e[parseInt(a.toString(),10)].textAlign)||(r.columns.getColumn(a+s).format=this.getHorizontalAlignment(e[parseInt(a.toString(),10)].textAlign)),r.style.allowHorizontalOverflow&&!t.isNullOrUndefined(e[parseInt(a.toString(),10)].width)&&o&&(r.columns.getColumn(a+s).width="number"==typeof e[parseInt(a.toString(),10)].width?.75*e[parseInt(a.toString(),10)].width:.75*i.getConvertedWidth(e[parseInt(a.toString(),10)].width))},i.prototype.setRecordThemeStyle=function(e,r){if(t.isNullOrUndefined(this.gridTheme)||t.isNullOrUndefined(this.gridTheme.record))e.style.setTextBrush(new p.PdfSolidBrush(new p.PdfColor(0,0,0)));else{var i=t.isNullOrUndefined(this.gridTheme.record.fontName)?p.PdfFontFamily.Helvetica:this.getFontFamily(this.gridTheme.record.fontName),n=t.isNullOrUndefined(this.gridTheme.record.fontSize)?9.75:this.gridTheme.record.fontSize,o=this.getFontStyle(this.gridTheme.record),s=new p.PdfStandardFont(i,n,o);t.isNullOrUndefined(this.gridTheme.record.font)||(s=this.gridTheme.record.font),e.style.setFont(s);var a=new p.PdfColor;if(!t.isNullOrUndefined(this.gridTheme.record.fontColor)){var l=this.hexToRgb(this.gridTheme.record.fontColor);a=new p.PdfColor(l.r,l.g,l.b)}e.style.setTextBrush(new p.PdfSolidBrush(a))}var h=this.gridTheme&&this.gridTheme.record&&this.gridTheme.record.border?this.getBorderStyle(this.gridTheme.record.border):r;return e.style.setBorder(h),e},i.prototype.processRecord=function(r,i,n,o,s,a,l,h,d){for(var c=0,u=h.getGridRowModel(i,o,n,d);c<u.length;c++){var g=u[c];d++,this.rowIndex=d;for(var f=this.setRecordThemeStyle(s.rows.addRow(),r),m=g.cells.length,y=0;y<m;y++){var v=g.cells[parseInt(y.toString(),10)];if(v.cellType===e.CellType.Data){var C=v.column,S=C.field,b=t.isNullOrUndefined(S)?"":C.valueAccessor(S,g.data,C),w=t.isNullOrUndefined(b)?"":b,I=void 0;if(C.isForeignColumn&&C.isForeignColumn()&&(I=h.getFData(w,C),w=t.getValue(C.foreignKeyValue,I)),(O={data:g.data,value:w,column:C,style:void 0,colSpan:1,cell:T=f.cells.getCell(y)}).value="boolean"===O.column.type&&"string"==typeof O.value?O.value:this.exportValueFormatter.formatCellValue(O),this.parent.trigger("pdfQueryCellInfo",O),t.isNullOrUndefined(O.image)||(O.value=new p.PdfBitmap(O.image.base64),O.value.height=O.image.height||O.value.height,O.value.width=O.image.width||O.value.width),T.value=O.value,t.isNullOrUndefined(O.hyperLink)||(T.value=this.setHyperLink(O)),t.isNullOrUndefined(O.style)||this.processCellStyle(T,O),O.colSpan>1){y+1+O.colSpan>f.cells.count&&(O.colSpan=f.cells.count-(y+1)),T.columnSpan=O.colSpan;for(var R=1;R<T.columnSpan;R++)f.cells.getCell(y+R).value="";y+=O.colSpan-1}}}if(g.isExpand){var x=this.setRecordThemeStyle(s.rows.addRow(),r),F=this.parent.childGrid?0:a,T=x.cells.getCell(F);T.columnSpan=x.cells.count-F,T.style.cellPadding=new p.PdfPaddings(10,10,10,10),n.isPrinting=!0;var E=!t.isNullOrUndefined(l)&&l.exportType?l.exportType:"AllPages",z=this.helper.createChildGrid(n,g,E,this.gridPool),M=z.childGrid,D=z.element;M.actionFailure=h.failureHandler(this.gridPool,M,this.globalResolve);var O={childGrid:M,row:g,cell:T,exportProperties:l};this.parent.trigger("exportDetailDataBound",O),M.beforeDataBound=this.childGridCell(T,M,l),M.appendTo(D)}this.parent.notify("export-RowDataBound",{type:"pdf",rowObj:g})}return d},i.prototype.setHyperLink=function(e){var t=new p.PdfTextWebLink;return t.url=e.hyperLink.target,t.text=e.hyperLink.displayText||e.hyperLink.target,t.font=new p.PdfStandardFont(p.PdfFontFamily.Helvetica,9.75),t.brush=new p.PdfSolidBrush(new p.PdfColor(51,102,187)),t},i.prototype.childGridCell=function(e,r,i){var n=this;return function(o){return r.beforeDataBound=null,o.cancel=!0,e.value=n.processGridExport(r,o,i),r.destroy(),t.detach(r.element),n.gridPool[r.id]=!0,n.helper.checkAndExport(n.gridPool,n.globalResolve),e}},i.prototype.processCellStyle=function(e,r){if(!t.isNullOrUndefined(r.style.backgroundColor)){var i=this.hexToRgb(r.style.backgroundColor);e.style.backgroundBrush=new p.PdfSolidBrush(new p.PdfColor(i.r,i.g,i.b))}if(t.isNullOrUndefined(r.style.textAlignment)||(e.style.stringFormat=this.getHorizontalAlignment(r.style.textAlignment)),t.isNullOrUndefined(r.style.cellPadding)||(e.style.cellPadding=r.style.cellPadding),t.isNullOrUndefined(r.style.verticalAlignment)||(e.style.stringFormat=this.getVerticalAlignment(r.style.verticalAlignment,e.style.stringFormat)),!t.isNullOrUndefined(r.style.textBrushColor)){var n=this.hexToRgb(r.style.textBrushColor);e.style.textBrush=new p.PdfSolidBrush(new p.PdfColor(n.r,n.g,n.b))}if(!t.isNullOrUndefined(r.style.textPenColor)){var o=this.hexToRgb(r.style.textPenColor);e.style.textPen=new p.PdfPen(new p.PdfColor(o.r,o.g,o.b))}if(t.isNullOrUndefined(r.style.fontFamily)&&t.isNullOrUndefined(r.style.fontSize)&&t.isNullOrUndefined(r.style.bold)&&t.isNullOrUndefined(r.style.italic)&&t.isNullOrUndefined(r.style.underline)&&t.isNullOrUndefined(r.style.strikeout)||(e.style.font=this.getFont(r)),!t.isNullOrUndefined(r.style.border)){var s=new p.PdfBorders,a=r.style.border.width,l=t.isNullOrUndefined(a)||"number"!=typeof a?void 0:.75*a,h=new p.PdfColor(196,196,196);if(!t.isNullOrUndefined(r.style.border.color)){var d=this.hexToRgb(r.style.border.color);h=new p.PdfColor(d.r,d.g,d.b)}var c=new p.PdfPen(h,l);t.isNullOrUndefined(r.style.border.dashStyle)||(c.dashStyle=this.getDashStyle(r.style.border.dashStyle)),s.all=c,e.style.borders=s}t.isNullOrUndefined(r.style.paragraphIndent)||(e.style.stringFormat=new p.PdfStringFormat,e.style.stringFormat.paragraphIndent=r.style.paragraphIndent)},i.prototype.getHorizontalAlignment=function(e,t){switch(void 0===t&&(t=new p.PdfStringFormat),e){case"Right":t.alignment=p.PdfTextAlignment.Right;break;case"Center":t.alignment=p.PdfTextAlignment.Center;break;case"Justify":t.alignment=p.PdfTextAlignment.Justify;break;case"Left":t.alignment=p.PdfTextAlignment.Left}return t},i.prototype.getVerticalAlignment=function(e,t,r){switch(void 0===t&&(t=new p.PdfStringFormat,t=this.getHorizontalAlignment(r,t)),e){case"Bottom":t.lineAlignment=p.PdfVerticalAlignment.Bottom;break;case"Middle":t.lineAlignment=p.PdfVerticalAlignment.Middle;break;case"Top":t.lineAlignment=p.PdfVerticalAlignment.Top}return t},i.prototype.getFontFamily=function(e){switch(e){case"TimesRoman":return 2;case"Courier":return 1;case"Symbol":return 3;case"ZapfDingbats":return 4;default:return 0}},i.prototype.getFont=function(e){if(e.font)return e.font;var r=t.isNullOrUndefined(e.style.fontSize)?9.75:.75*e.style.fontSize,i=t.isNullOrUndefined(e.style.fontFamily)?p.PdfFontFamily.TimesRoman:this.getFontFamily(e.style.fontFamily),n=p.PdfFontStyle.Regular;return!t.isNullOrUndefined(e.style.bold)&&e.style.bold&&(n|=p.PdfFontStyle.Bold),!t.isNullOrUndefined(e.style.italic)&&e.style.italic&&(n|=p.PdfFontStyle.Italic),!t.isNullOrUndefined(e.style.underline)&&e.style.underline&&(n|=p.PdfFontStyle.Underline),!t.isNullOrUndefined(e.style.strikeout)&&e.style.strikeout&&(n|=p.PdfFontStyle.Strikeout),new p.PdfStandardFont(i,r,n)},i.prototype.getPageNumberStyle=function(e){switch(e){case"LowerLatin":return 2;case"LowerRoman":return 3;case"UpperLatin":return 4;case"UpperRoman":return 5;default:return 1}},i.prototype.setContentFormat=function(e,r){if(!t.isNullOrUndefined(e.size)){var i=.75*e.size.width,n=.75*e.size.height;if(r=new p.PdfStringFormat(p.PdfTextAlignment.Left,p.PdfVerticalAlignment.Middle),!t.isNullOrUndefined(e.style.hAlign))switch(e.style.hAlign){case"Right":r.alignment=p.PdfTextAlignment.Right;break;case"Center":r.alignment=p.PdfTextAlignment.Center;break;case"Justify":r.alignment=p.PdfTextAlignment.Justify;break;default:r.alignment=p.PdfTextAlignment.Left}return t.isNullOrUndefined(e.style.vAlign)||(r=this.getVerticalAlignment(e.style.vAlign,r)),{format:r,size:new p.SizeF(i,n)}}return null},i.prototype.getPageSize=function(e){switch(e){case"Letter":return new p.SizeF(612,792);case"Note":return new p.SizeF(540,720);case"Legal":return new p.SizeF(612,1008);case"A0":return new p.SizeF(2380,3368);case"A1":return new p.SizeF(1684,2380);case"A2":return new p.SizeF(1190,1684);case"A3":return new p.SizeF(842,1190);case"A5":return new p.SizeF(421,595);case"A6":return new p.SizeF(297,421);case"A7":return new p.SizeF(210,297);case"A8":return new p.SizeF(148,210);case"A9":return new p.SizeF(105,148);case"B0":return new p.SizeF(2836,4008);case"B1":return new p.SizeF(2004,2836);case"B2":return new p.SizeF(1418,2004);case"B3":return new p.SizeF(1002,1418);case"B4":return new p.SizeF(709,1002);case"B5":return new p.SizeF(501,709);case"Archa":return new p.SizeF(648,864);case"Archb":return new p.SizeF(864,1296);case"Archc":return new p.SizeF(1296,1728);case"Archd":return new p.SizeF(1728,2592);case"Arche":return new p.SizeF(2592,3456);case"Flsa":return new p.SizeF(612,936);case"HalfLetter":return new p.SizeF(396,612);case"Letter11x17":return new p.SizeF(792,1224);case"Ledger":return new p.SizeF(1224,792);default:return new p.SizeF(595,842)}},i.prototype.getDashStyle=function(e){switch(e){case"Dash":return 1;case"Dot":return 2;case"DashDot":return 3;case"DashDotDot":return 4;default:return 0}},i.prototype.getPenFromContent=function(e){var r=new p.PdfPen(new p.PdfColor(0,0,0));if(!t.isNullOrUndefined(e.style)&&null!==e.style&&!t.isNullOrUndefined(e.style.penColor)){var i=this.hexToRgb(e.style.penColor);r=new p.PdfPen(new p.PdfColor(i.r,i.g,i.b))}return r},i.prototype.getBrushFromContent=function(e){var r=null;if(!t.isNullOrUndefined(e.style.textBrushColor)){var i=this.hexToRgb(e.style.textBrushColor);r=new p.PdfSolidBrush(new p.PdfColor(i.r,i.g,i.b))}return r},i.prototype.hexToRgb=function(e){if(null===e||""===e||7!==e.length)throw new Error("please set valid hex value for color...");e=e.substring(1);var t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}},i.prototype.getFontStyle=function(e){var r=p.PdfFontStyle.Regular;return!t.isNullOrUndefined(e)&&e.bold&&(r|=p.PdfFontStyle.Bold),!t.isNullOrUndefined(e)&&e.italic&&(r|=p.PdfFontStyle.Italic),!t.isNullOrUndefined(e)&&e.underline&&(r|=p.PdfFontStyle.Underline),!t.isNullOrUndefined(e)&&e.strikeout&&(r|=p.PdfFontStyle.Strikeout),r},i.prototype.getBorderStyle=function(e){var r=new p.PdfBorders;if(t.isNullOrUndefined(e))r.all=new p.PdfPen(new p.PdfColor(234,234,234));else{var i=e.width,n=t.isNullOrUndefined(i)||"number"!=typeof i?void 0:.75*i,o=new p.PdfColor(196,196,196);if(!t.isNullOrUndefined(e.color)){var s=this.hexToRgb(e.color);o=new p.PdfColor(s.r,s.g,s.b)}var a=new p.PdfPen(o,n);t.isNullOrUndefined(e.dashStyle)||(a.dashStyle=this.getDashStyle(e.dashStyle)),r.all=a}return r},i.prototype.destroy=function(){},i}(),cs=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),us=function(e){function r(t,r){var i=e.call(this,t,r)||this;return i.buttonElement=i.parent.createElement("button",{}),i.unbounDiv=i.parent.createElement("div",{className:"e-unboundcelldiv",styles:"display: inline-block"}),i.childRefs=[],i.element=i.parent.createElement("TD",{className:"e-rowcell e-unboundcell",attrs:{tabindex:"-1"}}),i.parent.on(lr,i.destroyButtons,i),i.parent.on(Ar,i.destroyButtons,i),i}return cs(r,e),r.prototype.destroyButtons=function(e){for(r=0;r<this.childRefs.length;r++)this.childRefs[parseInt(r.toString(),10)]&&!this.childRefs[parseInt(r.toString(),10)].isDestroyed&&(this.childRefs[parseInt(r.toString(),10)].destroy(),this.childRefs[parseInt(r.toString(),10)].element&&(this.childRefs[parseInt(r.toString(),10)].element.innerHTML=""));if(this.childRefs=[],"refreshCommandColumn"===e.type){var t=this.parent.element.querySelectorAll(".e-unboundcell");if(t.length){for(var r=0;r<t.length;r++)t[parseInt(r.toString(),10)]&&(t[parseInt(r.toString(),10)].querySelector(".e-unboundcelldiv")&&(t[parseInt(r.toString(),10)].querySelector(".e-unboundcelldiv").innerHTML=""),t[parseInt(r.toString(),10)].innerHTML="");t=null}}else this.parent.off(lr,this.destroyButtons),this.parent.off(Ar,this.destroyButtons)},r.prototype.render=function(e,r,i,n){var o=this.element.cloneNode();if(o.appendChild(this.unbounDiv.cloneNode()),o.setAttribute("aria-label",this.localizer.getConstant("CommandColumnAria")+e.column.headerText),e.column.commandsTemplate)if(this.parent.isReact&&"string"!=typeof e.column.commandsTemplate){var s=this.parent+"commandsTemplate";e.column.getColumnTemplate()(r,this.parent,"commandsTemplate",s,null,null,o.firstElementChild),this.parent.renderTemplates()}else q(o.firstElementChild,e.column.getColumnTemplate()(r));else for(var a=0,l=e.commands;a<l.length;a++){var h=l[a];o=this.renderButton(o,h,i.index,h.uid)}return this.setAttributes(o,e,i),!this.parent.enableVirtualization&&this.parent.isEdit||n?(t.addClass([].slice.call(o.getElementsByClassName("e-edit-delete")),"e-hide"),t.removeClass([].slice.call(o.getElementsByClassName("e-save-cancel")),"e-hide")):(t.addClass([].slice.call(o.getElementsByClassName("e-save-cancel")),"e-hide"),t.removeClass([].slice.call(o.getElementsByClassName("e-edit-delete")),"e-hide")),o},r.prototype.renderButton=function(e,r,i,o){var s=this.buttonElement.cloneNode();t.attributes(s,{id:this.parent.element.id+(r.type||"")+"_"+i+"_"+o,type:"button",title:t.isNullOrUndefined(r.title)?r.buttonOption.content||this.localizer.getConstant(r.type)||r.type:r.title,"data-uid":o}),s.onclick=r.buttonOption.click,r.buttonOption.cssClass=this.parent.cssClass?r.buttonOption.cssClass+" "+this.parent.cssClass:r.buttonOption.cssClass;var a=new n.Button(r.buttonOption,s);switch(this.childRefs.push(a),a.commandType=r.type,e.firstElementChild.appendChild(a.element),r.type){case"Edit":case"Delete":t.addClass([s],["e-edit-delete","e-"+r.type.toLowerCase()+"button"]);break;case"Cancel":case"Save":t.addClass([s],["e-save-cancel","e-"+r.type.toLowerCase()+"button"])}return e},r}(xi),gs=function(){function r(e,t){this.parent=e,this.locator=t,this.initiateRender(),this.addEventListener()}return r.prototype.initiateRender=function(){this.locator.getService("cellRendererFactory").addCellRenderer(e.CellType.CommandColumn,new us(this.parent,this.locator))},r.prototype.commandClickHandler=function(e){var r=this.parent,i=t.closest(e.target,"button");if(i&&t.closest(e.target,".e-unboundcell")){for(var n,o=i.ej2_instances[0],s=o.commandType,a=i.getAttribute("data-uid"),l=r.getRowObjectFromUID(t.closest(i,"."+Zr).getAttribute("data-uid")),h=this.parent.columnModel,p=0;p<h.length;p++)if(h[parseInt(p.toString(),10)].commands)for(var d=h[parseInt(p.toString(),10)].commands,c=0;c<d.length;c++){if(d[parseInt(c.toString(),10)].uid===a&&d[parseInt(c.toString(),10)].type===s)n=d[parseInt(c.toString(),10)];else{var u=[].slice.call(t.closest(i,".e-unboundcell").querySelectorAll("button")).findIndex(function(e){return e===i});u<d.length&&d[parseInt(u.toString(),10)].type===s&&String(d[parseInt(c.toString(),10)].uid)===a&&(n=d[parseInt(u.toString(),10)])}}var g={cancel:!1,target:i,commandColumn:n,rowData:t.isNullOrUndefined(l)?void 0:l.data};this.parent.trigger("commandClick",g,function(e){if(!o.disabled&&r.editModule&&!e.cancel)switch(s){case"Edit":r.editModule.endEdit(),r.editModule.startEdit(t.closest(i,"tr"));break;case"Cancel":r.editModule.closeEdit();break;case"Save":r.editModule.endEdit();break;case"Delete":"Batch"!==r.editSettings.mode&&r.editModule.endEdit(),r.commandDelIndex=parseInt(t.closest(i,"tr").getAttribute(si),10),r.clearSelection(),r.selectRow(r.commandDelIndex,!1),r.editModule.deleteRecord(),r.commandDelIndex=void 0}})}},r.prototype.getModuleName=function(){return"commandColumn"},r.prototype.destroy=function(){this.parent.isDestroyed||this.removeEventListener()},r.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ar,this.commandClickHandler),this.parent.off(sr,this.keyPressHandler),this.parent.off(Qt,this.load),this.parent.off(lr,this.destroy))},r.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(ar,this.commandClickHandler,this),this.parent.on(sr,this.keyPressHandler,this),this.parent.on(Qt,this.load,this),this.parent.on(lr,this.destroy,this))},r.prototype.keyPressHandler=function(e){"enter"===e.action&&t.closest(e.target,".e-unboundcelldiv")&&(this.commandClickHandler(e),e.preventDefault())},r.prototype.load=function(){for(var e=this.parent.columnModel,t=0;t<e.length;t++)if(e[parseInt(t.toString(),10)].commands)for(var r=e[parseInt(t.toString(),10)].commands,i=0;i<r.length;i++)r[parseInt(i.toString(),10)].uid=N("gridcommand")},r}(),fs={header:"."+jr,content:"."+Vr,edit:".e-inline-edit",batchEdit:".e-editedbatchcell",editIcon:"e-edit",pager:".e-gridpager",delete:"e-delete",save:"e-save",cancel:"e-cancel",copy:"e-copy",pdf:"e-pdfexport",group:"e-icon-group",ungroup:"e-icon-ungroup",csv:"e-csvexport",excel:"e-excelexport",fPage:"e-icon-first",nPage:"e-icon-next",lPage:"e-icon-last",pPage:"e-icon-prev",ascending:"e-icon-ascending",descending:"e-icon-descending",groupHeader:"e-groupdroparea",touchPop:"e-gridpopup"},ms=function(){function e(e,t){this.defaultItems={},this.disableItems=[],this.hiddenItems=[],this.localeText=this.setLocaleKey(),this.parent=e,this.gridID=e.element.id,this.serviceLocator=t,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(Jt,this.enableAfterRenderMenu,this),this.parent.on(Kt,this.render,this),this.parent.on(lr,this.destroy,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Kt,this.render),this.parent.off(Jt,this.enableAfterRenderMenu),this.parent.off(lr,this.destroy),t.EventHandler.remove(this.element,"keydown",this.keyDownHandler.bind(this)))},e.prototype.keyDownHandler=function(e){"Tab"!==e.code&&9!==e.which||this.contextMenu.close(),"Escape"===e.code&&(this.contextMenu.close(),this.parent.notify("restore-Focus",{}))},e.prototype.render=function(){this.parent.element.classList.add("e-noselect"),this.l10n=this.serviceLocator.getService("localization"),this.element=this.parent.createElement("ul",{id:this.gridID+"_cmenu"}),t.EventHandler.add(this.element,"keydown",this.keyDownHandler.bind(this)),this.parent.element.appendChild(this.element);var e="#"+this.gridID;this.contextMenu=new l.ContextMenu({items:this.getMenuItems(),enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,target:e,select:this.contextMenuItemClick.bind(this),beforeOpen:this.contextMenuBeforeOpen.bind(this),onOpen:this.contextMenuOpen.bind(this),onClose:this.contextMenuOnClose.bind(this),cssClass:this.parent.cssClass?"e-grid-menu "+this.parent.cssClass:"e-grid-menu"}),this.contextMenu.appendTo(this.element)},e.prototype.enableAfterRenderMenu=function(e){e.module===this.getModuleName()&&e.enable&&(this.contextMenu&&(this.contextMenu.destroy(),t.remove(this.element),this.parent.element.classList.remove("e-noselect")),this.render())},e.prototype.getMenuItems=function(){for(var e=[],t=[],r=0,i=this.parent.contextMenuItems;r<i.length;r++){var n=i[r];"string"==typeof n&&-1!==this.getDefaultItems().indexOf(n)?-1!==n.toLocaleLowerCase().indexOf("export")?t.push(this.buildDefaultItems(n)):e.push(this.buildDefaultItems(n)):"string"!=typeof n&&e.push(n)}if(t.length>0){var o=this.buildDefaultItems("export");o.items=t,e.push(o)}return e},e.prototype.getLastPage=function(){var e=Math.floor(this.parent.pageSettings.totalRecordsCount/this.parent.pageSettings.pageSize);return this.parent.pageSettings.totalRecordsCount%this.parent.pageSettings.pageSize&&(e+=1),e},e.prototype.contextMenuOpen=function(){this.isOpen=!0},e.prototype.contextMenuItemClick=function(e){switch(this.getKeyFromId(e.item.id)){case"AutoFitAll":this.parent.autoFitColumns([]);break;case"AutoFit":this.parent.autoFitColumns(this.targetColumn.field);break;case"Group":this.parent.groupColumn(this.targetColumn.field);break;case"Ungroup":this.parent.ungroupColumn(this.targetColumn.field);break;case"Edit":this.parent.editModule&&("Batch"===this.parent.editSettings.mode?this.row&&this.cell&&!isNaN(parseInt(this.cell.getAttribute(oi),10))&&this.parent.editModule.editCell(parseInt(this.row.getAttribute(si),10),this.parent.getColumns()[parseInt(this.cell.getAttribute(oi),10)].field):(this.parent.editModule.endEdit(),this.parent.editModule.startEdit(this.row)));break;case"Delete":this.parent.editModule&&("Batch"!==this.parent.editSettings.mode&&this.parent.editModule.endEdit(),1===this.parent.getSelectedRecords().length?this.parent.editModule.deleteRow(this.row):this.parent.deleteRecord());break;case"Save":this.parent.editModule&&this.parent.editModule.endEdit();break;case"Cancel":this.parent.editModule&&this.parent.editModule.closeEdit();break;case"Copy":this.parent.copy();break;case"PdfExport":this.parent.pdfExport();break;case"ExcelExport":this.parent.excelExport();break;case"CsvExport":this.parent.csvExport();break;case"SortAscending":this.isOpen=!1,this.parent.sortColumn(this.targetColumn.field,"Ascending");break;case"SortDescending":this.isOpen=!1,this.parent.sortColumn(this.targetColumn.field,"Descending");break;case"FirstPage":this.parent.goToPage(1);break;case"PrevPage":this.parent.goToPage(this.parent.pageSettings.currentPage-1);break;case"LastPage":this.parent.goToPage(this.getLastPage());break;case"NextPage":this.parent.goToPage(this.parent.pageSettings.currentPage+1)}e.column=this.targetColumn,e.rowInfo=this.targetRowdata,this.parent.trigger("contextMenuClick",e)},e.prototype.contextMenuOnClose=function(e){e.items.length>0&&e.items[0].parentObj instanceof l.ContextMenu&&this.updateItemStatus(),this.parent.notify("select-row-on-context-open",{isOpen:!1})},e.prototype.getLocaleText=function(e){return this.l10n.getConstant(this.localeText[""+e])},e.prototype.updateItemStatus=function(){this.contextMenu.showItems(this.hiddenItems),this.contextMenu.enableItems(this.disableItems),this.hiddenItems=[],this.disableItems=[],this.isOpen=!1},e.prototype.contextMenuBeforeOpen=function(e){var r=t.closest(e.event.target,".e-grid");if(e.event&&r&&r!==this.parent.element)e.cancel=!0;else if(e.event&&(t.closest(e.event.target,"."+fs.groupHeader)||t.closest(e.event.target,"."+fs.touchPop)||t.closest(e.event.target,".e-summarycell")||t.closest(e.event.target,".e-groupcaption")||t.closest(e.event.target,".e-filterbarcell")))e.cancel=!0;else{this.targetColumn=this.getColumn(e.event),O(e.event.target,"e-grid")&&(this.targetRowdata=this.parent.getRowInfo(e.event.target)),t.isNullOrUndefined(e.parentItem)&&this.targetColumn&&this.targetRowdata.cell&&(this.parent.notify("select-row-on-context-open",{isOpen:!0}),this.selectRow(e.event,!this.targetRowdata.cell.classList.contains("e-selectionbackground")||"Multiple"!==this.parent.selectionSettings.type));for(var i=[],n=[],o=0,s=e.items;o<s.length;o++){var a=s[o],l=this.getKeyFromId(a.id),h=this.defaultItems[""+l];if(-1!==this.getDefaultItems().indexOf(l))if(this.ensureDisabledStatus(l)&&this.disableItems.push(a.text),e.event&&(this.ensureTarget(e.event.target,fs.edit)||this.ensureTarget(e.event.target,fs.batchEdit)))"Save"!==l&&"Cancel"!==l&&this.hiddenItems.push(a.text);else{if(this.parent.editModule&&"Batch"===this.parent.editSettings.mode&&(t.closest(e.event.target,".e-gridform")||this.parent.editModule.getBatchChanges().changedRecords.length||this.parent.editModule.getBatchChanges().addedRecords.length||this.parent.editModule.getBatchChanges().deletedRecords.length)&&("Save"===l||"Cancel"===l))continue;t.isNullOrUndefined(e.parentItem)&&e.event&&!this.ensureTarget(e.event.target,h.target)&&this.hiddenItems.push(a.text)}else a.target&&e.event&&!this.ensureTarget(e.event.target,a.target)?a.separator?i.push(a.id):this.hiddenItems.push(a.text):this.ensureTarget(e.event.target,a.target)&&a.separator&&n.push(a.id)}n.length>0&&this.contextMenu.showItems(n,!0),this.contextMenu.enableItems(this.disableItems,!1),this.contextMenu.hideItems(this.hiddenItems),i.length>0&&this.contextMenu.hideItems(i,!0),this.eventArgs=e.event,e.column=this.targetColumn,e.rowInfo=this.targetRowdata,this.parent.trigger("contextMenuOpen",e),(e.cancel||this.hiddenItems.length===e.items.length&&!e.parentItem)&&(this.updateItemStatus(),e.cancel=!0)}Re(this.parent.element,this.contextMenu.element.parentElement)},e.prototype.ensureTarget=function(e,r){var i=e;return(i=!this.ensureFrozenHeader(e)||r!==fs.header&&r!==fs.content?r===fs.content||r===fs.header?O(t.closest(e,"."+Jr),r.substr(1,r.length)):t.closest(e,r):t.closest(e,r===fs.header?"thead":li))&&O(i,"e-grid")===this.parent.element},e.prototype.ensureFrozenHeader=function(e){return!(!this.parent.isFrozenGrid()&&!this.parent.frozenRows||!t.closest(e,fs.header))},e.prototype.ensureDisabledStatus=function(e){var t=!1;switch(e){case"AutoFitAll":case"AutoFit":t=!(this.parent.ensureModuleInjected(bo)&&!this.parent.isEdit)||this.targetColumn&&!this.targetColumn.field&&"AutoFit"===e;break;case"Group":(!this.parent.allowGrouping||this.parent.ensureModuleInjected(Ro)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)>=0||this.targetColumn&&!this.targetColumn.field)&&(t=!0);break;case"Ungroup":(!this.parent.allowGrouping||!this.parent.ensureModuleInjected(Ro)||this.parent.ensureModuleInjected(Ro)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)<0)&&(t=!0);break;case"Edit":case"Delete":case"Save":case"Cancel":this.parent.editModule&&0!==this.parent.getDataRows().length||(t=!0);break;case"Copy":(0===this.parent.getSelectedRowIndexes().length&&0===this.parent.getSelectedRowCellIndexes().length||0===this.parent.getCurrentViewRecords().length)&&(t=!0);break;case"export":this.parent.allowExcelExport&&this.parent.excelExport&&(this.parent.ensureModuleInjected(ds)||this.parent.ensureModuleInjected(ps))||(t=!0);break;case"PdfExport":this.parent.allowPdfExport&&this.parent.ensureModuleInjected(ds)||(t=!0);break;case"ExcelExport":case"CsvExport":this.parent.allowExcelExport&&this.parent.ensureModuleInjected(ps)||(t=!0);break;case"SortAscending":case"SortDescending":if(!this.parent.allowSorting||!this.parent.ensureModuleInjected(Jn)||this.targetColumn&&!this.targetColumn.field)t=!0;else if(this.parent.ensureModuleInjected(Jn)&&this.parent.sortSettings.columns.length>0&&this.targetColumn)for(var r=this.parent.sortSettings.columns,i=0;i<r.length;i++)r[parseInt(i.toString(),10)].field===this.targetColumn.field&&r[parseInt(i.toString(),10)].direction.toLowerCase()===e.toLowerCase().replace("sort","").toLocaleLowerCase()&&(t=!0);break;case"FirstPage":case"PrevPage":(!this.parent.allowPaging||!this.parent.ensureModuleInjected(oo)||0===this.parent.getCurrentViewRecords().length||this.parent.ensureModuleInjected(oo)&&1===this.parent.pageSettings.currentPage)&&(t=!0);break;case"LastPage":case"NextPage":(!this.parent.allowPaging||!this.parent.ensureModuleInjected(oo)||0===this.parent.getCurrentViewRecords().length||this.parent.ensureModuleInjected(oo)&&this.parent.pageSettings.currentPage===this.getLastPage())&&(t=!0)}return t},e.prototype.getContextMenu=function(){return this.element},e.prototype.destroy=function(){var e=this.parent.element;e&&(e.querySelector("."+jr)||e.querySelector("."+Vr))&&(this.contextMenu.destroy(),this.element.parentNode&&t.remove(this.element),this.removeEventListener(),this.parent.element.classList.remove("e-noselect"))},e.prototype.getModuleName=function(){return"contextMenu"},e.prototype.generateID=function(e){return this.gridID+"_cmenu_"+e},e.prototype.getKeyFromId=function(e){return e.replace(this.gridID+"_cmenu_","")},e.prototype.buildDefaultItems=function(e){var t;switch(e){case"AutoFitAll":case"AutoFit":t={target:fs.header};break;case"Group":t={target:fs.header,iconCss:fs.group};break;case"Ungroup":t={target:fs.header,iconCss:fs.ungroup};break;case"Edit":t={target:fs.content,iconCss:fs.editIcon};break;case"Delete":t={target:fs.content,iconCss:fs.delete};break;case"Save":t={target:fs.edit,iconCss:fs.save};break;case"Cancel":t={target:fs.edit,iconCss:fs.cancel};break;case"Copy":t={target:fs.content,iconCss:fs.copy};break;case"export":t={target:fs.content};break;case"PdfExport":t={target:fs.content,iconCss:fs.pdf};break;case"ExcelExport":t={target:fs.content,iconCss:fs.excel};break;case"CsvExport":t={target:fs.content,iconCss:fs.csv};break;case"SortAscending":t={target:fs.header,iconCss:fs.ascending};break;case"SortDescending":t={target:fs.header,iconCss:fs.descending};break;case"FirstPage":t={target:fs.pager,iconCss:fs.fPage};break;case"PrevPage":t={target:fs.pager,iconCss:fs.pPage};break;case"LastPage":t={target:fs.pager,iconCss:fs.lPage};break;case"NextPage":t={target:fs.pager,iconCss:fs.nPage}}return this.defaultItems[""+e]={text:this.getLocaleText(e),id:this.generateID(e),target:t.target,iconCss:t.iconCss?"e-icons "+t.iconCss:""},this.defaultItems[""+e]},e.prototype.getDefaultItems=function(){return["AutoFitAll","AutoFit","Group","Ungroup","Edit","Delete","Save","Cancel","Copy","export","PdfExport","ExcelExport","CsvExport","SortAscending","SortDescending","FirstPage","PrevPage","LastPage","NextPage"]},e.prototype.setLocaleKey=function(){return{AutoFitAll:"autoFitAll",AutoFit:"autoFit",Copy:"Copy",Group:"Group",Ungroup:"Ungroup",Edit:"EditRecord",Delete:"DeleteRecord",Save:"Save",Cancel:"CancelButton",PdfExport:"Pdfexport",ExcelExport:"Excelexport",CsvExport:"Csvexport",export:"Export",SortAscending:"SortAscending",SortDescending:"SortDescending",FirstPage:"FirstPage",LastPage:"LastPage",PrevPage:"PreviousPage",NextPage:"NextPage"}},e.prototype.getColumn=function(e){var r=t.closest(e.target,"th.e-headercell");if(r){var i=r.querySelector(".e-headercelldiv, .e-stackedheadercelldiv").getAttribute("e-mappinguid");return this.parent.getColumnByUid(i)}return this.parent.getRowInfo(e.target).column||null},e.prototype.selectRow=function(e,r){this.cell=e.target,this.row=t.closest(e.target,"tr.e-row")||this.row,this.row&&r&&!O(e.target,"e-gridpager")&&this.parent.selectRow(parseInt(this.row.getAttribute(si),10))},e}(),ys=function(){function e(e){this.parent=e,this.rowModelGenerator=new mi(this.parent)}return e.prototype.generateRows=function(e,t,r){var i;if(i=t.renderFrozenRightContent||t.renderMovableContent&&!this.parent.enableVirtualization?"frozen-right":t.renderMovableContent||t.isFrozen?"movable":this.parent.getFrozenLeftCount()?"frozen-left":"frozen-right","virtualscroll"===t.requestType&&"X"===t.virtualInfo.sentinelInfo.axis&&"movable"!==i)return null;for(var n=this.parent.enableVirtualization&&!t.isFrozenRowsRender?r:this.rowModelGenerator.generateRows(e,t),o=0,s=n.length;o<s;o++)n[parseInt(o.toString(),10)].cells=Pe(this.parent,n[parseInt(o.toString(),10)].cells,i);return n},e}(),vs=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Cs=function(e){function r(t,r){var i=e.call(this,t,r)||this;return i.isInitialRender=!0,i.widthService=r.getService("widthService"),i.addEventListener(),i}return vs(r,e),r.prototype.addEventListener=function(){this.parent.addEventListener(Nt,this.actionComplete.bind(this)),this.parent.addEventListener("batchAdd",this.batchAdd.bind(this)),this.parent.on("batchCancel",this.batchAdd.bind(this)),this.parent.addEventListener("batchDelete",this.batchAdd.bind(this)),this.parent.on("set-height-to-frozen-element",this.refreshScrollOffset),this.parent.on(hr,this.widthService.refreshFrozenScrollbar,this)},r.prototype.batchAdd=function(e){var t="batchCancel"!==e.name&&!(this.parent.frozenRows&&"Top"===this.parent.editSettings.newRowPosition);if("auto"!==this.parent.height&&(t||"batchCancel"===e.name||"batchDelete"===e.name)){this.refreshScrollOffset();var r=this.getTable().offsetHeight;"add"===e.name&&"Bottom"===this.parent.editSettings.newRowPosition&&this.parent.getContent().firstChild.scroll(0,r)}},r.prototype.setHeightToContent=function(e){this.getFrozenContent().style.height=e.toString()+"px",this.getMovableContent().style.height=e.toString()+"px"},r.prototype.actionComplete=function(e){if("Dialog"!==this.parent.editSettings.mode&&("add"===e.requestType||"cancel"===e.requestType&&e.row.classList.contains(ti))&&(!this.parent.frozenRows||"Bottom"===this.parent.editSettings.newRowPosition)&&"auto"!==this.parent.height){this.refreshScrollOffset();var t=this.getTable().offsetHeight;"add"===e.requestType&&"Bottom"===this.parent.editSettings.newRowPosition&&this.parent.getContent().firstChild.scroll(0,t)}},r.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.removeEventListener(Nt,this.actionComplete),this.parent.removeEventListener("batchAdd",this.batchAdd),this.parent.off(hr,this.widthService.refreshFrozenScrollbar))},r.prototype.renderPanel=function(){e.prototype.renderPanel.call(this);var r=this.parent.element.querySelector("."+Qr),i=this.parent.element.querySelector("."+Wr);t.isNullOrUndefined(r)&&(r=this.parent.createElement("div",{className:"e-frozencontent e-frozen-left-content"}),i=this.parent.createElement("div",{className:Wr}),this.getPanel().querySelector("."+Yr).appendChild(r),this.getPanel().querySelector("."+Yr).appendChild(i),i.style.scrollbarWidth="none"),this.setFrozenContent(r),this.setMovableContent(i),t.Browser.userAgent.indexOf("Mac OS")>-1&&"safari"===t.Browser.info.name&&!this.parent.enableVirtualization&&this.getPanel().firstElementChild.classList.add("e-mac-safari")},r.prototype.renderFrozenRigthPanel=function(){e.prototype.renderPanel.call(this)},r.prototype.renderEmpty=function(r){e.prototype.renderEmpty.call(this,r),this.getMovableContent().querySelector(li).innerHTML="<tr><td></td></tr>",t.addClass([this.getMovableContent().querySelector(li).querySelector("tr")],["e-emptyrow"]),this.getFrozenContent().querySelector(".e-emptyrow").querySelector("td").colSpan=this.parent.getVisibleFrozenColumns(),this.getFrozenContent().style.borderRightWidth="0px",this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector("."+Xr).querySelector(li).innerHTML="",this.parent.getHeaderContent().querySelector("."+Kr).querySelector(li).innerHTML="")},r.prototype.renderFrozenRightEmpty=function(t){e.prototype.renderEmpty.call(this,t)},r.prototype.setFrozenContent=function(e){this.frozenContent=e},r.prototype.setMovableContent=function(e){this.movableContent=e},r.prototype.getFrozenContent=function(){return this.frozenContent},r.prototype.getMovableContent=function(){return this.movableContent},r.prototype.getModelGenerator=function(){return new ys(this.parent)},r.prototype.renderFrozenRightTable=function(){e.prototype.renderTable.call(this)},r.prototype.renderTable=function(){var r;null==this.getFrozenContent().querySelector("."+Jr)?(e.prototype.renderTable.call(this),this.getFrozenContent().appendChild(this.getTable()),r=this.getTable().cloneNode(!0),this.getMovableContent().appendChild(r)):(this.setTable(this.getFrozenContent().querySelector("."+Jr)),this.setColGroup(this.parent.element.querySelector("."+jr).querySelector(hi).cloneNode(!0)),this.getFrozenContent().querySelector("."+Jr).appendChild(this.getColGroup()),r=this.getMovableContent().querySelector("."+Jr),this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont")),this.getMovableContent().querySelector(hi)&&t.remove(this.getMovableContent().querySelector(hi));var i=this.parent.getHeaderContent().querySelector("."+Kr).querySelector(hi).cloneNode(!0);r.insertBefore(i,r.querySelector(li));var n=this.parent.enableVirtualization?"":"flex";this.getPanel().firstChild.style.display=n,this.renderHorizontalScrollbar("e-frozenscrollbar e-frozen-left-scrollbar",this.getScrollbarDisplay())},r.prototype.getScrollbarDisplay=function(){var e="";return(this.parent.getFrozenColumns()&&!this.parent.getVisibleFrozenColumns()||this.parent.getFrozenLeftColumnsCount()&&!this.parent.getVisibleFrozenLeftCount())&&(e="none"),e},r.prototype.renderHorizontalScrollbar=function(e,t,r){var i=this.parent.createElement("div",{className:e,styles:"display:"+t}),n=this.parent.createElement("div",{className:"e-movablescrollbar"}),o=this.parent.createElement("div",{className:"e-movablechild"}),s=j().toString();this.setScrollbarHeight(n,s),this.setScrollbarHeight(o,s),n.appendChild(o),this.appendScrollbar(i,n,r)},r.prototype.appendScrollbar=function(e,t,r){var i=this.parent.createElement("div",{className:"e-scrollbar",styles:"display: flex"});i.appendChild(e),i.appendChild(t),this.parent.getContent().appendChild(i)},r.prototype.setScrollbarHeight=function(e,t){e.style.minHeight=t+"px",e.style.maxHeight=t+"px"},r.prototype.setIsFrozen=function(e,t){e.isFrozen=!e.isFrozen},r.prototype.setTbody=function(e,r){var i;t.isNullOrUndefined(e[0].cells[0])&&(this.getMovableContent().querySelector(li).innerHTML="");var n=e[0].cells[0],o=n.index;return t.isUndefined(o)&&this.parent.isRowDragable()&&(o=(n=e[0].cells[1]).index),0===o&&(this.getPanel().firstChild.style.overflowX="hidden",this.parent.enableColumnVirtualization&&(this.getMovableContent().style.overflowX="hidden")),this.parent.enableColumnVirtualization&&r.renderMovableContent&&"virtualscroll"===r.requestType&&this.getMovableContent().scrollLeft>0&&0!==r.virtualInfo.columnIndexes[0]&&(o=this.parent.getFrozenColumns()),n&&n.column&&(i=n.column.getFreezeTableName()),this.setIdx(o),r.tableName=i,i},r.prototype.splitRows=function(e){e===ni?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):this.movableRows=this.rows},r.prototype.renderNextFrozentPart=function(e,r){var i=this.parent.enableVirtualization;r===ni&&(i&&(e.renderMovableContent=!0),this.refreshContentRows(t.extend({},e)))},r.prototype.appendContent=function(e,r,i,n){this.parent.isReact&&!t.isNullOrUndefined(this.parent.rowTemplate)?e=r:e.appendChild(r),n===ni?(this.isLoaded=!1,this.getFrozenContent().querySelector("table").appendChild(e)):(this.refreshTbody(e),this.isLoaded=!0,this.getMovableContent().querySelector("table").appendChild(e),this.refreshHeight(),this.refreshScrollOffset(),this.widthService.refreshFrozenScrollbar()),this.isInitialRender&&(this.parent.scrollModule.setHeight(),this.isInitialRender=!1)},r.prototype.refreshScrollOffset=function(){if("auto"!==this.parent.height){var e=this.getTable().offsetHeight+1;this.setHeightToContent(e)}this.parent.notify("refresh-frozen-height",{})},r.prototype.getFrozenHeader=function(e){return e===ni?this.parent.getHeaderContent().querySelector("."+Xr).querySelector(li):this.parent.getHeaderContent().querySelector("."+Kr).querySelector(li)},r.prototype.refreshTbody=function(e){e.childElementCount<1&&e.appendChild(this.parent.createElement("tr").appendChild(this.parent.createElement("td")))},r.prototype.refreshHeight=function(){this.parent.allowTextWrap||this.parent.notify(wr,{case:"refreshHeight"}),this.getFrozenContent().style.borderRightWidth="1px"},r.prototype.setIdx=function(e){this.idx=e},r.prototype.getIdx=function(){return this.idx},r.prototype.getTbody=function(e){return e===ni?this.getTable().querySelector(li):this.getMovableContent().querySelector(li)},r}(Ii),Ss=function(e){function r(t,r){var i=e.call(this,t,r)||this;return i.addEventListener(),i}return vs(r,e),r.prototype.addEventListener=function(){this.eventHandler=[{event:wr,handler:this.refreshFreeze},{event:"frozenHeight",handler:this.setFrozenHeight},{event:Jt,handler:this.enableAfterRender}],Ze(this.parent,this.eventHandler,!0,this)},r.prototype.removeEventListener=function(){this.parent.isDestroyed||Ze(this.parent,this.eventHandler,!1)},r.prototype.renderTable=function(){e.prototype.renderTable.call(this),this.rfshMovable(),this.updateColgroup(),this.initializeHeaderDrag(),this.initializeHeaderDrop(),this.parent.notify(rr,{rows:this.rows,args:{isFrozen:!1}})},r.prototype.renderPanel=function(){var r=this.parent.element.querySelector("."+Xr),i=this.parent.element.querySelector("."+Kr);e.prototype.renderPanel.call(this),t.isNullOrUndefined(r)&&(r=this.parent.createElement("div",{className:"e-frozenheader e-frozen-left-header"}),i=this.parent.createElement("div",{className:Kr}),this.getPanel().querySelector("."+_r).appendChild(r),this.getPanel().querySelector("."+_r).appendChild(i)),this.setFrozenHeader(r),this.setMovableHeader(i)},r.prototype.renderFrozenRightPanel=function(){e.prototype.renderPanel.call(this)},r.prototype.renderFrozenRightTable=function(){e.prototype.renderTable.call(this)},r.prototype.refreshUI=function(){var r=this.getMovableHeader().querySelector(li);t.remove(this.getMovableHeader().querySelector("table")),e.prototype.refreshUI.call(this),this.rfshMovable(),this.getMovableHeader().querySelector(li).innerHTML=r.innerHTML,this.updateColgroup(),this.widthService.setWidthToColumns(),this.parent.enableVirtualization||this.parent.isFrozenGrid()||this.widthService.setWidthToTable(),this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&J([].slice.call(this.movableHeader.querySelectorAll("tr.e-columnheader")),!0),this.parent.updateDefaultCursor(),ce(this.parent.getContentTable().querySelector(hi),this.parent.getFrozenColumns(),this.parent),this.widthService.refreshFrozenScrollbar(),this.initializeHeaderDrag(),this.parent.notify(rr,{rows:this.rows,args:{isFrozen:!1}})},r.prototype.refreshFrozenLeftUI=function(){e.prototype.refreshUI.call(this)},r.prototype.rfshMovable=function(){this.getFrozenHeader().appendChild(this.getTable()),this.getMovableHeader().appendChild(this.createHeader(void 0,"movable")),this.refreshStackedHdrHgt(),this.addMovableFirstCls()},r.prototype.addMovableFirstCls=function(){if(this.parent.getVisibleFrozenColumns())for(var e=[].slice.call(this.parent.element.querySelector("."+Kr).querySelector("thead").getElementsByClassName("e-columnheader")),r=e.length,i=0;i<r;i++){var n=e[parseInt(i.toString(),10)].cells[0];n&&(t.addClass([n],["e-movablefirst"]),e[parseInt(i.toString(),10)].cells[0].rowSpan>1&&(i+=e[parseInt(i.toString(),10)].cells[0].rowSpan-1))}},r.prototype.refreshFreeze=function(e){if("filter"===e.case){var t=this.getTable().querySelector(".e-filterbar");if(this.parent.allowFiltering&&t&&this.getMovableHeader().querySelector("thead")){this.getMovableHeader().querySelector("thead:not(.e-masked-thead)").appendChild(this.filterRenderer(t,this.parent.getFrozenColumns()));for(var r=0,i=[].slice.call(this.getMovableHeader().querySelectorAll("thead .e-filterbarcell .e-input"));r<i.length;r++){var n={element:i[r],floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0}};o.Input.bindInitialEvent(n)}}}else"textwrap"!==e.case&&"refreshHeight"!==e.case||(this.refreshHeight(e),this.parent.contentModule.refreshScrollOffset())},r.prototype.refreshHeight=function(e){var t,r,i=this.getFrozenHeader(),n=this.getMovableHeader(),o=this.parent.getContent(),s=this.parent.textWrapSettings.wrapMode,a=this.parent.getHeaderContent().querySelector("."+_r).classList;"textwrap"===e.case?(("Header"!==s||e.isModeChg)&&(t=o.querySelector("."+Qr).querySelector("tbody").childNodes,r=o.querySelector("."+Wr).querySelector("tbody").childNodes,this.setWrapHeight(t,r,e.isModeChg,!0)),"Content"===s&&this.parent.allowTextWrap?a.add("e-wrap"):a.remove("e-wrap"),"Both"===s||e.isModeChg?(t=i.querySelectorAll("tr"),r=n.querySelectorAll("tr")):(r=n.querySelector("Content"===s?li:"thead").querySelectorAll("tr"),t=i.querySelector("Content"===s?li:"thead").querySelectorAll("tr")),this.parent.getHeaderContent().getElementsByClassName("e-stackedheadercell").length||this.setWrapHeight(t,r,e.isModeChg,!1,this.colDepth>1),this.refreshStackedHdrHgt()):"refreshHeight"===e.case&&(this.setWrapHeight(o.querySelector("."+Qr).querySelectorAll("tr"),o.querySelector("."+Wr).querySelectorAll("tr"),e.isModeChg),this.parent.getHeaderContent().getElementsByClassName("e-stackedheadercell").length||this.setWrapHeight(i.querySelectorAll("tr"),n.querySelectorAll("tr"),e.isModeChg))},r.prototype.enableAfterRender=function(e){"scroll"===e.module&&this.setFrozenHeight()},r.prototype.updateResizeHandler=function(){for(var e=[].slice.call(this.parent.getHeaderContent().getElementsByClassName("e-rhandler")),t=0;t<e.length;t++)e[parseInt(t.toString(),10)].style.height=e[parseInt(t.toString(),10)].parentElement.offsetHeight+"px"},r.prototype.setWrapHeight=function(e,r,i,n,o){for(var s,a,l=this.parent.allowTextWrap,h=this.parent.textWrapSettings.wrapMode,p=this.parent.getHeaderContent().querySelector("thead"),d=this.parent.getHeaderContent().querySelector(li),c=[],u=[],g=0,f=e.length;g<f;g++)(i&&(!this.parent.rowHeight&&"e-hide"===d.className||"Header"===h&&n||"Content"===h&&p.contains(e[parseInt(g.toString(),10)])||"Header"===h&&d.contains(e[parseInt(g.toString(),10)]))||o)&&(e[parseInt(g.toString(),10)].style.height=null,r[parseInt(g.toString(),10)].style.height=null),t.isNullOrUndefined(e[parseInt(g.toString(),10)])||t.isNullOrUndefined(r[parseInt(g.toString(),10)])||(c[parseInt(g.toString(),10)]=e[parseInt(g.toString(),10)].getBoundingClientRect().height,u[parseInt(g.toString(),10)]=r[parseInt(g.toString(),10)].getBoundingClientRect().height),s=c[parseInt(g.toString(),10)],a=u[parseInt(g.toString(),10)],!t.isNullOrUndefined(e[parseInt(g.toString(),10)])&&e[parseInt(g.toString(),10)].childElementCount&&(l&&s<a||!l&&s<a||this.parent.allowResizing&&this.parent.resizeModule&&!1===this.parent.resizeModule.isFrozenColResized)&&(e[parseInt(g.toString(),10)].style.height=a+"px"),r&&!t.isNullOrUndefined(r[parseInt(g.toString(),10)])&&r[parseInt(g.toString(),10)].childElementCount&&(l&&s>a||!l&&s>a||this.parent.allowResizing&&this.parent.resizeModule&&!0===this.parent.resizeModule.isFrozenColResized)&&(r[parseInt(g.toString(),10)].style.height=s+"px");l&&"auto"!==this.parent.height&&this.setFrozenHeight()},r.prototype.setFrozenHeight=function(e){void 0===e&&(e=j());var t=this.parent.element.querySelector("."+Wr).getBoundingClientRect().height,r=this.parent.element.querySelector("."+Wr),i=this.parent.element.querySelector("."+Qr),n=this.parent.getContent().scrollWidth,o=this.parent.element.querySelector(".e-movablecontent table").scrollWidth+this.parent.getContentTable().scrollWidth;r.scrollWidth-r.clientWidth?(i.style.height=t-e+"px",i.style.borderBottom=""):(i.style.height=t+"px",(i.scrollHeight<=i.clientHeight||r.scrollHeight<=r.clientHeight)&&n===o&&this.parent.scrollModule.removePadding(),i.style.borderBottom="0px")},r.prototype.refreshStackedHdrHgt=function(){for(var e,r,i=[].slice.call(this.getFrozenHeader().getElementsByClassName("e-columnheader")),n=[].slice.call(this.getMovableHeader().getElementsByClassName("e-columnheader")),o=0,s=i.length;o<s;o++)e=this.getRowSpan(i[parseInt(o.toString(),10)]),r=this.getRowSpan(n[parseInt(o.toString(),10)]),e.min>1||this.parent.isRowDragable()&&t.isNullOrUndefined(this.parent.getFrozenVirtualHeader().querySelector(".e-stackedheadercell"))?this.updateStackedHdrRowHgt(o,e.max,i[parseInt(o.toString(),10)],n):r.min>1&&this.updateStackedHdrRowHgt(o,r.max,n[parseInt(o.toString(),10)],i);this.parent.allowResizing&&this.updateResizeHandler();for(var a=this.parent.columns,o=0,s=a.length;o<s;o++)if(this.parent.isRowDragable()&&!t.isNullOrUndefined(a[parseInt(o.toString(),10)].columns)&&t.isNullOrUndefined(this.parent.getFrozenVirtualHeader().querySelector(".e-stackedheadercell"))){var l=this.frozenHeader.querySelectorAll(".e-columnheader").length-1;this.frozenHeader.querySelectorAll(".e-columnheader")[parseInt(l.toString(),10)].remove();break}},r.prototype.getRowSpan=function(e){var t,r,i,n=e.childElementCount-1;this.parent.isRowDragable()&&"Right"===this.parent.getFrozenMode()&&e.children[parseInt(n.toString(),10)].remove();for(var o=0,s=e.childElementCount;o<s;o++)0===o&&(r=e.children[0].rowSpan),t=e.children[parseInt(o.toString(),10)].rowSpan,r=Math.min(t,r),i=Math.max(t,r);return{min:r,max:i}},r.prototype.updateStackedHdrRowHgt=function(e,t,r,i){for(var n=0,o=0;o<t;o++)n+=i[e+o].style.height?parseInt(i[e+o].style.height,10):i[e+o].offsetHeight;r.style.height=n+"px"},r.prototype.setFrozenHeader=function(e){this.frozenHeader=e},r.prototype.setMovableHeader=function(e){this.movableHeader=e},r.prototype.getFrozenHeader=function(){return this.frozenHeader},r.prototype.getMovableHeader=function(){return this.movableHeader},r.prototype.updateColgroup=function(){var e=this.getMovableHeader().querySelector("table");t.remove(this.getMovableHeader().querySelector(hi)),e.insertBefore(ce(this.getFrozenHeader().querySelector(hi),this.parent.getFrozenColumns(),this.parent),e.querySelector("thead"))},r.prototype.filterRenderer=function(e,t,r){var i=e.cloneNode(!0);i.innerHTML="";for(var n=r||this.parent.getColumns().length,o=t;o<n;o++)i.appendChild(e.removeChild(e.children[parseInt(t.toString(),10)]));return i},r}(Ri),bs=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ws=function(e){function r(t,r){var i=e.call(this,t,r)||this;return i.addEventListener(),i}return bs(r,e),r.prototype.addEventListener=function(){this.evtHandlers=[{event:wr,handler:this.refreshFreeze},{event:"refresh-frozen-columns",handler:this.refreshFrozenColumns},{event:"set-reorder-destination-element",handler:this.setReorderElement},{event:hr,handler:this.setVisible}],Ze(this.parent,this.evtHandlers,!0,this)},r.prototype.removeEventListener=function(){this.parent.isDestroyed||Ze(this.parent,this.evtHandlers,!1)},r.prototype.setReorderElement=function(e){this.destEle=e.ele},r.prototype.refreshFrozenColumns=function(e){e.parent||this.parent.setProperties({columns:e.columns},!0);var t=O(this.destEle,"e-frozen-left-header"),r=O(this.destEle,"e-frozen-right-header"),i=this.parent.getFrozenLeftColumnsCount(),n=this.parent.getFrozenRightColumnsCount();e.column.freeze=null,t?e.column.freeze="Left":r&&(e.column.freeze="Right"),this.parent.setFrozenCount(),e.cancel=i!==this.parent.getFrozenLeftColumnsCount()||n!==this.parent.getFrozenRightColumnsCount(),e.cancel&&this.parent.refreshColumns()},r.prototype.setWrapHeight=function(e,r,i,n,o,s){for(var a,l,h,p=this.parent.allowTextWrap,d=this.parent.getHeaderContent().querySelector(li),c=this.parent.textWrapSettings.wrapMode,u=this.parent.getHeaderContent().querySelector("thead"),g=[],f=[],m=[],y=0,v=e.length;y<v;y++)t.isNullOrUndefined(e[parseInt(y.toString(),10)])||t.isNullOrUndefined(r[parseInt(y.toString(),10)])||(s&&(m[parseInt(y.toString(),10)]=s[parseInt(y.toString(),10)].getBoundingClientRect().height),f[parseInt(y.toString(),10)]=r[parseInt(y.toString(),10)].getBoundingClientRect().height,g[parseInt(y.toString(),10)]=e[parseInt(y.toString(),10)].getBoundingClientRect().height);for(var y=0,v=e.length;y<v;y++){(i&&("Content"===c&&u.contains(e[parseInt(y.toString(),10)])||"Header"===c&&d.contains(e[parseInt(y.toString(),10)])||"Header"===c&&n)||o)&&(!t.isNullOrUndefined(s)&&s[parseInt(y.toString(),10)]&&(s[parseInt(y.toString(),10)].style.height=null),e[parseInt(y.toString(),10)].style.height=null,r[parseInt(y.toString(),10)].style.height=null),a=g[parseInt(y.toString(),10)],l=f[parseInt(y.toString(),10)],h=m[parseInt(y.toString(),10)]?m[parseInt(y.toString(),10)]:0;var C=Math.max(a,l,h);!t.isNullOrUndefined(e[parseInt(y.toString(),10)])&&e[parseInt(y.toString(),10)].childElementCount&&(p&&a<C||!p&&a<C||this.parent.allowResizing&&this.parent.resizeModule&&!1===this.parent.resizeModule.isFrozenColResized)&&(e[parseInt(y.toString(),10)].style.height=C+"px"),r&&!t.isNullOrUndefined(r[parseInt(y.toString(),10)])&&r[parseInt(y.toString(),10)].childElementCount&&(p&&C>l||!p&&C>l||this.parent.allowResizing&&this.parent.resizeModule&&!0===this.parent.resizeModule.isFrozenColResized)&&(r[parseInt(y.toString(),10)].style.height=C+"px"),s&&!t.isNullOrUndefined(s[parseInt(y.toString(),10)])&&s[parseInt(y.toString(),10)].childElementCount&&(p&&C>h||!p&&C>h||this.parent.allowResizing&&this.parent.resizeModule&&!0===this.parent.resizeModule.isFrozenColResized)&&(s[parseInt(y.toString(),10)].style.height=C+"px")}p&&this.setFrozenHeight()},r.prototype.refreshHeight=function(e){var t,r,i,n=this.parent.getFrozenMode()===ri,o=this.getFrozenRightHeader(),s=this.parent.getHeaderContent().querySelector("."+Xr),a=this.parent.getContent(),l=this.getMovableHeader(),h=this.parent.getHeaderContent().querySelector("."+_r).classList,p=this.parent.textWrapSettings.wrapMode;"textwrap"===e.case?(("Header"!==p||e.isModeChg)&&(n&&(r=a.querySelector(".e-frozen-right-content").querySelectorAll("tr")),i=a.querySelector("."+Wr).querySelectorAll("tr"),t=a.querySelector("."+Qr).querySelectorAll("tr"),this.setWrapHeight(t,i,e.isModeChg,!0,!1,r)),"Content"===p&&this.parent.allowTextWrap?h.add("e-wrap"):h.remove("e-wrap"),"Both"===p||e.isModeChg?(n&&(r=o.querySelectorAll("tr")),t=s.querySelectorAll("tr"),i=l.querySelectorAll("tr")):(n&&(r=o.querySelector("Content"===p?li:"thead").querySelectorAll("tr")),t=s.querySelector("Content"===p?li:"thead").querySelectorAll("tr"),i=l.querySelector("Content"===p?li:"thead").querySelectorAll("tr")),this.parent.getHeaderContent().getElementsByClassName("e-stackedheadercell").length||this.setWrapHeight(t,i,e.isModeChg,!1,this.colDepth>1,r),this.refreshStackedHdrHgt()):"refreshHeight"===e.case&&(i=a.querySelector("."+Wr).querySelectorAll("tr"),t=a.querySelector("."+Qr).querySelectorAll("tr"),n&&(r=a.querySelector(".e-frozen-right-content").querySelectorAll("tr")),this.setWrapHeight(t,i,e.isModeChg,!1,!1,r),this.parent.getHeaderContent().getElementsByClassName("e-stackedheadercell").length||(n&&(r=o.querySelectorAll("tr")),t=s.querySelectorAll("tr"),i=l.querySelectorAll("tr"),this.setWrapHeight(t,i,e.isModeChg,!1,!1,r)))},r.prototype.setVisible=function(e){for(var r,i,n=this.parent,o=this.parent.getFrozenLeftColumnsCount(),s=this.parent.getFrozenRightColumnsCount(),a=this.parent.getMovableColumnsCount(),l=0,h=e.length;l<h;l++){var p=e[parseInt(l.toString(),10)];if(i=n.getNormalizedColumnIndex(p.uid),r=p.visible?"":"none","Left"===p.freeze||"Right"===p.freeze){if(o&&!s){var d=n.getHeaderContent().querySelector(".e-frozen-left-header").querySelector(hi);t.setStyleAttribute(d.children[parseInt(i.toString(),10)],{display:r})}else if(!o&&s){var c=n.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(hi);t.setStyleAttribute(c.children[i-a],{display:r})}}else{var u=n.getHeaderContent().querySelector("."+Kr).querySelector(hi);t.setStyleAttribute(u.children[i-o],{display:r})}}this.refreshUI()},r.prototype.filterRenderer=function(t,r,i){return e.prototype.filterRenderer.call(this,t,r,i)},r.prototype.refreshUI=function(){var r,i=this.getMovableHeader().querySelector(li);t.remove(this.getMovableHeader().querySelector("table")),this.parent.getFrozenMode()===ri&&(r=this.getFrozenRightHeader().querySelector(li),t.remove(this.getFrozenRightHeader().querySelector("table"))),e.prototype.refreshFrozenLeftUI.call(this),this.rfshMovable(),this.getMovableHeader().querySelector(li).innerHTML=i.innerHTML,r&&(this.getFrozenRightHeader().querySelector(li).innerHTML=r.innerHTML),this.updateColgroup(),this.widthService.setWidthToColumns(),this.parent.notify(tr,{}),this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&J([].slice.call(this.getMovableHeader().querySelectorAll("tr.e-columnheader")),!0),this.parent.updateDefaultCursor();var n=this.parent.getContent().querySelector("."+Wr).querySelector("."+Jr);t.remove(n.querySelector(hi));var o=this.getMovableHeader().querySelector(hi).cloneNode(!0);if(n.insertBefore(o,n.querySelector(li)),r){var s=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector("."+Jr);t.remove(s.querySelector(hi));var a=this.getFrozenRightHeader().querySelector(hi).cloneNode(!0);s.insertBefore(a,s.querySelector(li)),this.getFrozenRightHeader().querySelector("table").style.width=s.style.width}this.widthService.refreshFrozenScrollbar(),this.initializeHeaderDrag(),this.parent.notify(rr,{rows:this.rows,args:{isFrozen:!1}})},r.prototype.refreshFreeze=function(e){var t=this.parent.getFrozenLeftColumnsCount(),r=this.parent.getFrozenRightColumnsCount(),i=this.parent.getMovableColumnsCount();if("filter"===e.case){var n=this.getTable().querySelector(".e-filterbar");if(this.parent.allowFiltering&&n&&this.getMovableHeader().querySelector("thead")){var o=this.parent.isRowDragable(),s=t?o?t+1:t:0,a=t+i+(t&&o?1:0);if(this.getMovableHeader().querySelector("thead").appendChild(this.filterRenderer(n,s,a)),this.parent.getFrozenMode()===ri){var l=[].slice.call(this.getMovableHeader().querySelectorAll("thead .e-filterbarcell .e-input"));this.getFrozenRightHeader().querySelector("thead").appendChild(this.filterRenderer(n,s,s+r)),this.adjudtFilterBarCell(l)}var h=[].slice.call(this.getMovableHeader().querySelectorAll("thead .e-filterbarcell .e-input"));this.adjudtFilterBarCell(h)}}else"textwrap"!==e.case&&"refreshHeight"!==e.case||(this.refreshHeight(e),this.parent.contentModule.refreshScrollOffset())},r.prototype.updateFrozenColGroup=function(e,r){e&&!1===e.visible&&t.setStyleAttribute(r,{display:"none"})},r.prototype.adjudtFilterBarCell=function(e){for(var t=0,r=e;t<r.length;t++){var i={element:r[t],floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0}};o.Input.bindInitialEvent(i)}},r.prototype.renderPanel=function(){this.parent.getFrozenLeftColumnsCount()?(e.prototype.renderPanel.call(this),this.parent.getFrozenRightColumnsCount()&&this.renderLeftWithRightFrozenPanel()):this.renderRightFrozenPanelAlone(),this.getPanel().firstChild.style.display="flex",this.getMovableHeader().style.flex="1"},r.prototype.renderTable=function(){this.parent.getFrozenLeftColumnsCount()?e.prototype.renderTable.call(this):this.renderFrozenRightTableAlone()},r.prototype.rfshMovable=function(){if(this.parent.getFrozenLeftColumnsCount()){if(e.prototype.rfshMovable.call(this),this.parent.getFrozenRightColumnsCount()){var t=this.rows;this.getFrozenRightHeader().appendChild(this.createHeader(void 0,"frozen-right")),this.refreshStackedHdrHgt(),this.parent.notify(rr,{rows:this.rows,args:{renderFrozenRightContent:!0}}),this.rows=t}}else this.getFrozenRightHeader().appendChild(this.getTable()),this.getMovableHeader().appendChild(this.createHeader(void 0,"movable")),this.refreshStackedHdrHgt(),this.addMovableFirstCls()},r.prototype.refreshStackedHdrHgt=function(){this.parent.getFrozenLeftColumnsCount()?(e.prototype.refreshStackedHdrHgt.call(this),this.parent.getFrozenRightColumnsCount()&&this.refreshFrozenRightStackedHdrHgt()):this.refreshFrozenRightStackedHdrHgt()},r.prototype.refreshFrozenRightStackedHdrHgt=function(){for(var e,t=[].slice.call(this.getFrozenRightHeader().getElementsByClassName("e-columnheader")),r=[].slice.call(this.getMovableHeader().getElementsByClassName("e-columnheader")),i=0,n=t.length;i<n;i++)(e=this.getRowSpan(t[parseInt(i.toString(),10)])).min>1&&this.updateStackedHdrRowHgt(i,e.max,t[parseInt(i.toString(),10)],r)},r.prototype.updateColgroup=function(){this.updateMovableColGroup(),this.parent.getFrozenLeftColumnsCount()&&this.updateFrozenLeftColGroup(),this.parent.getFrozenRightColumnsCount()&&this.updateFrozenRightColGroup()},r.prototype.renderRightFrozenPanelAlone=function(){var r=this.parent.element.querySelector("."+Kr),i=this.parent.element.querySelector(".e-frozen-right-header");e.prototype.renderFrozenRightPanel.call(this),t.isNullOrUndefined(i)&&(r=this.parent.createElement("div",{className:Kr}),i=this.parent.createElement("div",{className:"e-frozenheader e-frozen-right-header"}),this.getPanel().querySelector("."+_r).appendChild(r),this.getPanel().querySelector("."+_r).appendChild(i)),e.prototype.setMovableHeader.call(this,r),this.setFrozenRightHeader(i)},r.prototype.renderLeftWithRightFrozenPanel=function(){var r=this.parent.element.querySelector(".e-frozen-right-header");e.prototype.renderFrozenRightPanel.call(this),t.isNullOrUndefined(r)&&(r=this.parent.createElement("div",{className:"e-frozenheader e-frozen-right-header"}),this.getPanel().querySelector("."+_r).appendChild(r)),this.setFrozenRightHeader(r)},r.prototype.renderFrozenRightTableAlone=function(){e.prototype.renderFrozenRightTable.call(this),this.rfshMovable(),this.updateColgroup(),this.initializeHeaderDrag(),this.initializeHeaderDrop(),this.parent.notify(rr,{rows:this.rows,args:{isFrozen:!1}})},r.prototype.updateFrozenLeftColGroup=function(){for(var e=this.getFrozenHeader().querySelector(hi).children,r=this.parent.isRowDragable()?1:0,i=this.parent.isRowDragable()?this.parent.getFrozenLeftColumnsCount()+1:this.parent.getFrozenLeftColumnsCount(),n=r;n<e.length;n++)n>=i&&(t.remove(e[parseInt(n.toString(),10)]),n--)},r.prototype.updateMovableColGroup=function(){var e=this.getMovableHeader().querySelector(hi).children;this.parent.isRowDragable()&&t.remove(e[0]);for(var r=e.length,i=this.parent.getFrozenLeftColumnsCount(),n=this.parent.getMovableColumnsCount(),o=0,s=0;s<r;s++,o++)(s<i||s>=i+n)&&(t.remove(e[parseInt(o.toString(),10)]),o--)},r.prototype.updateFrozenRightColGroup=function(){var e=this.parent.isRowDragable(),r=this.parent.getFrozenRightColumns(),i=this.getFrozenRightHeader().querySelector(hi).children;this.parent.getFrozenMode()===ri&&e&&t.remove(i[0]);for(var n=i.length,o=this.parent.getFrozenLeftColumnsCount(),s=this.parent.getMovableColumnsCount(),a=0,l=0;l<n;l++)l<o+s?t.remove(i[0]):(this.updateFrozenColGroup(r[parseInt(a.toString(),10)],i[parseInt(a.toString(),10)]),a++)},r.prototype.setFrozenRightHeader=function(e){this.frozenRightHeader=e},r.prototype.getFrozenRightHeader=function(){return this.frozenRightHeader},r}(Ss),Is=function(e){function r(t,r){var i=e.call(this,t,r)||this;return i.frzCount=0,i.isColGroupRefresh=!1,i.widthService=r.getService("widthService"),i}return bs(r,e),r.prototype.renderPanel=function(){this.parent.getFrozenLeftColumnsCount()?(e.prototype.renderPanel.call(this),this.parent.getFrozenRightColumnsCount()&&this.renderFrozenLeftWithRightPanel()):this.renderFrozenRightPanelAlone();var t=this.parent.enableVirtualization?"":"flex";this.getPanel().firstChild.style.display=t},r.prototype.renderTable=function(){if(this.parent.getFrozenLeftColumnsCount()){if(e.prototype.renderTable.call(this),this.parent.getFrozenRightColumnsCount()){this.renderFrozenLeftWithRightTable();t=this.parent.getVisibleFrozenRightCount()?"":"none";this.renderHorizontalScrollbar("e-frozenscrollbar e-frozen-right-scrollbar",t,!0)}}else{this.renderFrozenRightTableAlone();var t=this.parent.getVisibleFrozenRightCount()?"":"none";this.renderHorizontalScrollbar("e-frozenscrollbar e-frozen-right-scrollbar",t)}this.getMovableContent().style.flex="1"},r.prototype.appendScrollbar=function(e,t,r){var i=this.parent.createElement("div",{className:"e-scrollbar",styles:"display: flex"});if(this.parent.getFrozenLeftColumnsCount()){if(r)return void this.parent.getContent().querySelector(".e-scrollbar").appendChild(e);i.appendChild(e),i.appendChild(t)}else i.appendChild(t),i.appendChild(e);this.parent.getContent().appendChild(i)},r.prototype.renderFrozenRightPanelAlone=function(){this.renderFrozenRigthPanel();var r=this.parent.element.querySelector("."+Wr),i=this.parent.element.querySelector(".e-frozen-right-content");t.isNullOrUndefined(i)&&(r=this.parent.createElement("div",{className:Wr}),i=this.parent.createElement("div",{className:"e-frozencontent e-frozen-right-content"}),this.getPanel().querySelector("."+Yr).appendChild(r),this.getPanel().querySelector("."+Yr).appendChild(i)),e.prototype.setMovableContent.call(this,r),this.setFrozenRightContent(i)},r.prototype.renderFrozenLeftWithRightPanel=function(){this.renderFrozenRigthPanel();var e=this.parent.element.querySelector(".e-frozen-right-content");t.isNullOrUndefined(e)&&(e=this.parent.createElement("div",{className:"e-frozencontent e-frozen-right-content"}),this.getPanel().querySelector("."+Yr).appendChild(e)),this.setFrozenRightContent(e)},r.prototype.renderFrozenRightTableAlone=function(){var r;null==this.getFrozenRightContent().querySelector("."+Jr)?(e.prototype.renderFrozenRightTable.call(this),this.getFrozenRightContent().appendChild(this.getTable()),r=this.getTable().cloneNode(!0),this.getMovableContent().appendChild(r)):(this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont"),this.setTable(this.getFrozenRightContent().querySelector("."+Jr)),this.setColGroup(this.getFrozenRightHeaderColGroup()),r=this.getMovableContent().querySelector("."+Jr),this.getFrozenRightContent().querySelector("."+Jr).appendChild(this.getColGroup())),this.getMovableContent().querySelector(hi)&&t.remove(this.getMovableContent().querySelector(hi));var i=this.parent.getHeaderContent().querySelector("."+Kr).querySelector(hi).cloneNode(!0);r.insertBefore(i,r.querySelector(li))},r.prototype.renderFrozenLeftWithRightTable=function(){var e=this.getTable().cloneNode(!0);this.getFrozenRightContent().appendChild(e);var r=this.getFrozenRightContent().querySelector(hi);r&&t.remove(r);var i=this.getFrozenRightContent().querySelector("."+Jr);i.insertBefore(this.getFrozenRightHeaderColGroup(),i.querySelector(li))},r.prototype.renderFrozenRightEmptyRowAlone=function(r){e.prototype.renderFrozenRightEmpty.call(this,r),this.getMovableContent().querySelector(li).innerHTML="<tr><td></td></tr>",t.addClass([this.parent.getMovableContentTbody().querySelector("tr")],["e-emptyrow"]),this.getFrozenRightContent().querySelector(".e-emptyrow").querySelector("td").colSpan=this.parent.getVisibleFrozenRightCount(),this.parent.frozenRows&&(this.parent.getFrozenRightHeaderTbody().innerHTML="",this.parent.getMovableHeaderTbody().innerHTML="")},r.prototype.getFrozenHeader=function(e){return e===ni?this.parent.getHeaderContent().querySelector(".e-frozen-left-header").querySelector(li):"movable"===e?this.parent.getHeaderContent().querySelector("."+Kr).querySelector(li):this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(li)},r.prototype.renderFrozenLeftWithRightEmptyRow=function(){this.getFrozenRightContent().querySelector(li).innerHTML="<tr><td></td></tr>",t.addClass([this.getFrozenRightContent().querySelector(li).querySelector("tr")],["e-emptyrow"]),this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(li).innerHTML="")},r.prototype.setFrozenRightContent=function(e){this.frozenRigthContent=e},r.prototype.getFrozenRightContent=function(){return this.frozenRigthContent},r.prototype.getHeaderColGroup=function(){var e=this.parent.element.querySelector("."+jr).querySelector(hi).cloneNode(!0);if(!this.parent.getFrozenLeftColumnsCount()){var t=this.getFrozenRightHeaderColGroup();e=t&&this.frzCount?t.cloneNode(!0):e,this.frzCount++,this.isColGroupRefresh=!0}return e},r.prototype.getFrozenRightHeaderColGroup=function(){var e=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(hi);return e||(e=this.parent.getHeaderContent().querySelector(hi)),e.cloneNode(!0)},r.prototype.setColGroup=function(r){return this.parent.getFrozenLeftColumnsCount()?e.prototype.setColGroup.call(this,r):(r=this.isColGroupRefresh?r:this.getFrozenRightHeaderColGroup(),t.isNullOrUndefined(r)||(r.id="content-"+r.id),this.isColGroupRefresh=!1,2===this.frzCount&&(this.frzCount=0),this.colgroup=r)},r.prototype.renderEmpty=function(t){this.parent.getFrozenLeftColumnsCount()?(e.prototype.renderEmpty.call(this,t),this.getFrozenContent().querySelector(".e-emptyrow").querySelector("td").colSpan=this.parent.getVisibleFrozenLeftCount(),this.parent.getFrozenRightColumnsCount()&&this.renderFrozenLeftWithRightEmptyRow()):this.renderFrozenRightEmptyRowAlone(t),this.parent.notify(wr,{case:"refreshHeight"})},r.prototype.setHeightToContent=function(e){this.parent.getFrozenRightColumnsCount()&&(this.getFrozenRightContent().style.height=e.toString()+"px"),this.parent.getFrozenLeftColumnsCount()&&(this.getFrozenContent().style.height=e.toString()+"px"),this.getMovableContent().style.height=e.toString()+"px"},r.prototype.actionComplete=function(t){e.prototype.actionComplete.call(this,t)},r.prototype.batchAdd=function(t){e.prototype.batchAdd.call(this,t)},r.prototype.getTbody=function(e){var t;return e===ni?t=this.parent.getFrozenLeftContentTbody():"movable"===e?t=this.parent.getMovableContentTbody():e===ii&&(t=this.parent.getFrozenRightContentTbody()),t},r.prototype.setIsFrozen=function(e,t){e.isFrozen=t===ni||"Right"===this.parent.getFrozenMode()&&t===ii,e.renderFrozenRightContent=this.parent.getFrozenMode()===ri&&t===ii,e.renderMovableContent="movable"===t},r.prototype.appendContent=function(e,r,i,n){!t.isNullOrUndefined(this.parent.rowTemplate)&&this.parent.isReact?e=r:e.appendChild(r),"Left"===this.parent.getFrozenMode()?n===ni?(this.isLoaded=!1,this.getFrozenContent().querySelector("table").appendChild(e),this.refreshContentRows(t.extend({},i))):(this.refreshTbody(e),this.isLoaded=!0,this.getMovableContent().querySelector("table").appendChild(e),this.refreshHeight(),this.refreshScrollOffset()):"Right"===this.parent.getFrozenMode()?"movable"===n?(this.refreshTbody(e),this.isLoaded=!0,this.getMovableContent().querySelector("table").appendChild(e),this.refreshHeight(),this.refreshScrollOffset()):(this.isLoaded=!1,this.getFrozenRightContent().querySelector("table").appendChild(e),this.refreshContentRows(t.extend({},i))):this.parent.getFrozenMode()===ri&&(n===ni?(this.isLoaded=!1,this.getFrozenContent().querySelector("table").appendChild(e),this.refreshContentRows(t.extend({},i))):"movable"===n?(this.refreshTbody(e),this.isLoaded=!1,this.getMovableContent().querySelector("table").appendChild(e),this.refreshContentRows(t.extend({},i))):(this.isLoaded=!0,this.getFrozenRightContent().querySelector("table").appendChild(e),this.refreshHeight(),this.refreshScrollOffset())),this.isInitialRender&&(this.parent.scrollModule.setHeight(),this.isInitialRender=!1),this.widthService.refreshFrozenScrollbar()},r.prototype.refreshHeight=function(){this.parent.allowTextWrap||this.parent.notify(wr,{case:"refreshHeight"})},r.prototype.splitRows=function(e){var t=this.parent.getFrozenLeftColumnsCount(),r=this.parent.getFrozenRightColumnsCount();t&&!r?e===ni?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):this.movableRows=this.rows:!t&&r?"movable"===e?this.movableRows=this.rows:(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):t&&r&&(e===ni?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):"movable"===e?(this.movableRows=this.rows,this.movableRowElements=this.rowElements):(this.frozenRightRows=this.rows,this.frozenRightRowElements=this.rowElements))},r.prototype.getMovableRowElements=function(){return this.parent.getFrozenMode()!==ri?this.rowElements:this.movableRowElements},r.prototype.getFrozenRightRowElements=function(){return this.parent.getFrozenMode()!==ri?this.freezeRowElements:this.frozenRightRowElements},r.prototype.getFrozenRightRows=function(){return this.parent.getFrozenMode()===ri?this.parent.enableInfiniteScrolling?this.rightFreezeRows:this.frozenRightRows:this.getRows()},r.prototype.getFrozenRightRowByIndex=function(e){return t.isNullOrUndefined(e)?void 0:this.parent.getFrozenRightDataRows()[parseInt(e.toString(),10)]},r.prototype.getRows=function(){var e=this.getInfiniteRows();return e.length?e:this.freezeRows},r.prototype.getRowElements=function(){return this.freezeRowElements},r}(Cs),Rs=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),xs=function(t){function r(e,r){var i=t.call(this,e,r)||this;return i.frzRows=[],i.mvblRows=[],i.frRows=[],i.serviceLoc=r,i.eventListener("on"),i.rowModelGenerator=new mi(i.parent),i}return Rs(r,t),r.prototype.eventListener=function(e){this.parent[""+e](Mr,this.getVirtualData,this),this.parent[""+e]("set-freeze-selection",this.setFreezeSelection,this),this.parent[""+e]("refresh-virtual-frozenrows",this.refreshVirtualFrozenRows,this),this.parent.addEventListener(Nt,this.actionComplete.bind(this))},r.prototype.actionComplete=function(e){if("delete"===e.requestType&&this.parent.frozenRows)for(var t=0;t<this.parent.frozenRows;t++)Et(this,t)},r.prototype.refreshVirtualFrozenRows=function(e){var t=this,r=this.parent;if("delete"===e.requestType&&r.frozenRows){e.isFrozenRowsRender=!0;var i=r.renderModule.data.generateQuery(!0).clone();i.page(1,r.pageSettings.pageSize),r.renderModule.data.getData({},i).then(function(i){gt(e,i.result,r.getSelectedRowIndexes(),r,t.rowModelGenerator,t.serviceLoc,t.virtualRenderer,t)})}},r.prototype.getVirtualData=function(e){this.virtualRenderer.getVirtualData(e)},r.prototype.setFreezeSelection=function(e){yt(e,this.virtualRenderer)},r.prototype.renderTable=function(){this.freezeRowGenerator=new ys(this.parent),this.virtualRenderer=new Lo(this.parent,this.serviceLoc),this.virtualRenderer.header=this.serviceLoc.getService("rendererFactory").getRenderer(e.RenderType.Header).virtualHdrRenderer,t.prototype.renderTable.call(this),this.virtualRenderer.setPanel(this.parent.getContent()),this.scrollbar=this.parent.getContent().querySelector(".e-movablescrollbar");var r=this.getMovableContent(),i=this.parent.height;if(this.virtualRenderer.virtualEle.content=this.virtualRenderer.content=this.getPanel().querySelector("."+Yr),this.virtualRenderer.virtualEle.content.style.overflowX="hidden",this.virtualRenderer.virtualEle.renderFrozenWrapper(i),this.virtualRenderer.virtualEle.renderFrozenPlaceHolder(),this.parent.enableColumnVirtualization){this.virtualRenderer.virtualEle.movableContent=this.virtualRenderer.movableContent=this.getPanel().querySelector("."+Wr),this.virtualRenderer.virtualEle.renderMovableWrapper(i),this.virtualRenderer.virtualEle.renderMovablePlaceHolder();var n=r.querySelector("table");this.virtualRenderer.virtualEle.movableTable=n,this.virtualRenderer.virtualEle.movableWrapper.appendChild(n),r.appendChild(this.virtualRenderer.virtualEle.movableWrapper),r.appendChild(this.virtualRenderer.virtualEle.movablePlaceholder)}this.virtualRenderer.virtualEle.wrapper.appendChild(this.getFrozenContent()),this.virtualRenderer.virtualEle.wrapper.appendChild(r),this.virtualRenderer.virtualEle.table=this.getTable(),zt(this.parent,this.virtualRenderer,this.scrollbar,this.getMovableContent())},r.prototype.appendContent=function(e,t,r){Ct(this.virtualRenderer,this.widthService,e,t,r)},r.prototype.generateRows=function(e,t){return this.firstPageRecords||(this.firstPageRecords=e),St(this.virtualRenderer,e,t,this.freezeRowGenerator,this.parent)},r.prototype.getRowByIndex=function(e){return this.virtualRenderer.getRowByIndex(e)},r.prototype.getMovableRowByIndex=function(e){return this.virtualRenderer.getMovableVirtualRowByIndex(e)},r.prototype.collectRows=function(e){return mt(e,this.virtualRenderer,this.parent)},r.prototype.getMovableRows=function(){return this.collectRows("movable")},r.prototype.getRows=function(){return this.collectRows("frozen-left")},r.prototype.getColGroup=function(){var e=this.parent.getMovableVirtualContent();return this.isXaxis()?e.querySelector("colgroup:not(.e-masked-colgroup)"):this.colgroup},r.prototype.getReorderedFrozenRows=function(e){return bt(e,this.virtualRenderer,this.parent,this.freezeRowGenerator,this.firstPageRecords)},r.prototype.isXaxis=function(){return It(this.virtualRenderer)},r.prototype.getHeaderCells=function(){return Rt(this.virtualRenderer,this.parent)},r.prototype.getVirtualFreezeHeader=function(){return xt(this.virtualRenderer,this.parent)},r.prototype.ensureFrozenCols=function(e){return Ft(e,this.parent)},r.prototype.getRowObjectByIndex=function(e){return this.virtualRenderer.getRowObjectByIndex(e)},r.prototype.setColGroup=function(e){return Tt(e,this.virtualRenderer,this)},r}(Cs),Fs=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i.serviceLoc=r,i}return Rs(t,e),t.prototype.renderTable=function(){this.virtualHdrRenderer=new Po(this.parent,this.serviceLoc),this.virtualHdrRenderer.gen.refreshColOffsets(),this.parent.setColumnIndexesInView(this.virtualHdrRenderer.gen.getColumnIndexes(this.getPanel().querySelector("."+_r))),this.virtualHdrRenderer.virtualEle.content=this.getPanel().querySelector("."+_r),this.virtualHdrRenderer.virtualEle.renderFrozenWrapper(),this.virtualHdrRenderer.virtualEle.renderFrozenPlaceHolder(),this.parent.enableColumnVirtualization&&(this.virtualHdrRenderer.virtualEle.movableContent=this.getPanel().querySelector("."+Kr),this.virtualHdrRenderer.virtualEle.renderMovableWrapper(),this.virtualHdrRenderer.virtualEle.renderMovablePlaceHolder()),e.prototype.renderTable.call(this),this.virtualHdrRenderer.setPanel(this.parent.getHeaderContent())},t.prototype.rfshMovable=function(){this.getFrozenHeader().appendChild(this.getTable()),this.virtualHdrRenderer.virtualEle.wrapper.appendChild(this.getFrozenHeader()),this.parent.enableColumnVirtualization?this.virtualHdrRenderer.virtualEle.movableWrapper.appendChild(this.createHeader(void 0,"movable")):this.getMovableHeader().appendChild(this.createTable()),this.virtualHdrRenderer.virtualEle.wrapper.appendChild(this.getMovableHeader())},t}(Ss),Ts=function(r){function i(e,t){var i=r.call(this,e,t)||this;return i.frRows=[],i.frzRows=[],i.mvblRows=[],i.serviceLoc=t,i.eventListener("on"),i.rowModelGenerator=new mi(i.parent),i}return Rs(i,r),i.prototype.actionComplete=function(e){if("delete"===e.requestType&&this.parent.frozenRows)for(var t=0;t<this.parent.frozenRows;t++){if(!this.virtualRenderer.vgenerator.frozenRightCache[1]){this.virtualRenderer.vgenerator.frozenRightCache[1]=this.frRows.length?this.frRows:this.frzRows;break}this.virtualRenderer.vgenerator.frozenRightCache[1][parseInt(t.toString(),10)]=this.frRows.length?this.frRows[parseInt(t.toString(),10)]:this.frzRows[parseInt(t.toString(),10)],Et(this,t)}},i.prototype.eventListener=function(e){this.parent.addEventListener(Nt,this.actionComplete.bind(this)),this.parent[""+e]("refresh-virtual-frozenrows",this.refreshVirtualFrozenRows,this),this.parent[""+e](Mr,this.getVirtualData,this),this.parent[""+e]("set-freeze-selection",this.setFreezeSelection,this)},i.prototype.refreshVirtualFrozenRows=function(e){var t=this;if("delete"===e.requestType&&this.parent.frozenRows){e.isFrozenRowsRender=!0;var r=this.parent.renderModule.data.generateQuery(!0).clone();r.page(1,this.parent.pageSettings.pageSize);var i=this.parent.getSelectedRowIndexes();this.parent.renderModule.data.getData({},r).then(function(r){gt(e,r.result,i,t.parent,t.rowModelGenerator,t.serviceLoc,t.virtualRenderer,t)})}},i.prototype.setFreezeSelection=function(e){yt(e,this.virtualRenderer)},i.prototype.getVirtualData=function(e){this.virtualRenderer.getVirtualData(e)},i.prototype.renderNextFrozentPart=function(e,r){e.renderMovableContent=this.parent.getFrozenLeftCount()?r===ni:r===ii,e.renderFrozenRightContent=this.parent.getFrozenMode()===ri&&"movable"===r,(e.renderMovableContent||e.renderFrozenRightContent)&&this.refreshContentRows(t.extend({},e))},i.prototype.renderTable=function(){this.virtualRenderer=new Lo(this.parent,this.serviceLoc),this.virtualRenderer.header=this.serviceLoc.getService("rendererFactory").getRenderer(e.RenderType.Header).virtualHdrRenderer,this.freezeRowGenerator=new ys(this.parent),r.prototype.renderTable.call(this),this.virtualRenderer.setPanel(this.parent.getContent()),this.scrollbar=this.parent.getContent().querySelector(".e-movablescrollbar");var t=this.getFrozenRightContent(),i=this.getFrozenContent(),n=this.getMovableContent();"Right"===this.parent.getFrozenMode()&&(i=t),this.virtualRenderer.virtualEle.content=this.virtualRenderer.content=this.getPanel().querySelector("."+Yr),this.virtualRenderer.virtualEle.content.style.overflowX="hidden";var o=this.parent.height;this.virtualRenderer.virtualEle.renderFrozenWrapper(o),this.virtualRenderer.virtualEle.renderFrozenPlaceHolder(),this.renderVirtualFrozenLeft(i,n),this.renderVirtualFrozenRight(i,n),this.renderVirtualFrozenLeftRight(i,n,t),this.virtualRenderer.virtualEle.table=this.getTable(),zt(this.parent,this.virtualRenderer,this.scrollbar,this.getMovableContent())},i.prototype.renderVirtualFrozenLeft=function(e,t){"Left"===this.parent.getFrozenMode()&&(this.virtualRenderer.virtualEle.wrapper.appendChild(e),this.virtualRenderer.virtualEle.wrapper.appendChild(t))},i.prototype.renderVirtualFrozenRight=function(e,t){"Right"===this.parent.getFrozenMode()&&(this.virtualRenderer.virtualEle.wrapper.appendChild(t),this.virtualRenderer.virtualEle.wrapper.appendChild(e))},i.prototype.renderVirtualFrozenLeftRight=function(e,t,r){this.parent.getFrozenMode()===ri&&(this.virtualRenderer.virtualEle.wrapper.appendChild(e),this.virtualRenderer.virtualEle.wrapper.appendChild(t),this.virtualRenderer.virtualEle.wrapper.appendChild(r))},i.prototype.appendContent=function(e,t,r){Ct(this.virtualRenderer,this.widthService,e,t,r),this.refreshScrollOffset()},i.prototype.generateRows=function(e,t){return this.firstPageRecords||(this.firstPageRecords=e),St(this.virtualRenderer,e,t,this.freezeRowGenerator,this.parent)},i.prototype.getRowByIndex=function(e){return this.virtualRenderer.getRowByIndex(e)},i.prototype.getFrozenRightRowByIndex=function(e){return this.virtualRenderer.getFrozenRightVirtualRowByIndex(e)},i.prototype.collectRows=function(e){return mt(e,this.virtualRenderer,this.parent)},i.prototype.getMovableRowByIndex=function(e){return this.virtualRenderer.getMovableVirtualRowByIndex(e)},i.prototype.getFrozenRightRows=function(){return this.collectRows("frozen-right")},i.prototype.getMovableRows=function(){return this.collectRows("movable")},i.prototype.getColGroup=function(){var e=this.parent.getMovableVirtualContent();return It(this.virtualRenderer)?e.querySelector(hi):this.colgroup},i.prototype.getRows=function(){return this.collectRows("Right"===this.parent.getFrozenMode()?"frozen-right":"frozen-left")},i.prototype.getReorderedFrozenRows=function(e){return bt(e,this.virtualRenderer,this.parent,this.freezeRowGenerator,this.firstPageRecords)},i.prototype.getHeaderCells=function(){return Rt(this.virtualRenderer,this.parent)},i.prototype.isXaxis=function(){return It(this.virtualRenderer)},i.prototype.getVirtualFreezeHeader=function(){return xt(this.virtualRenderer,this.parent)},i.prototype.getRowObjectByIndex=function(e){return this.virtualRenderer.getRowObjectByIndex(e)},i.prototype.ensureFrozenCols=function(e){return Ft(e,this.parent)},i.prototype.setColGroup=function(e){return Tt(e,this.virtualRenderer,this)},i}(Is),Es=function(){function t(e,t){this.parent=e,this.locator=t,this.addEventListener()}return t.prototype.getModuleName=function(){return"freeze"},t.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(Kt,this.instantiateRenderer,this),this.parent.on(lr,this.destroy,this))},t.prototype.instantiateRenderer=function(){this.parent.log("limitation",this.getModuleName());var t=this.locator.getService("rendererFactory");this.parent.getFrozenColumns()&&(this.parent.enableColumnVirtualization?t.addRenderer(e.RenderType.Header,new Fs(this.parent,this.locator)):t.addRenderer(e.RenderType.Header,new Ss(this.parent,this.locator)),this.parent.enableVirtualization?t.addRenderer(e.RenderType.Content,new xs(this.parent,this.locator)):t.addRenderer(e.RenderType.Content,new Cs(this.parent,this.locator))),(this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount())&&(t.addRenderer(e.RenderType.Header,new ws(this.parent,this.locator)),this.parent.enableVirtualization?t.addRenderer(e.RenderType.Content,new Ts(this.parent,this.locator)):t.addRenderer(e.RenderType.Content,new Is(this.parent,this.locator)))},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Kt,this.instantiateRenderer),this.parent.off(lr,this.destroy))},t.prototype.destroy=function(){this.removeEventListener()},t}(),zs=function(){function e(e,t){this.defaultItems={},this.localeText=this.setLocaleKey(),this.disableItems=[],this.hiddenItems=[],this.isOpen=!1,this.GROUP="e-icon-group",this.UNGROUP="e-icon-ungroup",this.ASCENDING="e-icon-ascending",this.DESCENDING="e-icon-descending",this.ROOT="e-columnmenu",this.FILTER="e-icon-filter",this.POP="e-filter-popup",this.WRAP="e-col-menu",this.CHOOSER="_chooser_",this.parent=e,this.gridID=e.element.id,this.serviceLocator=t,this.addEventListener()}return e.prototype.wireEvents=function(){for(var e=this.getColumnMenuHandlers(),r=0;r<e.length;r++)t.EventHandler.add(e[parseInt(r.toString(),10)],"mousedown",this.columnMenuHandlerDown,this)},e.prototype.unwireEvents=function(){for(var e=this.getColumnMenuHandlers(),r=0;r<e.length;r++)t.EventHandler.remove(e[parseInt(r.toString(),10)],"mousedown",this.columnMenuHandlerDown)},e.prototype.destroy=function(){var e=this.parent.element;e&&(e.querySelector("."+jr)||e.querySelector("."+Vr))&&(this.columnMenu.destroy(),this.removeEventListener(),this.unwireFilterEvents(),this.unwireEvents(),this.element.parentNode&&t.remove(this.element))},e.prototype.columnMenuHandlerClick=function(e){e.target.classList.contains("e-columnmenu")&&(this.columnMenu.items=this.getItems(),this.columnMenu.dataBind(),this.isOpen&&this.headerCell!==this.getHeaderCell(e)||document.querySelector(".e-grid-menu .e-menu-parent.e-ul")?(this.columnMenu.close(),this.openColumnMenu(e)):this.isOpen?this.columnMenu.close():this.openColumnMenu(e))},e.prototype.openColumnMenuByField=function(e){this.openColumnMenu({target:this.parent.getColumnHeaderByField(e).querySelector(".e-columnmenu")})},e.prototype.afterFilterColumnMenuClose=function(){this.columnMenu&&(this.columnMenu.items=this.getItems(),this.columnMenu.dataBind(),this.columnMenu.close())},e.prototype.openColumnMenu=function(e){var t=this.parent.getContent().getClientRects()[0],r=this.parent.getHeaderContent(),n=r.getBoundingClientRect(),o={top:0,left:0};this.element.style.cssText="display:block;visibility:hidden";var s=this.element.getBoundingClientRect(),a=this.parent.element.getBoundingClientRect();this.element.style.cssText="display:none;visibility:visible",this.headerCell=this.getHeaderCell(e),this.parent.enableRtl?o=this.parent.enableStickyHeader?i.calculatePosition(this.headerCell,"left","bottom",!0):i.calculatePosition(this.headerCell,"left","bottom"):((o=this.parent.enableStickyHeader?i.calculatePosition(this.headerCell,"right","bottom",!0):i.calculatePosition(this.headerCell,"right","bottom")).left-=s.width,r.classList.contains("e-sticky")?(o.top=this.parent.element.offsetTop+n.top+n.height,n.top+n.height>t.top&&(o.top+=n.top+n.height-t.top)):this.parent.enableStickyHeader&&(o.top=this.parent.element.offsetTop+r.offsetTop+n.height),o.left+s.width+1>=a.right&&(o.left-=35)),this.columnMenu.open(o.top,o.left),e.preventDefault&&e.preventDefault(),Re(this.parent.element,this.columnMenu.element.parentElement)},e.prototype.columnMenuHandlerDown=function(){this.isOpen=!("none"===this.element.style.display||""===this.element.style.display)},e.prototype.getColumnMenuHandlers=function(){return[].slice.call(this.parent.getHeaderTable().getElementsByClassName(this.ROOT))},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(rr,this.wireEvents,this),this.parent.on(Jt,this.enableAfterRenderMenu,this),this.parent.on(Qt,this.render,this),this.isFilterItemAdded()&&this.parent.on("filterDialogCreated",this.filterPosition,this),this.parent.on(ar,this.columnMenuHandlerClick,this),this.parent.on("after-filter-column-menu-close",this.afterFilterColumnMenuClose,this),this.parent.on(sr,this.keyPressHandler,this),this.parent.on(lr,this.destroy,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(rr,this.unwireEvents),this.parent.off(Jt,this.enableAfterRenderMenu),this.parent.off(Qt,this.render),this.isFilterItemAdded()&&this.parent.off("filterDialogCreated",this.filterPosition),this.parent.off(ar,this.columnMenuHandlerClick),this.parent.on("after-filter-column-menu-close",this.afterFilterColumnMenuClose),this.parent.off(sr,this.keyPressHandler),this.parent.off(lr,this.destroy))},e.prototype.keyPressHandler=function(e){var t=this.parent;if("altDownArrow"===e.action){var r=t.focusModule.currentInfo.element;if(r&&r.classList.contains("e-headercell")){var i=t.getColumnByUid(r.firstElementChild.getAttribute("e-mappinguid"));this.openColumnMenuByField(i.field)}}},e.prototype.enableAfterRenderMenu=function(e){e.module===this.getModuleName()&&e.enable&&(this.columnMenu&&(this.columnMenu.destroy(),t.remove(this.element)),this.render())},e.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization"),this.element=this.parent.createElement("ul",{id:this.gridID+"_columnmenu",className:"e-colmenu"}),this.element.setAttribute("aria-label",this.l10n.getConstant("ColumnMenuDialogARIA")),this.parent.element.appendChild(this.element),this.columnMenu=new l.ContextMenu({cssClass:this.parent.cssClass?"e-grid-menu "+this.parent.cssClass:"e-grid-menu",enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,items:this.getItems(),select:this.columnMenuItemClick.bind(this),beforeOpen:this.columnMenuBeforeOpen.bind(this),onOpen:this.columnMenuOnOpen.bind(this),onClose:this.columnMenuOnClose.bind(this),beforeItemRender:this.beforeMenuItemRender.bind(this),beforeClose:this.columnMenuBeforeClose.bind(this)}),this.columnMenu.appendTo(this.element),this.wireFilterEvents()},e.prototype.wireFilterEvents=function(){!t.Browser.isDevice&&this.isFilterItemAdded()&&t.EventHandler.add(this.element,"mouseover",this.appendFilter,this)},e.prototype.unwireFilterEvents=function(){!t.Browser.isDevice&&this.isFilterItemAdded()&&t.EventHandler.remove(this.element,"mouseover",this.appendFilter)},e.prototype.beforeMenuItemRender=function(e){if(this.isChooserItem(e.item)){var t=this.getKeyFromId(e.item.id,this.CHOOSER),r=this.parent.columnModel.filter(function(e){return e.field===t}),i=n.createCheckBox(this.parent.createElement,!1,{label:e.item.text,checked:r[0].visible});this.parent.enableRtl&&i.classList.add("e-rtl"),this.parent.cssClass&&i.classList.add(this.parent.cssClass),e.element.innerHTML="",e.element.appendChild(i)}else e.item.id&&"Filter"===this.getKeyFromId(e.item.id)&&(e.element.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),e.element.className+="e-filter-item e-menu-caret-icon")},e.prototype.columnMenuBeforeClose=function(e){var r=e.event?t.closest(e.event.target,".e-menu-item"):null;!t.isNullOrUndefined(e.parentItem)&&"ColumnChooser"===this.getKeyFromId(e.parentItem.id)&&r&&this.isChooserItem(r)?e.cancel=!0:e.event&&(t.closest(e.event.target,"."+this.POP)||e.event.currentTarget&&e.event.currentTarget.activeElement&&O(e.event.currentTarget.activeElement,"e-filter-popup")||O(e.event.target,"e-popup")||O(e.event.target,"e-popup-wrapper"))&&!t.Browser.isDevice&&(e.cancel=!0)},e.prototype.isChooserItem=function(e){return e.id&&e.id.indexOf("_colmenu_")>=0&&-1===this.getKeyFromId(e.id,this.CHOOSER).indexOf("_colmenu_")},e.prototype.columnMenuBeforeOpen=function(e){e.column=this.targetColumn=this.getColumn(),this.parent.trigger("columnMenuOpen",e);for(var t=0,r=e.items;t<r.length;t++){var i=r[t],n=this.getKeyFromId(i.id),o=this.defaultItems[""+n];-1!==this.getDefaultItems().indexOf(n)&&this.ensureDisabledStatus(n)&&!o.hide&&this.disableItems.push(i.text),i.hide&&this.hiddenItems.push(i.text)}this.columnMenu.enableItems(this.disableItems,!1),this.columnMenu.hideItems(this.hiddenItems)},e.prototype.columnMenuOnOpen=function(e){"e-menu-parent e-ul "===e.element.className&&(e.element.offsetHeight>window.innerHeight||this.parent.element.offsetHeight>window.innerHeight)&&(e.element.style.maxHeight=.8*window.innerHeight+"px",e.element.style.overflowY="auto",this.parent.enableStickyHeader&&(e.element.style.position="fixed"))},e.prototype.ensureDisabledStatus=function(e){var t=!1;switch(e){case"Group":(!this.parent.allowGrouping||this.parent.ensureModuleInjected(Ro)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)>=0||this.targetColumn&&!this.targetColumn.allowGrouping)&&(t=!0);break;case"AutoFitAll":case"AutoFit":t=!this.parent.ensureModuleInjected(bo);break;case"Ungroup":(!this.parent.ensureModuleInjected(Ro)||this.parent.ensureModuleInjected(Ro)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)<0)&&(t=!0);break;case"SortDescending":case"SortAscending":if(this.parent.allowSorting&&this.parent.ensureModuleInjected(Jn)&&this.parent.sortSettings.columns.length>0&&this.targetColumn&&this.targetColumn.allowSorting)for(var r=this.parent.sortSettings.columns,i=0;i<r.length;i++)r[parseInt(i.toString(),10)].field===this.targetColumn.field&&r[parseInt(i.toString(),10)].direction.toLocaleLowerCase()===e.toLocaleLowerCase().replace("sort","")&&(t=!0);else(!this.parent.allowSorting||!this.parent.ensureModuleInjected(Jn)||this.parent.allowSorting&&this.targetColumn&&!this.targetColumn.allowSorting)&&(t=!0);break;case"Filter":this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&this.parent.ensureModuleInjected(Co)&&this.targetColumn&&this.targetColumn.allowFiltering?t=!1:this.parent.ensureModuleInjected(Co)&&this.parent.allowFiltering&&this.targetColumn&&(!this.targetColumn.allowFiltering||"FilterBar"===this.parent.filterSettings.type)&&(t=!0)}return t},e.prototype.columnMenuItemClick=function(e){switch(this.isChooserItem(e.item)?"ColumnChooser":this.getKeyFromId(e.item.id)){case"AutoFit":this.parent.autoFitColumns(this.targetColumn.field);break;case"AutoFitAll":this.parent.autoFitColumns([]);break;case"Ungroup":this.parent.ungroupColumn(this.targetColumn.field);break;case"Group":this.parent.groupColumn(this.targetColumn.field);break;case"SortAscending":this.parent.sortColumn(this.targetColumn.field,"Ascending");break;case"SortDescending":this.parent.sortColumn(this.targetColumn.field,"Descending");break;case"ColumnChooser":var t=this.getKeyFromId(e.item.id,this.CHOOSER),r=e.element.querySelector(".e-checkbox-wrapper .e-frame");r&&r.classList.contains("e-check")?(r.classList.remove("e-check"),this.parent.hideColumns(t,"field")):r&&(this.parent.showColumns(t,"field"),r.classList.add("e-check"));break;case"Filter":this.getFilter(e.element,e.item.id)}e.column=this.targetColumn,this.parent.trigger("columnMenuClick",e)},e.prototype.columnMenuOnClose=function(e){e.items.length>0&&e.items[0].parentObj instanceof l.ContextMenu&&(this.columnMenu.enableItems(this.disableItems,!1),this.disableItems=[],this.columnMenu.showItems(this.hiddenItems),this.hiddenItems=[],this.isFilterPopupOpen()&&this.getFilter(e.element,e.element.id,!0)),this.parent.isFrozenGrid()||this.parent.notify("restore-Focus",{})},e.prototype.getDefaultItems=function(){return["AutoFitAll","AutoFit","SortAscending","SortDescending","Group","Ungroup","ColumnChooser","Filter"]},e.prototype.getItems=function(){for(var e=[],t=0,r=this.parent.columnMenuItems?this.parent.columnMenuItems:this.getDefault();t<r.length;t++){var i=r[t];if("string"==typeof i)if("ColumnChooser"===i){var n=this.getDefaultItem(i);n.items=this.createChooserItems(),e.push(n)}else e.push(this.getDefaultItem(i));else e.push(i)}return e},e.prototype.getDefaultItem=function(e){var t={};switch(e){case"SortAscending":t={iconCss:this.ASCENDING};break;case"SortDescending":t={iconCss:this.DESCENDING};break;case"Group":t={iconCss:this.GROUP};break;case"Ungroup":t={iconCss:this.UNGROUP};break;case"Filter":t={iconCss:this.FILTER}}return this.defaultItems[""+e]={text:this.getLocaleText(e),id:this.generateID(e),iconCss:t.iconCss?"e-icons "+t.iconCss:null},this.defaultItems[""+e]},e.prototype.getLocaleText=function(e){return this.l10n.getConstant(this.localeText[""+e])},e.prototype.generateID=function(e,t){return this.gridID+"_colmenu_"+(t?t+e:e)},e.prototype.getKeyFromId=function(e,t){return e.indexOf("_colmenu_")>0&&e.replace(this.gridID+"_colmenu_"+(t||""),"")},e.prototype.getColumnMenu=function(){return this.element},e.prototype.getModuleName=function(){return"columnMenu"},e.prototype.setLocaleKey=function(){return{AutoFitAll:"autoFitAll",AutoFit:"autoFit",Group:"Group",Ungroup:"Ungroup",SortAscending:"SortAscending",SortDescending:"SortDescending",ColumnChooser:"Columnchooser",Filter:"FilterMenu"}},e.prototype.getHeaderCell=function(e){return t.closest(e.target,"th.e-headercell")},e.prototype.getColumn=function(){if(this.headerCell){var e=this.headerCell.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");return this.parent.getColumnByUid(e)}return null},e.prototype.createChooserItems=function(){for(var e=[],t=0,r=this.parent.columnModel;t<r.length;t++){var i=r[t];i.showInColumnChooser&&i.field&&e.push({id:this.generateID(i.field,this.CHOOSER),text:i.headerText?i.headerText:i.field})}return e},e.prototype.appendFilter=function(e){if(this.defaultItems.Filter){var r=this.defaultItems.Filter.id;t.closest(e.target,"#"+r)&&!this.isFilterPopupOpen()?this.getFilter(e.target,r):!t.closest(e.target,"#"+r)&&this.isFilterPopupOpen()&&this.getFilter(e.target,r,!0)}},e.prototype.getFilter=function(e,r,i){var n=this.getFilterPop();n?n.style.display=!t.Browser.isDevice&&i?"none":"block":this.parent.notify("filterOpen",{col:this.targetColumn,target:e,isClose:i,id:r})},e.prototype.setPosition=function(e,t){var r=this.parent.element.getBoundingClientRect(),i=e.getBoundingClientRect(),n=i.left-r.left,o=i.top-r.top;r.height<o?o=o-t.offsetHeight+i.height:r.height<o+t.offsetHeight&&(o=r.height-t.offsetHeight),window.innerHeight<t.offsetHeight+o+r.top&&(o=window.innerHeight-t.offsetHeight-r.top),o+r.top<0&&(o=0),n+=this.parent.enableRtl?-t.offsetWidth:i.width,r.width<=n+t.offsetWidth?(n-=i.width+t.offsetWidth,i.left<t.offsetWidth&&(n=i.left+t.offsetWidth/2)):n<0&&(n+=t.offsetWidth+i.width),t.style.top=o+"px",t.style.left=n+"px"},e.prototype.filterPosition=function(){var e=this.getFilterPop();if(e.classList.add(this.WRAP),!t.Browser.isDevice){var r=e.style.display;e.style.cssText+="display:block;visibility:hidden";var i=this.element.querySelector("."+this.FILTER);i&&(this.setPosition(i.parentElement,e),e.style.cssText+="display:"+r+";visibility:visible")}},e.prototype.getDefault=function(){var e=[];return this.parent.ensureModuleInjected(bo)&&(e.push("AutoFitAll"),e.push("AutoFit")),this.parent.allowGrouping&&this.parent.ensureModuleInjected(Ro)&&(e.push("Group"),e.push("Ungroup")),this.parent.allowSorting&&this.parent.ensureModuleInjected(Jn)&&(e.push("SortAscending"),e.push("SortDescending")),e.push("ColumnChooser"),this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&this.parent.ensureModuleInjected(Co)&&e.push("Filter"),e},e.prototype.isFilterPopupOpen=function(){var e=this.getFilterPop();return e&&"none"!==e.style.display},e.prototype.getFilterPop=function(){return t.Browser.isDevice&&null!==this.targetColumn&&"Menu"===this.parent.filterSettings.type?document.getElementById(this.targetColumn.uid+"-flmdlg"):this.parent.element.querySelector("."+this.POP)},e.prototype.isFilterItemAdded=function(){return this.parent.columnMenuItems&&this.parent.columnMenuItems.indexOf("Filter")>=0||!this.parent.columnMenuItems},e}(),Ms=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ds=function(e){function i(t,r){var i=e.call(this,t,r)||this;return i.parent=t,i.serviceLocator=r,i.initEvent(),i}return Ms(i,e),i.prototype.initEvent=function(){this.parent.isDestroyed||(this.parent.on("initForeignKeyColumn",this.initForeignKeyColumns,this),this.parent.on("getForeignKeyData",this.getForeignKeyData,this),this.parent.on("generateQuery",this.generateQueryFormData,this))},i.prototype.initForeignKeyColumns=function(e){for(var i=0;i<e.length;i++)e[parseInt(i.toString(),10)].dataSource=e[parseInt(i.toString(),10)].dataSource instanceof r.DataManager?e[parseInt(i.toString(),10)].dataSource:t.isNullOrUndefined(e[parseInt(i.toString(),10)].dataSource)?new r.DataManager:"result"in e[parseInt(i.toString(),10)].dataSource?e[parseInt(i.toString(),10)].dataSource:new r.DataManager(e[parseInt(i.toString(),10)].dataSource)},i.prototype.eventfPromise=function(e,i,n,o){var s=this.getStateEventArgument(i),a=new r.Deferred,l=new r.Deferred;s.action=e.action;var h=this.parent.getDataModule();return!t.isNullOrUndefined(e.action)&&e.action.requestType&&!1!==h.foreignKeyDataState.isDataChanged?(h.setForeignKeyDataState({isPending:!0,resolver:l.resolve}),l.promise.then(function(){a.resolve(o.dataSource)}),s.setColumnData=this.parent.setForeignKeyData.bind(this.parent),this.parent.trigger("columnDataStateChange",s)):(h.setForeignKeyDataState({}),a.resolve(n)),a},i.prototype.getForeignKeyData=function(e){for(var i=this,n=e.column?[e.column]:this.parent.getForeignKeyColumns(),o=[],s=this,a=0;a<n.length;a++)!function(t){var r=void 0,i=e.isComplex?s.genarateColumnQuery(n[parseInt(t.toString(),10)]):s.genarateQuery(n[parseInt(t.toString(),10)],e.result.result,!1,!0);i.params=s.parent.query.params;var a=n[parseInt(t.toString(),10)].dataSource;r=a&&"result"in a?s.eventfPromise(e,i,a,n[parseInt(t.toString(),10)]).promise:!a.ready||a.dataSource.offline?a.executeQuery(i):a.ready.then(function(){return a.executeQuery(i)}),o.push(r)}(a);Promise.all(o).then(function(i){for(var o=0;o<i.length;o++)n[parseInt(o.toString(),10)].columnData=i[parseInt(o.toString(),10)].result,"dropdownedit"===n[parseInt(o.toString(),10)].editType&&"result"in n[parseInt(o.toString(),10)].dataSource&&(n[parseInt(o.toString(),10)].edit.params=t.extend(n[parseInt(o.toString(),10)].edit.params,{dataSource:i[parseInt(o.toString(),10)].result,query:new r.Query,fields:{value:n[parseInt(o.toString(),10)].foreignKeyField||n[parseInt(o.toString(),10)].field,text:n[parseInt(o.toString(),10)].foreignKeyValue}}));e.promise.resolve(e.result)}).catch(function(t){return i.parent.log(["actionfailure","foreign_key_failure"]),e.promise&&e.promise.reject&&e.promise.reject(t),t})},i.prototype.generateQueryFormData=function(e){e.predicate.predicate=this.genarateQuery(e.column,e.column.columnData,!0)},i.prototype.genarateQuery=function(e,t,i,n){var o=this.parent,s=[],a=new r.Query,l=i?e.foreignKeyField:e.field;if(o.allowPaging||o.enableVirtualization||i){t=new r.DataManager(o.allowGrouping&&o.groupSettings.columns.length&&!i?t.records:t).executeLocal((new r.Query).select(l));var h=r.DataUtil.distinct(t,l,!1);l=i?e.field:e.foreignKeyField;for(var p=0;p<h.length;p++)h[parseInt(p.toString(),10)]&&h[parseInt(p.toString(),10)].getDay?s.push(de({field:l,operator:"equal",value:h[parseInt(p.toString(),10)],matchCase:!1})):s.push(new r.Predicate(l,"equal",h[parseInt(p.toString(),10)],!1))}return n?s.length?a.where(r.Predicate.or(s)):a:s.length?r.Predicate.or(s):{predicates:[]}},i.prototype.genarateColumnQuery=function(e){var t=this.parent,i=new r.Query,n=this.isFiltered(e);if(n.isTrue&&(i=this.filterQuery(i,n.column,!0)),t.searchSettings.key.length){var o=t.searchSettings;e.dataSource instanceof r.DataManager&&e.dataSource.adaptor.getModuleName&&"ODataV4Adaptor"===e.dataSource.adaptor.getModuleName()?i=this.searchQuery(i,e,!0):i.search(o.key,e.foreignKeyValue,o.operator,o.ignoreCase)}return i},i.prototype.isFiltered=function(e){var t=this.parent.filterSettings.columns.filter(function(t){return t.field===e.foreignKeyValue&&t.uid===e.uid});return{column:t,isTrue:!!t.length}},i.prototype.getModuleName=function(){return"foreignKey"},i.prototype.destroy=function(){this.destroyEvent()},i.prototype.destroyEvent=function(){this.parent.isDestroyed||(this.parent.off("initForeignKeyColumn",this.initForeignKeyColumns),this.parent.off("getForeignKeyData",this.getForeignKeyData),this.parent.off("generateQuery",this.generateQueryFormData))},i}(Br),Os="https://ej2.syncfusion.com/documentation/grid",ks="https://ej2.syncfusion.com/documentation/",As="[EJ2Grid.Warning]",Ls="[EJ2Grid.Error]",Ps="[EJ2Grid.Info]",Bs=function(){function e(e){this.parent=e,this.parent.on("initial-end",this.patchadaptor,this)}return e.prototype.getModuleName=function(){return"logger"},e.prototype.log=function(e,t){e instanceof Array||(e=[e]);for(var r=e,i=0;i<r.length;i++){var n=Ns[r[parseInt(i.toString(),10)]],o=n.check(t,this.parent);o.success&&console[n.logType](n.generateMessage(t,this.parent,o.options))}},e.prototype.patchadaptor=function(){var e=this.parent.getDataModule().dataManager.adaptor,t=e.beforeSend;t&&(e.beforeSend=function(r,i,n){t.call(e,r,i,n)})},e.prototype.destroy=function(){this.parent.isDestroyed||this.parent.off("initial-end",this.patchadaptor)},e}(),Ns={module_missing:{type:"module_missing",logType:"warn",check:function(e,t){var r=t.getInjectedModules().map(function(e){return e.prototype.getModuleName()}),i=t.requiredModules().map(function(e){return e.member}).filter(function(e){return-1===r.indexOf(e)});return{success:i.filter(function(e){return"resize"!==e}).length>0,options:i}},generateMessage:function(e,t,r){return r=r.filter(function(e){return"resize"!==e}).reduce(function(e,t){return e+"* "+t+"\n"},""),As+": MODULES MISSING\nThe following modules are not injected:.\n"+r+"Refer to "+Os+"/module.html for documentation on importing feature modules."}},promise_enabled:{type:"promise_enabled",logType:"error",check:function(){return{success:"undefined"==typeof Promise}},generateMessage:function(){return Ls+": PROMISE UNDEFINED\nPromise object is not present in the global environment,please use polyfil to support Promise object in your environment.\nRefer to "+ks+"/base/browser.html?#required-polyfills for more information."}},primary_column_missing:{type:"primary_column_missing",logType:"warn",check:function(e,t){return{success:0===t.getColumns().filter(function(e){return e.isPrimaryKey}).length}},generateMessage:function(){return As+": PRIMARY KEY MISSING\nEditing is enabled but primary key column is not specified.\nRefer to "+Os+"/api-column.html?#isprimarykey for documentation on providing primary key columns."}},selection_key_missing:{type:"selection_key_missing",logType:"warn",check:function(e,t){return{success:t.selectionSettings.persistSelection&&0===t.getColumns().filter(function(e){return e.isPrimaryKey}).length}},generateMessage:function(){return As+": PRIMARY KEY MISSING\nselectionSettings.persistSelection property is enabled. It requires one primary key column to persist selection.\nRefer to "+Os+"/api-column.html?#isprimarykey for documentation on providing primary key columns."}},actionfailure:{type:"actionfailure",logType:"error",check:function(){return{success:!0}},generateMessage:function(e,t){var r="",i=qs(e,t),n=Hs(e,t);return r=""!==n?n:""!==i?i:e.error,As+": "+r}},locale_missing:{type:"locale_missing",logType:"warn",check:function(e,i){var n=r.DataUtil.getObject("locale."+i.locale+".grid",t.L10n);return{success:"en-US"!==i.locale&&t.isNullOrUndefined(n)}},generateMessage:function(e,t){return As+": LOCALE CONFIG MISSING\nLocale configuration for '"+t.locale+"' is not provided.\nRefer to "+Os+"/globalization-and-localization.html?#localization \n             for documentation on setting locale configuration."}},limitation:{type:"limitation",logType:"warn",check:function(e,r){var i;switch(e){case"freeze":i={success:r.allowGrouping||!t.isUndefined(r.detailTemplate)||!t.isUndefined(r.childGrid)||!t.isUndefined(r.rowTemplate)||r.enableVirtualization,options:{name:"freeze"}};break;case"virtualization":i={success:!t.isUndefined(r.detailTemplate)||!t.isUndefined(r.childGrid)||0!==r.frozenRows||0!==r.frozenColumns,options:{name:"virtualization"}};break;default:i={success:!1}}return i},generateMessage:function(e,t,r){var i,n=r.name;switch(n){case"freeze":i="Frozen rows and columns do not support the following features:\n* Virtualization\n* Row Template\n* Details Template\n* Hierarchy Grid\n* Grouping";break;case"virtualization":i="Virtualization does not support the following features.\n* Freeze rows and columns.\n* Details Template.\n* Hierarchy Grid.\n";break;default:i=""}return As+": "+n.toUpperCase()+" LIMITATIONS\n"+i}},check_datasource_columns:{type:"check_datasource_columns",logType:"warn",check:function(e,t){return{success:!(t.columns.length||t.dataSource instanceof r.DataManager||t.dataSource.length)}},generateMessage:function(){return As+": GRID CONFIG MISSING\ndataSource and columns are not provided in the grid. At least one of either must be provided for grid configuration.\nRefer to "+Os+"/columns.html for documentation on configuring the grid data and columns."}},virtual_height:{type:"virtual_height",logType:"error",check:function(e,r){return{success:t.isNullOrUndefined(r.height)||"auto"===r.height}},generateMessage:function(){return Ls+": GRID HEIGHT MISSING \nheight property is required to use virtualization.\nRefer to "+Os+"/virtual.html for documentation on configuring the virtual grid."}},grid_remote_edit:{type:"grid_remote_edit",logType:"error",check:function(e){return{success:Array.isArray(e)||Array.isArray(e.result)}},generateMessage:function(){return Ls+": RETRUN VALUE MISSING  \nRemote service returns invalid data. \nRefer to "+Os+"/edit.html for documentation on configuring editing with remote data."}},grid_sort_comparer:{type:"grid_sort_comparer",logType:"warn",check:function(e,t){return{success:t.getDataModule().isRemote()}},generateMessage:function(){return As+": SORT COMPARER NOT WORKING  \nSort comparer will not work with remote data.Refer to "+Os+"/sorting/#custom-sort-comparer for documentation on using the sort comparer."}},resize_min_max:{type:"resize_min_max",logType:"info",check:function(e){return{success:e.column.minWidth&&e.column.minWidth>=e.width||e.column.maxWidth&&e.column.maxWidth<=e.width}},generateMessage:function(){return Ps+": RESIZING COLUMN REACHED MIN OR MAX  \nThe column resizing width is at its min or max."}},action_disabled_column:{type:"action_disabled_column",logType:"info",check:function(e){var r;switch(e.moduleName){case"reorder":r=t.isNullOrUndefined(e.destColumn)?"reordering action is disabled for the "+e.column.headerText+" column":"reordering action is disabled for the "+(e.column.allowReordering?e.destColumn.headerText:e.column.headerText)+" column";break;case"group":r="grouping action is disabled for the "+e.columnName+" column.";break;case"filter":r="filtering action is disabled for the "+e.columnName+" column.";break;case"sort":r="sorting action is disabled for the "+e.columnName+" column."}return{success:!0,options:{fn:r}}},generateMessage:function(e,t,r){return Ps+": ACTION DISABLED \n "+r.fn}},exporting_begin:{type:"exporting_begin",logType:"info",check:function(e){return{success:!0,options:{args:e}}},generateMessage:function(e,t,r){return Ps+": EXPORTNIG INPROGRESS \n Grid "+r.args+"ing is in progress"}},exporting_complete:{type:"exporting_complete",logType:"info",check:function(e){return{success:!0,options:{args:e}}},generateMessage:function(e,t,r){return Ps+": EXPORTNIG COMPLETED \n Grid "+r.args+"ing is complete"}},foreign_key_failure:{type:"foreign_key_failure",logType:"error",check:function(){return{success:!0}},generateMessage:function(){return Ls+": FOREIGNKEY CONFIG \n  Grid foreign key column needs a valid data source/service.Refer to "+Os+"/columns/#foreign-key-column for documentation on configuring foreign key columns."}},initial_action:{type:"initial_action",logType:"error",check:function(e){var t;switch(e.moduleName){case"group":t="The "+e.columnName+" column is not available in the grid's column model.Please provide a valid field name to group the column";break;case"filter":t="The "+e.columnName+" column is not available in the grid's column model.Please provide a valid field name to filter the column.";break;case"sort":t="The "+e.columnName+" column is not available in the grid's column model.Please provide a valid field name to sort the column."}return{success:!0,options:{fn:t}}},generateMessage:function(e,t,r){return Ls+": INITIAL ACTION FAILURE \n "+r.fn}},frozen_rows_columns:{type:"frozen_rows_columns",logType:"error",check:function(e,t){return{success:t.getColumns().length<=t.frozenColumns||t.frozenRows>=t.currentViewData.length}},generateMessage:function(e,t){return Ls+": OUT OF RANGE ERROR-\n "+(t.getColumns().length<=t.frozenColumns?"FROZEN COLUMNS,":"")+(t.frozenRows>=t.currentViewData.length?"FROZEN ROWS":"")+" invalid"}},column_type_missing:{type:"column_type_missing",logType:"error",check:function(e){return{success:t.isNullOrUndefined(e.column.type),options:e.column.headerText}},generateMessage:function(e,t,r){return Ls+": COLUMN TYPE MISSING-\n  "+r+" column type was invalid or not defined.Please go through below help link: "+ks+"/grid/columns/#column-type"}},datasource_syntax_mismatch:{type:"datasource_syntax_mismatch",logType:"warn",check:function(e){return{success:e.dataState.dataSource&&!(e.dataState.dataSource instanceof r.DataManager||"result"in e.dataState.dataSource||e.dataState.dataSource instanceof Array)&&!t.isNullOrUndefined(e.dataState.dataStateChange)}},generateMessage:function(){return As+": DATASOURCE SYNTAX WARNING\nDataSource should be in the form of {result: Object[], count: number}when dataStateChangeEvent used"}}},qs=function(e){var t=e.error;return t.indexOf&&0!==t.indexOf("Format options")?"":"INVALID FORMAT\nFor more information, refer to the following documentation links:\nNumber format: "+ks+"/base/intl.html?#supported-format-string.\nDate format: "+ks+"/base/intl.html?#manipulating-datetime.\nMessage: "+t},Hs=function(e){var i=r.DataUtil.getObject("error.error",e);if(t.isNullOrUndefined(i))return"";var n="";try{n=JSON.parse(i.responseText)}catch(e){n=""}return"XMLHTTPREQUEST FAILED\nUrl: "+i.responseURL+"\nStatus: "+i.status+" - "+i.statusText+"\n"+(""!==n?"Message: "+n:"")},Us=function(){function e(e,t){this.infiniteCache={},this.infiniteCurrentViewData={},this.infiniteFrozenCache={},this.isDownScroll=!1,this.isUpScroll=!1,this.isScroll=!0,this.enableContinuousScroll=!1,this.initialRender=!0,this.isRemove=!1,this.isInitialCollapse=!1,this.prevScrollTop=0,this.actions=["filtering","searching","grouping","ungrouping","reorder","sorting","refresh"],this.keys=[di,ci,ui,gi],this.rowTop=0,this.isInitialMovableRender=!0,this.virtualInfiniteData={},this.isCancel=!1,this.emptyRowData={},this.isNormaledit=!1,this.isInfiniteScroll=!1,this.isLastPage=!1,this.isInitialRender=!0,this.isFocusScroll=!1,this.isGroupCollapse=!1,this.parent=e,this.serviceLocator=t,this.isNormaledit="Normal"===this.parent.editSettings.mode,this.addEventListener(),this.widthService=t.getService("widthService"),this.rowModelGenerator=this.parent.isFrozenGrid()?new ys(this.parent):new mi(this.parent)}return e.prototype.getModuleName=function(){return"infiniteScroll"},e.prototype.addEventListener=function(){this.parent.on(Xt,this.onDataReady,this),this.parent.on(fr,this.dataSourceModified,this),this.parent.on("infinite-page-query",this.infinitePageQuery,this),this.parent.on("infinite-scroll-handler",this.infiniteScrollHandler,this),this.parent.on(or,this.infiniteCellFocus,this),this.parent.on("append-infinite-content",this.appendInfiniteRows,this),this.parent.on("remove-infinite-rows",this.removeInfiniteCacheRows,this),this.parent.on("reset-infinite-blocks",this.resetInfiniteBlocks,this),this.parent.on("set-infinite-cache",this.setCache,this),this.parent.on("initial-collapse",this.ensureIntialCollapse,this),this.parent.on(sr,this.infiniteCellFocus,this),this.parent.on("infinite-show-hide",this.setDisplayNone,this),this.parent.on("virtual-scroll-edit-action-begin",this.editActionBegin,this),this.parent.on(Mr,this.getVirtualInfiniteData,this),this.parent.on("edit-reset",this.resetInfiniteEdit,this),this.parent.on("virtual-scroll-edit-success",this.infiniteEditSuccess,this),this.parent.on("refresh-virtual-cache",this.refreshInfiniteCache,this),this.parent.on("refresh-infinite-editrowindex",this.refreshInfiniteEditrowindex,this),this.parent.on("infinite-edit-handler",this.infiniteEditHandler,this),this.parent.on("virtual-scroll-add-action-begin",this.infiniteAddActionBegin,this),this.parent.on(er,this.modelChanged,this),this.parent.on("refresh-infinite-current-view-data",this.refreshInfiniteCurrentViewData,this),this.parent.on(lr,this.destroy,this),this.parent.on(Yt,this.selectNewRow,this),this.parent.on("infinite-group-collapse",this.captionActionComplete,this),this.parent.on("set-virtual-page-query",this.setGroupCollapsePageQuery,this),this.actionBeginFunction=this.actionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.dataBoundFunction=this.dataBound.bind(this),this.parent.on("delete-complete",this.deleteComplate,this),this.parent.addEventListener(Bt,this.actionBeginFunction),this.parent.addEventListener(Nt,this.actionCompleteFunction),this.parent.addEventListener(qt,this.dataBoundFunction)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Xt,this.onDataReady),this.parent.off(fr,this.dataSourceModified),this.parent.off("infinite-page-query",this.infinitePageQuery),this.parent.off("infinite-scroll-handler",this.infiniteScrollHandler),this.parent.off(or,this.infiniteCellFocus),this.parent.off("append-infinite-content",this.appendInfiniteRows),this.parent.off("remove-infinite-rows",this.removeInfiniteCacheRows),this.parent.off("reset-infinite-blocks",this.resetInfiniteBlocks),this.parent.off("set-infinite-cache",this.setCache),this.parent.off("initial-collapse",this.ensureIntialCollapse),this.parent.off(sr,this.infiniteCellFocus),this.parent.off("infinite-show-hide",this.setDisplayNone),this.parent.off("virtual-scroll-edit-action-begin",this.editActionBegin),this.parent.off(Mr,this.getVirtualInfiniteData),this.parent.off("edit-reset",this.resetInfiniteEdit),this.parent.off("virtual-scroll-edit-success",this.infiniteEditSuccess),this.parent.off("refresh-virtual-cache",this.refreshInfiniteCache),this.parent.on("refresh-infinite-editrowindex",this.refreshInfiniteEditrowindex),this.parent.off("infinite-edit-handler",this.infiniteEditHandler),this.parent.off("virtual-scroll-add-action-begin",this.infiniteAddActionBegin),this.parent.off(er,this.modelChanged),this.parent.off("refresh-infinite-current-view-data",this.refreshInfiniteCurrentViewData),this.parent.off(lr,this.destroy),this.parent.off(Yt,this.selectNewRow),this.parent.off("infinite-group-collapse",this.captionActionComplete),this.parent.off("set-virtual-page-query",this.setGroupCollapsePageQuery),this.parent.removeEventListener(Bt,this.actionBeginFunction),this.parent.removeEventListener(Nt,this.actionCompleteFunction),this.parent.removeEventListener(qt,this.dataBoundFunction))},e.prototype.dataBound=function(){"collapse"===this.groupCaptionAction?(this.groupCaptionAction="refresh",this.makeGroupCollapseRequest()):"refresh"===this.groupCaptionAction&&(this.parent.hideSpinner(),this.groupCaptionAction=this.empty)},e.prototype.setGroupCollapsePageQuery=function(e){var t=this.parent;if(!t.infiniteScrollSettings.enableCache&&this.isGroupCollapse)if(e.skipPage=!0,this.isGroupCollapse=!1,"collapse"===this.groupCaptionAction){for(var r=t.getRowObjectFromUID(this.parentCapUid),i=t.getRowsObject(),n=0,o=i.length-1;o>=0&&i[parseInt(o.toString(),10)].indent!==r.indent;o--)i[parseInt(o.toString(),10)].isDataRow&&n++;var s=lt(i.indexOf(r),i),a=st(s.fields,s.keys,this),l=at(a);a=l[l.length-1];for(o=l.length-2;o>=0;o--)a=a.and(l[parseInt(o.toString(),10)]);e.query.where(a),e.query.skip(n),this.parentCapUid=this.empty}else{var h=t.getRows(),p=t.pageSettings.pageSize,d=ot(h[h.length-1])+1,c=d-d%p+p-d;d%p==0&&(c=0),e.query.skip(d),e.query.take(t.infiniteScrollSettings.initialBlocks*t.pageSettings.pageSize+c)}},e.prototype.captionActionComplete=function(e){var t=this.parent;if(!t.infiniteScrollSettings.enableCache&&e.isCollapse){var r=t.getContent().firstElementChild.getBoundingClientRect(),i=t.contentModule.getTable().getBoundingClientRect();if(Math.round(i.bottom-t.getRowHeight())<=Math.round(r.bottom)){this.parentCapUid=e.parentUid,this.groupCaptionAction="collapse",t.showSpinner();var n=t.getRowObjectFromUID(e.parentUid);this.getCaptionChildCount(n)?this.makeGroupCollapseRequest(e.parentUid):(this.groupCaptionAction="refresh",this.makeGroupCollapseRequest())}}},e.prototype.makeGroupCollapseRequest=function(e){var t=this.parent,r=[].slice.call(t.getContentTable().querySelectorAll("tr")),i=t.groupSettings.enableLazyLoading?r:t.getRows(),n=t.groupSettings.enableLazyLoading?t.contentModule.visibleRows.length-1:ot(i[i.length-1]),o=this.parent.pageSettings.currentPage;if(o>=this.maxPage)return void t.hideSpinner();this.parent.pageSettings.currentPage=Math.ceil(n/this.parent.pageSettings.pageSize)+1;var s={requestType:"infiniteScroll",currentPage:this.parent.pageSettings.currentPage,prevPage:o,startIndex:n+1,direction:"down",isCaptionCollapse:!0,parentUid:e};this.isGroupCollapse=!0,this.parent.notify("model-changed",s)},e.prototype.getCaptionChildCount=function(e){for(var t=this.parent.getRowsObject(),r=!1,i=t.indexOf(e);i<t.length&&(!(t[parseInt(i.toString(),10)].indent===e.indent||t[parseInt(i.toString(),10)].indent<e.indent)||t[parseInt(i.toString(),10)].data.key===e.data.key);i++)if(t[parseInt(i.toString(),10)].isCaptionRow&&!this.childCheck(t,t[parseInt(i.toString(),10)],i)){r=!0;break}return r},e.prototype.childCheck=function(e,t,r){for(var i=0,n=r+1;n<e.length&&e[parseInt(n.toString(),10)].indent!==t.indent;n++)e[parseInt(n.toString(),10)].indent===t.indent+1&&e[parseInt(n.toString(),10)].parentUid===t.uid&&i++;return t.data.count===i},e.prototype.updateCurrentViewData=function(){var e=this.parent;if(!e.groupSettings.columns.length){var t=Object.keys(this.infiniteCurrentViewData);e.currentViewData=[];for(var r=e.pageSettings.currentPage,i=e.infiniteScrollSettings.enableCache,n=e.infiniteScrollSettings.maxBlocks,o=i&&(r>n||this.isUpScroll&&r>1),s=o?this.isUpScroll?r:r-n+1:1,a=o?s+n-1:i?n:t.length,l=s;l<=a;l++)this.infiniteCurrentViewData[parseInt(l.toString(),10)]&&(e.currentViewData=e.currentViewData.concat(this.infiniteCurrentViewData[parseInt(l.toString(),10)]))}},e.prototype.refreshInfiniteCurrentViewData=function(e){var t=this.parent.pageSettings.currentPage,r=this.parent.pageSettings.pageSize,i=this.parent.infiniteScrollSettings.initialBlocks,n=Object.keys(this.infiniteCurrentViewData),o=this.parent.infiniteScrollSettings.enableCache;if(!this.parent.groupSettings.columns.length){var s="save"===e.args.requestType&&!(this.parent.sortSettings.columns.length||this.parent.filterSettings.columns.length||this.parent.groupSettings.columns.length||this.parent.searchSettings.key),a="delete"===e.args.requestType;if(o||!s&&!a)i>1&&e.data.length===i*r?this.setInitialCache(e.data.slice(),{},o&&"delete"===e.args.requestType,!0):this.infiniteCurrentViewData[parseInt(t.toString(),10)]=e.data.slice();else if(s){for(var l=0,h=1;h<=n.length;h++)if(l+=this.infiniteCurrentViewData[parseInt(h.toString(),10)].length-1,e.args.index<=l){this.resetCurrentViewData(h),this.infiniteCurrentViewData[parseInt(h.toString(),10)].splice(e.args.index,0,e.args.data);break}}else this.infiniteCurrentViewData[n[n.length-1]].push(e.data[0])}},e.prototype.resetCurrentViewData=function(e){for(var t=Object.keys(this.infiniteCurrentViewData),r=e;r<=t.length;r++){var i=this.infiniteCurrentViewData[parseInt(r.toString(),10)][this.infiniteCurrentViewData[parseInt(r.toString(),10)].length-1];this.infiniteCurrentViewData[r+1]&&this.infiniteCurrentViewData[r+1].splice(0,0,i),this.infiniteCurrentViewData[parseInt(r.toString(),10)].pop()}},e.prototype.deleteComplate=function(){this.parent.isFrozenGrid()&&!this.parent.infiniteScrollSettings.enableCache&&this.parent.contentModule.refreshScrollOffset()},e.prototype.modelChanged=function(e){var t=this.parent.getRows();if("save"===e.requestType&&e.index&&e.data&&(this.addRowIndex=e.index),t&&t.length&&"infiniteScroll"!==e.requestType&&("delete"===e.requestType||"add"===this.requestType)){if(this.firstIndex=ot(t[0]),this.firstBlock=Math.ceil((this.firstIndex+1)/this.parent.pageSettings.pageSize),this.lastIndex=ot(t[t.length-1]),"delete"===e.requestType){var r=this.parent.getRowsObject();e.startIndex=this.parent.infiniteScrollSettings.enableCache?(this.firstBlock-1)*this.parent.pageSettings.pageSize:r[r.length-1].index}else e.startIndex=this.firstIndex;this.parent.infiniteScrollSettings.enableCache||this.parent.pageSettings.currentPage!==this.maxPage||"delete"!==e.requestType||(this.isLastPage=!0,this.lastIndex=this.lastIndex-1)}},e.prototype.infiniteAddActionBegin=function(e){this.isNormaledit&&(this.isAdd=!0,this.parent.infiniteScrollSettings.enableCache&&(Object.keys(this.emptyRowData).length||this.createEmptyRowdata(),this.parent.pageSettings.currentPage>1&&(e.startEdit=!1,this.resetInfiniteBlocks({},!0),this.makeRequest({currentPage:1}))))},e.prototype.infiniteEditHandler=function(e){if(!this.parent.infiniteScrollSettings.enableCache&&("delete"===e.e.requestType||"save"===e.e.requestType&&"add"===this.requestType)){var r=this.parent.isFrozenGrid(),i=this.parent.getRows(),n=this.parent.getRowsObject();if(this.ensureRowAvailability(n,e.result[0])){if(i.length&&!(this.addRowIndex&&this.addRowIndex>=i.length)&&(this.resetRowIndex(n,e.e,i,"add"===this.requestType,!0),r)){var o=this.parent.getMovableRowsObject();if(this.resetRowIndex(o,e.e,this.parent.getMovableDataRows(),"add"===this.requestType),this.parent.getFrozenMode()===ri){var s=this.parent.getFrozenRightRowsObject();this.resetRowIndex(s,e.e,this.parent.getFrozenRightRows(),"add"===this.requestType)}}if(this.isLastPage){if(this.isLastPage=!1,this.parent.pageSettings.currentPage=this.maxPage,this.parent.selectionModule.index<this.parent.frozenRows){if(t.remove(i[this.parent.frozenRows-1]),this.createRow([n[this.parent.frozenRows-1]],e,!1,!0),r){var a=this.parent.getMovableDataRows();if(t.remove(a[this.parent.frozenRows]),this.createRow([this.parent.getMovableRowsObject()[this.parent.frozenRows-1]],e,!0,!0),this.parent.getFrozenMode()===ri){var l=this.parent.getFrozenRightDataRows();t.remove(l[this.parent.frozenRows]),this.createRow([this.parent.getFrozenRightRowsObject()[this.parent.frozenRows-1]],e,!1,!0,!0)}}Le(this.parent)}}else this.createRow(n,e)}this.parent.hideSpinner(),this.parent.notify("refresh-infinite-persist-selection",{}),"delete"===this.requestType?this.parent.notify("delete-complete",e.e):this.parent.notify("save-complete",e.e)}this.parent.notify(wr,{case:"refreshHeight"})},e.prototype.createRow=function(e,r,i,n,o){var s=n?e:this.generateRows(r.result,r.e),a=new fi(this.serviceLocator,null,this.parent);if(this.parent.removeMaskRow(),!("save"===r.e.requestType&&r.e.index&&r.e.data&&(s[0].index=this.addRowIndex,this.addRowIndex=null,s[0].index>=e.length))){var l;l=o?this.parent.element.querySelector(".e-frozen-right-content").querySelector(li):this.parent.isFrozenGrid()?i?this.parent.getMovableVirtualContent().querySelector(li):this.parent.getFrozenVirtualContent().querySelector(li):this.parent.getContent().querySelector(li),this.parent.frozenRows&&(l=n&&"add"!==this.requestType||!n&&"add"===this.requestType?this.parent.isFrozenGrid()?i?this.parent.getMovableVirtualHeader().querySelector(li):o?this.parent.element.querySelector(".e-frozen-right-header").querySelector(li):this.parent.getFrozenVirtualHeader().querySelector(li):this.parent.getHeaderContent().querySelector(li):l);var h={rows:e,cancel:!1,args:r,isMovable:i,isFrozenRows:n,isFrozenRight:n,row:s};if(this.parent.notify("infinite-crud-cancel",h),!h.cancel)for(var p=s.length-1;p>=0;p--)"delete"===this.requestType?l.appendChild(a.render(s[parseInt(p.toString(),10)],this.parent.getColumns())):l.insertBefore(a.render(s[parseInt(p.toString(),10)],this.parent.getColumns()),l.rows[r.e.index]);if(!n&&this.parent.frozenRows&&(this.parent.selectionModule.index<this.parent.frozenRows||"add"===this.requestType)){var d=i?this.parent.getMovableDataRows():o?this.parent.getFrozenRightDataRows():this.parent.getRows(),c=(i||o)&&"add"===this.requestType?this.parent.frozenRows:this.parent.frozenRows-1;t.remove(d[parseInt(c.toString(),10)]),this.createRow([e[this.parent.frozenRows-1]],r,i,!0,o)}this.parent.infiniteScrollSettings.enableCache||n||(o?(Le(this.parent),this.parent.contentModule.rightFreezeRows="add"===this.requestType?s.concat(e):e.concat(s)):!this.parent.isFrozenGrid()||i?(Le(this.parent),this.parent.contentModule.visibleRows="add"===this.requestType?s.concat(e):e.concat(s),this.parent.getFrozenMode()===ri&&(r.e.renderMovableContent=!0,this.createRow(this.parent.getFrozenRightRowsObject(),r,!1,!1,!0))):(this.parent.contentModule.visibleFrozenRows="add"===this.requestType?s.concat(e):e.concat(s),r.e.isFrozen=!0,this.createRow(this.parent.getMovableRowsObject(),r,!0)))}},e.prototype.ensureRowAvailability=function(e,t){var r=!0;if(this.parent.frozenRows&&!this.parent.infiniteScrollSettings.enableCache&&this.parent.sortSettings.columns&&"add"===this.requestType)for(var i=this.parent.getPrimaryKeyFieldNames()[0],n=0;n<e.length;n++)if(e[parseInt(n.toString(),10)].data[""+i]===t[""+i]){r=!1;break}return r},e.prototype.generateRows=function(e,t){return this.rowModelGenerator.generateRows(e,t)},e.prototype.resetRowIndex=function(e,r,i,n,o){var s=this,a=this.parent.getPrimaryKeyFieldNames()[0],l=!(i.length%this.parent.pageSettings.pageSize);n?l&&(o&&!this.parent.groupSettings.columns.length&&this.swapCurrentViewData(1,!0),t.remove(i[e.length-1]),i.splice(e.length-1,1),e.splice(e.length-1,1)):e.filter(function(n,l){if(n.data[""+a]===r.data[0][""+a]){if(o&&!s.parent.groupSettings.columns.length){var h=Math.ceil((l+1)/s.parent.pageSettings.pageSize);s.resetInfiniteCurrentViewData(h,l)}e.splice(l,1),t.remove(i[parseInt(l.toString(),10)]),i.splice(l,1)}});var h=n?this.addRowIndex?this.addRowIndex+1:1:0;ke(this.parent,e,i,h,this.addRowIndex?this.addRowIndex:0)},e.prototype.resetInfiniteCurrentViewData=function(e,t){t-=(e-1)*this.parent.pageSettings.pageSize,this.infiniteCurrentViewData[parseInt(e.toString(),10)].splice(t,1),this.swapCurrentViewData(e,!1)},e.prototype.swapCurrentViewData=function(e,t){for(var r=Object.keys(this.infiniteCurrentViewData),i=t?r.length+1:r.length,n=e;n<i;n++)if(this.infiniteCurrentViewData[n+1]){var o=t?n:n+1,s=t?this.infiniteCurrentViewData[parseInt(n.toString(),10)].length-1:0,a=this.infiniteCurrentViewData[parseInt(o.toString(),10)].splice(s,1);t?(this.infiniteCurrentViewData[n+1]=a.concat(this.infiniteCurrentViewData[n+1]),n+1===i-1&&this.infiniteCurrentViewData[n+1].splice(this.infiniteCurrentViewData[n+1].length-1,1)):this.infiniteCurrentViewData[parseInt(n.toString(),10)].push(a[0])}this.updateCurrentViewData()},e.prototype.setDisplayNone=function(e){if(this.parent.infiniteScrollSettings.enableCache){for(var t=this.parent.isFrozenGrid(),r=t?Object.keys(this.infiniteFrozenCache):Object.keys(this.infiniteCache),i=1;i<=r.length;i++)(t?e.isFreeze?this.infiniteFrozenCache[parseInt(i.toString(),10)][0]:this.infiniteFrozenCache[parseInt(i.toString(),10)][1]:this.infiniteCache[parseInt(i.toString(),10)]).filter(function(t){t.cells[e.index].visible=""===e.visible});this.resetContentModuleCache(t?this.infiniteFrozenCache:this.infiniteCache)}},e.prototype.refreshInfiniteCache=function(e){this.getEditedRowObject().data=e.data},e.prototype.refreshInfiniteCacheRowVisibleLength=function(e,r){var i=e[parseInt(r.toString(),10)];if(this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache){for(var n=0,o=0,s=0,a=0;a<i.length;a++)i[parseInt(a.toString(),10)].visible||t.isNullOrUndefined(i[parseInt(a.toString(),10)].visible)?o++:s++;return s>o?(n=s-o)>o&&(n=o):(n=o-s)>s&&(n=s),0===n&&(n=1),n}return i.length},e.prototype.refreshInfiniteEditrowindex=function(e){this.editRowIndex=e.index},e.prototype.getEditedRowObject=function(){for(var e,t=this.parent.getRowsObject(),r=0;r<t.length;r++)t[parseInt(r.toString(),10)].index===this.editRowIndex&&(e=t[parseInt(r.toString(),10)]);return e},e.prototype.infiniteEditSuccess=function(e){this.isNormaledit&&(!this.isAdd&&e.data&&this.updateCurrentViewRecords(e.data),this.isAdd=!1)},e.prototype.updateCurrentViewRecords=function(e){var r=ze(this.parent,e);t.isNullOrUndefined(r)||(this.parent.getCurrentViewRecords()[parseInt(r.toString(),10)]=e)},e.prototype.actionBegin=function(e){"add"===e.requestType||"delete"===e.requestType?this.requestType=e.requestType:"add"===e.action&&"save"===e.requestType&&(this.requestType=e.action),(this.parent.isFrozenGrid()&&!e.cancel&&"searching"===e.requestType||"sorting"===e.requestType||"filtering"===e.requestType)&&(this.isInitialRender=!0)},e.prototype.actionComplete=function(e){"delete"!==e.requestType&&"save"!==e.requestType&&"cancel"!==e.requestType||(this.requestType=this.empty,this.isCancel="cancel"===e.requestType||"save"===e.requestType,this.isAdd=this.isEdit=!1,this.isNormaledit&&(this.editRowIndex=this.empty,this.virtualInfiniteData={},this.parent.editModule.previousVirtualData={}))},e.prototype.resetInfiniteEdit=function(){this.parent.enableInfiniteScrolling&&this.isNormaledit&&(this.parent.editSettings.allowEditing&&this.isEdit||this.parent.editSettings.allowAdding&&this.isAdd)&&(this.parent.isEdit=!0)},e.prototype.getVirtualInfiniteData=function(e){this.parent.infiniteScrollSettings.enableCache&&this.parent.isEdit&&t.isNullOrUndefined(e.endEdit)?this.parent.editModule.closeEdit():(this.getVirtualInfiniteEditedData(),e.virtualData=this.virtualInfiniteData,e.isAdd=this.isAdd,e.isCancel=this.isCancel)},e.prototype.editActionBegin=function(e){this.isEdit=!0,this.editRowIndex=e.index;var r=t.extend({},this.getEditedRowObject().data);e.data=Object.keys(this.virtualInfiniteData).length?this.virtualInfiniteData:r},e.prototype.dataSourceModified=function(){this.resetInfiniteBlocks({requestType:this.empty},!0)},e.prototype.onDataReady=function(e){t.isNullOrUndefined(e.count)||"infiniteScroll"===e.requestType||(this.maxPage=Math.ceil(e.count/this.parent.pageSettings.pageSize))},e.prototype.ensureIntialCollapse=function(e){this.isInitialCollapse=!e},e.prototype.infiniteScrollHandler=function(e){this.restoreInfiniteEdit(),this.restoreInfiniteAdd();var r=e.target;if(r.classList.contains(Yr)&&this.parent.enableInfiniteScrolling&&!e.isLeft){var i=this.parent.getContent().firstElementChild,n=[].slice.call(this.parent.getContentTable().querySelectorAll("tr"));this.prevScrollTop=i.scrollTop;var o=this.parent.groupSettings.enableLazyLoading?n:this.parent.getRows();if(!o.length)return;var s=ot(o[o.length-1])+1,a=this.parent.pageSettings.currentPage,l=void 0,h=r.scrollHeight-r.scrollTop,p=Math.round(r.scrollHeight-r.scrollTop),d=h<r.clientHeight?Math.ceil(h):Math.floor(h);d>r.clientHeight&&(d-=1);var c=d===r.clientHeight||p===r.clientHeight;if(!t.isNullOrUndefined(this.groupCaptionAction))return;if(this.isScroll&&c&&(this.parent.pageSettings.currentPage<=this.maxPage-1||this.enableContinuousScroll)){this.parent.infiniteScrollSettings.enableCache&&(this.isUpScroll=!1,this.isDownScroll=!0);var u=[].slice.call(i.querySelectorAll(".e-row:not(.e-addedrow)")),g=u[u.length-1],f=this.parent.groupSettings.enableLazyLoading?this.parent.contentModule.visibleRows.length-1:ot(g);this.parent.pageSettings.currentPage=Math.ceil(f/this.parent.pageSettings.pageSize)+1,l={requestType:"infiniteScroll",currentPage:this.parent.pageSettings.currentPage,prevPage:a,startIndex:s,direction:"down"},this.makeRequest(l)}if(this.isScroll&&this.parent.infiniteScrollSettings.enableCache&&0===r.scrollTop&&1!==this.parent.pageSettings.currentPage){this.parent.infiniteScrollSettings.enableCache&&(this.isDownScroll=!1,this.isUpScroll=!0);var f=ot((g=[].slice.call(i.getElementsByClassName(Zr)))[this.parent.pageSettings.pageSize-1]),m=ot(g[0])-this.parent.pageSettings.pageSize;this.parent.pageSettings.currentPage=Math.ceil(f/this.parent.pageSettings.pageSize)-1,this.parent.pageSettings.currentPage&&(l={requestType:"infiniteScroll",currentPage:this.parent.pageSettings.currentPage,prevPage:a,startIndex:m,direction:"up"},this.makeRequest(l))}this.parent.infiniteScrollSettings.enableCache&&!this.isScroll&&t.isNullOrUndefined(l)&&(this.isDownScroll||this.isUpScroll)&&(i.scrollTop=this.top)}},e.prototype.makeRequest=function(e){var r=this;this.parent.pageSettings.currentPage!==e.prevPage&&(this.parent.infiniteScrollSettings.initialBlocks<this.maxPage&&this.parent.pageSettings.currentPage<=this.maxPage?(this.isInfiniteScroll=!0,t.isNullOrUndefined(this.infiniteCache[e.currentPage])?setTimeout(function(){r.getVirtualInfiniteEditedData(),r.parent.notify("model-changed",e)},100):setTimeout(function(){r.getVirtualInfiniteEditedData(),r.parent.notify(Dr,e)},100)):this.parent.pageSettings.currentPage=this.maxPage)},e.prototype.infinitePageQuery=function(e){this.initialRender?(this.initialRender=!1,this.intialPageQuery(e)):"delete"===this.requestType||"add"===this.requestType?this.isInfiniteScroll||this.parent.groupSettings.enableLazyLoading?this.parent.groupSettings.enableLazyLoading&&!this.parent.infiniteScrollSettings.enableCache?this.parent.infiniteScrollSettings.initialBlocks<this.parent.pageSettings.currentPage?e.page(1,this.parent.pageSettings.pageSize*this.parent.pageSettings.currentPage):e.page(1,this.parent.pageSettings.pageSize*this.parent.infiniteScrollSettings.initialBlocks):e.page(this.parent.pageSettings.currentPage,this.parent.pageSettings.pageSize):this.editPageQuery(e):e.page(this.parent.pageSettings.currentPage,this.parent.pageSettings.pageSize)},e.prototype.editPageQuery=function(e){var r=this.parent.infiniteScrollSettings.initialBlocks;if(this.parent.infiniteScrollSettings.enableCache)this.infiniteCache={},this.infiniteFrozenCache={},this.infiniteCurrentViewData={},e.skip(this.firstIndex),e.take(r*this.parent.pageSettings.pageSize);else{"Dialog"===this.parent.editSettings.mode&&this.parent.clearSelection();var i="delete"===this.requestType?this.lastIndex:this.addRowIndex?this.addRowIndex:this.firstIndex;e.skip(i),t.isNullOrUndefined(this.parent.getDataModule().dataManager.dataSource.url)||""===this.parent.getDataModule().dataManager.dataSource.url||"delete"!==this.requestType&&"add"!==this.requestType?e.take(1):e.take(r*this.parent.pageSettings.pageSize)}},e.prototype.intialPageQuery=function(e){this.parent.infiniteScrollSettings.enableCache&&this.parent.infiniteScrollSettings.initialBlocks>this.parent.infiniteScrollSettings.maxBlocks&&(this.parent.infiniteScrollSettings.initialBlocks=this.parent.infiniteScrollSettings.maxBlocks);var t=this.parent.pageSettings.pageSize*this.parent.infiniteScrollSettings.initialBlocks;e.page(1,t)},e.prototype.scrollToLastFocusedCell=function(e){var r=this.parent,i=this.lastFocusInfo.rowIdx+(e.keyArgs.action===ci?-1:1),n=this.lastFocusInfo.cellIdx,o=r.getRowByIndex(i);if(!o){var s=new fi(this.serviceLocator,null,this.parent),a=Math.floor(i/this.parent.pageSettings.pageSize)+1;r.pageSettings.currentPage=a;var l=r.getColumns();t.remove(r.getContent().querySelector("tbody")),r.getContent().querySelector("table").appendChild(r.createElement("tbody",{attrs:{role:"rowgroup"}}));for(var h=[],p=1===a||this.maxPage===a?0:-1,d=0;d<r.infiniteScrollSettings.maxBlocks;this.maxPage===a?p--:p++,d++){var c=this.infiniteCache[a+p];if(c){h=h.concat(c);for(var u=0;u<c.length;u++)r.getContent().querySelector("tbody").appendChild(s.render(c[parseInt(u.toString(),10)],l))}}r.notify(Yt,{rows:h,args:{}}),Le(r)}var g=(o=r.getRowByIndex(i)).cells[parseInt(n.toString(),10)];r.focusModule.isInfiniteScroll=!0,r.focusModule.onClick({target:g},!0),r.selectRow(i),g.focus(),this.isFocusScroll=!1,e.cancel=!0},e.prototype.setLastCellFocusInfo=function(e){var t=e.byClick&&e.clickArgs.target||e.byKey&&e.keyArgs.target||(!this.isFocusScroll&&e).target;if(t&&t.classList.contains("e-rowcell")){var r=parseInt(t.getAttribute("data-colindex"),10),i=parseInt(t.parentElement.getAttribute("data-rowindex"),10);this.lastFocusInfo={rowIdx:i,cellIdx:r}}},e.prototype.infiniteCellFocus=function(e){var t=this.parent,r=t.infiniteScrollSettings.enableCache;if(e.byKey){if(r&&this.isFocusScroll)return void this.scrollToLastFocusedCell(e);var i=document.activeElement,n=ot(i.parentElement);this.cellIndex=parseInt(i.getAttribute(oi),10);var o=t.getContent().firstElementChild,s=this.maxPage*t.pageSettings.pageSize-1,a=Math.floor(o.offsetHeight/this.parent.getRowHeight()),l=o.getBoundingClientRect();if(!isNaN(n))if(e.keyArgs.action===di||e.keyArgs.action===ui){this.rowIndex=n+=1;p=(h=t.getRowByIndex(n))&&h.getBoundingClientRect();r&&(n=i.parentElement.rowIndex+1),this.isFocusScroll||!h&&n<s||p&&p.bottom>=l.bottom?(this.isFocusScroll||(this.pressedKey=e.keyArgs.action),this.isFocusScroll=!1,o.scrollTop=(n-a+1)*this.parent.getRowHeight()):!r&&h&&p&&(p.bottom>=l.bottom||p.top<l.top)&&h.cells[this.cellIndex].scrollIntoView()}else if(e.keyArgs.action===ci||e.keyArgs.action===gi){this.rowIndex=n-=1;var h=t.getRowByIndex(n),p=h&&h.getBoundingClientRect();r&&(n=i.parentElement.rowIndex-1),(!h||p.top<=l.top)&&(this.pressedKey=e.keyArgs.action,o.scrollTop=n*this.parent.getRowHeight())}}else"PageDown"!==e.key&&"PageUp"!==e.key||(this.pressedKey=e.key);this.setLastCellFocusInfo(e)},e.prototype.createEmptyRowdata=function(){var e=this;this.parent.getColumns().filter(function(t){e.emptyRowData[t.field]=e.empty})},e.prototype.getVirtualInfiniteEditedData=function(){var e=this.parent.element.querySelector("."+ei),r=this.parent.element.querySelector("."+ti),i=this.parent.element.querySelector(".e-gridform");if(this.parent.infiniteScrollSettings.enableCache&&(e||r)){var n=e?t.extend({},this.getEditedRowObject().data):t.extend({},this.emptyRowData);this.virtualInfiniteData=this.parent.editModule.getCurrentEditedData(i,n);for(var o=this.parent.getHiddenColumns(),s=0;s<o.length;s++)o[parseInt(s.toString(),10)].defaultValue&&(this.virtualInfiniteData[o[parseInt(s.toString(),10)].field]=o[parseInt(s.toString(),10)].defaultValue);this.parent.isFrozenGrid()&&(this.virtualInfiniteData=this.parent.editModule.getCurrentEditedData(this.parent.getMovableVirtualContent().querySelector(".e-gridform"),n))}},e.prototype.restoreInfiniteEdit=function(){var e=this.parent.getContent().firstElementChild,r=!this.parent.frozenRows||this.editRowIndex>=this.parent.frozenRows;if(this.isNormaledit&&this.parent.infiniteScrollSettings.enableCache&&r&&this.parent.editSettings.allowEditing&&!t.isNullOrUndefined(this.editRowIndex)){var i=this.parent.getRowByIndex(this.editRowIndex);if(Object.keys(this.virtualInfiniteData).length&&i&&!this.parent.getContent().querySelector("."+ei)){var n=i.getBoundingClientRect().top;n<e.offsetHeight&&n>this.parent.getRowHeight()&&(this.parent.isEdit=!1,this.parent.editModule.startEdit(i))}}},e.prototype.restoreInfiniteAdd=function(){var e=this.parent.getContent().firstElementChild;this.parent.getCurrentViewRecords().length&&this.parent.getRowByIndex(0)&&this.isNormaledit&&this.parent.infiniteScrollSettings.enableCache&&this.isAdd&&!e.querySelector("."+ti)&&e.scrollTop<this.parent.getRowHeight()&&(this.parent.isEdit=!1,this.parent.addRecord())},e.prototype.appendInfiniteRows=function(e){var t=this.parent.isFrozenGrid(),r=this.parent.getContent().firstElementChild,i=this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.args.requestType,n=this.parent.getFrozenMode()===ri&&"movable"===e.tableName;if((this.parent.isAngular||this.parent.isReact||this.parent.isVue||this.parent.isVue3)&&i&&!e.args.isFrozen&&this.parent.infiniteScrollSettings.enableCache){var o=!(!this.parent.childGrid||!this.parent.element.querySelectorAll(".e-childgrid").length),s=this.parent.getDataRows();if(t){this.parent.contentModule.freezeRowElements=s;var a=this.parent.getContent().querySelector("."+Wr),l=this.parent.getContent().querySelector(".e-frozen-left-content");a&&a.querySelectorAll(".e-templatecell").length&&this.parent.refreshReactTemplateTD(this.parent.getMovableDataRows(),o,!0),l&&l.querySelectorAll(".e-templatecell").length&&this.parent.refreshReactTemplateTD(this.parent.getDataRows(),o,!0),this.parent.contentModule.freezeRowElements=this.parent.getRows()}else this.parent.refreshReactTemplateTD(s,o)}if((!i||e.args.isFrozen||n)&&i||(i&&"up"===e.args.direction?e.tbody.insertBefore(e.frag,e.tbody.firstElementChild):e.tbody.appendChild(e.frag)),t)if(i)if(e.tableName===ni||"Right"===this.parent.getFrozenMode()&&e.tableName===ii)this.frozenFrag=e.frag;else if(this.parent.getFrozenMode()===ri&&"movable"===e.tableName)this.movableFrag=e.frag;else{var h=this.parent.getFrozenVirtualContent().querySelector(li);"up"===e.args.direction?h.insertBefore(this.frozenFrag,h.firstElementChild):h.appendChild(this.frozenFrag),e.tableName===ii?(this.parent.getMovableVirtualContent().querySelector(li).appendChild(this.movableFrag),this.parent.element.querySelector(".e-frozen-right-content").querySelector(li).appendChild(e.frag)):this.parent.getMovableVirtualContent().querySelector("."+Jr).appendChild(e.tbody),this.parent.contentModule.refreshScrollOffset(),this.updateCurrentViewData()}else{var p=void 0;e.tableName===ni?p=this.parent.getFrozenVirtualContent().querySelector("."+Jr):"movable"===e.tableName?(p=this.parent.getMovableVirtualContent().querySelector("."+Jr),this.parent.getFrozenMode()!==ri&&(this.parent.contentModule.refreshScrollOffset(),this.updateCurrentViewData())):(p=this.parent.element.querySelector(".e-frozen-right-content").querySelector("."+Jr),this.parent.getFrozenMode()===ri&&(this.parent.contentModule.refreshScrollOffset(),this.updateCurrentViewData())),p.appendChild(e.tbody),this.widthService.refreshFrozenScrollbar()}else this.parent.contentModule.getTable().appendChild(e.tbody),this.updateCurrentViewData();this.isInitialRender&&!e.args.isFrozen&&(this.isInitialRender=!1,this.parent.scrollModule.setHeight()),e.args.isFrozen||(this.rowTop=this.rowTop?this.rowTop:this.parent.getRows()[0].getBoundingClientRect().top,i&&(this.parent.infiniteScrollSettings.enableCache&&this.isRemove&&(r.scrollTop=this.top),Le(this.parent)),this.restoreInfiniteAdd(),this.isScroll=!0),this.isInfiniteScroll=!1},e.prototype.selectNewRow=function(e){var t=this,r=this.parent,i=r.getRowByIndex(this.rowIndex),n=r.infiniteScrollSettings.enableCache;if(i&&this.keys.some(function(e){return e===t.pressedKey})){var o=r.getContent().firstElementChild,s=r.getRowHeight(),a=i.cells[this.cellIndex];(this.pressedKey===di||this.pressedKey===ui||n&&(this.pressedKey===ci||this.pressedKey===gi))&&(n||this.pressedKey===ci||this.pressedKey===gi||(o.scrollTop=o.scrollTop+s),r.focusModule.isInfiniteScroll=!0,r.focusModule.onClick({target:a},!0),r.selectRow(this.rowIndex))}else if(this.lastFocusInfo&&("PageDown"===this.pressedKey||"PageUp"===this.pressedKey)){var l=n?0:this.lastFocusInfo.rowIdx;r.getRowByIndex(l)&&(a=r.getCellFromIndex(l,this.lastFocusInfo.cellIdx))&&(this.isFocusScroll=!0,n?a.focus({preventScroll:!0}):(r.focusModule.isInfiniteScroll=!0,r.focusModule.onClick({target:a},!0)))}this.pressedKey=void 0},e.prototype.removeInfiniteCacheRows=function(e){var t=this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.args.requestType;if(!e.args.isFrozen&&t&&this.parent.infiniteScrollSettings.enableCache&&this.isRemove){var r=[].slice.call(this.parent.getContentTable().getElementsByClassName(Zr));if("down"===e.args.direction){if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length){n=[].slice.call(this.parent.getContentTable().querySelectorAll("tr"));this.removeCaptionRows(n,e.args)}var i=this.parent.element.querySelector("."+ti)?0:1;this.removeTopRows(r,this.parent.pageSettings.pageSize-i)}if("up"===e.args.direction)if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length){var n=[].slice.call(this.parent.getContentTable().querySelectorAll("tr"));this.removeCaptionRows(n,e.args)}else this.removeBottomRows(r,r.length-1,e.args);this.isScroll=!1,this.top=this.calculateScrollTop(e.args)}},e.prototype.calculateScrollTop=function(e){var r=0,i=this.parent.getContent().firstElementChild;if("down"===e.direction){this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!this.isInitialCollapse&&(r=this.captionRowHeight());var n=[].slice.call(this.parent.getContent().firstElementChild.querySelectorAll("tr:not(.e-row)")),o=0;this.isInitialCollapse&&!t.isNullOrUndefined(n)&&(o=Math.round((n.length-1)/this.parent.groupSettings.columns.length));for(var s=o||this.parent.pageSettings.pageSize*(this.parent.infiniteScrollSettings.maxBlocks-1),a=0,l=0;a<i.clientHeight;)a=++l*this.parent.getRowHeight();r+=(s-(l-=1))*this.parent.getRowHeight()}if("up"===e.direction)if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!this.isInitialCollapse)r=this.refreshInfiniteCacheRowVisibleLength(this.infiniteCache,this.parent.pageSettings.currentPage)*this.parent.getRowHeight();else if(this.isInitialCollapse){for(var h=this.infiniteCache[this.parent.pageSettings.currentPage],p=0,l=0;l<h.length;l++)h[parseInt(l.toString(),10)].isCaptionRow&&p++;r+=Math.round(p/this.parent.groupSettings.columns.length)*this.parent.getRowHeight()}else r+=this.parent.pageSettings.pageSize*this.parent.getRowHeight()+j();return r},e.prototype.captionRowHeight=function(){return[].slice.call(this.parent.getContent().querySelectorAll("tr:not(.e-row)")).length*this.parent.getRowHeight()},e.prototype.removeTopRows=function(e,r){for(var i=this.parent.isFrozenGrid(),n=this.parent.getFrozenMode()===ri?[].slice.call(this.parent.element.querySelector(".e-frozen-right-content").getElementsByClassName(Zr)):null,o=i?[].slice.call(this.parent.getMovableVirtualContent().getElementsByClassName(Zr)):null,s=0;s<=r;s++)this.parent.frozenRows&&this.parent.pageSettings.currentPage===this.parent.infiniteScrollSettings.maxBlocks+1&&s>r-this.parent.frozenRows||(t.remove(e[parseInt(s.toString(),10)]),o&&t.remove(o[parseInt(s.toString(),10)]),n&&t.remove(n[parseInt(s.toString(),10)]))},e.prototype.removeBottomRows=function(e,r,i){var n=0,o=this.parent.isFrozenGrid(),s=o?[].slice.call(this.parent.getMovableVirtualContent().getElementsByClassName(Zr)):null,a=this.parent.getFrozenMode()===ri?[].slice.call(this.parent.element.querySelector(".e-frozen-right-content").getElementsByClassName(Zr)):null,l=this.parent.pageSettings.pageSize;!o&&this.infiniteCache[i.prevPage].length<l&&(n=this.parent.pageSettings.pageSize-this.infiniteCache[i.prevPage].length),o&&this.infiniteFrozenCache[i.prevPage][1].length<l&&(n=this.parent.pageSettings.pageSize-this.infiniteFrozenCache[i.prevPage][1].length);for(var h=r;n<l;h--)n++,t.remove(e[parseInt(h.toString(),10)]),s&&t.remove(s[parseInt(h.toString(),10)]),a&&t.remove(a[parseInt(h.toString(),10)])},e.prototype.removeCaptionRows=function(e,r){var i=[].slice.call(this.parent.getContent().getElementsByClassName(Zr));if("down"===r.direction)for(var n=ot(i[this.parent.pageSettings.pageSize-1])-1,o=0,s=0;o<n;s++)e[parseInt(s.toString(),10)].classList.contains(Zr)?o=ot(e[parseInt(s.toString(),10)]):t.remove(e[parseInt(s.toString(),10)]);if("up"===r.direction){for(var a=ot(i[i.length-1]),l=Math.ceil(a/this.parent.pageSettings.pageSize),h=0,s=this.parent.pageSettings.currentPage+1;s<l;s++)h+=this.infiniteCache[parseInt(s.toString(),10)].length;for(s=h;s<e.length;s++)t.remove(e[parseInt(s.toString(),10)])}},e.prototype.resetInfiniteBlocks=function(e,r){var i=this.parent.enableInfiniteScrolling&&"infiniteScroll"!==e.requestType;if(!this.initialRender&&!t.isNullOrUndefined(this.parent.infiniteScrollModule)&&i&&(this.actions.some(function(t){return t===e.requestType})||r||"save"===e.requestType&&(this.parent.sortSettings.columns.length||this.parent.filterSettings.columns.length||this.parent.groupSettings.columns.length||this.parent.searchSettings.key))){var n=this.parent.getContent().firstElementChild;this.initialRender=!0,n.scrollTop=0,this.parent.pageSettings.currentPage=1,this.infiniteCache=this.infiniteFrozenCache={},this.infiniteCurrentViewData={},this.resetContentModuleCache({}),this.isRemove=!1,this.top=0,this.isInitialMovableRender=!0,this.isInitialCollapse=!1,this.parent.contentModule.isRemove=this.isRemove,this.parent.contentModule.isAddRows=this.isRemove,this.parent.contentModule.visibleRows=[],this.parent.contentModule.visibleFrozenRows=[]}},e.prototype.setCache=function(e){if(this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache){var r=this.parent.isFrozenGrid(),i=e.args.isFrozen?1:0,n="infiniteScroll"!==e.args.requestType&&("delete"===this.requestType||"add"===this.requestType),o=this.parent.pageSettings.currentPage;(r&&this.isInitialMovableRender||!r&&!Object.keys(this.infiniteCache).length||n)&&(this.isInitialMovableRender=!e.args.isFrozen,this.setInitialCache(e.modelData,e.args,n)),!r&&t.isNullOrUndefined(this.infiniteCache[this.parent.pageSettings.currentPage])&&(this.infiniteCache[this.parent.pageSettings.currentPage]=e.modelData,this.resetContentModuleCache(this.infiniteCache)),r&&(0===i&&t.isNullOrUndefined(this.infiniteFrozenCache[parseInt(o.toString(),10)])||!this.infiniteFrozenCache[parseInt(o.toString(),10)][parseInt(i.toString(),10)].length)&&(this.createFrozenCache(o),this.infiniteFrozenCache[parseInt(o.toString(),10)][parseInt(i.toString(),10)]=e.modelData,1===i&&this.resetContentModuleCache(this.infiniteFrozenCache)),e.isInfiniteScroll&&!this.isRemove&&(this.isRemove=(o-1)%this.parent.infiniteScrollSettings.maxBlocks==0,this.parent.contentModule.isRemove=this.isRemove)}},e.prototype.setInitialCache=function(e,r,i,n){for(var o=this.parent.isFrozenGrid(),s=r.isFrozen?1:0,a=i?t.isNullOrUndefined(this.firstBlock)?1:this.firstBlock:1,l=1;l<=this.parent.infiniteScrollSettings.initialBlocks;l++){var h=(l-1)*this.parent.pageSettings.pageSize,p=l*this.parent.pageSettings.pageSize;this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!n?this.setInitialGroupCache(e,a,h,p):n?this.infiniteCurrentViewData[parseInt(a.toString(),10)]=e.slice(h,p):o?(this.createFrozenCache(a),this.infiniteFrozenCache[parseInt(a.toString(),10)][parseInt(s.toString(),10)]=e.slice(h,p),this.resetContentModuleCache(this.infiniteFrozenCache)):(this.infiniteCache[parseInt(a.toString(),10)]=e.slice(h,p),this.resetContentModuleCache(this.infiniteCache)),a++}},e.prototype.createFrozenCache=function(e){this.infiniteFrozenCache[parseInt(e.toString(),10)]||(this.infiniteFrozenCache[parseInt(e.toString(),10)]=[[],[]])},e.prototype.setInitialGroupCache=function(e,t,r,i){for(var n=[],o=0,s=1;s<=Object.keys(this.infiniteCache).length;s++)o+=this.infiniteCache[parseInt(s.toString(),10)].length;for(var a=r,s=o;s<e.length&&a<i&&((e[parseInt(s.toString(),10)].index<i||e[parseInt(s.toString(),10)].isCaptionRow)&&(a=e[parseInt(s.toString(),10)].isCaptionRow?a:e[parseInt(s.toString(),10)].index,n.push(e[parseInt(s.toString(),10)])),!(e[parseInt(s.toString(),10)].index>=i||e[parseInt(s.toString(),10)].index===i-1));s++);this.infiniteCache[parseInt(t.toString(),10)]=n,this.resetContentModuleCache(this.infiniteCache)},e.prototype.resetContentModuleCache=function(e){this.parent.contentModule.infiniteCache=e},e.prototype.destroy=function(){this.removeEventListener()},e}(),js=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Vs=function(e){function r(t,r){var i=e.call(this,t,r)||this;return i.childCount=0,i.scrollData=[],i.isFirstChildRow=!1,i.isScrollDown=!1,i.isScrollUp=!1,i.groupCache={},i.cacheRowsObj={},i.startIndexes={},i.captionCounts={},i.rowsByUid={},i.objIdxByUid={},i.initialGroupCaptions={},i.requestType=["paging","columnstate","reorder","cancel","save","beginEdit","add","delete","filterbeforeopen","filterchoicerequest","infiniteScroll","virtualscroll"],i.scrollTopCache=void 0,i.refRowsObj={},i.cacheMode=!1,i.cacheBlockSize=5,i.ignoreAccent=!!i.parent.allowFiltering&&i.parent.filterSettings.ignoreAccent,i.allowCaseSensitive=!1,i.lazyLoadQuery=[],i.locator=r,i.groupGenerator=new wi(i.parent),i.summaryModelGen=new Ci(i.parent),i.captionModelGen=new Si(i.parent),i.rowRenderer=new fi(i.locator,null,i.parent),i.eventListener(),i}return js(r,e),r.prototype.eventListener=function(){this.parent.addEventListener(Bt,this.actionBegin.bind(this)),this.parent.addEventListener(Nt,this.actionComplete.bind(this)),this.parent.on(Qt,this.setLazyLoadPageSize,this),this.parent.on("group-cache",this.setCache,this),this.parent.on("lazy-load-scroll-handler",this.scrollHandler,this),this.parent.on(hr,this.setVisible,this),this.parent.on("group-collapse",this.collapseShortcut,this)},r.prototype.captionExpand=function(e){var t=this,r=this.parent.pageSettings.currentPage,i=this.groupCache[parseInt(r.toString(),10)],n=e.getAttribute("data-uid");this.refreshCaches(),this.scrollTopCache&&!(this.parent.scrollModule.content.scrollTop>this.scrollTopCache)||this.parent.enableVirtualization||(this.scrollTopCache=this.parent.scrollModule.content.scrollTop);var o=this.getRowObjectIndexByUid(n),s=!!i[o+1]&&i[parseInt(o.toString(),10)].indent<i[o+1].indent;this.parent.enableVirtualization&&(s=!!this.cacheRowsObj[""+n]);var a=i[parseInt(o.toString(),10)],l=lt(o,i),h={captionRowElement:e,groupInfo:a,enableCaching:!0,cancel:!1};this.parent.trigger("lazyLoadGroupExpand",h,function(i){i.cancel||(i.keys=l.keys,i.fields=l.fields,i.rowIndex=e.rowIndex,i.makeRequest=!i.enableCaching||!s,!i.enableCaching&&s&&t.clearCache([n]),i.skip=0,i.take=t.pageSize,a.isExpand=!0,t.rowsByUid[parseInt(r.toString(),10)][a.uid]&&(t.rowsByUid[parseInt(r.toString(),10)][a.uid].isExpand=!0),t.captionRowExpand(i))})},r.prototype.captionCollapse=function(e){var r=this,i=this.groupCache[this.parent.pageSettings.currentPage],n=e.rowIndex,o=e.getAttribute("data-uid");this.refreshCaches();var s=this.getRowObjectIndexByUid(o),a={captionRowElement:e,groupInfo:i[parseInt(s.toString(),10)],cancel:!1};this.parent.trigger("lazyLoadGroupCollapse",a,function(e){if(!e.cancel){e.isExpand=!1;for(var i=0;i<r.lazyLoadQuery.length;i++){var a=r.lazyLoadQuery[parseInt(i.toString(),10)][0];e.groupInfo.data.key===a.value&&r.lazyLoadQuery.splice(i,1)}r.removeRows(s,n,o),(r.parent.enableInfiniteScrolling||r.parent.enableVirtualization)&&(r.groupCache[r.parent.pageSettings.currentPage]=t.extend([],r.refRowsObj[r.parent.pageSettings.currentPage]),r.refreshRowObjects([],s))}})},r.prototype.setLazyLoadPageSize=function(){var e=this.parent.getContent().firstElementChild,t=Math.floor(e.offsetHeight/this.parent.getRowHeight())-1;this.pageSize=this.pageSize?this.pageSize:3*t,this.blockSize=Math.ceil(this.pageSize/2)},r.prototype.clearLazyGroupCache=function(){this.clearCache()},r.prototype.clearCache=function(e){e=e||this.getInitialCaptionIndexes();var t=this.groupCache[this.parent.pageSettings.currentPage];if(e.length)for(var r=0;r<e.length;r++){var i=this.getRowObjectIndexByUid(e[parseInt(r.toString(),10)]),n=t[parseInt(i.toString(),10)];if(n){if(this.captionCounts[this.parent.pageSettings.currentPage][n.uid])for(var o=i+1;o<t.length;o++){if(t[parseInt(o.toString(),10)].indent===n.indent||t[parseInt(o.toString(),10)].indent<n.indent){delete this.captionCounts[this.parent.pageSettings.currentPage][n.uid];break}t[parseInt(o.toString(),10)].isCaptionRow&&delete this.captionCounts[this.parent.pageSettings.currentPage][t[parseInt(o.toString(),10)].uid]}if(n.isExpand){var s=this.parent.getRowElementByUID(n.uid);if(!s)return;this.parent.groupModule.expandCollapseRows(s.querySelector(".e-recordplusexpand"))}var a=this.getNextChilds(i);if(a.length){var l=[];a[a.length-1].isCaptionRow&&(l=this.getChildRowsByParentIndex(t.indexOf(a[a.length-1]),!1,!1,null,!0,!0));var h=t.indexOf(a[0]),p=l.length?t.indexOf(l[l.length-1]):t.indexOf(a[a.length-1]);t.splice(h,p-(h-1)),this.refreshCaches()}}}},r.prototype.refreshCaches=function(){var e=this.parent.pageSettings.currentPage,t=this.groupCache[parseInt(e.toString(),10)];this.parent.enableInfiniteScrolling?(this.rowsByUid[parseInt(e.toString(),10)]=[],this.objIdxByUid[parseInt(e.toString(),10)]=[]):(this.rowsByUid={},this.objIdxByUid={});for(var r=0;r<t.length;r++)this.maintainRows(t[parseInt(r.toString(),10)],r)},r.prototype.getInitialCaptionIndexes=function(){for(var e=this.parent.pageSettings.currentPage,t=[],r=0;r<this.initialGroupCaptions[parseInt(e.toString(),10)].length;r++)t.push(this.initialGroupCaptions[parseInt(e.toString(),10)][parseInt(r.toString(),10)].uid);return t},r.prototype.getRowObjectIndexByUid=function(e){return this.objIdxByUid[this.parent.pageSettings.currentPage][""+e]},r.prototype.collapseShortcut=function(e){if(this.parent.groupSettings.columns.length&&e.target&&O(e.target,Yr)&&"TR"===e.target.parentElement.tagName){if(!e.collapse&&O(e.target,Zr))return;var t=e.target.parentElement.getAttribute("data-uid");if(e.collapse){var r=this.getRowByUid(t);if((i=this.getRowByUid(r.parentUid)).isCaptionRow&&i.isExpand){n=this.getRowElementByUid(r.parentUid);this.parent.groupModule.expandCollapseRows(n.cells[r.indent-1])}}else{var i=this.getRowByUid(t);if(i.isCaptionRow&&!i.isExpand){var n=this.getRowElementByUid(t);this.parent.groupModule.expandCollapseRows(n.cells[i.indent])}}}},r.prototype.getRowByUid=function(e){return this.rowsByUid[this.parent.pageSettings.currentPage][""+e]},r.prototype.actionBegin=function(e){if(!e.cancel){if(this.requestType.some(function(t){return t===e.requestType})||(this.groupCache={},this.resetRowMaintenance(),this.parent.enableVirtualization&&(this.parent.contentModule.currentInfo={})),"reorder"===e.requestType&&this.parent.groupSettings.columns.length)for(var t=Object.keys(this.groupCache),r=0;r<t.length;r++)for(var i=this.groupCache[t[parseInt(r.toString(),10)]],n=0;n<i.length;n++)if(i[parseInt(n.toString(),10)].isCaptionRow&&!this.captionModelGen.isEmpty()&&this.changeCaptionRow(i[parseInt(n.toString(),10)],null,t[parseInt(r.toString(),10)]),i[parseInt(n.toString(),10)].isDataRow){var o=e.fromIndex+i[parseInt(n.toString(),10)].indent,s=e.toIndex+i[parseInt(n.toString(),10)].indent;this.moveCells(i[parseInt(n.toString(),10)].cells,o,s)}("delete"===e.requestType||"add"===e.action&&"save"===e.requestType)&&(this.groupCache={},this.resetRowMaintenance(),this.parent.enableVirtualization&&(this.parent.contentModule.currentInfo={}))}},r.prototype.actionComplete=function(e){e.cancel||"columnstate"===e.requestType||"beginEdit"===e.requestType||"delete"===e.requestType||"save"===e.requestType||"reorder"===e.requestType||this.scrollReset()},r.prototype.resetRowMaintenance=function(){this.startIndexes={},this.captionCounts={},this.rowsByUid={},this.objIdxByUid={},this.initialGroupCaptions={}},r.prototype.moveCells=function(e,t,r){if(t>=e.length)for(var i=t-e.length;1+i--;)e.push(void 0);e.splice(t,0,e.splice(r,1)[0])},r.prototype.removeRows=function(e,r,i){var n,o=this.parent.pageSettings.currentPage,s=this.groupCache[parseInt(o.toString(),10)],a=[].slice.call(this.parent.getContent().querySelectorAll("tr")),l=0;if(this.parent.aggregates.length){var h=this.getAggregateByCaptionIndex(e);n=h.length?h[h.length-1].uid:void 0}var p=s[parseInt(e.toString(),10)].indent;this.addClass(this.getNextChilds(parseInt(e.toString(),10))),s[parseInt(e.toString(),10)].isExpand=!1,this.rowsByUid[parseInt(o.toString(),10)][s[parseInt(e.toString(),10)].uid]&&(this.rowsByUid[parseInt(o.toString(),10)][s[parseInt(e.toString(),10)].uid].isExpand=!1);for(var d,c=e+1;c<s.length;c++){if(s[parseInt(c.toString(),10)].indent===p||s[parseInt(c.toString(),10)].indent<p){d=s[parseInt(c.toString(),10)].uid;break}s[parseInt(c.toString(),10)].isCaptionRow&&s[parseInt(c.toString(),10)].isExpand&&this.addClass(this.getNextChilds(c))}for(c=r+1;c<a.length&&a[parseInt(c.toString(),10)].getAttribute("data-uid")!==d;c++){if(a[parseInt(c.toString(),10)].getAttribute("data-uid")===n){t.remove(a[parseInt(c.toString(),10)]);break}t.remove(a[parseInt(c.toString(),10)]),this.refRowsObj[parseInt(o.toString(),10)].splice(r+1,1),l+=1}this.parent.enableVirtualization&&(this.cacheRowsObj[""+i]=this.groupCache[parseInt(o.toString(),10)].slice(e+1,e+1+l),this.groupCache[parseInt(o.toString(),10)].splice(e+1,l),this.parent.notify("refresh-Virtual-LazyLoad-Cache",{rows:[],uid:s[parseInt(e.toString(),10)].uid,count:l}),this.parent.contentModule.setVirtualHeight(),this.parent.islazyloadRequest=!1),this.parent.scrollModule.content.scrollTop>this.scrollTopCache&&!this.parent.enableVirtualization&&(this.parent.scrollModule.content.scrollTop=this.scrollTopCache),this.parent.notify("refresh-Expand-and-Collapse",{rows:this.refRowsObj[parseInt(o.toString(),10)]})},r.prototype.addClass=function(e){var t=e[this.blockSize];t&&(t.lazyLoadCssClass="e-lazyload-middle-down")},r.prototype.getNextChilds=function(e,t){for(var r=this.groupCache[this.parent.pageSettings.currentPage],i=t||r,n=r[parseInt(e.toString(),10)].indent+1,o=[],s=t?0:e+1;s<i.length&&!(i[parseInt(s.toString(),10)].indent<n);s++)i[parseInt(s.toString(),10)].indent===n&&o.push(i[parseInt(s.toString(),10)]);return o},r.prototype.lazyLoadHandler=function(e){this.setStartIndexes();var t=this.parent.getContent().querySelectorAll("tr")[e.index].getAttribute("data-uid"),r=this.getRowObjectIndexByUid(t),i=this.groupCache[this.parent.pageSettings.currentPage][parseInt(r.toString(),10)],n=e.isRowExist?e.isScroll?this.scrollData:this.parent.enableVirtualization?this.cacheRowsObj[""+t]:this.getChildRowsByParentIndex(r,!0,!0,null,!0):[];if(this.scrollData=[],!e.isRowExist)if(this.setRowIndexes(r,i),this.refreshCaptionRowCount(this.groupCache[this.parent.pageSettings.currentPage][parseInt(r.toString(),10)],e.count),-1!==Object.keys(e.data).indexOf("GroupGuid"))for(d=0;d<e.data.length;d++){var o=this.groupGenerator.generateCaptionRow(e.data[parseInt(d.toString(),10)],e.level,i.parentGid,void 0,0,i.uid);n.push(o),this.parent.aggregates.length&&(n=n.concat(this.summaryModelGen.generateRows(e.data[parseInt(d.toString(),10)],{level:e.level+1,parentUid:o.uid})))}else this.groupGenerator.index=this.getStartIndex(r,e.isScroll),n=this.groupGenerator.generateDataRows(e.data,e.level,i.parentGid,0,i.uid);var s=e.isScroll?this.rowIndex:e.index,a=this.getNextChilds(r,n),l=!!e.up||this.hasLastChildRow(e.isScroll,e.count,a.length);e.isRowExist||l||(a[this.blockSize].lazyLoadCssClass="e-lazyload-middle-down"),l||(a[a.length-1].lazyLoadCssClass="e-not-lazyload-end");var h=e.isScroll||e.isRowExist?[]:this.getAggregateByCaptionIndex(r);if(e.up||(!e.isRowExist||this.parent.enableVirtualization&&e.isRowExist&&this.cacheRowsObj[""+t])&&this.refreshRowObjects(n,e.isScroll?this.rowObjectIndex:r),this.parent.enableVirtualization){var p=e.isScroll?this.groupCache[this.parent.pageSettings.currentPage][this.rowIndex].uid:i.uid;this.parent.notify("refresh-Virtual-LazyLoad-Cache",{rows:n,uid:p}),this.parent.contentModule.setVirtualHeight(),this.parent.contentModule.isTop=!1}this.render(s,n,l,h),this.isFirstChildRow&&!e.up&&(this.parent.getContent().firstElementChild.scrollTop=n.length*this.parent.getRowHeight()),this.isFirstChildRow=!1,this.rowIndex=void 0,this.rowObjectIndex=void 0,this.childCount=0;for(var d=0;d<n.length;d++)this.refRowsObj[this.parent.pageSettings.currentPage].splice(r+d+1,0,n[parseInt(d.toString(),10)]);this.parent.notify("refresh-Expand-and-Collapse",{rows:this.refRowsObj[this.parent.pageSettings.currentPage]}),this.parent.enableVirtualMaskRow&&this.parent.removeMaskRow()},r.prototype.setRowIndexes=function(e,t){this.captionCounts[this.parent.pageSettings.currentPage]||(this.captionCounts[this.parent.pageSettings.currentPage]={}),t.isCaptionRow&&(this.captionCounts[this.parent.pageSettings.currentPage][t.uid]=t.data.count)},r.prototype.getStartIndex=function(e,t){var r=this.parent.pageSettings.currentPage,i=this.groupCache[parseInt(r.toString(),10)];if(t)return i[this.rowObjectIndex].index+1;var n=0,o=0,s=this.getRowByUid(i[parseInt(e.toString(),10)].parentUid);if(s&&(o=this.prevCaptionCount(s)),i[parseInt(e.toString(),10)].indent>0)for(var a=e-1;a>=0&&!(i[parseInt(a.toString(),10)].indent<i[parseInt(e.toString(),10)].indent);a--)i[parseInt(a.toString(),10)].isCaptionRow&&i[parseInt(a.toString(),10)].indent===i[parseInt(e.toString(),10)].indent&&(n+=i[parseInt(a.toString(),10)].data.count);return n+o+this.startIndexes[parseInt(r.toString(),10)][i[parseInt(e.toString(),10)].parentGid]},r.prototype.prevCaptionCount=function(e){for(var t=this.parent.pageSettings.currentPage,r=this.groupCache[parseInt(t.toString(),10)],i=0,n=r.indexOf(e)-1;n>=0&&0!==r[parseInt(n.toString(),10)].indent&&!(r[parseInt(n.toString(),10)].indent<e.indent);n--)if(r[parseInt(n.toString(),10)].isCaptionRow&&r[parseInt(n.toString(),10)].indent===e.indent){var o=this.captionCounts[parseInt(t.toString(),10)][r[parseInt(n.toString(),10)].uid];i+=o||r[parseInt(n.toString(),10)].data.count}var s=this.getRowByUid(e.parentUid);return s&&(i+=this.prevCaptionCount(s)),i},r.prototype.setStartIndexes=function(){var e=this.groupCache[this.parent.pageSettings.currentPage];if(!this.startIndexes[this.parent.pageSettings.currentPage]){for(var t=[],r=void 0,i=0;i<e.length;i++)e[parseInt(i.toString(),10)].isCaptionRow&&(t.length?t.push(e[parseInt(r.toString(),10)].data.count+t[t.length-1]):t.push(0),r=i);this.startIndexes[this.parent.pageSettings.currentPage]=t}},r.prototype.hasLastChildRow=function(e,t,r){return e?t===this.childCount+r:t===r},r.prototype.refreshCaptionRowCount=function(e,t){e.data.count=t},r.prototype.render=function(e,t,r,i){var n=this.parent.getContent().querySelectorAll("tr")[parseInt(e.toString(),10)],o=this.parent.getContent().firstElementChild,s=this.parent.getRowHeight();if(n&&i.length)for(a=i.length-1;a>=0;a--)n.insertAdjacentElement("afterend",this.rowRenderer.render(i[parseInt(a.toString(),10)],this.parent.getColumns()));if(n&&t.length)for(var a=t.length-1;a>=0;a--)this.confirmRowRendering(t[parseInt(a.toString(),10)])&&(n.insertAdjacentElement("afterend",this.rowRenderer.render(t[parseInt(a.toString(),10)],this.parent.getColumns())),this.isScrollDown&&(o.scrollTop=o.scrollTop-s),this.isScrollUp&&(o.scrollTop=o.scrollTop+s));this.isScrollDown=!1,this.isScrollUp=!1},r.prototype.maintainRows=function(e,t){var r=this.parent.pageSettings.currentPage;this.rowsByUid[parseInt(r.toString(),10)]||(this.rowsByUid[parseInt(r.toString(),10)]={},this.objIdxByUid[parseInt(r.toString(),10)]={}),e.uid&&(this.rowsByUid[parseInt(r.toString(),10)][e.uid]=e),this.objIdxByUid[parseInt(r.toString(),10)][e.uid]=t},r.prototype.confirmRowRendering=function(e){var r=!0;if(t.isNullOrUndefined(e.indent)&&!e.isDataRow&&!e.isCaptionRow){var i=this.getRowByUid(e.parentUid);i.isCaptionRow&&!i.isExpand&&(r=!1)}return r},r.prototype.refreshRowObjects=function(e,r){var i=this.parent.pageSettings.currentPage,n=this.groupCache[parseInt(i.toString(),10)];this.rowsByUid[parseInt(i.toString(),10)]={},this.objIdxByUid[parseInt(i.toString(),10)]={};for(var o=[],s=0,a=0;a<n.length;a++)if(a===r){this.maintainRows(n[parseInt(a.toString(),10)],s),o.push(n[parseInt(a.toString(),10)]),s++;for(var l=0;l<e.length;l++)this.maintainRows(e[parseInt(l.toString(),10)],s),o.push(e[parseInt(l.toString(),10)]),s++}else this.maintainRows(n[parseInt(a.toString(),10)],s),o.push(n[parseInt(a.toString(),10)]),s++;this.groupCache[this.parent.pageSettings.currentPage]=t.extend([],o),this.updateCurrentViewData()},r.prototype.getAggregateByCaptionIndex=function(e){for(var r=this.groupCache[this.parent.pageSettings.currentPage],i=r[parseInt(e.toString(),10)],n=i.indent,o=i.uid,s=[],a=e+1;a<r.length&&r[parseInt(a.toString(),10)].indent!==n;a++)t.isNullOrUndefined(r[parseInt(a.toString(),10)].indent)&&r[parseInt(a.toString(),10)].parentUid===o&&s.push(r[parseInt(a.toString(),10)]);return s},r.prototype.getChildRowsByParentIndex=function(e,r,i,n,o,s){var a=n||this.groupCache[this.parent.pageSettings.currentPage],l=a[parseInt(e.toString(),10)],h=[];if(!l.isCaptionRow||l.isCaptionRow&&!l.isExpand&&!s)return[];o&&this.parent.aggregates.length&&(h=this.getAggregateByCaptionIndex(e));for(var p=l.indent,d=l.uid,c=[],u=0,g=e+1;g<a.length;g++){if(a[parseInt(g.toString(),10)].parentUid===d){if(t.isNullOrUndefined(a[parseInt(g.toString(),10)].indent))continue;if(u++,c.push(a[parseInt(g.toString(),10)]),r&&a[parseInt(g.toString(),10)].isCaptionRow&&(c=c.concat(this.getChildRowsByParentIndex(g,r,i,n,o))),i&&u===this.pageSize)break}if(a[parseInt(g.toString(),10)].indent===p)break}return c.concat(h)},r.prototype.initialGroupRows=function(e){var t=[],r=this.groupCache[this.parent.pageSettings.currentPage];if(e)return this.getRenderedRowsObject();for(var i=0;i<r.length;i++)0===r[parseInt(i.toString(),10)].indent&&(t.push(r[parseInt(i.toString(),10)]),t=t.concat(this.getChildRowsByParentIndex(i,!0,!0,r,!0)));return t},r.prototype.getRenderedRowsObject=function(){for(var e=[],t=[].slice.call(this.parent.getContent().querySelectorAll("tr")),r=0;r<t.length;r++)e.push(this.getRowByUid(t[parseInt(r.toString(),10)].getAttribute("data-uid")));return e},r.prototype.getCacheRowsOnDownScroll=function(e){for(var r=[],i=this.groupCache[this.parent.pageSettings.currentPage],n=e,o=0;o<this.pageSize&&(i[parseInt(n.toString(),10)]&&!(i[parseInt(n.toString(),10)].indent<i[parseInt(e.toString(),10)].indent));o++)i[parseInt(n.toString(),10)].indent===i[parseInt(e.toString(),10)].indent&&(r.push(i[parseInt(n.toString(),10)]),i[parseInt(n.toString(),10)].isCaptionRow&&i[parseInt(n.toString(),10)].isExpand&&(r=r.concat(this.getChildRowsByParentIndex(n,!0,!0,null,!0)))),(i[parseInt(n.toString(),10)].indent>i[parseInt(e.toString(),10)].indent||t.isNullOrUndefined(i[parseInt(n.toString(),10)].indent))&&o--,n++;return r},r.prototype.getCacheRowsOnUpScroll=function(e,t,r){for(var i=[],n=this.groupCache[this.parent.pageSettings.currentPage],o=!1,s=0;s<n.length&&(!o||n[parseInt(s.toString(),10)]&&!(n[parseInt(s.toString(),10)].indent<n[parseInt(r.toString(),10)].indent)&&n[parseInt(s.toString(),10)].uid!==t);s++)o||n[parseInt(s.toString(),10)].uid!==e||(o=!0),o&&n[parseInt(s.toString(),10)].indent===n[parseInt(r.toString(),10)].indent&&(i.push(n[parseInt(s.toString(),10)]),n[parseInt(s.toString(),10)].isCaptionRow&&n[parseInt(s.toString(),10)].isExpand&&(i=i.concat(this.getChildRowsByParentIndex(s,!0,!0,null,!0))));return i},r.prototype.scrollHandler=function(e){if(!this.parent.isDestroyed&&!this.childCount){var t,r=[].slice.call(this.parent.getContent().getElementsByClassName("e-lazyload-middle-down")),i=[].slice.call(this.parent.getContent().getElementsByClassName("e-lazyload-middle-up")),n=[].slice.call(this.parent.getContent().getElementsByClassName("e-not-lazyload-end")),o=!1,s=!1,a=!1;if(e.scrollDown&&r.length&&(t=(d=this.findRowElements(r)).tr,o=d.entered),!e.scrollDown&&n)for(var l=0;l<n.length;l++){var h=n[parseInt(l.toString(),10)].getBoundingClientRect().top,p=this.parent.getContent().scrollHeight;if(h>0&&h<p){t=n[parseInt(l.toString(),10)],a=!0,this.rowIndex=t.rowIndex;break}}if(!e.scrollDown&&i.length&&!a){var d=this.findRowElements(i);t=d.tr,s=d.entered}t&&!t.classList.contains("e-masked-row")&&(o&&e.scrollDown&&o&&t&&this.scrollDownHandler(t),!e.scrollDown&&a&&t&&this.scrollUpEndRowHandler(t),this.cacheMode&&!e.scrollDown&&!a&&s&&t&&this.scrollUpHandler(t))}},r.prototype.scrollUpEndRowHandler=function(e){var t=this.parent.pageSettings.currentPage,r=this.groupCache[parseInt(t.toString(),10)],i=e.getAttribute("data-uid"),n=this.rowObjectIndex=this.getRowObjectIndexByUid(i),o=n,s=r[parseInt(n.toString(),10)],a=this.getRowByUid(s.parentUid),l=this.getRowObjectIndexByUid(a.uid),h=this.parent.getContent().querySelector("tr[data-uid="+a.uid+"]").rowIndex,p=this.getChildRowsByParentIndex(l).indexOf(s),d=Math.ceil(p/this.pageSize);if(1!==d)if(this.childCount=d*this.pageSize,n=this.getCurrentBlockEndIndex(s,n),this.childCount<a.data.count){e.classList.remove("e-not-lazyload-end"),s.lazyLoadCssClass="";var c=!!r[n+1]&&s.indent===r[n+1].indent;this.scrollData=c?this.getCacheRowsOnDownScroll(n+1):[];var u=lt(l,r),g={rowIndex:h,makeRequest:!c,groupInfo:a,fields:u.fields,keys:u.keys,skip:this.childCount,take:this.pageSize,isScroll:!0};if(this.cacheMode&&this.childCount>=this.pageSize*this.cacheBlockSize){var f=this.getChildRowsByParentIndex(l),m=Math.ceil(f.indexOf(r[parseInt(o.toString(),10)])/this.pageSize)-(this.cacheBlockSize-1);this.removeBlock(i,c,m,f),g.cachedRowIndex=m*this.pageSize}this.captionRowExpand(g)}else this.childCount=0},r.prototype.scrollDownHandler=function(e){var r=this.parent.pageSettings.currentPage,i=this.groupCache[parseInt(r.toString(),10)],n=e.getAttribute("data-uid"),o=this.getRowObjectIndexByUid(n),s=o,a=i[parseInt(o.toString(),10)],l=this.getRowByUid(a.parentUid),h=this.getRowObjectIndexByUid(l.uid),p=this.getRowElementByUid(l.uid).rowIndex,d=this.getChildRowsByParentIndex(h);if(0!==d.length){var c=d.indexOf(a),u=Math.ceil(c/this.pageSize);if(this.childCount=u*this.pageSize,!t.isNullOrUndefined(d[this.childCount-1])){this.parent.enableVirtualization&&(this.parent.islazyloadRequest=!0),o=this.rowObjectIndex=this.getRowObjectIndexByUid(d[this.childCount-1].uid);var g=i[parseInt(o.toString(),10)],f=this.getRowElementByUid(g.uid);if(this.rowIndex=f.rowIndex,o=this.getCurrentBlockEndIndex(g,o),this.childCount===l.data.count&&(this.parent.islazyloadRequest=!1),this.childCount<l.data.count){var m=!!i[o+1]&&a.indent===i[o+1].indent;if(m&&!t.isNullOrUndefined(this.getRowElementByUid(i[o+1].uid)))return this.parent.islazyloadRequest=!1,void(this.childCount=0);(u>1||!this.cacheMode)&&(e.classList.remove("e-lazyload-middle-down"),f.classList.remove("e-not-lazyload-end"),g.lazyLoadCssClass=""),this.scrollData=m?this.getCacheRowsOnDownScroll(this.rowObjectIndex+1):[];var y=lt(h,i),v={rowIndex:p,makeRequest:!m,groupInfo:l,fields:y.fields,keys:y.keys,skip:this.childCount,take:this.pageSize,isScroll:!0};if(this.cacheMode&&this.childCount-this.pageSize>=this.pageSize*this.cacheBlockSize){this.isScrollDown=!0;var C=this.getChildRowsByParentIndex(h),S=Math.ceil(C.indexOf(i[parseInt(s.toString(),10)])/this.pageSize)-1-(this.cacheBlockSize-1)+1;this.removeBlock(n,m,S,C,g),v.cachedRowIndex=S*this.pageSize}this.captionRowExpand(v)}else this.childCount=0,this.parent.islazyloadRequest=!1}}},r.prototype.getCurrentBlockEndIndex=function(e,t){var r=this.parent.pageSettings.currentPage,i=this.groupCache[parseInt(r.toString(),10)];if(e.isCaptionRow){if(e.isExpand){var n=this.getChildRowsByParentIndex(t,!0).length;this.rowIndex=this.rowIndex+n}var o=this.getAggregateByCaptionIndex(t);this.rowObjectIndex=this.rowObjectIndex+o.length;for(var s=t,a=s+1;a<i.length;a++){if(i[parseInt(a.toString(),10)].indent===i[parseInt(t.toString(),10)].indent||i[parseInt(a.toString(),10)].indent<i[parseInt(t.toString(),10)].indent){t=s;break}s++}}return t},r.prototype.removeBlock=function(e,t,r,i,n){var o=this.parent.pageSettings.currentPage,s=this.groupCache[parseInt(o.toString(),10)],a=i[(r+1)*this.pageSize-1-this.blockSize].uid,l=i[r*this.pageSize-this.pageSize].uid,h=i[r*this.pageSize].uid,p=this.getRowObjectIndexByUid(a);s[parseInt(p.toString(),10)].lazyLoadCssClass="e-lazyload-middle-up",this.getRowElementByUid(a).classList.add("e-lazyload-middle-up"),n&&(this.getRowElementByUid(h).classList.add("e-not-lazyload-first"),this.getRowByUid(h).lazyLoadCssClass="e-not-lazyload-first",this.getRowByUid(l).lazyLoadCssClass=""),t?this.removeTopRows(n?n.uid:e,l,h):(this.uid1=l,this.uid2=h,this.uid3=n?n.uid:e)},r.prototype.scrollUpHandler=function(e){var r=this.parent.pageSettings.currentPage,i=this.groupCache[parseInt(r.toString(),10)],n=e.getAttribute("data-uid"),o=this.getRowByUid(n),s=this.rowObjectIndex=this.getRowObjectIndexByUid(n),a=this.getRowByUid(o.parentUid),l=this.rowIndex=this.getRowObjectIndexByUid(a.uid),h=this.parent.getRowElementByUID(a.uid).rowIndex,p=this.getChildRowsByParentIndex(l),d=p.indexOf(i[parseInt(s.toString(),10)]),c=Math.floor(d/this.pageSize),u=this.blockSize;2*this.blockSize>this.pageSize&&(u=2*this.blockSize-this.pageSize,u=this.blockSize-u);var g=p[d-(u-1)-this.pageSize].uid,f=p[d-(u-1)].uid;this.scrollData=this.getCacheRowsOnUpScroll(g,f,s-(u-1)),this.isFirstChildRow=c>1,this.isFirstChildRow&&(this.scrollData[0].lazyLoadCssClass="e-not-lazyload-first"),this.getRowByUid(f).lazyLoadCssClass="",this.getRowElementByUid(f).classList.remove("e-not-lazyload-first");var m=c+this.cacheBlockSize;if(p.length!==a.data.count&&m*this.pageSize>p.length)return this.isFirstChildRow=!1,this.scrollData[0].lazyLoadCssClass="",void this.getRowElementByUid(f).classList.add("e-not-lazyload-first");var y=m*this.pageSize>a.data.count?a.data.count:m*this.pageSize,v=m*this.pageSize>a.data.count?this.pageSize-(this.pageSize*m-a.data.count):this.pageSize,C=this.getChildRowsByParentIndex(i.indexOf(p[y-1]),!0,!1,null,!0),S=C.length?C[C.length-1].uid:p[y-1].uid,b=p[y-v].uid,w=p[y-v-1].uid,I=this.objIdxByUid[parseInt(r.toString(),10)][""+b]-u;if("e-lazyload-middle-down"===i[parseInt(I.toString(),10)].lazyLoadCssClass){var R=this.getRowElementByUid(i[parseInt(I.toString(),10)].uid);R&&R.classList.add("e-lazyload-middle-down")}if(this.getRowByUid(S).lazyLoadCssClass="",this.getRowByUid(w).lazyLoadCssClass="e-not-lazyload-end",this.getRowElementByUid(w).classList.add("e-not-lazyload-end"),this.removeBottomRows(S,b,w),this.rowIndex=e.rowIndex-u,e.classList.length>1?e.classList.remove("e-lazyload-middle-up"):e.removeAttribute("class"),!t.isNullOrUndefined(this.getRowElementByUid(g)))return this.childCount=0,void(this.scrollData=[]);var x=lt(this.getRowObjectIndexByUid(a.uid),i),F={rowIndex:h,makeRequest:!1,groupInfo:a,fields:x.fields,keys:x.keys,skip:this.childCount,take:this.pageSize,isScroll:!0,scrollUp:!0};this.isScrollUp=!0,this.captionRowExpand(F)},r.prototype.findRowElements=function(e){for(var t,r=!1,i=0;i<e.length;i++){var n=e[parseInt(i.toString(),10)].rowIndex;if(this.parent.enableVirtualization){var o=this.parent.contentModule.currentInfo;o&&o.blockIndexes&&o.blockIndexes[0]>1&&(n+=this.parent.contentModule.offsets[o.blockIndexes[0]-1]/this.parent.getRowHeight())}if(Ee(n,this.parent)){r=!0,this.rowIndex=n,t=e[parseInt(i.toString(),10)];break}}return{entered:r,tr:t}},r.prototype.getRowElementByUid=function(e){return this.parent.getContent().querySelector("tr[data-uid="+e+"]")},r.prototype.removeTopRows=function(e,r,i){for(var n=[].slice.call(this.parent.getContent().querySelectorAll("tr")),o=!1,s=0;s<n.length;s++){if(n[parseInt(s.toString(),10)].getAttribute("data-uid")===i){var a=this.parent.getContent().querySelector("tr[data-uid="+e+"]");a&&(this.rowIndex=a.rowIndex);break}n[parseInt(s.toString(),10)].getAttribute("data-uid")===r&&(o=!0),o&&t.remove(n[parseInt(s.toString(),10)])}},r.prototype.removeBottomRows=function(e,r,i){for(var n=[].slice.call(this.parent.getContent().querySelectorAll("tr")),o=!1,s=0;s<n.length&&(n[parseInt(s.toString(),10)].getAttribute("data-uid")===r&&(o=!0),!o||(t.remove(n[parseInt(s.toString(),10)]),n[parseInt(s.toString(),10)].getAttribute("data-uid")!==e));s++);},r.prototype.setCache=function(e){var r=this.parent.pageSettings.currentPage;this.parent.enableVirtualization&&(this.parent.lazyLoadRender=this),this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.args.requestType&&e.args.prevPage!==e.args.currentPage?this.groupCache[parseInt(r.toString(),10)]=this.initialGroupCaptions[parseInt(r.toString(),10)]=this.groupCache[e.args.prevPage].concat(t.extend([],e.data)):this.groupCache[parseInt(r.toString(),10)]=this.initialGroupCaptions[parseInt(r.toString(),10)]=t.extend([],e.data)},r.prototype.captionRowExpand=function(e){var t=this,r=e.groupInfo,i=this.parent.groupSettings.columns.indexOf(r.data.field)+1,n=at(st(e.fields,e.keys,this)),o={level:i,skip:e.skip,take:e.take,where:n};if(e.makeRequest){var s=this.parent.renderModule.data.generateQuery(!0);s.isCountRequired||(s.isCountRequired=!0),s.lazyLoad.push({key:"onDemandGroupInfo",value:o}),this.lazyLoadQuery.push(o.where),e.isScroll&&this.parent.enableVirtualMaskRow?this.parent.showMaskRow():this.parent.showSpinner(),this.parent.renderModule.data.getData({},s).then(function(r){t.parent.enableVirtualization&&(t.parent.islazyloadRequest=!0),t.parent.hideSpinner(),t.parent.removeMaskRow(),0!==r.result.length&&(t.cacheMode&&t.uid1&&t.uid2&&(t.removeTopRows(t.uid3,t.uid1,t.uid2),t.uid1=t.uid2=t.uid3=void 0),t.lazyLoadHandler({data:r.result,count:r.count,level:i,index:e.rowIndex,isRowExist:!1,isScroll:e.isScroll,up:!1,rowIndex:e.cachedRowIndex}))}).catch(function(e){return t.parent.renderModule.dataManagerFailure(e,{requestType:"grouping"})})}else this.lazyLoadHandler({data:null,count:e.groupInfo.data.count,level:i,index:e.rowIndex,isRowExist:!0,isScroll:e.isScroll,up:e.scrollUp,rowIndex:e.cachedRowIndex})},r.prototype.scrollReset=function(e){this.parent.getContent().firstElementChild.scrollTop=e?this.parent.getContent().firstElementChild.scrollTop+e:0},r.prototype.updateCurrentViewData=function(){var e=[];this.getRows().filter(function(t){t.isDataRow&&(e[t.index]=t.data)}),this.parent.currentViewData=e.length?e:this.parent.currentViewData},r.prototype.getGroupCache=function(){return this.groupCache},r.prototype.getRows=function(){return this.groupCache[this.parent.pageSettings.currentPage]||[]},r.prototype.getRowElements=function(){return[].slice.call(this.parent.getContent().getElementsByClassName(Zr))},r.prototype.getRowByIndex=function(e){for(var r,i=[].slice.call(this.parent.getContent().getElementsByClassName(Zr)),n=0;!t.isNullOrUndefined(e)&&n<i.length;n++)if(i[parseInt(n.toString(),10)].getAttribute(si)===e.toString()){r=i[parseInt(n.toString(),10)];break}return r},r.prototype.setVisible=function(e){var r,i=this.parent;this.getRows().some(function(e){return e.isDataRow&&(r=e),e.isDataRow});for(var n=this.getRows().filter(function(e){return!e.isDetailRow}),o=0;o<e.length;o++){var s=e[parseInt(o.toString(),10)],a=this.parent.getNormalizedColumnIndex(s.uid),l=this.parent.getColumnIndexByUid(s.uid),h=!0===s.visible?"":"none";-1!==a&&r&&a<r.cells.length&&t.setStyleAttribute(this.getColGroup().childNodes[parseInt(a.toString(),10)],{display:h}),this.setDisplayNone(i.getDataRows(),l,h,n,a),!this.parent.invokedFromMedia&&s.hideAtMedia&&this.parent.updateMediaColumns(s),this.parent.invokedFromMedia=!1}},r.prototype.setDisplayNone=function(e,r,i,n,o){if(this.parent.groupSettings.columns.length)for(var s=Object.keys(this.groupCache),a=0;a<s.length;a++)for(var l=this.rowsByUid[s[parseInt(a.toString(),10)]],h=Object.keys(l),p=0;p<h.length;p++){var d=this.parent.getContent().querySelector("tr[data-uid="+h[parseInt(p.toString(),10)]+"]"),c=l[h[parseInt(p.toString(),10)]];c.isCaptionRow&&(this.captionModelGen.isEmpty()?(c.cells[c.indent+1].colSpan=""===i?c.cells[c.indent+1].colSpan+1:c.cells[c.indent+1].colSpan-1,d&&(d.cells[c.indent+1].colSpan=c.cells[c.indent+1].colSpan)):this.changeCaptionRow(c,d,s[parseInt(a.toString(),10)])),c.isDataRow&&(this.showAndHideCells(d,r,i,!1),c.cells[parseInt(o.toString(),10)].visible=""===i),c.isCaptionRow||c.isDataRow||!t.isNullOrUndefined(c.indent)||(c.cells[parseInt(o.toString(),10)].visible=""===i,c.visible=c.cells.some(function(e){return e.isDataCell&&e.visible}),this.showAndHideCells(d,r,i,!0,c))}else Je(e,r,i,n)},r.prototype.changeCaptionRow=function(e,t,r){var i=e,n=e.data,o=this.groupGenerator.generateCaptionRow(n,i.indent,i.parentGid,void 0,i.tIndex,i.parentUid);o.uid=e.uid,o.isExpand=e.isExpand,o.lazyLoadCssClass=e.lazyLoadCssClass,this.rowsByUid[parseInt(r.toString(),10)][e.uid]=o,this.groupCache[parseInt(r.toString(),10)][this.objIdxByUid[parseInt(r.toString(),10)][e.uid]]=o,t&&this.parent.getContentTable().querySelector(li).replaceChild(this.rowRenderer.render(o,this.parent.getColumns()),t)},r.prototype.showAndHideCells=function(e,r,i,n,o){if(e){var s=n?"td.e-summarycell":"td.e-rowcell";t.setStyleAttribute(e.querySelectorAll(s)[parseInt(r.toString(),10)],{display:i}),e.querySelectorAll(s)[parseInt(r.toString(),10)].classList.contains("e-hide")&&t.removeClass([e.querySelectorAll(s)[parseInt(r.toString(),10)]],["e-hide"]),n&&(o.visible&&e.classList.contains("e-hide")?t.removeClass([e],["e-hide"]):o.visible||t.addClass([e],["e-hide"]))}},r}(Ii),Gs=function(){function t(e,t){this.parent=e,this.serviceLocator=t,this.addEventListener()}return t.prototype.getModuleName=function(){return"lazyLoadGroup"},t.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(Kt,this.instantiateRenderer,this),this.parent.on(lr,this.destroy,this))},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Kt,this.instantiateRenderer),this.parent.off(lr,this.destroy))},t.prototype.instantiateRenderer=function(){"auto"===this.parent.height&&(this.parent.height=this.parent.pageSettings.pageSize*this.parent.getRowHeight());var t=this.serviceLocator.getService("rendererFactory");this.parent.groupSettings.enableLazyLoading&&t.addRenderer(e.RenderType.Content,new Vs(this.parent,this.serviceLocator)),this.parent.enableVirtualization&&(this.parent.lazyLoadRender=new Vs(this.parent,this.serviceLocator))},t.prototype.destroy=function(){this.removeEventListener()},t}(),_s=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ws=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return _s(i,e),i.prototype.write=function(e){this.column=e.column;var i="Dialog"!==this.parent.editSettings.mode;this.object=new s.AutoComplete(t.extend({dataSource:this.parent.dataSource instanceof r.DataManager?this.parent.dataSource:new r.DataManager(this.parent.dataSource),query:(new r.Query).select(e.column.field),enabled:X(e.column,e.requestType,e.element),fields:{value:e.column.field},value:ge(e.column.field,e.rowData),actionComplete:this.selectedValues.bind(this),placeholder:i?"":e.column.headerText,floatLabelType:i?"Never":"Always"},e.column.edit.params)),this.object.appendTo(e.element),e.element.setAttribute("name",W(e.column.field))},i.prototype.selectedValues=function(e){e.result=r.DataUtil.distinct(e.result,this.object.fields.value,!0),this.column.dataSource&&(this.column.dataSource.dataSource.json=e.result)},i}(Vo),Ks=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Qs=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ks(i,e),i.prototype.write=function(e){this.column=e.column;var i="Dialog"!==this.parent.editSettings.mode;this.obj=new s.ComboBox(t.extend({dataSource:this.parent.dataSource instanceof r.DataManager?this.parent.dataSource:new r.DataManager(this.parent.dataSource),query:(new r.Query).select(e.column.field),fields:{value:e.column.field},value:ge(e.column.field,e.rowData),enableRtl:this.parent.enableRtl,actionComplete:this.finalValue.bind(this),placeholder:i?"":e.column.headerText,floatLabelType:i?"Never":"Always",enabled:X(e.column,e.requestType,e.element),cssClass:this.parent.cssClass?this.parent.cssClass:null},e.column.edit.params)),this.obj.appendTo(e.element)},i.prototype.finalValue=function(e){e.result=r.DataUtil.distinct(e.result,this.obj.fields.value,!0),this.column.dataSource&&(this.column.dataSource.dataSource.json=e.result)},i}(Vo),Xs=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ys=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Xs(r,e),r.prototype.write=function(e){this.column=e.column;var r="Dialog"!==this.parent.editSettings.mode;this.obj=new s.MultiSelect(t.extend({fields:{text:e.column.field,value:e.column.field},value:t.getValue(e.column.field,e.rowData),enableRtl:this.parent.enableRtl,placeholder:r?"":e.column.headerText,popupHeight:"200px",floatLabelType:r?"Never":"Always",cssClass:this.parent.cssClass?this.parent.cssClass:null},e.column.edit.params)),this.obj.appendTo(e.element),e.element.setAttribute("name",W(e.column.field))},r}(Vo),Js=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Zs=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Js(r,e),r.prototype.write=function(e){var r="Dialog"!==this.parent.editSettings.mode,i=ge(e.column.field,e.rowData);i=i?new Date(i):null,this.obj=new a.TimePicker(t.extend({floatLabelType:r?"Never":"Always",value:i,placeholder:r?"":e.column.headerText,enableRtl:this.parent.enableRtl,enabled:X(e.column,e.requestType,e.element),cssClass:this.parent.cssClass?this.parent.cssClass:null},e.column.edit.params)),this.obj.appendTo(e.element)},r}(Vo),$s=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ea=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.activeClasses=["e-selectionbackground","e-active"],t}return $s(r,e),r.prototype.create=function(e){var t="e-field e-boolcell";return"checkbox"===e.column.type&&(t="e-field e-boolcell e-edit-checkselect"),$e(this.parent,e.column,t,{type:"checkbox",value:e.value})},r.prototype.read=function(e){return e.checked},r.prototype.write=function(e){var r=!t.isNullOrUndefined(e.row)&&e.row.querySelector(".e-edit-checkselect"),i=ge(e.column.field,e.rowData),o=i&&JSON.parse(i.toString().toLowerCase());if(!t.isNullOrUndefined(r)){if(this.editType=this.parent.editSettings.mode,this.editRow=e.row,"add"!==e.requestType){var s=this.parent.getRowObjectFromUID(e.row.getAttribute("data-uid"));o=!!s&&s.isSelected}$.apply(void 0,[[].slice.call(e.row.getElementsByClassName(Ur)),o].concat(this.activeClasses))}this.obj=new n.Switch(t.extend({label:"Dialog"!==this.parent.editSettings.mode?" ":e.column.headerText,checked:o,disabled:!X(e.column,e.requestType,e.element),enableRtl:this.parent.enableRtl,change:this.switchModeChange.bind(this),cssClass:this.parent.cssClass?this.parent.cssClass:""},e.column.edit.params)),this.obj.appendTo(e.element)},r.prototype.switchModeChange=function(e){if(this.editRow&&"Dialog"!==this.editType){var t=!1;e.checked?(t=!0,this.editRow.setAttribute("aria-selected",t.toString())):this.editRow.removeAttribute("aria-selected"),$.apply(void 0,[[].slice.call(this.editRow.getElementsByClassName(Ur)),t].concat(this.activeClasses))}},r}(Vo),ta=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ra=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return ta(r,e),r.prototype.write=function(e){this.column=e.column;var r="Dialog"!==this.parent.editSettings.mode;this.obj=new o.MaskedTextBox(t.extend({fields:{value:e.column.field},value:ge(e.column.field,e.rowData),floatLabelType:r?"Never":"Always",mask:"000-000-0000",enabled:X(e.column,e.requestType,e.element),cssClass:this.parent.cssClass?this.parent.cssClass:null},e.column.edit.params)),this.obj.appendTo(e.element)},r}(Vo);return Vn.Inject(Co,oo,Cn,Jn,Ro,wo,Io,xo,Fo,Do,Sn,No,ss,bo,ps,ds,gs,ms,Es,zs,as,Ds,Us,Gs),e.CheckBoxFilterBase=Qn,e.ExcelFilterBase=Yn,e.SortDescriptor=Mn,e.SortSettings=Dn,e.Predicate=On,e.InfiniteScrollSettings=kn,e.FilterSettings=An,e.SelectionSettings=Ln,e.SearchSettings=Pn,e.RowDropSettings=Bn,e.TextWrapSettings=Nn,e.ResizeSettings=qn,e.GroupSettings=Hn,e.EditSettings=Un,e.LoadingIndicator=jn,e.Grid=Vn,e.doesImplementInterface=u,e.valueAccessor=g,e.headerValueAccessor=f,e.getUpdateUsingRaf=m,e.isExportColumns=y,e.updateColumnTypeForExportColumns=v,e.updatecloneRow=C,e.getCollapsedRowsCount=S,e.recursive=b,e.iterateArrayOrObject=w,e.iterateExtend=I,e.templateCompiler=R,e.setStyleAndAttributes=x,e.extend=F,e.setColumnIndex=T,e.prepareColumns=E,e.setCssInGridPopUp=z,e.getActualProperties=D,e.parentsUntil=O,e.getElementIndex=k,e.inArray=A,e.getActualPropFromColl=L,e.removeElement=P,e.getPosition=B,e.getUid=N,e.appendChildren=q,e.parents=H,e.calculateAggregate=U,e.getScrollBarWidth=j,e.getRowHeight=V,e.getActualRowHeight=G,e.isComplexField=_,e.getComplexFieldID=W,e.getParsedFieldID=K,e.setComplexFieldID=Q,e.isEditable=X,e.isActionPrevent=Y,e.wrap=J,e.setFormatter=Z,e.addRemoveActiveClasses=$,e.distinctStringValues=ee,e.getFilterMenuPostion=te,e.getZIndexCalcualtion=re,e.toogleCheckbox=ie,e.setChecked=ne,e.createCboxWithWrap=oe,e.removeAddCboxClasses=se,e.refreshForeignData=ae,e.getForeignData=le,e.getColumnByForeignKeyValue=he,e.padZero=pe,e.getDatePredicate=de,e.renderMovable=ce,e.isGroupAdaptive=ue,e.getObject=ge,e.getCustomDateFormat=fe,e.getExpandedState=me,e.getPrintGridModel=ye,e.extendObjWithFn=ve,e.measureColumnDepth=Se,e.checkDepth=be,e.refreshFilteredColsUid=we,e.getTransformValues=Ie,e.applyBiggerTheme=Re,e.alignFrozenEditForm=xe,e.ensureLastRow=Fe,e.ensureFirstRow=Te,e.isRowEnteredInGrid=Ee,e.getEditedDataIndex=ze,e.eventPromise=Me,e.getStateEventArgument=De,e.ispercentageWidth=Oe,e.resetRowIndex=ke,e.compareChanges=Ae,e.setRowElements=Le,e.splitFrozenRowObjectCells=Pe,e.getExactFrozenMovableColumn=Be,e.gridActionHandler=Ne,e.getGridRowObjects=qe,e.getGridRowElements=He,e.sliceElements=Ue,e.getCellsByTableName=je,e.getCellByColAndRowIndex=Ve,e.setValidationRuels=Ge,e.getMovableTbody=_e,e.getFrozenRightTbody=We,e.setRowsInTbody=Ke,e.getNumberFormat=Qe,e.addBiggerDialog=Xe,e.performComplexDataOperation=Ye,e.setDisplayValue=Je,e.addRemoveEventListener=Ze,e.createEditElement=$e,e.getColumnModelByUid=et,e.getColumnModelByFieldName=tt,e.registerEventHandlers=rt,e.removeEventHandlers=it,e.clearReactVueTemplates=nt,e.getRowIndexFromElement=ot,e.generateExpandPredicates=st,e.getPredicates=at,e.getGroupKeysAndFields=lt,e.findCellIndex=ht,e.capitalizeFirstLetter=pt,e.created="create",e.destroyed="destroy",e.load="load",e.rowDataBound="rowDataBound",e.queryCellInfo="queryCellInfo",e.headerCellInfo="headerCellInfo",e.actionBegin=Bt,e.actionComplete=Nt,e.actionFailure="actionFailure",e.dataBound=qt,e.rowSelecting="rowSelecting",e.rowSelected="rowSelected",e.rowDeselecting="rowDeselecting",e.rowDeselected="rowDeselected",e.cellSelecting="cellSelecting",e.cellSelected="cellSelected",e.cellDeselecting="cellDeselecting",e.cellDeselected="cellDeselected",e.columnSelecting="columnSelecting",e.columnSelected="columnSelected",e.columnDeselecting="columnDeselecting",e.columnDeselected="columnDeselected",e.columnDragStart=Ht,e.columnDrag=Ut,e.columnDrop=jt,e.rowDragStartHelper=Vt,e.rowDragStart=Gt,e.rowDrag=_t,e.rowDrop=Wt,e.beforePrint="beforePrint",e.printComplete="printComplete",e.detailDataBound="detailDataBound",e.toolbarClick="toolbarClick",e.batchAdd="batchAdd",e.batchCancel="batchCancel",e.batchDelete="batchDelete",e.beforeBatchAdd="beforeBatchAdd",e.beforeBatchDelete="beforeBatchDelete",e.beforeBatchSave="beforeBatchSave",e.beginEdit="beginEdit",e.cellEdit="cellEdit",e.cellSave="cellSave",e.cellSaved="cellSaved",e.endAdd="endAdd",e.endDelete="endDelete",e.endEdit="endEdit",e.recordDoubleClick="recordDoubleClick",e.recordClick="recordClick",e.beforeDataBound="beforeDataBound",e.beforeOpenColumnChooser="beforeOpenColumnChooser",e.beforeOpenAdaptiveDialog="beforeOpenAdaptiveDialog",e.resizeStart="resizeStart",e.onResize="resizing",e.resizeStop="resizeStop",e.checkBoxChange="checkBoxChange",e.beforeCopy="beforeCopy",e.beforePaste="beforePaste",e.beforeAutoFill="beforeAutoFill",e.filterChoiceRequest="filterchoicerequest",e.filterAfterOpen="filterafteropen",e.filterBeforeOpen="filterbeforeopen",e.filterSearchBegin="filtersearchbegin",e.commandClick="commandClick",e.exportGroupCaption="exportGroupCaption",e.lazyLoadGroupExpand="lazyLoadGroupExpand",e.lazyLoadGroupCollapse="lazyLoadGroupCollapse",e.initialLoad=Kt,e.initialEnd=Qt,e.dataReady=Xt,e.contentReady=Yt,e.uiUpdate=Jt,e.onEmpty=Zt,e.inBoundModelChanged=$t,e.modelChanged=er,e.colGroupRefresh=tr,e.headerRefreshed=rr,e.pageBegin="paging-begin",e.pageComplete="paging-complete",e.sortBegin="sorting-begin",e.sortComplete="sorting-complete",e.filterBegin="filtering-begin",e.filterComplete="filtering-complete",e.searchBegin="searching-begin",e.searchComplete="searching-complete",e.reorderBegin="reorder-begin",e.reorderComplete=ir,e.rowDragAndDropBegin="rowdraganddrop-begin",e.rowDragAndDropComplete=nr,e.groupBegin="grouping-begin",e.groupComplete="grouping-complete",e.ungroupBegin="ungrouping-begin",e.ungroupComplete="ungrouping-complete",e.groupAggregates="group-aggregates",e.refreshFooterRenderer="refresh-footer-rendered",e.refreshAggregateCell="refresh-aggregate-cell",e.refreshAggregates="refresh-aggregates",e.rowSelectionBegin="rowselecting",e.rowSelectionComplete="rowselected",e.columnSelectionBegin="columnselecting",e.columnSelectionComplete="columnselected",e.cellSelectionBegin="cellselecting",e.cellSelectionComplete="cellselected",e.beforeCellFocused=or,e.cellFocused="cellfocused",e.keyPressed=sr,e.click=ar,e.destroy=lr,e.columnVisibilityChanged=hr,e.scroll="scroll",e.columnWidthChanged="column-width-changed",e.columnPositionChanged=pr,e.rowDragAndDrop="row-drag-and-drop",e.rowsAdded=dr,e.rowsRemoved=cr,e.columnDragStop=ur,e.headerDrop=gr,e.dataSourceModified=fr,e.refreshComplete="refresh-complete",e.refreshVirtualBlock=mr,e.dblclick="dblclick",e.toolbarRefresh="toolbar-refresh",e.bulkSave="bulk-save",e.autoCol=yr,e.tooltipDestroy="tooltip-destroy",e.updateData=vr,e.editBegin="edit-begin",e.editComplete="edit-complete",e.addBegin="add-begin",e.addComplete="add-complete",e.saveComplete="save-complete",e.deleteBegin="delete-begin",e.deleteComplete="delete-complete",e.preventBatch=Cr,e.dialogDestroy=Sr,e.crudAction="crud-Action",e.addDeleteAction=br,e.destroyForm="destroy-form",e.doubleTap="double-tap",e.beforeExcelExport="beforeExcelExport",e.excelExportComplete="excelExportComplete",e.excelQueryCellInfo="excelQueryCellInfo",e.excelHeaderQueryCellInfo="excelHeaderQueryCellInfo",e.exportDetailDataBound="exportDetailDataBound",e.beforePdfExport="beforePdfExport",e.pdfExportComplete="pdfExportComplete",e.pdfQueryCellInfo="pdfQueryCellInfo",e.pdfHeaderQueryCellInfo="pdfHeaderQueryCellInfo",e.accessPredicate="access-predicate",e.contextMenuClick="contextMenuClick",e.freezeRender=wr,e.freezeRefresh="freezerefresh",e.contextMenuOpen="contextMenuOpen",e.columnMenuClick="columnMenuClick",e.columnMenuOpen="columnMenuOpen",e.filterOpen="filterOpen",e.filterDialogCreated="filterDialogCreated",e.filterMenuClose=Ir,e.initForeignKeyColumn="initForeignKeyColumn",e.getForeignKeyData="getForeignKeyData",e.generateQuery="generateQuery",e.showEmptyGrid="showEmptyGrid",e.foreignKeyData="foreignKeyData",e.columnDataStateChange="columnDataStateChange",e.dataStateChange="dataStateChange",e.dataSourceChanged="dataSourceChanged",e.rtlUpdated="rtl-updated",e.beforeFragAppend="beforeFragAppend",e.frozenHeight="frozenHeight",e.textWrapRefresh="textWrapRefresh",e.recordAdded="recordAdded",e.cancelBegin="cancel-Begin",e.editNextValCell="editNextValCell",e.hierarchyPrint=Rr,e.expandChildGrid=xr,e.printGridInit="printGrid-Init",e.exportRowDataBound="export-RowDataBound",e.exportDataBound="export-DataBound",e.rowPositionChanged=Fr,e.columnChooserOpened="columnChooserOpened",e.batchForm="batchedit-form",e.beforeStartEdit="edit-form",e.beforeBatchCancel="before-batch-cancel",e.batchEditFormRendered="batcheditform-rendered",e.partialRefresh="partial-refresh",e.beforeCustomFilterOpen="beforeCustomFilterOpen",e.selectVirtualRow="select-virtual-Row",e.columnsPrepared=Tr,e.cBoxFltrBegin="cbox-filter-begin",e.cBoxFltrComplete=Er,e.fltrPrevent=zr,e.beforeFltrcMenuOpen="before-filter-cmenu-open",e.valCustomPlacement="validation-custom-placement",e.filterCboxValue="filter-cbox-value",e.componentRendered="component-rendered",e.restoreFocus="restore-Focus",e.detailStateChange="detail-state-change",e.detailIndentCellInfo="detail-indentcell-info",e.virtaulKeyHandler="virtaul-key-handler",e.virtaulCellFocus="virtaul-cell-focus",e.virtualScrollEditActionBegin="virtual-scroll-edit-action-begin",e.virtualScrollEditSuccess="virtual-scroll-edit-success",e.virtualScrollEditCancel="virtual-scroll-edit-cancel",e.virtualScrollEdit="virtual-scroll-edit",e.refreshVirtualCache="refresh-virtual-cache",e.editReset="edit-reset",e.virtualScrollAddActionBegin="virtual-scroll-add-action-begin",e.getVirtualData=Mr,e.refreshInfiniteModeBlocks=Dr,e.resetInfiniteBlocks="reset-infinite-blocks",e.infiniteScrollHandler="infinite-scroll-handler",e.infinitePageQuery="infinite-page-query",e.infiniteShowHide="infinite-show-hide",e.appendInfiniteContent="append-infinite-content",e.removeInfiniteRows="remove-infinite-rows",e.setInfiniteCache="set-infinite-cache",e.infiniteEditHandler="infinite-edit-handler",e.initialCollapse="initial-collapse",e.getAggregateQuery="get-aggregate-query",e.closeFilterDialog="close-filter-dialog",e.columnChooserCancelBtnClick="columnChooserCancelBtnClick",e.getFilterBarOperator="get-filterbar-operator",e.resetColumns="reset-columns",e.pdfAggregateQueryCellInfo="pdfAggregateQueryCellInfo",e.excelAggregateQueryCellInfo="excelAggregateQueryCellInfo",e.setGroupCache="group-cache",e.lazyLoadScrollHandler="lazy-load-scroll-handler",e.groupCollapse="group-collapse",e.beforeCheckboxRenderer="beforeCheckboxRenderer",e.refreshHandlers=Or,e.refreshFrozenColumns="refresh-frozen-columns",e.setReorderDestinationElement="set-reorder-destination-element",e.refreshVirtualFrozenHeight="refresh-virtual-frozen-height",e.setFreezeSelection="set-freeze-selection",e.setInfiniteFrozenHeight="set-infinite-frozen-height",e.setInfiniteColFrozenHeight="set-infinite-col-frozen-height",e.beforeRefreshOnDataChange="before-refresh-on-data-change",e.immutableBatchCancel="immutable-batch-cancel",e.refreshVirtualFrozenRows="refresh-virtual-frozenrows",e.checkScrollReset="check-scroll-reset",e.refreshFrozenHeight="refresh-frozen-height",e.setHeightToFrozenElement="set-height-to-frozen-element",e.preventFrozenScrollRefresh="prevent-frozen-scroll-refresh",e.nextCellIndex="next-cell-index",e.refreshInfiniteCurrentViewData="refresh-infinite-current-view-data",e.infiniteCrudCancel="infinite-crud-cancel",e.filterDialogClose="filter-dialog-close",e.refreshCustomFilterOkBtn="refresh-cutsom-filter-ok-button",e.refreshCustomFilterClearBtn="refresh-cutsom-filter-clear-button",e.renderResponsiveCmenu="render-responsive-cmenu",e.filterCmenuSelect="filter-cmenu-select",e.customFilterClose="custom-filter-close",e.setFullScreenDialog="set-fullscreen-dialog",e.refreshExpandandCollapse="refresh-Expand-and-Collapse",e.rowModeChange="row-mode-change",e.enterKeyHandler="enter-key-handler",e.refreshVirtualMaxPage="refresh-virtual-max-page",e.setVirtualPageQuery="set-virtual-page-query",e.selectRowOnContextOpen="select-row-on-context-open",e.pagerRefresh="pager-refresh",e.closeInline="closeinline",e.closeBatch="closebatch",e.closeEdit="close-edit",e.resetVirtualFocus="reset-virtual-focus",e.afterContentRender="after-content-renderer",e.refreshVirtualEditFormCells="refresh-virtual-editform-cells",e.scrollToEdit="scroll-to-edit",e.beforeCheckboxRendererQuery="before-checkbox-renderer-query",e.createVirtualValidationForm="create-virtual-validation-form",e.validateVirtualForm="validate-virtual-form",e.destroyChildGrid=kr,e.stickyScrollComplete="sticky-scroll-complete",e.captionActionComplete="infinite-group-collapse",e.refreshInfinitePersistSelection="refresh-infinite-persist-selection",e.refreshInfiniteEditrowindex="refresh-infinite-editrowindex",e.afterFilterColumnMenuClose="after-filter-column-menu-close",e.beforeCheckboxfilterRenderer="beforeCheckboxfilterRenderer",e.commandColumnDestroy=Ar,e.batchCnfrmDlgCancel="cancelcnfrmDlg",e.refreshVirtualLazyLoadCache="refresh-Virtual-LazyLoad-Cache",e.rowCell=Ur,e.gridHeader=jr,e.gridContent=Vr,e.gridFooter=Gr,e.headerContent=_r,e.movableContent=Wr,e.movableHeader=Kr,e.frozenContent=Qr,e.frozenHeader=Xr,e.content=Yr,e.table=Jr,e.row=Zr,e.gridChkBox=$r,e.editedRow=ei,e.addedRow=ti,e.changedRecords="changedRecords",e.addedRecords="addedRecords",e.deletedRecords="deletedRecords",e.leftRight=ri,e.frozenRight=ii,e.frozenLeft=ni,e.dataColIndex=oi,e.ariaColIndex="aria-colindex",e.dataRowIndex=si,e.ariaRowIndex=ai,e.tbody=li,e.colGroup=hi,e.open=pi,e.change="change",e.focus="focus",e.create="created",e.beforeOpen="beforeOpen",e.downArrow=di,e.upArrow=ci,e.pageUp="PageUp",e.pageDown="PageDown",e.enter=ui,e.shiftEnter=gi,e.tab="tab",e.shiftTab="shiftTab",e.Data=Br,e.Sort=Jn,e.Page=oo,e.Selection=Cn,e.Filter=Co,e.Search=Sn,e.Scroll=wn,e.resizeClassList=So,e.Resize=bo,e.Reorder=wo,e.RowDD=Io,e.Group=Ro,e.getCloneProperties=c,e.Print=Gn,e.DetailRow=xo,e.Toolbar=Fo,e.Aggregate=Do,e.summaryIterator=dt,e.VirtualScroll=No,e.Edit=ss,e.BatchEdit=es,e.InlineEdit=$o,e.NormalEdit=Jo,e.DialogEdit=rs,e.ColumnChooser=as,e.ExcelExport=ps,e.PdfExport=ds,e.ExportHelper=ls,e.ExportValueFormatter=hs,e.Clipboard=Tn,e.CommandColumn=gs,e.CheckBoxFilter=mo,e.menuClass=fs,e.ContextMenu=ms,e.Freeze=Es,e.ColumnMenu=zs,e.ExcelFilter=vo,e.ForeignKey=Ds,e.Logger=Bs,e.detailLists=Ns,e.InfiniteScroll=Us,e.LazyLoadGroup=Gs,e.Column=kt,e.CommandColumnModel=At,e.GridColumn=Lt,e.StackedColumn=Pt,e.Row=Nr,e.Cell=qr,e.HeaderRender=Ri,e.ContentRender=Ii,e.RowRenderer=fi,e.CellRenderer=xi,e.HeaderCellRenderer=zi,e.FilterCellRenderer=lo,e.StackedHeaderCellRenderer=Di,e.Render=Xi,e.IndentCellRenderer=ki,e.GroupCaptionCellRenderer=Li,e.GroupCaptionEmptyCellRenderer=Pi,e.BatchEditRender=Ho,e.DialogEditRender=Uo,e.InlineEditRender=qo,e.EditRender=jo,e.BooleanEditCell=_o,e.DefaultEditCell=Yo,e.DropDownEditCell=Ko,e.NumericEditCell=Qo,e.DatePickerEditCell=ns,e.CommandColumnRenderer=us,e.FreezeContentRender=Cs,e.FreezeRender=Ss,e.StringFilterUI=po,e.NumberFilterUI=co,e.DateFilterUI=go,e.BooleanFilterUI=uo,e.FlMenuOptrUI=ho,e.AutoCompleteEditCell=Ws,e.ComboboxEditCell=Qs,e.MultiSelectEditCell=Ys,e.TimePickerEditCell=Zs,e.ToggleEditCell=ea,e.MaskedTextBoxCellEdit=ra,e.VirtualContentRenderer=Lo,e.VirtualHeaderRenderer=Po,e.VirtualElementHandler=Bo,e.VirtualFreezeRenderer=xs,e.VirtualFreezeHdrRenderer=Fs,e.renderFrozenRows=gt,e.splitCells=ft,e.collectRows=mt,e.setFreezeSelectionAction=yt,e.selectFreezeRows=vt,e.appendContent=Ct,e.generateRows=St,e.getReorderedFrozenRows=bt,e.splitReorderedRows=wt,e.isXaxis=It,e.getHeaderCells=Rt,e.getVirtualFreezeHeader=xt,e.ensureFrozenCols=Ft,e.setColGroup=Tt,e.setCache=Et,e.setDebounce=zt,e.ColumnVirtualFreezeRenderer=Ts,e.GroupLazyLoadRenderer=Vs,e.ColumnFreezeHeaderRenderer=ws,e.ColumnFreezeContentRenderer=Is,e.ResponsiveDialogRenderer=Ji,e.EditCellBase=Vo,e.CellRendererFactory=Yi,e.ServiceLocator=Zi,e.RowModelGenerator=mi,e.GroupModelGenerator=wi,e.FreezeRowModelGenerator=ys,e.ValueFormatter=Mt,e.VirtualRowModelGenerator=ko,e.InterSectionObserver=Oo,e.Pager=ro,e.ExternalMessage=no,e.NumericContainer=Zn,e.PagerMessage=$n,e.PagerDropDown=io,e}({},ej.base,ej.data,ej.popups,ej.buttons,ej.inputs,ej.dropdowns,ej.calendars,ej.navigations,ej.excelexport,ej.pdfexport),this.ejs=ej;
//# sourceMappingURL=ej2-grids.min.js.map
