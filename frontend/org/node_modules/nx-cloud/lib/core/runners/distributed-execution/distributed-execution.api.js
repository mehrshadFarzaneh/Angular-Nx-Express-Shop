const a10_0x1525=['target','hash','createApiAxiosInstance','start','parseCommand','recordMetric','VERBOSE_LOGGING','apply','axiosMultipleTries','error:\x20','NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','../../../utilities/nx-imports','NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE','data','/nx-cloud/executions/start','Starting\x20a\x20distributed\x20execution','then','map','serializeOverrides','completeRunGroupWithError','post','dteStart','completeRunGroup','/nx-cloud/executions/complete-run-group','defineProperty','next','RUNNER_FAILURE_PERF_ENTRY','axiosException','parallel','false','dteStatus','enabled','DistributedExecutionApi','maxParallel','../../../utilities/serializer-overrides','error','apiAxiosInstance','project','stopAgentsOnFailure','createStartRequest','note','done','createMetricRecorder','value','__esModule','configuration','mapRespToPerfEntry','response','agentCount','ciExecutionEnv:\x20','exit'];(function(_0x242c5e,_0x152532){const _0x5ee01d=function(_0x5803de){while(--_0x5803de){_0x242c5e['push'](_0x242c5e['shift']());}};_0x5ee01d(++_0x152532);}(a10_0x1525,0xfc));const a10_0x5ee0=function(_0x242c5e,_0x152532){_0x242c5e=_0x242c5e-0x0;let _0x5ee01d=a10_0x1525[_0x242c5e];return _0x5ee01d;};'use strict';var __awaiter=this&&this['__awaiter']||function(_0x1eb054,_0x1726f5,_0x3115ee,_0xb93d7f){function _0x3868dd(_0x4a6fdf){return _0x4a6fdf instanceof _0x3115ee?_0x4a6fdf:new _0x3115ee(function(_0x417610){_0x417610(_0x4a6fdf);});}return new(_0x3115ee||(_0x3115ee=Promise))(function(_0x4c91da,_0x3aeeec){function _0x14db5f(_0x410af2){try{_0x11b159(_0xb93d7f['next'](_0x410af2));}catch(_0xf5541e){_0x3aeeec(_0xf5541e);}}function _0x37708e(_0x1dcb3c){try{_0x11b159(_0xb93d7f['throw'](_0x1dcb3c));}catch(_0x32658d){_0x3aeeec(_0x32658d);}}function _0x11b159(_0x21a7ff){_0x21a7ff[a10_0x5ee0('0x2c')]?_0x4c91da(_0x21a7ff[a10_0x5ee0('0x2e')]):_0x3868dd(_0x21a7ff[a10_0x5ee0('0x2e')])[a10_0x5ee0('0x13')](_0x14db5f,_0x37708e);}_0x11b159((_0xb93d7f=_0xb93d7f[a10_0x5ee0('0xa')](_0x1eb054,_0x1726f5||[]))[a10_0x5ee0('0x1c')]());});};Object[a10_0x5ee0('0x1b')](exports,a10_0x5ee0('0x2f'),{'value':!![]});exports['createStartRequest']=exports[a10_0x5ee0('0x23')]=void 0x0;const axios_1=require('../../../utilities/axios');const environment_1=require('../../../utilities/environment');const metric_logger_1=require('../../../utilities/metric-logger');const serializer_overrides_1=require(a10_0x5ee0('0x25'));const {output}=require(a10_0x5ee0('0xe'));class DistributedExecutionApi{constructor(_0x427dd6){this[a10_0x5ee0('0x27')]=(0x0,axios_1[a10_0x5ee0('0x5')])(_0x427dd6);}[a10_0x5ee0('0x6')](_0x9dce83){var _0x231300;return __awaiter(this,void 0x0,void 0x0,function*(){const _0xc25eaa=(0x0,metric_logger_1['createMetricRecorder'])(a10_0x5ee0('0x18'));let _0x4f403f;if(environment_1[a10_0x5ee0('0x9')]){output[a10_0x5ee0('0x2b')]({'title':a10_0x5ee0('0x12'),'bodyLines':[JSON['stringify'](_0x9dce83,null,0x2)]});}try{_0x4f403f=yield(0x0,axios_1[a10_0x5ee0('0xb')])(()=>this[a10_0x5ee0('0x27')][a10_0x5ee0('0x17')](a10_0x5ee0('0x11'),_0x9dce83));_0xc25eaa[a10_0x5ee0('0x8')]((0x0,metric_logger_1[a10_0x5ee0('0x31')])(_0x4f403f));}catch(_0x4fcee7){_0xc25eaa[a10_0x5ee0('0x8')](((_0x231300=_0x4fcee7===null||_0x4fcee7===void 0x0?void 0x0:_0x4fcee7[a10_0x5ee0('0x1e')])===null||_0x231300===void 0x0?void 0x0:_0x231300[a10_0x5ee0('0x32')])?(0x0,metric_logger_1['mapRespToPerfEntry'])(_0x4fcee7['axiosException'][a10_0x5ee0('0x32')]):metric_logger_1[a10_0x5ee0('0x1d')]);throw _0x4fcee7;}if(!_0x4f403f['data'][a10_0x5ee0('0x22')]){throw new Error('Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.');}if(_0x4f403f[a10_0x5ee0('0x10')][a10_0x5ee0('0x26')]){throw new Error(_0x4f403f[a10_0x5ee0('0x10')][a10_0x5ee0('0x26')]);}return _0x4f403f['data']['id'];});}['status'](_0x32d92c){var _0x4a877b;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x183215=(0x0,metric_logger_1[a10_0x5ee0('0x2d')])(a10_0x5ee0('0x21'));try{const _0x34a6bc=yield(0x0,axios_1[a10_0x5ee0('0xb')])(()=>this[a10_0x5ee0('0x27')][a10_0x5ee0('0x17')]('/nx-cloud/executions/status',{'id':_0x32d92c}));_0x183215['recordMetric']((0x0,metric_logger_1[a10_0x5ee0('0x31')])(_0x34a6bc));return _0x34a6bc[a10_0x5ee0('0x10')];}catch(_0x44fd6f){_0x183215[a10_0x5ee0('0x8')](((_0x4a877b=_0x44fd6f===null||_0x44fd6f===void 0x0?void 0x0:_0x44fd6f[a10_0x5ee0('0x1e')])===null||_0x4a877b===void 0x0?void 0x0:_0x4a877b[a10_0x5ee0('0x32')])?(0x0,metric_logger_1['mapRespToPerfEntry'])(_0x44fd6f[a10_0x5ee0('0x1e')]['response']):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);output[a10_0x5ee0('0x26')]({'title':_0x44fd6f['message']});process[a10_0x5ee0('0x2')](0x1);}});}[a10_0x5ee0('0x16')](_0x25612e,_0x19ed91,_0x3f09d1,_0xf0babd,_0x2ab760){var _0x108a19;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x492c95=(0x0,metric_logger_1['createMetricRecorder'])(a10_0x5ee0('0x19'));if(environment_1[a10_0x5ee0('0x9')]){output['note']({'title':'Completing\x20with\x20an\x20error','bodyLines':['ciExecutionId:\x20'+_0x3f09d1,a10_0x5ee0('0x1')+_0xf0babd,'runGroup:\x20'+_0x19ed91,a10_0x5ee0('0xc')+_0x2ab760]});}try{const _0x3b9201=yield(0x0,axios_1['axiosMultipleTries'])(()=>this['apiAxiosInstance'][a10_0x5ee0('0x17')](a10_0x5ee0('0x1a'),{'runGroup':_0x19ed91,'ciExecutionId':_0x3f09d1,'ciExecutionEnv':_0xf0babd,'criticalErrorMessage':_0x2ab760}),0x3);_0x492c95['recordMetric']((0x0,metric_logger_1[a10_0x5ee0('0x31')])(_0x3b9201));}catch(_0xbd2b0f){_0x492c95[a10_0x5ee0('0x8')](((_0x108a19=_0xbd2b0f===null||_0xbd2b0f===void 0x0?void 0x0:_0xbd2b0f['axiosException'])===null||_0x108a19===void 0x0?void 0x0:_0x108a19[a10_0x5ee0('0x32')])?(0x0,metric_logger_1['mapRespToPerfEntry'])(_0xbd2b0f[a10_0x5ee0('0x1e')][a10_0x5ee0('0x32')]):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);}});}}exports[a10_0x5ee0('0x23')]=DistributedExecutionApi;function createStartRequest(_0x513534,_0x324d14,_0x73ff6b,_0x375539,_0x43fb1f,_0x56c0d8){const _0x1b5dcb=_0x43fb1f['map'](_0x3fb1b4=>{return _0x3fb1b4[a10_0x5ee0('0x14')](_0x32d8ce=>{return{'taskId':_0x32d8ce['id'],'hash':_0x32d8ce[a10_0x5ee0('0x4')],'projectName':_0x32d8ce['target'][a10_0x5ee0('0x28')],'target':_0x32d8ce['target']['target'],'configuration':_0x32d8ce[a10_0x5ee0('0x3')][a10_0x5ee0('0x30')]||null,'params':(0x0,serializer_overrides_1[a10_0x5ee0('0x15')])(_0x32d8ce)};});});const _0x369b43={'command':(0x0,environment_1[a10_0x5ee0('0x7')])(),'branch':_0x513534,'runGroup':_0x324d14,'ciExecutionId':_0x73ff6b,'ciExecutionEnv':_0x375539,'tasks':_0x1b5dcb,'maxParallel':calculateMaxParallel(_0x56c0d8)};if(environment_1['NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT']){_0x369b43[a10_0x5ee0('0x0')]=environment_1[a10_0x5ee0('0xd')];}if(!environment_1[a10_0x5ee0('0xf')]){_0x369b43[a10_0x5ee0('0x29')]=![];}return _0x369b43;}exports[a10_0x5ee0('0x2a')]=createStartRequest;function calculateMaxParallel(_0x1d25ba){if(_0x1d25ba[a10_0x5ee0('0x1f')]===a10_0x5ee0('0x20')||_0x1d25ba['parallel']===![]){return 0x1;}else if(_0x1d25ba[a10_0x5ee0('0x1f')]==='true'||_0x1d25ba[a10_0x5ee0('0x1f')]===!![]){return Number(_0x1d25ba['maxParallel']||0x3);}else if(_0x1d25ba[a10_0x5ee0('0x1f')]===undefined){return _0x1d25ba[a10_0x5ee0('0x24')]?Number(_0x1d25ba[a10_0x5ee0('0x24')]):0x3;}else{return Number(_0x1d25ba[a10_0x5ee0('0x1f')])||0x3;}}